/*! For license information please see main.0bd1ddb9.js.LICENSE.txt */
!function(){var e={2957:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(A){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(i[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=u(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function s(e,t){if(isNaN(e))return t?m:g;if(t){if(e<0)return m;if(e>=d)return w}else{if(e<=-p)return I;if(e+1>=p)return k}return e<0?s(-e,t).neg():u(e%h|0,e/h|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=u;var c=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var a=s(c(n,8)),i=g,o=0;o<e.length;o+=8){var u=Math.min(8,e.length-o),f=parseInt(e.substring(o,o+u),n);if(u<8){var h=s(c(n,u));i=i.mul(h).add(s(f))}else i=(i=i.mul(a)).add(s(f))}return i.unsigned=t,i}function f(e,t){return"number"===typeof e?s(e,t):"string"===typeof e?l(e,t):u(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=f;var h=4294967296,d=h*h,p=d/2,v=o(1<<24),g=o(0);n.ZERO=g;var m=o(0,!0);n.UZERO=m;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var k=u(-1,2147483647,!1);n.MAX_VALUE=k;var w=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=w;var I=u(0,-2147483648,!1);n.MIN_VALUE=I;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(I)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=s(c(e,6),this.unsigned),i=this,o="";;){var u=i.div(a),l=(i.sub(u.mul(a)).toInt()>>>0).toString(e);if((i=u).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1===(1&this.low)},C.isEven=function(){return 0===(1&this.low)},C.equals=function(e){return r(e)||(e=f(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(r(e)||(e=f(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(y)},C.neg=C.negate,C.add=function(e){r(e)||(e=f(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,c=e.low>>>16,l=0,h=0,d=0,p=0;return d+=(p+=i+(65535&e.low))>>>16,h+=(d+=a+c)>>>16,l+=(h+=n+s)>>>16,l+=t+o,u((d&=65535)<<16|(p&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},C.subtract=function(e){return r(e)||(e=f(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=f(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(I))return e.isOdd()?I:g;if(e.eq(I))return this.isOdd()?I:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(v)&&e.lt(v))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,l=65535&e.high,h=e.low>>>16,d=65535&e.low,p=0,m=0,y=0,b=0;return y+=(b+=o*d)>>>16,m+=(y+=i*d)>>>16,y&=65535,m+=(y+=o*h)>>>16,p+=(m+=a*d)>>>16,m&=65535,p+=(m+=i*h)>>>16,m&=65535,p+=(m+=o*l)>>>16,p+=n*d+a*h+i*l+o*c,u((y&=65535)<<16|(b&=65535),(p&=65535)<<16|(m&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(r(e)||(e=f(e)),e.isZero())throw Error("division by zero");var n,a,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return b;i=m}else{if(this.eq(I))return e.eq(y)||e.eq(x)?I:e.eq(I)?y:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:x:(a=this.sub(e.mul(n)),i=n.add(a.div(e)));if(e.eq(I))return this.unsigned?m:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=g}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),h=s(n),d=h.mul(e);d.isNegative()||d.gt(a);)d=(h=s(n-=l,this.unsigned)).mul(e);h.isZero()&&(h=y),i=i.add(h),a=a.sub(d)}return i},C.div=C.divide,C.modulo=function(e){return r(e)||(e=f(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return u(~this.low,~this.high,this.unsigned)},C.and=function(e){return r(e)||(e=f(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return r(e)||(e=f(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return r(e)||(e=f(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},3152:function(e,t,n){var r=n(4088),a=n(632),i=n(690),o=n(9381),s=n(2947),u=n(8272),c=n(910);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},4088:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},8272:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},632:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},2947:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},9381:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},690:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},910:function(e,t,n){var r;!function(a,i,o){var s,u=256,c=6,l="random",f=o.pow(u,c),h=o.pow(2,52),d=2*h,p=u-1;function v(e,t,n){var r=[],p=b(y((t=1==t?{entropy:!0}:t||{}).entropy?[e,x(i)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(u):(e=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(e)),x(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,x(i)]}}():e,3),r),v=new g(r),k=function(){for(var e=v.g(c),t=f,n=0;e<h;)e=(e+n)*u,t*=u,n=v.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return k.int32=function(){return 0|v.g(4)},k.quick=function(){return v.g(4)/4294967296},k.double=k,b(x(v.S),i),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,v),e.state=function(){return m(v,{})}),n?(o[l]=e,t):e})(k,p,"global"in t?t.global:this==o,t.state)}function g(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=p&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=p&a+1],n=n*u+o[p&(o[a]=o[i=p&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function y(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(y(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function b(e,t){for(var n,r=e+"",a=0;a<r.length;)t[p&a]=p&(n^=19*t[p&a])+r.charCodeAt(a++);return x(t)}function x(e){return String.fromCharCode.apply(0,e)}if(b(o.random(),i),e.exports){e.exports=v;try{s=n(3706)}catch(k){}}else void 0===(r=function(){return v}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},1694:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var o=a.apply(null,n);o&&e.push(o)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},4890:function(e){var t={px:{px:1,cm:96/2.54,mm:96/25.4,in:96,pt:96/72,pc:16},cm:{px:2.54/96,cm:1,mm:.1,in:2.54,pt:2.54/72,pc:2.54/6},mm:{px:25.4/96,cm:10,mm:1,in:25.4,pt:25.4/72,pc:25.4/6},in:{px:1/96,cm:1/2.54,mm:1/25.4,in:1,pt:1/72,pc:1/6},pt:{px:.75,cm:72/2.54,mm:72/25.4,in:72,pt:1,pc:12},pc:{px:6/96,cm:6/2.54,mm:6/25.4,in:6,pt:6/72,pc:1},deg:{deg:1,grad:.9,rad:180/Math.PI,turn:360},grad:{deg:400/360,grad:1,rad:200/Math.PI,turn:400},rad:{deg:Math.PI/180,grad:Math.PI/200,rad:1,turn:2*Math.PI},turn:{deg:1/360,grad:1/400,rad:.5/Math.PI,turn:1},s:{s:1,ms:.001},ms:{s:1e3,ms:1},Hz:{Hz:1,kHz:1e3},kHz:{Hz:.001,kHz:1},dpi:{dpi:1,dpcm:1/2.54,dppx:1/96},dpcm:{dpi:2.54,dpcm:1,dppx:2.54/96},dppx:{dpi:96,dpcm:96/2.54,dppx:1}};e.exports=function(e,n,r,a){if(!t.hasOwnProperty(r))throw new Error("Cannot convert to "+r);if(!t[r].hasOwnProperty(n))throw new Error("Cannot convert from "+n+" to "+r);var i=t[r][n]*e;return!1!==a?(a=Math.pow(10,parseInt(a)||5),Math.round(i*a)/a):i}},4234:function(e,t,n){var r;!function(a){"use strict";var i,o=1e9,s={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},u=!0,c="[DecimalError] ",l=c+"Invalid argument: ",f=c+"Exponent out of range: ",h=Math.floor,d=Math.pow,p=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,v=1e7,g=7,m=9007199254740991,y=h(m/g),b={};function x(e,t){var n,r,a,i,o,s,c,l,f=e.constructor,h=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),u?N(t,h):t;if(c=e.d,l=t.d,o=e.e,a=t.e,c=c.slice(),i=o-a){for(i<0?(r=c,i=-i,s=l.length):(r=l,a=o,s=c.length),i>(s=(o=Math.ceil(h/g))>s?o+1:s+1)&&(i=s,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for((s=c.length)-(i=l.length)<0&&(i=s,r=l,l=c,c=r),n=0;i;)n=(c[--i]=c[i]+l[i]+n)/v|0,c[i]%=v;for(n&&(c.unshift(n),++a),s=c.length;0==c[--s];)c.pop();return t.d=c,t.e=a,u?N(t,h):t}function k(e,t,n){if(e!==~~e||e<t||e>n)throw Error(l+e)}function w(e){var t,n,r,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)r=e[t]+"",(n=g-r.length)&&(i+=_(n)),i+=r;o=e[t],(n=g-(r=o+"").length)&&(i+=_(n))}else if(0===o)return"0";for(;o%10===0;)o/=10;return i+o}b.absoluteValue=b.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},b.comparedTo=b.cmp=function(e){var t,n,r,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(t=0,n=(r=i.d.length)<(a=e.d.length)?r:a;t<n;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return r===a?0:r>a^i.s<0?1:-1},b.decimalPlaces=b.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*g;if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},b.dividedBy=b.div=function(e){return I(this,new this.constructor(e))},b.dividedToIntegerBy=b.idiv=function(e){var t=this.constructor;return N(I(this,new t(e),0,1),t.precision)},b.equals=b.eq=function(e){return!this.cmp(e)},b.exponent=function(){return A(this)},b.greaterThan=b.gt=function(e){return this.cmp(e)>0},b.greaterThanOrEqualTo=b.gte=function(e){return this.cmp(e)>=0},b.isInteger=b.isint=function(){return this.e>this.d.length-2},b.isNegative=b.isneg=function(){return this.s<0},b.isPositive=b.ispos=function(){return this.s>0},b.isZero=function(){return 0===this.s},b.lessThan=b.lt=function(e){return this.cmp(e)<0},b.lessThanOrEqualTo=b.lte=function(e){return this.cmp(e)<1},b.logarithm=b.log=function(e){var t,n=this,r=n.constructor,a=r.precision,o=a+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(i))throw Error(c+"NaN");if(n.s<1)throw Error(c+(n.s?"NaN":"-Infinity"));return n.eq(i)?new r(0):(u=!1,t=I(E(n,o),E(e,o),o),u=!0,N(t,a))},b.minus=b.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?O(t,e):x(t,(e.s=-e.s,e))},b.modulo=b.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(!(e=new r(e)).s)throw Error(c+"NaN");return n.s?(u=!1,t=I(n,e,0,1).times(e),u=!0,n.minus(t)):N(new r(n),a)},b.naturalExponential=b.exp=function(){return C(this)},b.naturalLogarithm=b.ln=function(){return E(this)},b.negated=b.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},b.plus=b.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?x(t,e):O(t,(e.s=-e.s,e))},b.precision=b.sd=function(e){var t,n,r,a=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(l+e);if(t=A(a)+1,n=(r=a.d.length-1)*g+1,r=a.d[r]){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},b.squareRoot=b.sqrt=function(){var e,t,n,r,a,i,o,s=this,l=s.constructor;if(s.s<1){if(!s.s)return new l(0);throw Error(c+"NaN")}for(e=A(s),u=!1,0==(a=Math.sqrt(+s))||a==1/0?(((t=w(s.d)).length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=h((e+1)/2)-(e<0||e%2),r=new l(t=a==1/0?"5e"+e:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new l(a.toString()),a=o=(n=l.precision)+3;;)if(r=(i=r).plus(I(s,i,o+2)).times(.5),w(i.d).slice(0,o)===(t=w(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&"4999"==t){if(N(i,n+1,0),i.times(i).eq(s)){r=i;break}}else if("9999"!=t)break;o+=4}return u=!0,N(r,n)},b.times=b.mul=function(e){var t,n,r,a,i,o,s,c,l,f=this,h=f.constructor,d=f.d,p=(e=new h(e)).d;if(!f.s||!e.s)return new h(0);for(e.s*=f.s,n=f.e+e.e,(c=d.length)<(l=p.length)&&(i=d,d=p,p=i,o=c,c=l,l=o),i=[],r=o=c+l;r--;)i.push(0);for(r=l;--r>=0;){for(t=0,a=c+r;a>r;)s=i[a]+p[r]*d[a-r-1]+t,i[a--]=s%v|0,t=s/v|0;i[a]=(i[a]+t)%v|0}for(;!i[--o];)i.pop();return t?++n:i.shift(),e.d=i,e.e=n,u?N(e,h.precision):e},b.toDecimalPlaces=b.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(k(e,0,o),void 0===t?t=r.rounding:k(t,0,8),N(n,e+A(n)+1,t))},b.toExponential=function(e,t){var n,r=this,a=r.constructor;return void 0===e?n=R(r,!0):(k(e,0,o),void 0===t?t=a.rounding:k(t,0,8),n=R(r=N(new a(r),e+1,t),!0,e+1)),n},b.toFixed=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?R(a):(k(e,0,o),void 0===t?t=i.rounding:k(t,0,8),n=R((r=N(new i(a),e+A(a)+1,t)).abs(),!1,e+A(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},b.toInteger=b.toint=function(){var e=this,t=e.constructor;return N(new t(e),A(e)+1,t.rounding)},b.toNumber=function(){return+this},b.toPower=b.pow=function(e){var t,n,r,a,o,s,l=this,f=l.constructor,d=+(e=new f(e));if(!e.s)return new f(i);if(!(l=new f(l)).s){if(e.s<1)throw Error(c+"Infinity");return l}if(l.eq(i))return l;if(r=f.precision,e.eq(i))return N(l,r);if(s=(t=e.e)>=(n=e.d.length-1),o=l.s,s){if((n=d<0?-d:d)<=m){for(a=new f(i),t=Math.ceil(r/g+4),u=!1;n%2&&P((a=a.times(l)).d,t),0!==(n=h(n/2));)P((l=l.times(l)).d,t);return u=!0,e.s<0?new f(i).div(a):N(a,r)}}else if(o<0)throw Error(c+"NaN");return o=o<0&&1&e.d[Math.max(t,n)]?-1:1,l.s=1,u=!1,a=e.times(E(l,r+12)),u=!0,(a=C(a)).s=o,a},b.toPrecision=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?r=R(a,(n=A(a))<=i.toExpNeg||n>=i.toExpPos):(k(e,1,o),void 0===t?t=i.rounding:k(t,0,8),r=R(a=N(new i(a),e,t),e<=(n=A(a))||n<=i.toExpNeg,e)),r},b.toSignificantDigits=b.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(k(e,1,o),void 0===t?t=n.rounding:k(t,0,8)),N(new n(this),e,t)},b.toString=b.valueOf=b.val=b.toJSON=function(){var e=this,t=A(e),n=e.constructor;return R(e,t<=n.toExpNeg||t>=n.toExpPos)};var I=function(){function e(e,t){var n,r=0,a=e.length;for(e=e.slice();a--;)n=e[a]*t+r,e[a]=n%v|0,r=n/v|0;return r&&e.unshift(r),e}function t(e,t,n,r){var a,i;if(n!=r)i=n>r?1:-1;else for(a=i=0;a<n;a++)if(e[a]!=t[a]){i=e[a]>t[a]?1:-1;break}return i}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*v+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,a,i,o){var s,u,l,f,h,d,p,m,y,b,x,k,w,I,C,S,_,E,T=r.constructor,O=r.s==a.s?1:-1,R=r.d,P=a.d;if(!r.s)return new T(r);if(!a.s)throw Error(c+"Division by zero");for(u=r.e-a.e,_=P.length,C=R.length,m=(p=new T(O)).d=[],l=0;P[l]==(R[l]||0);)++l;if(P[l]>(R[l]||0)&&--u,(k=null==i?i=T.precision:o?i+(A(r)-A(a))+1:i)<0)return new T(0);if(k=k/g+2|0,l=0,1==_)for(f=0,P=P[0],k++;(l<C||f)&&k--;l++)w=f*v+(R[l]||0),m[l]=w/P|0,f=w%P|0;else{for((f=v/(P[0]+1)|0)>1&&(P=e(P,f),R=e(R,f),_=P.length,C=R.length),I=_,b=(y=R.slice(0,_)).length;b<_;)y[b++]=0;(E=P.slice()).unshift(0),S=P[0],P[1]>=v/2&&++S;do{f=0,(s=t(P,y,_,b))<0?(x=y[0],_!=b&&(x=x*v+(y[1]||0)),(f=x/S|0)>1?(f>=v&&(f=v-1),1==(s=t(h=e(P,f),y,d=h.length,b=y.length))&&(f--,n(h,_<d?E:P,d))):(0==f&&(s=f=1),h=P.slice()),(d=h.length)<b&&h.unshift(0),n(y,h,b),-1==s&&(s=t(P,y,_,b=y.length))<1&&(f++,n(y,_<b?E:P,b)),b=y.length):0===s&&(f++,y=[0]),m[l++]=f,s&&y[0]?y[b++]=R[I]||0:(y=[R[I]],b=1)}while((I++<C||void 0!==y[0])&&k--)}return m[0]||m.shift(),p.e=u,N(p,o?i+A(p)+1:i)}}();function C(e,t){var n,r,a,o,s,c=0,l=0,h=e.constructor,p=h.precision;if(A(e)>16)throw Error(f+A(e));if(!e.s)return new h(i);for(null==t?(u=!1,s=p):s=t,o=new h(.03125);e.abs().gte(.1);)e=e.times(o),l+=5;for(s+=Math.log(d(2,l))/Math.LN10*2+5|0,n=r=a=new h(i),h.precision=s;;){if(r=N(r.times(e),s),n=n.times(++c),w((o=a.plus(I(r,n,s))).d).slice(0,s)===w(a.d).slice(0,s)){for(;l--;)a=N(a.times(a),s);return h.precision=p,null==t?(u=!0,N(a,p)):a}a=o}}function A(e){for(var t=e.e*g,n=e.d[0];n>=10;n/=10)t++;return t}function S(e,t,n){if(t>e.LN10.sd())throw u=!0,n&&(e.precision=n),Error(c+"LN10 precision limit exceeded");return N(new e(e.LN10),t)}function _(e){for(var t="";e--;)t+="0";return t}function E(e,t){var n,r,a,o,s,l,f,h,d,p=1,v=e,g=v.d,m=v.constructor,y=m.precision;if(v.s<1)throw Error(c+(v.s?"NaN":"-Infinity"));if(v.eq(i))return new m(0);if(null==t?(u=!1,h=y):h=t,v.eq(10))return null==t&&(u=!0),S(m,h);if(h+=10,m.precision=h,r=(n=w(g)).charAt(0),o=A(v),!(Math.abs(o)<15e14))return f=S(m,h+2,y).times(o+""),v=E(new m(r+"."+n.slice(1)),h-10).plus(f),m.precision=y,null==t?(u=!0,N(v,y)):v;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=w((v=v.times(e)).d)).charAt(0),p++;for(o=A(v),r>1?(v=new m("0."+n),o++):v=new m(r+"."+n.slice(1)),l=s=v=I(v.minus(i),v.plus(i),h),d=N(v.times(v),h),a=3;;){if(s=N(s.times(d),h),w((f=l.plus(I(s,new m(a),h))).d).slice(0,h)===w(l.d).slice(0,h))return l=l.times(2),0!==o&&(l=l.plus(S(m,h+2,y).times(o+""))),l=I(l,new m(p),h),m.precision=y,null==t?(u=!0,N(l,y)):l;l=f,a+=2}}function T(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(a=t.length;48===t.charCodeAt(a-1);)--a;if(t=t.slice(r,a)){if(a-=r,n=n-r-1,e.e=h(n/g),e.d=[],r=(n+1)%g,n<0&&(r+=g),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=g;r<a;)e.d.push(+t.slice(r,r+=g));t=t.slice(r),r=g-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),u&&(e.e>y||e.e<-y))throw Error(f+n)}else e.s=0,e.e=0,e.d=[0];return e}function N(e,t,n){var r,a,i,o,s,c,l,p,m=e.d;for(o=1,i=m[0];i>=10;i/=10)o++;if((r=t-o)<0)r+=g,a=t,l=m[p=0];else{if((p=Math.ceil((r+1)/g))>=(i=m.length))return e;for(l=i=m[p],o=1;i>=10;i/=10)o++;a=(r%=g)-g+o}if(void 0!==n&&(s=l/(i=d(10,o-a-1))%10|0,c=t<0||void 0!==m[p+1]||l%i,c=n<4?(s||c)&&(0==n||n==(e.s<0?3:2)):s>5||5==s&&(4==n||c||6==n&&(r>0?a>0?l/d(10,o-a):0:m[p-1])%10&1||n==(e.s<0?8:7))),t<1||!m[0])return c?(i=A(e),m.length=1,t=t-i-1,m[0]=d(10,(g-t%g)%g),e.e=h(-t/g)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(0==r?(m.length=p,i=1,p--):(m.length=p+1,i=d(10,g-r),m[p]=a>0?(l/d(10,o-a)%d(10,a)|0)*i:0),c)for(;;){if(0==p){(m[0]+=i)==v&&(m[0]=1,++e.e);break}if(m[p]+=i,m[p]!=v)break;m[p--]=0,i=1}for(r=m.length;0===m[--r];)m.pop();if(u&&(e.e>y||e.e<-y))throw Error(f+A(e));return e}function O(e,t){var n,r,a,i,o,s,c,l,f,h,d=e.constructor,p=d.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new d(e),u?N(t,p):t;if(c=e.d,h=t.d,r=t.e,l=e.e,c=c.slice(),o=l-r){for((f=o<0)?(n=c,o=-o,s=h.length):(n=h,r=l,s=c.length),o>(a=Math.max(Math.ceil(p/g),s)+2)&&(o=a,n.length=1),n.reverse(),a=o;a--;)n.push(0);n.reverse()}else{for((f=(a=c.length)<(s=h.length))&&(s=a),a=0;a<s;a++)if(c[a]!=h[a]){f=c[a]<h[a];break}o=0}for(f&&(n=c,c=h,h=n,t.s=-t.s),s=c.length,a=h.length-s;a>0;--a)c[s++]=0;for(a=h.length;a>o;){if(c[--a]<h[a]){for(i=a;i&&0===c[--i];)c[i]=v-1;--c[i],c[a]+=v}c[a]-=h[a]}for(;0===c[--s];)c.pop();for(;0===c[0];c.shift())--r;return c[0]?(t.d=c,t.e=r,u?N(t,p):t):new d(0)}function R(e,t,n){var r,a=A(e),i=w(e.d),o=i.length;return t?(n&&(r=n-o)>0?i=i.charAt(0)+"."+i.slice(1)+_(r):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+_(-a-1)+i,n&&(r=n-o)>0&&(i+=_(r))):a>=o?(i+=_(a+1-o),n&&(r=n-a-1)>0&&(i=i+"."+_(r))):((r=a+1)<o&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-o)>0&&(a+1===o&&(i+="."),i+=_(r))),e.s<0?"-"+i:i}function P(e,t){if(e.length>t)return e.length=t,!0}function D(e){if(!e||"object"!==typeof e)throw Error(c+"Object expected");var t,n,r,a=["precision",1,o,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if(void 0!==(r=e[n=a[t]])){if(!(h(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(l+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(l+n+": "+r);this[n]=new this(r)}return this}s=function e(t){var n,r,a;function i(e){var t=this;if(!(t instanceof i))return new i(e);if(t.constructor=i,e instanceof i)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"===typeof e){if(0*e!==0)throw Error(l+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):T(t,e.toString())}if("string"!==typeof e)throw Error(l+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!p.test(e))throw Error(l+e);T(t,e)}if(i.prototype=b,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=e,i.config=i.set=D,void 0===t&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<a.length;)t.hasOwnProperty(r=a[n++])||(t[r]=this[r]);return i.config(t),i}(s),s.default=s.Decimal=s,i=new s(1),void 0===(r=function(){return s}.call(t,n,t,e))||(e.exports=r)}()},8354:function(e,t,n){"use strict";var r=n(4836);t.__esModule=!0,t.default=function(e,t){e.classList?e.classList.add(t):(0,a.default)(e,t)||("string"===typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))};var a=r(n(3812));e.exports=t.default},3812:function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")},e.exports=t.default},2910:function(e){"use strict";function t(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}e.exports=function(e,n){e.classList?e.classList.remove(n):"string"===typeof e.className?e.className=t(e.className,n):e.setAttribute("class",t(e.className&&e.className.baseVal||"",n))}},7143:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,o){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new a(r,i||e,o),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,i=r.length,o=new Array(i);a<i;a++)o[a]=r[a].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,a,i,o){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,a),!0;case 5:return l.fn.call(l.context,t,r,a,i),!0;case 6:return l.fn.call(l.context,t,r,a,i,o),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,a);break;default:if(!u)for(h=1,u=new Array(f-1);h<f;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,a){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||a&&!s.once||r&&s.context!==r||o(this,i);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||a&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[i]=1===c.length?c[0]:c:o(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},5244:function(e,t){!function(e){"use strict";function t(e){return function(t,n,r,a,i,o,s){return e(t,n,s)}}function n(e){return function(t,n,r,a){if(!t||!n||"object"!==typeof t||"object"!==typeof n)return e(t,n,r,a);var i=a.get(t),o=a.get(n);if(i&&o)return i===n&&o===t;a.set(t,n),a.set(n,t);var s=e(t,n,r,a);return a.delete(t),a.delete(n),s}}function r(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}function a(e){return e.constructor===Object||null==e.constructor}function i(e){return"function"===typeof e.then}function o(e,t){return e===t||e!==e&&t!==t}var s="[object Arguments]",u="[object Boolean]",c="[object Date]",l="[object RegExp]",f="[object Map]",h="[object Number]",d="[object Object]",p="[object Set]",v="[object String]",g=Object.prototype.toString;function m(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areMapsEqual,m=e.areObjectsEqual,y=e.areRegExpsEqual,b=e.areSetsEqual,x=(0,e.createIsNestedEqual)(k);function k(e,k,w){if(e===k)return!0;if(!e||!k||"object"!==typeof e||"object"!==typeof k)return e!==e&&k!==k;if(a(e)&&a(k))return m(e,k,x,w);var I=Array.isArray(e),C=Array.isArray(k);if(I||C)return I===C&&t(e,k,x,w);var A=g.call(e);return A===g.call(k)&&(A===c?n(e,k,x,w):A===l?y(e,k,x,w):A===f?r(e,k,x,w):A===p?b(e,k,x,w):A===d||A===s?!i(e)&&!i(k)&&m(e,k,x,w):(A===u||A===h||A===v)&&o(e.valueOf(),k.valueOf()))}return k}function y(e,t,n,r){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(!n(e[a],t[a],a,a,e,t,r))return!1;return!0}var b=n(y);function x(e,t){return o(e.valueOf(),t.valueOf())}function k(e,t,n,r){var a=e.size===t.size;if(!a)return!1;if(!e.size)return!0;var i={},o=0;return e.forEach((function(s,u){if(a){var c=!1,l=0;t.forEach((function(a,f){c||i[l]||!(c=n(u,f,o,l,e,t,r)&&n(s,a,u,f,e,t,r))||(i[l]=!0),l++})),o++,a=c}})),a}var w=n(k),I="_owner",C=Object.prototype.hasOwnProperty;function A(e,t,n,r){var a,i=Object.keys(e),o=i.length;if(Object.keys(t).length!==o)return!1;for(;o-- >0;){if((a=i[o])===I){var s=!!e.$$typeof,u=!!t.$$typeof;if((s||u)&&s!==u)return!1}if(!C.call(t,a)||!n(e[a],t[a],a,a,e,t,r))return!1}return!0}var S=n(A);function _(e,t){return e.source===t.source&&e.flags===t.flags}function E(e,t,n,r){var a=e.size===t.size;if(!a)return!1;if(!e.size)return!0;var i={};return e.forEach((function(o,s){if(a){var u=!1,c=0;t.forEach((function(a,l){u||i[c]||!(u=n(o,a,s,l,e,t,r))||(i[c]=!0),c++})),a=u}})),a}var T=n(E),N=Object.freeze({areArraysEqual:y,areDatesEqual:x,areMapsEqual:k,areObjectsEqual:A,areRegExpsEqual:_,areSetsEqual:E,createIsNestedEqual:t}),O=Object.freeze({areArraysEqual:b,areDatesEqual:x,areMapsEqual:w,areObjectsEqual:S,areRegExpsEqual:_,areSetsEqual:T,createIsNestedEqual:t}),R=m(N);function P(e,t){return R(e,t,void 0)}var D=m(r(N,{createIsNestedEqual:function(){return o}}));function M(e,t){return D(e,t,void 0)}var F=m(O);function L(e,t){return F(e,t,new WeakMap)}var j=m(r(O,{createIsNestedEqual:function(){return o}}));function z(e,t){return j(e,t,new WeakMap)}function U(e){return m(r(N,e(N)))}function B(e){var t=m(r(O,e(O)));return function(e,n,r){return void 0===r&&(r=new WeakMap),t(e,n,r)}}e.circularDeepEqual=L,e.circularShallowEqual=z,e.createCustomCircularEqual=B,e.createCustomEqual=U,e.deepEqual=P,e.sameValueZeroEqual=o,e.shallowEqual=M,Object.defineProperty(e,"__esModule",{value:!0})}(t)},2110:function(e,t,n){"use strict";var r=n(8309),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?o:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,l=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var a=d(n);a&&a!==p&&e(t,a,r)}var o=l(n);f&&(o=o.concat(f(n)));for(var s=u(t),v=u(n),g=0;g<o.length;++g){var m=o[g];if(!i[m]&&(!r||!r[m])&&(!v||!v[m])&&(!s||!s[m])){var y=h(n,m);try{c(t,m,y)}catch(b){}}}}return t}},746:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function k(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case f:case i:case s:case o:case d:return e;default:switch(e=e&&e.$$typeof){case c:case h:case g:case v:case u:return e;default:return t}}case a:return t}}}function w(e){return k(e)===f}t.AsyncMode=l,t.ConcurrentMode=f,t.ContextConsumer=c,t.ContextProvider=u,t.Element=r,t.ForwardRef=h,t.Fragment=i,t.Lazy=g,t.Memo=v,t.Portal=a,t.Profiler=s,t.StrictMode=o,t.Suspense=d,t.isAsyncMode=function(e){return w(e)||k(e)===l},t.isConcurrentMode=w,t.isContextConsumer=function(e){return k(e)===c},t.isContextProvider=function(e){return k(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return k(e)===h},t.isFragment=function(e){return k(e)===i},t.isLazy=function(e){return k(e)===g},t.isMemo=function(e){return k(e)===v},t.isPortal=function(e){return k(e)===a},t.isProfiler=function(e){return k(e)===s},t.isStrictMode=function(e){return k(e)===o},t.isSuspense=function(e){return k(e)===d},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===f||e===s||e===o||e===d||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===v||e.$$typeof===u||e.$$typeof===c||e.$$typeof===h||e.$$typeof===y||e.$$typeof===b||e.$$typeof===x||e.$$typeof===m)},t.typeOf=k},8309:function(e,t,n){"use strict";e.exports=n(746)},908:function(e,t,n){var r=n(8136)(n(7009),"DataView");e.exports=r},9676:function(e,t,n){var r=n(5403),a=n(2747),i=n(6037),o=n(4154),s=n(7728);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,e.exports=u},8384:function(e,t,n){var r=n(3894),a=n(8699),i=n(4957),o=n(7184),s=n(7109);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,e.exports=u},5797:function(e,t,n){var r=n(8136)(n(7009),"Map");e.exports=r},8059:function(e,t,n){var r=n(4086),a=n(9255),i=n(9186),o=n(3423),s=n(3739);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,e.exports=u},8319:function(e,t,n){var r=n(8136)(n(7009),"Promise");e.exports=r},3924:function(e,t,n){var r=n(8136)(n(7009),"Set");e.exports=r},692:function(e,t,n){var r=n(8059),a=n(5774),i=n(1596);function o(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}o.prototype.add=o.prototype.push=a,o.prototype.has=i,e.exports=o},2854:function(e,t,n){var r=n(8384),a=n(511),i=n(835),o=n(707),s=n(8832),u=n(5077);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=a,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=u,e.exports=c},7197:function(e,t,n){var r=n(7009).Symbol;e.exports=r},6219:function(e,t,n){var r=n(7009).Uint8Array;e.exports=r},7091:function(e,t,n){var r=n(8136)(n(7009),"WeakMap");e.exports=r},3665:function(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},8573:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}},4903:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,a=0,i=[];++n<r;){var o=e[n];t(o,n,e)&&(i[a++]=o)}return i}},9055:function(e,t,n){var r=n(4842);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},2683:function(e){e.exports=function(e,t,n){for(var r=-1,a=null==e?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}},7538:function(e,t,n){var r=n(6478),a=n(4963),i=n(3629),o=n(5174),s=n(6800),u=n(9102),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),l=!n&&a(e),f=!n&&!l&&o(e),h=!n&&!l&&!f&&u(e),d=n||l||f||h,p=d?r(e.length,String):[],v=p.length;for(var g in e)!t&&!c.call(e,g)||d&&("length"==g||f&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v))||p.push(g);return p}},8950:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}},1705:function(e){e.exports=function(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}},7897:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},4622:function(e){e.exports=function(e){return e.split("")}},7112:function(e,t,n){var r=n(9231);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},2526:function(e,t,n){var r=n(8528);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},7927:function(e,t,n){var r=n(5358),a=n(7056)(r);e.exports=a},9863:function(e,t,n){var r=n(7927);e.exports=function(e,t){var n=!0;return r(e,(function(e,r,a){return n=!!t(e,r,a)})),n}},3079:function(e,t,n){var r=n(152);e.exports=function(e,t,n){for(var a=-1,i=e.length;++a<i;){var o=e[a],s=t(o);if(null!=s&&(void 0===u?s===s&&!r(s):n(s,u)))var u=s,c=o}return c}},2045:function(e){e.exports=function(e,t,n,r){for(var a=e.length,i=n+(r?1:-1);r?i--:++i<a;)if(t(e[i],i,e))return i;return-1}},5182:function(e,t,n){var r=n(1705),a=n(3529);e.exports=function e(t,n,i,o,s){var u=-1,c=t.length;for(i||(i=a),s||(s=[]);++u<c;){var l=t[u];n>0&&i(l)?n>1?e(l,n-1,i,o,s):r(s,l):o||(s[s.length]=l)}return s}},5099:function(e,t,n){var r=n(372)();e.exports=r},5358:function(e,t,n){var r=n(5099),a=n(2742);e.exports=function(e,t){return e&&r(e,t,a)}},8667:function(e,t,n){var r=n(3082),a=n(9793);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[a(t[n++])];return n&&n==i?e:void 0}},1986:function(e,t,n){var r=n(1705),a=n(3629);e.exports=function(e,t,n){var i=t(e);return a(e)?i:r(i,n(e))}},9066:function(e,t,n){var r=n(7197),a=n(1587),i=n(3581),o="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?s:o:u&&u in Object(e)?a(e):i(e)}},1954:function(e){e.exports=function(e,t){return e>t}},529:function(e){e.exports=function(e,t){return null!=e&&t in Object(e)}},4842:function(e,t,n){var r=n(2045),a=n(505),i=n(7167);e.exports=function(e,t,n){return t===t?i(e,t,n):r(e,a,n)}},4906:function(e,t,n){var r=n(9066),a=n(3141),i="[object Arguments]";e.exports=function(e){return a(e)&&r(e)==i}},1848:function(e,t,n){var r=n(3355),a=n(3141);e.exports=function e(t,n,i,o,s){return t===n||(null==t||null==n||!a(t)&&!a(n)?t!==t&&n!==n:r(t,n,i,o,e,s))}},3355:function(e,t,n){var r=n(2854),a=n(5305),i=n(2206),o=n(8078),s=n(8383),u=n(3629),c=n(5174),l=n(9102),f=1,h="[object Arguments]",d="[object Array]",p="[object Object]",v=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,g,m,y){var b=u(e),x=u(t),k=b?d:s(e),w=x?d:s(t),I=(k=k==h?p:k)==p,C=(w=w==h?p:w)==p,A=k==w;if(A&&c(e)){if(!c(t))return!1;b=!0,I=!1}if(A&&!I)return y||(y=new r),b||l(e)?a(e,t,n,g,m,y):i(e,t,k,n,g,m,y);if(!(n&f)){var S=I&&v.call(e,"__wrapped__"),_=C&&v.call(t,"__wrapped__");if(S||_){var E=S?e.value():e,T=_?t.value():t;return y||(y=new r),m(E,T,n,g,y)}}return!!A&&(y||(y=new r),o(e,t,n,g,m,y))}},8856:function(e,t,n){var r=n(2854),a=n(1848),i=1,o=2;e.exports=function(e,t,n,s){var u=n.length,c=u,l=!s;if(null==e)return!c;for(e=Object(e);u--;){var f=n[u];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++u<c;){var h=(f=n[u])[0],d=e[h],p=f[1];if(l&&f[2]){if(void 0===d&&!(h in e))return!1}else{var v=new r;if(s)var g=s(d,p,h,e,t,v);if(!(void 0===g?a(p,d,i|o,s,v):g))return!1}}return!0}},505:function(e){e.exports=function(e){return e!==e}},6703:function(e,t,n){var r=n(4786),a=n(257),i=n(8092),o=n(7907),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,f=c.hasOwnProperty,h=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||a(e))&&(r(e)?h:s).test(o(e))}},8150:function(e,t,n){var r=n(9066),a=n(4635),i=n(3141),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&a(e.length)&&!!o[r(e)]}},6025:function(e,t,n){var r=n(7080),a=n(4322),i=n(2100),o=n(3629),s=n(38);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?o(e)?a(e[0],e[1]):r(e):s(e)}},3654:function(e,t,n){var r=n(2936),a=n(8836),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return a(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},2580:function(e){e.exports=function(e,t){return e<t}},3849:function(e,t,n){var r=n(7927),a=n(1473);e.exports=function(e,t){var n=-1,i=a(e)?Array(e.length):[];return r(e,(function(e,r,a){i[++n]=t(e,r,a)})),i}},7080:function(e,t,n){var r=n(8856),a=n(9091),i=n(284);e.exports=function(e){var t=a(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},4322:function(e,t,n){var r=n(1848),a=n(6181),i=n(5658),o=n(5823),s=n(5072),u=n(284),c=n(9793),l=1,f=2;e.exports=function(e,t){return o(e)&&s(t)?u(c(e),t):function(n){var o=a(n,e);return void 0===o&&o===t?i(n,e):r(t,o,l|f)}}},3226:function(e,t,n){var r=n(8950),a=n(8667),i=n(6025),o=n(3849),s=n(9179),u=n(6194),c=n(4480),l=n(2100),f=n(3629);e.exports=function(e,t,n){t=t.length?r(t,(function(e){return f(e)?function(t){return a(t,1===e.length?e[0]:e)}:e})):[l];var h=-1;t=r(t,u(i));var d=o(e,(function(e,n,a){return{criteria:r(t,(function(t){return t(e)})),index:++h,value:e}}));return s(d,(function(e,t){return c(e,t,n)}))}},9586:function(e){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},4084:function(e,t,n){var r=n(8667);e.exports=function(e){return function(t){return r(t,e)}}},7255:function(e){var t=Math.ceil,n=Math.max;e.exports=function(e,r,a,i){for(var o=-1,s=n(t((r-e)/(a||1)),0),u=Array(s);s--;)u[i?s:++o]=e,e+=a;return u}},8794:function(e,t,n){var r=n(2100),a=n(4262),i=n(9156);e.exports=function(e,t){return i(a(e,t,r),e+"")}},7532:function(e,t,n){var r=n(1547),a=n(8528),i=n(2100),o=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=o},2646:function(e){e.exports=function(e,t,n){var r=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(a);++r<a;)i[r]=e[r+t];return i}},9204:function(e,t,n){var r=n(7927);e.exports=function(e,t){var n;return r(e,(function(e,r,a){return!(n=t(e,r,a))})),!!n}},9179:function(e){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},6478:function(e){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},2446:function(e,t,n){var r=n(7197),a=n(8950),i=n(3629),o=n(152),s=1/0,u=r?r.prototype:void 0,c=u?u.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return a(t,e)+"";if(o(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-s?"-0":n}},821:function(e,t,n){var r=n(6050),a=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(a,""):e}},6194:function(e){e.exports=function(e){return function(t){return e(t)}}},9602:function(e,t,n){var r=n(692),a=n(9055),i=n(2683),o=n(75),s=n(7730),u=n(2230),c=200;e.exports=function(e,t,n){var l=-1,f=a,h=e.length,d=!0,p=[],v=p;if(n)d=!1,f=i;else if(h>=c){var g=t?null:s(e);if(g)return u(g);d=!1,f=o,v=new r}else v=t?[]:p;e:for(;++l<h;){var m=e[l],y=t?t(m):m;if(m=n||0!==m?m:0,d&&y===y){for(var b=v.length;b--;)if(v[b]===y)continue e;t&&v.push(y),p.push(m)}else f(v,y,n)||(v!==p&&v.push(y),p.push(m))}return p}},75:function(e){e.exports=function(e,t){return e.has(t)}},3082:function(e,t,n){var r=n(3629),a=n(5823),i=n(170),o=n(3518);e.exports=function(e,t){return r(e)?e:a(e,t)?[e]:i(o(e))}},9813:function(e,t,n){var r=n(2646);e.exports=function(e,t,n){var a=e.length;return n=void 0===n?a:n,!t&&n>=a?e:r(e,t,n)}},8558:function(e,t,n){var r=n(152);e.exports=function(e,t){if(e!==t){var n=void 0!==e,a=null===e,i=e===e,o=r(e),s=void 0!==t,u=null===t,c=t===t,l=r(t);if(!u&&!l&&!o&&e>t||o&&s&&c&&!u&&!l||a&&s&&c||!n&&c||!i)return 1;if(!a&&!o&&!l&&e<t||l&&n&&i&&!a&&!o||u&&n&&i||!s&&i||!c)return-1}return 0}},4480:function(e,t,n){var r=n(8558);e.exports=function(e,t,n){for(var a=-1,i=e.criteria,o=t.criteria,s=i.length,u=n.length;++a<s;){var c=r(i[a],o[a]);if(c)return a>=u?c:c*("desc"==n[a]?-1:1)}return e.index-t.index}},5525:function(e,t,n){var r=n(7009)["__core-js_shared__"];e.exports=r},7056:function(e,t,n){var r=n(1473);e.exports=function(e,t){return function(n,a){if(null==n)return n;if(!r(n))return e(n,a);for(var i=n.length,o=t?i:-1,s=Object(n);(t?o--:++o<i)&&!1!==a(s[o],o,s););return n}}},372:function(e){e.exports=function(e){return function(t,n,r){for(var a=-1,i=Object(t),o=r(t),s=o.length;s--;){var u=o[e?s:++a];if(!1===n(i[u],u,i))break}return t}}},322:function(e,t,n){var r=n(9813),a=n(7302),i=n(7580),o=n(3518);e.exports=function(e){return function(t){t=o(t);var n=a(t)?i(t):void 0,s=n?n[0]:t.charAt(0),u=n?r(n,1).join(""):t.slice(1);return s[e]()+u}}},5481:function(e,t,n){var r=n(6025),a=n(1473),i=n(2742);e.exports=function(e){return function(t,n,o){var s=Object(t);if(!a(t)){var u=r(n,3);t=i(t),n=function(e){return u(s[e],e,s)}}var c=e(t,n,o);return c>-1?s[u?t[c]:c]:void 0}}},6381:function(e,t,n){var r=n(7255),a=n(3195),i=n(1495);e.exports=function(e){return function(t,n,o){return o&&"number"!=typeof o&&a(t,n,o)&&(n=o=void 0),t=i(t),void 0===n?(n=t,t=0):n=i(n),o=void 0===o?t<n?1:-1:i(o),r(t,n,o,e)}}},7730:function(e,t,n){var r=n(3924),a=n(9694),i=n(2230),o=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:a;e.exports=o},8528:function(e,t,n){var r=n(8136),a=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=a},5305:function(e,t,n){var r=n(692),a=n(7897),i=n(75),o=1,s=2;e.exports=function(e,t,n,u,c,l){var f=n&o,h=e.length,d=t.length;if(h!=d&&!(f&&d>h))return!1;var p=l.get(e),v=l.get(t);if(p&&v)return p==t&&v==e;var g=-1,m=!0,y=n&s?new r:void 0;for(l.set(e,t),l.set(t,e);++g<h;){var b=e[g],x=t[g];if(u)var k=f?u(x,b,g,t,e,l):u(b,x,g,e,t,l);if(void 0!==k){if(k)continue;m=!1;break}if(y){if(!a(t,(function(e,t){if(!i(y,t)&&(b===e||c(b,e,n,u,l)))return y.push(t)}))){m=!1;break}}else if(b!==x&&!c(b,x,n,u,l)){m=!1;break}}return l.delete(e),l.delete(t),m}},2206:function(e,t,n){var r=n(7197),a=n(6219),i=n(9231),o=n(5305),s=n(234),u=n(2230),c=1,l=2,f="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Map]",v="[object Number]",g="[object RegExp]",m="[object Set]",y="[object String]",b="[object Symbol]",x="[object ArrayBuffer]",k="[object DataView]",w=r?r.prototype:void 0,I=w?w.valueOf:void 0;e.exports=function(e,t,n,r,w,C,A){switch(n){case k:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case x:return!(e.byteLength!=t.byteLength||!C(new a(e),new a(t)));case f:case h:case v:return i(+e,+t);case d:return e.name==t.name&&e.message==t.message;case g:case y:return e==t+"";case p:var S=s;case m:var _=r&c;if(S||(S=u),e.size!=t.size&&!_)return!1;var E=A.get(e);if(E)return E==t;r|=l,A.set(e,t);var T=o(S(e),S(t),r,w,C,A);return A.delete(e),T;case b:if(I)return I.call(e)==I.call(t)}return!1}},8078:function(e,t,n){var r=n(8248),a=1,i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,s,u){var c=n&a,l=r(e),f=l.length;if(f!=r(t).length&&!c)return!1;for(var h=f;h--;){var d=l[h];if(!(c?d in t:i.call(t,d)))return!1}var p=u.get(e),v=u.get(t);if(p&&v)return p==t&&v==e;var g=!0;u.set(e,t),u.set(t,e);for(var m=c;++h<f;){var y=e[d=l[h]],b=t[d];if(o)var x=c?o(b,y,d,t,e,u):o(y,b,d,e,t,u);if(!(void 0===x?y===b||s(y,b,n,o,u):x)){g=!1;break}m||(m="constructor"==d)}if(g&&!m){var k=e.constructor,w=t.constructor;k==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof k&&k instanceof k&&"function"==typeof w&&w instanceof w||(g=!1)}return u.delete(e),u.delete(t),g}},1032:function(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},8248:function(e,t,n){var r=n(1986),a=n(5918),i=n(2742);e.exports=function(e){return r(e,i,a)}},2799:function(e,t,n){var r=n(5964);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},9091:function(e,t,n){var r=n(5072),a=n(2742);e.exports=function(e){for(var t=a(e),n=t.length;n--;){var i=t[n],o=e[i];t[n]=[i,o,r(o)]}return t}},8136:function(e,t,n){var r=n(6703),a=n(40);e.exports=function(e,t){var n=a(e,t);return r(n)?n:void 0}},1587:function(e,t,n){var r=n(7197),a=Object.prototype,i=a.hasOwnProperty,o=a.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(u){}var a=o.call(e);return r&&(t?e[s]=n:delete e[s]),a}},5918:function(e,t,n){var r=n(4903),a=n(8174),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(e){return null==e?[]:(e=Object(e),r(o(e),(function(t){return i.call(e,t)})))}:a;e.exports=s},8383:function(e,t,n){var r=n(908),a=n(5797),i=n(8319),o=n(3924),s=n(7091),u=n(9066),c=n(7907),l="[object Map]",f="[object Promise]",h="[object Set]",d="[object WeakMap]",p="[object DataView]",v=c(r),g=c(a),m=c(i),y=c(o),b=c(s),x=u;(r&&x(new r(new ArrayBuffer(1)))!=p||a&&x(new a)!=l||i&&x(i.resolve())!=f||o&&x(new o)!=h||s&&x(new s)!=d)&&(x=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case v:return p;case g:return l;case m:return f;case y:return h;case b:return d}return t}),e.exports=x},40:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},6417:function(e,t,n){var r=n(3082),a=n(4963),i=n(3629),o=n(6800),s=n(4635),u=n(9793);e.exports=function(e,t,n){for(var c=-1,l=(t=r(t,e)).length,f=!1;++c<l;){var h=u(t[c]);if(!(f=null!=e&&n(e,h)))break;e=e[h]}return f||++c!=l?f:!!(l=null==e?0:e.length)&&s(l)&&o(h,l)&&(i(e)||a(e))}},7302:function(e){var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},5403:function(e,t,n){var r=n(9620);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},2747:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},6037:function(e,t,n){var r=n(9620),a="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return n===a?void 0:n}return i.call(t,e)?t[e]:void 0}},4154:function(e,t,n){var r=n(9620),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:a.call(t,e)}},7728:function(e,t,n){var r=n(9620),a="__lodash_hash_undefined__";e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?a:t,this}},3529:function(e,t,n){var r=n(7197),a=n(4963),i=n(3629),o=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||a(e)||!!(o&&e&&e[o])}},6800:function(e){var t=9007199254740991,n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var a=typeof e;return!!(r=null==r?t:r)&&("number"==a||"symbol"!=a&&n.test(e))&&e>-1&&e%1==0&&e<r}},3195:function(e,t,n){var r=n(9231),a=n(1473),i=n(6800),o=n(8092);e.exports=function(e,t,n){if(!o(n))return!1;var s=typeof t;return!!("number"==s?a(n)&&i(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},5823:function(e,t,n){var r=n(3629),a=n(152),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!a(e))||(o.test(e)||!i.test(e)||null!=t&&e in Object(t))}},5964:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},257:function(e,t,n){var r=n(5525),a=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!a&&a in e}},2936:function(e){var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},5072:function(e,t,n){var r=n(8092);e.exports=function(e){return e===e&&!r(e)}},3894:function(e){e.exports=function(){this.__data__=[],this.size=0}},8699:function(e,t,n){var r=n(7112),a=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)}},4957:function(e,t,n){var r=n(7112);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},7184:function(e,t,n){var r=n(7112);e.exports=function(e){return r(this.__data__,e)>-1}},7109:function(e,t,n){var r=n(7112);e.exports=function(e,t){var n=this.__data__,a=r(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this}},4086:function(e,t,n){var r=n(9676),a=n(8384),i=n(5797);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||a),string:new r}}},9255:function(e,t,n){var r=n(2799);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},9186:function(e,t,n){var r=n(2799);e.exports=function(e){return r(this,e).get(e)}},3423:function(e,t,n){var r=n(2799);e.exports=function(e){return r(this,e).has(e)}},3739:function(e,t,n){var r=n(2799);e.exports=function(e,t){var n=r(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this}},234:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},284:function(e){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},4634:function(e,t,n){var r=n(9151),a=500;e.exports=function(e){var t=r(e,(function(e){return n.size===a&&n.clear(),e})),n=t.cache;return t}},9620:function(e,t,n){var r=n(8136)(Object,"create");e.exports=r},8836:function(e,t,n){var r=n(2709)(Object.keys,Object);e.exports=r},9494:function(e,t,n){e=n.nmd(e);var r=n(1032),a=t&&!t.nodeType&&t,i=a&&e&&!e.nodeType&&e,o=i&&i.exports===a&&r.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(t){}}();e.exports=s},3581:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},2709:function(e){e.exports=function(e,t){return function(n){return e(t(n))}}},4262:function(e,t,n){var r=n(3665),a=Math.max;e.exports=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=a(i.length-t,0),u=Array(s);++o<s;)u[o]=i[t+o];o=-1;for(var c=Array(t+1);++o<t;)c[o]=i[o];return c[t]=n(u),r(e,this,c)}}},7009:function(e,t,n){var r=n(1032),a="object"==typeof self&&self&&self.Object===Object&&self,i=r||a||Function("return this")();e.exports=i},5774:function(e){var t="__lodash_hash_undefined__";e.exports=function(e){return this.__data__.set(e,t),this}},1596:function(e){e.exports=function(e){return this.__data__.has(e)}},2230:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},9156:function(e,t,n){var r=n(7532),a=n(3197)(r);e.exports=a},3197:function(e){var t=800,n=16,r=Date.now;e.exports=function(e){var a=0,i=0;return function(){var o=r(),s=n-(o-i);if(i=o,s>0){if(++a>=t)return arguments[0]}else a=0;return e.apply(void 0,arguments)}}},511:function(e,t,n){var r=n(8384);e.exports=function(){this.__data__=new r,this.size=0}},835:function(e){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},707:function(e){e.exports=function(e){return this.__data__.get(e)}},8832:function(e){e.exports=function(e){return this.__data__.has(e)}},5077:function(e,t,n){var r=n(8384),a=n(5797),i=n(8059),o=200;e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!a||s.length<o-1)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(s)}return n.set(e,t),this.size=n.size,this}},7167:function(e){e.exports=function(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}},7580:function(e,t,n){var r=n(4622),a=n(7302),i=n(2129);e.exports=function(e){return a(e)?i(e):r(e)}},170:function(e,t,n){var r=n(4634),a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,o=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(a,(function(e,n,r,a){t.push(r?a.replace(i,"$1"):n||e)})),t}));e.exports=o},9793:function(e,t,n){var r=n(152),a=1/0;e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}},7907:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}},6050:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},2129:function(e){var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+r+"|"+a+")"+"?",c="[\\ufe0e\\ufe0f]?",l=c+u+("(?:\\u200d(?:"+[i,o,s].join("|")+")"+c+u+")*"),f="(?:"+[i+r+"?",r,o,s,n].join("|")+")",h=RegExp(a+"(?="+a+")|"+f+l,"g");e.exports=function(e){return e.match(h)||[]}},1547:function(e){e.exports=function(e){return function(){return e}}},4003:function(e,t,n){var r=n(8092),a=n(72),i=n(2582),o="Expected a function",s=Math.max,u=Math.min;e.exports=function(e,t,n){var c,l,f,h,d,p,v=0,g=!1,m=!1,y=!0;if("function"!=typeof e)throw new TypeError(o);function b(t){var n=c,r=l;return c=l=void 0,v=t,h=e.apply(r,n)}function x(e){var n=e-p;return void 0===p||n>=t||n<0||m&&e-v>=f}function k(){var e=a();if(x(e))return w(e);d=setTimeout(k,function(e){var n=t-(e-p);return m?u(n,f-(e-v)):n}(e))}function w(e){return d=void 0,y&&c?b(e):(c=l=void 0,h)}function I(){var e=a(),n=x(e);if(c=arguments,l=this,p=e,n){if(void 0===d)return function(e){return v=e,d=setTimeout(k,t),g?b(e):h}(p);if(m)return clearTimeout(d),d=setTimeout(k,t),b(p)}return void 0===d&&(d=setTimeout(k,t)),h}return t=i(t)||0,r(n)&&(g=!!n.leading,f=(m="maxWait"in n)?s(i(n.maxWait)||0,t):f,y="trailing"in n?!!n.trailing:y),I.cancel=function(){void 0!==d&&clearTimeout(d),v=0,c=p=l=d=void 0},I.flush=function(){return void 0===d?h:w(a())},I}},9231:function(e){e.exports=function(e,t){return e===t||e!==e&&t!==t}},2730:function(e,t,n){var r=n(8573),a=n(9863),i=n(6025),o=n(3629),s=n(3195);e.exports=function(e,t,n){var u=o(e)?r:a;return n&&s(e,t,n)&&(t=void 0),u(e,i(t,3))}},1211:function(e,t,n){var r=n(5481)(n(1475));e.exports=r},1475:function(e,t,n){var r=n(2045),a=n(6025),i=n(9753),o=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var u=null==n?0:i(n);return u<0&&(u=o(s+u,0)),r(e,a(t,3),u)}},5008:function(e,t,n){var r=n(5182),a=n(2034);e.exports=function(e,t){return r(a(e,t),1)}},6181:function(e,t,n){var r=n(8667);e.exports=function(e,t,n){var a=null==e?void 0:r(e,t);return void 0===a?n:a}},5658:function(e,t,n){var r=n(529),a=n(6417);e.exports=function(e,t){return null!=e&&a(e,t,r)}},2100:function(e){e.exports=function(e){return e}},4963:function(e,t,n){var r=n(4906),a=n(3141),i=Object.prototype,o=i.hasOwnProperty,s=i.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return a(e)&&o.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},3629:function(e){var t=Array.isArray;e.exports=t},1473:function(e,t,n){var r=n(4786),a=n(4635);e.exports=function(e){return null!=e&&a(e.length)&&!r(e)}},5127:function(e,t,n){var r=n(9066),a=n(3141),i="[object Boolean]";e.exports=function(e){return!0===e||!1===e||a(e)&&r(e)==i}},5174:function(e,t,n){e=n.nmd(e);var r=n(7009),a=n(9488),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.Buffer:void 0,u=(s?s.isBuffer:void 0)||a;e.exports=u},8111:function(e,t,n){var r=n(1848);e.exports=function(e,t){return r(e,t)}},4786:function(e,t,n){var r=n(9066),a=n(8092),i="[object AsyncFunction]",o="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";e.exports=function(e){if(!a(e))return!1;var t=r(e);return t==o||t==s||t==i||t==u}},4635:function(e){var t=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=t}},2066:function(e,t,n){var r=n(298);e.exports=function(e){return r(e)&&e!=+e}},5633:function(e){e.exports=function(e){return null==e}},298:function(e,t,n){var r=n(9066),a=n(3141),i="[object Number]";e.exports=function(e){return"number"==typeof e||a(e)&&r(e)==i}},8092:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3141:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},6769:function(e,t,n){var r=n(9066),a=n(3629),i=n(3141),o="[object String]";e.exports=function(e){return"string"==typeof e||!a(e)&&i(e)&&r(e)==o}},152:function(e,t,n){var r=n(9066),a=n(3141),i="[object Symbol]";e.exports=function(e){return"symbol"==typeof e||a(e)&&r(e)==i}},9102:function(e,t,n){var r=n(8150),a=n(6194),i=n(9494),o=i&&i.isTypedArray,s=o?a(o):r;e.exports=s},2742:function(e,t,n){var r=n(7538),a=n(3654),i=n(1473);e.exports=function(e){return i(e)?r(e):a(e)}},5727:function(e){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},2034:function(e,t,n){var r=n(8950),a=n(6025),i=n(3849),o=n(3629);e.exports=function(e,t){return(o(e)?r:i)(e,a(t,3))}},7702:function(e,t,n){var r=n(2526),a=n(5358),i=n(6025);e.exports=function(e,t){var n={};return t=i(t,3),a(e,(function(e,a,i){r(n,a,t(e,a,i))})),n}},9627:function(e,t,n){var r=n(3079),a=n(1954),i=n(2100);e.exports=function(e){return e&&e.length?r(e,i,a):void 0}},9151:function(e,t,n){var r=n(8059),a="Expected a function";function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(a);var n=function n(){var r=arguments,a=t?t.apply(this,r):r[0],i=n.cache;if(i.has(a))return i.get(a);var o=e.apply(this,r);return n.cache=i.set(a,o)||i,o};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},6452:function(e,t,n){var r=n(3079),a=n(2580),i=n(2100);e.exports=function(e){return e&&e.length?r(e,i,a):void 0}},9694:function(e){e.exports=function(){}},72:function(e,t,n){var r=n(7009);e.exports=function(){return r.Date.now()}},38:function(e,t,n){var r=n(9586),a=n(4084),i=n(5823),o=n(9793);e.exports=function(e){return i(e)?r(o(e)):a(e)}},6222:function(e,t,n){var r=n(6381)();e.exports=r},4064:function(e,t,n){var r=n(7897),a=n(6025),i=n(9204),o=n(3629),s=n(3195);e.exports=function(e,t,n){var u=o(e)?r:i;return n&&s(e,t,n)&&(t=void 0),u(e,a(t,3))}},4286:function(e,t,n){var r=n(5182),a=n(3226),i=n(8794),o=n(3195),s=i((function(e,t){if(null==e)return[];var n=t.length;return n>1&&o(e,t[0],t[1])?t=[]:n>2&&o(t[0],t[1],t[2])&&(t=[t[0]]),a(e,r(t,1),[])}));e.exports=s},8174:function(e){e.exports=function(){return[]}},9488:function(e){e.exports=function(){return!1}},3038:function(e,t,n){var r=n(4003),a=n(8092),i="Expected a function";e.exports=function(e,t,n){var o=!0,s=!0;if("function"!=typeof e)throw new TypeError(i);return a(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),r(e,t,{leading:o,maxWait:t,trailing:s})}},1495:function(e,t,n){var r=n(2582),a=1/0,i=17976931348623157e292;e.exports=function(e){return e?(e=r(e))===a||e===-a?(e<0?-1:1)*i:e===e?e:0:0===e?e:0}},9753:function(e,t,n){var r=n(1495);e.exports=function(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}},2582:function(e,t,n){var r=n(821),a=n(8092),i=n(152),o=NaN,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return o;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=u.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):s.test(e)?o:+e}},3518:function(e,t,n){var r=n(2446);e.exports=function(e){return null==e?"":r(e)}},6339:function(e,t,n){var r=n(6025),a=n(9602);e.exports=function(e,t){return e&&e.length?a(e,r(t,2)):[]}},2085:function(e,t,n){var r=n(322)("toUpperCase");e.exports=r},888:function(e,t,n){"use strict";var r=n(9047);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7981:function(e,t,n){"use strict";var r=n(2791),a=n(4164);function i(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function o(e){if(i(e)!==e)throw Error("Unable to find node on an unmounted component.")}var s=Object.assign;function u(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function c(){return!0}function l(){return!1}function f(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?c:l,this.isPropagationStopped=l,this}return s(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=c)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=c)},persist:function(){},isPersistent:c}),t}var h={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},d=f(h),p=s({},h,{view:0,detail:0});f(p);var v,g,m,y=s({},p,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:I,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==m&&(m&&"mousemove"===e.type?(v=e.screenX-m.screenX,g=e.screenY-m.screenY):g=v=0,m=e),v)},movementY:function(e){return"movementY"in e?e.movementY:g}});f(y),f(s({},y,{dataTransfer:0})),f(s({},p,{relatedTarget:0})),f(s({},h,{animationName:0,elapsedTime:0,pseudoElement:0})),f(s({},h,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),f(s({},h,{data:0}));var b={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},x={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},k={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function w(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=k[e])&&!!t[e]}function I(){return w}function C(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}f(s({},p,{key:function(e){if(e.key){var t=b[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=u(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?x[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:I,charCode:function(e){return"keypress"===e.type?u(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?u(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),f(s({},y,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),f(s({},p,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:I})),f(s({},h,{propertyName:0,elapsedTime:0,pseudoElement:0})),f(s({},y,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}));var A=!1,S=null,_=!1,E=null,T={onError:function(e){A=!0,S=e}};function N(e,t,n,r,a,i,o,s,u){A=!1,S=null,C.apply(T,arguments)}var O=Array.isArray,R=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Events,P=R[0],D=R[1],M=R[2],F=R[3],L=R[4],j=r.unstable_act;function z(){}function U(e,t){if(!e)return[];if(e=function(e){var t=e.alternate;if(!t){if(null===(t=i(e)))throw Error("Unable to find node on an unmounted component.");return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return o(a),e;if(s===r)return o(a),t;s=s.sibling}throw Error("Unable to find node on an unmounted component.")}if(n.return!==r.return)n=a,r=s;else{for(var u=!1,c=a.child;c;){if(c===n){u=!0,n=a,r=s;break}if(c===r){u=!0,r=a,n=s;break}c=c.sibling}if(!u){for(c=s.child;c;){if(c===n){u=!0,n=s,r=a;break}if(c===r){u=!0,r=s,n=a;break}c=c.sibling}if(!u)throw Error("Child was not found in either parent set. This indicates a bug in React related to the return pointer. Please file an issue.")}}if(n.alternate!==r)throw Error("Return fibers should always be each others' alternates. This error is likely caused by a bug in React. Please file an issue.")}if(3!==n.tag)throw Error("Unable to find node on an unmounted component.");return n.stateNode.current===n?e:t}(e),!e)return[];for(var n=e,r=[];;){if(5===n.tag||6===n.tag||1===n.tag||0===n.tag){var a=n.stateNode;t(a)&&r.push(a)}if(n.child)n.child.return=n,n=n.child;else{if(n===e)return r;for(;!n.sibling;){if(!n.return||n.return===e)return r;n=n.return}n.sibling.return=n.return,n=n.sibling}}}function B(e,t){if(e&&!e._reactInternals){var n=String(e);throw e=O(e)?"an array":e&&1===e.nodeType&&e.tagName?"a DOM node":"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,Error(t+"(...): the first argument must be a React class instance. Instead received: "+e+".")}}function W(e){return!(!e||1!==e.nodeType||!e.tagName)}function V(e){return!W(e)&&(null!=e&&"function"===typeof e.render&&"function"===typeof e.setState)}function G(e,t){return!!V(e)&&e._reactInternals.type===t}function H(e,t){return B(e,"findAllInRenderedTree"),e?U(e._reactInternals,t):[]}function K(e,t){return B(e,"scryRenderedDOMComponentsWithClass"),H(e,(function(e){if(W(e)){var n=e.className;"string"!==typeof n&&(n=e.getAttribute("class")||"");var r=n.split(/\s+/);if(!O(t)){if(void 0===t)throw Error("TestUtils.scryRenderedDOMComponentsWithClass expects a className as a second argument.");t=t.split(/\s+/)}return t.every((function(e){return-1!==r.indexOf(e)}))}return!1}))}function q(e,t){return B(e,"scryRenderedDOMComponentsWithTag"),H(e,(function(e){return W(e)&&e.tagName.toUpperCase()===t.toUpperCase()}))}function X(e,t){return B(e,"scryRenderedComponentsWithType"),H(e,(function(e){return G(e,t)}))}function Y(e,t,n){var r=e.type||"unknown-event";e.currentTarget=D(n),function(e,t,n,r,a,i,o,s,u){if(N.apply(this,arguments),A){if(!A)throw Error("clearCaughtError was called but no error was captured. This error is likely caused by a bug in React. Please file an issue.");var c=S;A=!1,S=null,_||(_=!0,E=c)}}(r,t,void 0,e),e.currentTarget=null}function Z(e,t,n){for(var r=[];e;){r.push(e);do{e=e.return}while(e&&5!==e.tag);e=e||null}for(e=r.length;0<e--;)t(r[e],"captured",n);for(e=0;e<r.length;e++)t(r[e],"bubbled",n)}function Q(e,t){var n=e.stateNode;if(!n)return null;var r=M(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error("Expected `"+t+"` listener to be a function, instead got a value of `"+typeof n+"` type.");return n}function J(e,t,n){var r=n._reactName;"captured"===t&&(r+="Capture"),(t=Q(e,r))&&(null==n._dispatchListeners&&(n._dispatchListeners=[]),null==n._dispatchInstances&&(n._dispatchInstances=[]),n._dispatchListeners.push(t),n._dispatchInstances.push(e))}var $={},ee=new Set(["mouseEnter","mouseLeave","pointerEnter","pointerLeave"]);function te(e){return function(t,n){if(r.isValidElement(t))throw Error("TestUtils.Simulate expected a DOM node as the first argument but received a React element. Pass the DOM node you wish to simulate the event on instead. Note that TestUtils.Simulate will not work if you are using shallow rendering.");if(V(t))throw Error("TestUtils.Simulate expected a DOM node as the first argument but received a component instance. Pass the DOM node you wish to simulate the event on instead.");var i="on"+e[0].toUpperCase()+e.slice(1),o=new z;o.target=t,o.type=e.toLowerCase();var u=P(t),c=new d(i,o.type,u,o,t);c.persist(),s(c,n),ee.has(e)?c&&c._reactName&&function(e,t,n){e&&n&&n._reactName&&(t=Q(e,n._reactName))&&(null==n._dispatchListeners&&(n._dispatchListeners=[]),null==n._dispatchInstances&&(n._dispatchInstances=[]),n._dispatchListeners.push(t),n._dispatchInstances.push(e))}(c._targetInst,null,c):c&&c._reactName&&Z(c._targetInst,J,c),a.unstable_batchedUpdates((function(){if(F(t),c){var e=c._dispatchListeners,n=c._dispatchInstances;if(O(e))for(var r=0;r<e.length&&!c.isPropagationStopped();r++)Y(c,e[r],n[r]);else e&&Y(c,e,n);c._dispatchListeners=null,c._dispatchInstances=null,c.isPersistent()||c.constructor.release(c)}if(_)throw e=E,_=!1,E=null,e})),L()}}"blur cancel click close contextMenu copy cut auxClick doubleClick dragEnd dragStart drop focus input invalid keyDown keyPress keyUp mouseDown mouseUp paste pause play pointerCancel pointerDown pointerUp rateChange reset resize seeked submit touchCancel touchEnd touchStart volumeChange drag dragEnter dragExit dragLeave dragOver mouseMove mouseOut mouseOver pointerMove pointerOut pointerOver scroll toggle touchMove wheel abort animationEnd animationIteration animationStart canPlay canPlayThrough durationChange emptied encrypted ended error gotPointerCapture load loadedData loadedMetadata loadStart lostPointerCapture playing progress seeking stalled suspend timeUpdate transitionEnd waiting mouseEnter mouseLeave pointerEnter pointerLeave change select beforeInput compositionEnd compositionStart compositionUpdate".split(" ").forEach((function(e){$[e]=te(e)}))},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!f.call(p,e)||!f.call(d,e)&&(h.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),w=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var F,L=Object.assign;function j(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var z=!1;function U(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function B(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case I:return"Fragment";case w:return"Portal";case A:return"Profiler";case C:return"StrictMode";case T:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return W(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function ie(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,fe=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var me=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ie=null,Ce=null;function Ae(e){if(e=ba(e)){if("function"!==typeof we)throw Error(i(280));var t=e.stateNode;t&&(t=ka(t),we(e.stateNode,e.type,t))}}function Se(e){Ie?Ce?Ce.push(e):Ce=[e]:Ie=e}function _e(){if(Ie){var e=Ie,t=Ce;if(Ce=Ie=null,Ae(e),t)for(e=0;e<t.length;e++)Ae(t[e])}}function Ee(e,t){return e(t)}function Te(){}var Ne=!1;function Oe(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return Ee(e,t,n)}finally{Ne=!1,(null!==Ie||null!==Ce)&&(Te(),_e())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=ka(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Pe=!1;if(l)try{var De={};Object.defineProperty(De,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(le){Pe=!1}function Me(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Fe=!1,Le=null,je=!1,ze=null,Ue={onError:function(e){Fe=!0,Le=e}};function Be(e,t,n,r,a,i,o,s,u){Fe=!1,Le=null,Me.apply(Ue,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(We(e)!==e)throw Error(i(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ge(a),e;if(o===r)return Ge(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var qe=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Ze=a.unstable_requestPaint,Qe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,$e=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ft(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ft(s):0!==(i&=o)&&(r=ft(i))}else 0!==(o=n&~a)?r=ft(o):0!==i&&(r=ft(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,wt,It,Ct,At,St=!1,_t=[],Et=null,Tt=null,Nt=null,Ot=new Map,Rt=new Map,Pt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Ft(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ya(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void At(e.priority,(function(){It(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function zt(e,t,n){jt(e)&&n.delete(t)}function Ut(){St=!1,null!==Et&&jt(Et)&&(Et=null),null!==Tt&&jt(Tt)&&(Tt=null),null!==Nt&&jt(Nt)&&(Nt=null),Ot.forEach(zt),Rt.forEach(zt)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function Wt(e){function t(t){return Bt(t,e)}if(0<_t.length){Bt(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Bt(Et,e),null!==Tt&&Bt(Tt,e),null!==Nt&&Bt(Nt,e),Ot.forEach(t),Rt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Pt.shift()}var Vt=x.ReactCurrentBatchConfig,Gt=!0;function Ht(e,t,n,r){var a=bt,i=Vt.transition;Vt.transition=null;try{bt=1,qt(e,t,n,r)}finally{bt=a,Vt.transition=i}}function Kt(e,t,n,r){var a=bt,i=Vt.transition;Vt.transition=null;try{bt=4,qt(e,t,n,r)}finally{bt=a,Vt.transition=i}}function qt(e,t,n,r){if(Gt){var a=Yt(e,t,n,r);if(null===a)Gr(e,t,r,Xt,n),Mt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Et=Ft(Et,e,t,n,r,a),!0;case"dragenter":return Tt=Ft(Tt,e,t,n,r,a),!0;case"mouseover":return Nt=Ft(Nt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ot.set(i,Ft(Ot.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Rt.set(i,Ft(Rt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&kt(i),null===(i=Yt(e,t,n,r))&&Gr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=ya(e=ke(r))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,$t=null;function en(){if($t)return $t;var e,t,n=Jt,r=n.length,a="value"in Qt?Qt.value:Qt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return $t=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),fn=L({},cn,{view:0,detail:0}),hn=an(fn),dn=L({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(dn),vn=an(L({},dn,{dataTransfer:0})),gn=an(L({},fn,{relatedTarget:0})),mn=an(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(L({},cn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},In={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=In[e])&&!!t[e]}function An(){return Cn}var Sn=L({},fn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=an(Sn),En=an(L({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=an(L({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),Nn=an(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=L({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=an(On),Pn=[9,13,27,32],Dn=l&&"CompositionEvent"in window,Mn=null;l&&"documentMode"in document&&(Mn=document.documentMode);var Fn=l&&"TextEvent"in window&&!Mn,Ln=l&&(!Dn||Mn&&8<Mn&&11>=Mn),jn=String.fromCharCode(32),zn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Hn(e,t,n,r){Se(r),0<(t=Kr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,qn=null;function Xn(e){jr(e,0)}function Yn(e){if(q(xa(e)))return e}function Zn(e,t){if("change"===e)return t}var Qn=!1;if(l){var Jn;if(l){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Jn=$n}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),qn=Kn=null)}function nr(e){if("value"===e.propertyName&&Yn(qn)){var t=[];Hn(t,qn,e,ke(e)),Oe(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(qn)}function ir(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!f.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,gr=null,mr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Kr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},Ir={},Cr={};function Ar(e){if(Ir[e])return Ir[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return Ir[e]=n[t];return e}l&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Sr=Ar("animationend"),_r=Ar("animationiteration"),Er=Ar("animationstart"),Tr=Ar("transitionend"),Nr=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Nr.set(e,t),u(t,[e])}for(var Pr=0;Pr<Or.length;Pr++){var Dr=Or[Pr];Rr(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Rr(Sr,"onAnimationEnd"),Rr(_r,"onAnimationIteration"),Rr(Er,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,u,c){if(Be.apply(this,arguments),Fe){if(!Fe)throw Error(i(198));var l=Le;Fe=!1,Le=null,je||(je=!0,ze=l)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}}}if(je)throw e=ze,je=!1,ze=null,e}function zr(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){if(!e[Br]){e[Br]=!0,o.forEach((function(t){"selectionchange"!==t&&(Fr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,Ur("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Zt(t)){case 1:var a=Ht;break;case 4:a=Kt;break;default:a=qt}n=a.bind(null,t,n,e),a=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}Oe((function(){var r=i,a=ke(n),o=[];e:{var s=Nr.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=_n;break;case"focusin":c="focus",u=gn;break;case"focusout":c="blur",u=gn;break;case"beforeblur":case"afterblur":u=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Tn;break;case Sr:case _r:case Er:u=mn;break;case Tr:u=Nn;break;case"scroll":u=hn;break;case"wheel":u=Rn;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=En}var l=0!==(4&t),f=!l&&"scroll"===e,h=l?null!==s?s+"Capture":null:s;l=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==h&&(null!=(v=Re(p,h))&&l.push(Hr(p,v,d)))),f)break;p=p.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[pa])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(f=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=pn,v="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=En,v="onPointerLeave",h="onPointerEnter",p="pointer"),f=null==u?s:xa(u),d=null==c?s:xa(c),(s=new l(v,p+"leave",u,n,a)).target=f,s.relatedTarget=d,v=null,ya(a)===r&&((l=new l(h,p+"enter",c,n,a)).target=d,l.relatedTarget=f,v=l),f=v,u&&c)e:{for(h=c,p=0,d=l=u;d;d=qr(d))p++;for(d=0,v=h;v;v=qr(v))d++;for(;0<p-d;)l=qr(l),p--;for(;0<d-p;)h=qr(h),d--;for(;p--;){if(l===h||null!==h&&l===h.alternate)break e;l=qr(l),h=qr(h)}l=null}else l=null;null!==u&&Xr(o,s,u,l,!1),null!==c&&null!==f&&Xr(o,f,c,l,!0)}if("select"===(u=(s=r?xa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var g=Zn;else if(Gn(s))if(Qn)g=or;else{g=ar;var m=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ir);switch(g&&(g=g(e,r))?Hn(o,g,n,a):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=r?xa(r):window,e){case"focusin":(Gn(m)||"true"===m.contentEditable)&&(gr=m,mr=r,yr=null);break;case"focusout":yr=mr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(o,n,a)}var y;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(y=en()):(Jt="value"in(Qt=a)?Qt.value:Qt.textContent,Wn=!0)),0<(m=Kr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:m}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(zn=!0,jn);case"textInput":return(e=t.data)===jn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!Dn&&Un(e,t)?(e=en(),$t=Jt=Qt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}jr(o,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Re(e,n))&&r.unshift(Hr(e,i,a)),null!=(i=Re(e,t))&&r.push(Hr(e,i,a))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=Re(n,i))&&o.unshift(Hr(n,u,s)):a||null!=(u=Re(n,i))&&o.push(Hr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Zr,"")}function Jr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(i(425))}function $r(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ua(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Wt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Wt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fa=Math.random().toString(36).slice(2),ha="__reactFiber$"+fa,da="__reactProps$"+fa,pa="__reactContainer$"+fa,va="__reactEvents$"+fa,ga="__reactListeners$"+fa,ma="__reactHandles$"+fa;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[ha])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ka(e){return e[da]||null}var wa=[],Ia=-1;function Ca(e){return{current:e}}function Aa(e){0>Ia||(e.current=wa[Ia],wa[Ia]=null,Ia--)}function Sa(e,t){Ia++,wa[Ia]=e.current,e.current=t}var _a={},Ea=Ca(_a),Ta=Ca(!1),Na=_a;function Oa(e,t){var n=e.type.contextTypes;if(!n)return _a;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ra(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pa(){Aa(Ta),Aa(Ea)}function Da(e,t,n){if(Ea.current!==_a)throw Error(i(168));Sa(Ea,t),Sa(Ta,n)}function Ma(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,V(e)||"Unknown",a));return L({},n,r)}function Fa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Na=Ea.current,Sa(Ea,e),Sa(Ta,Ta.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ma(e,t,Na),r.__reactInternalMemoizedMergedChildContext=e,Aa(Ta),Aa(Ea),Sa(Ea,e)):Aa(Ta),Sa(Ta,n)}var ja=null,za=!1,Ua=!1;function Ba(e){null===ja?ja=[e]:ja.push(e)}function Wa(){if(!Ua&&null!==ja){Ua=!0;var e=0,t=bt;try{var n=ja;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}ja=null,za=!1}catch(a){throw null!==ja&&(ja=ja.slice(e+1)),qe($e,Wa),a}finally{bt=t,Ua=!1}}return null}var Va=[],Ga=0,Ha=null,Ka=0,qa=[],Xa=0,Ya=null,Za=1,Qa="";function Ja(e,t){Va[Ga++]=Ka,Va[Ga++]=Ha,Ha=e,Ka=t}function $a(e,t,n){qa[Xa++]=Za,qa[Xa++]=Qa,qa[Xa++]=Ya,Ya=e;var r=Za;e=Qa;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Za=1<<32-ot(t)+a|n<<a|r,Qa=i+e}else Za=1<<i|n<<a|r,Qa=e}function ei(e){null!==e.return&&(Ja(e,1),$a(e,1,0))}function ti(e){for(;e===Ha;)Ha=Va[--Ga],Va[Ga]=null,Ka=Va[--Ga],Va[Ga]=null;for(;e===Ya;)Ya=qa[--Xa],qa[Xa]=null,Qa=qa[--Xa],qa[Xa]=null,Za=qa[--Xa],qa[Xa]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ya?{id:Za,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ui(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(ui(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ui(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function fi(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ui(e))throw hi(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=ca(e.nextSibling)}function di(){ri=ni=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var vi=x.ReactCurrentBatchConfig;function gi(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var mi=Ca(null),yi=null,bi=null,xi=null;function ki(){xi=bi=yi=null}function wi(e){var t=mi.current;Aa(mi),e._currentValue=t}function Ii(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ci(e,t){yi=e,xi=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Ai(e){var t=e._currentValue;if(xi!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===yi)throw Error(i(308));bi=e,yi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var Si=null;function _i(e){null===Si?Si=[e]:Si.push(e)}function Ei(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,_i(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ti(e,r)}function Ti(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ni=!1;function Oi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ri(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Di(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tu)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ti(e,n)}return null===(a=r.interleaved)?(t.next=t,_i(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ti(e,n)}function Mi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Fi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Li(e,t,n,r){var a=e.updateQueue;Ni=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var f=a.baseState;for(o=0,l=c=u=null,s=i;;){var h=s.lane,d=s.eventTime;if((r&h)===h){null!==l&&(l=l.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(h=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=v.payload)?p.call(d,f,h):p)||void 0===h)break e;f=L({},f,h);break e;case 2:Ni=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[s]:h.push(s))}else d={eventTime:d,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=d,u=f):l=l.next=d,o|=h;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(h=s).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===l&&(u=f),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Lu|=o,e.lanes=o,e.memoizedState=f}}function ji(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var zi=(new r.Component).refs;function Ui(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Bi={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=Pi(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Di(e,i,a))&&(rc(t,e,a,r),Mi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=Pi(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Di(e,i,a))&&(rc(t,e,a,r),Mi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),a=Pi(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Di(e,a,r))&&(rc(t,e,r,n),Mi(t,e,r))}};function Wi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function Vi(e,t,n){var r=!1,a=_a,i=t.contextType;return"object"===typeof i&&null!==i?i=Ai(i):(a=Ra(t)?Na:Ea.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oa(e,a):_a),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Bi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Gi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Bi.enqueueReplaceState(t,t.state,null)}function Hi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=zi,Oi(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ai(i):(i=Ra(t)?Na:Ea.current,a.context=Oa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Ui(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Bi.enqueueReplaceState(a,a.state,null),Li(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Ki(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===zi&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function qi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xi(e){return(0,e._init)(e._payload)}function Yi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=jc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===I?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===R&&Xi(i)===t.type)?((r=a(t,n.props)).ref=Ki(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=Ki(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Fc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=Ki(e,null,t),n.return=e,n;case w:return(t=zc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Fc(t,e.mode,n,null)).return=e,t;qi(e,t)}return null}function d(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===a?c(e,t,n,r):null;case w:return n.key===a?l(e,t,n,r):null;case R:return d(e,t,(a=n._init)(n._payload),r)}if(te(n)||M(n))return null!==a?null:f(e,t,n,r,null);qi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case R:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||M(r))return f(t,e=e.get(n)||null,r,a,null);qi(t,r)}return null}function v(a,i,s,u){for(var c=null,l=null,f=i,v=i=0,g=null;null!==f&&v<s.length;v++){f.index>v?(g=f,f=null):g=f.sibling;var m=d(a,f,s[v],u);if(null===m){null===f&&(f=g);break}e&&f&&null===m.alternate&&t(a,f),i=o(m,i,v),null===l?c=m:l.sibling=m,l=m,f=g}if(v===s.length)return n(a,f),ai&&Ja(a,v),c;if(null===f){for(;v<s.length;v++)null!==(f=h(a,s[v],u))&&(i=o(f,i,v),null===l?c=f:l.sibling=f,l=f);return ai&&Ja(a,v),c}for(f=r(a,f);v<s.length;v++)null!==(g=p(f,a,v,s[v],u))&&(e&&null!==g.alternate&&f.delete(null===g.key?v:g.key),i=o(g,i,v),null===l?c=g:l.sibling=g,l=g);return e&&f.forEach((function(e){return t(a,e)})),ai&&Ja(a,v),c}function g(a,s,u,c){var l=M(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var f=l=null,v=s,g=s=0,m=null,y=u.next();null!==v&&!y.done;g++,y=u.next()){v.index>g?(m=v,v=null):m=v.sibling;var b=d(a,v,y.value,c);if(null===b){null===v&&(v=m);break}e&&v&&null===b.alternate&&t(a,v),s=o(b,s,g),null===f?l=b:f.sibling=b,f=b,v=m}if(y.done)return n(a,v),ai&&Ja(a,g),l;if(null===v){for(;!y.done;g++,y=u.next())null!==(y=h(a,y.value,c))&&(s=o(y,s,g),null===f?l=y:f.sibling=y,f=y);return ai&&Ja(a,g),l}for(v=r(a,v);!y.done;g++,y=u.next())null!==(y=p(v,a,g,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?g:y.key),s=o(y,s,g),null===f?l=y:f.sibling=y,f=y);return e&&v.forEach((function(e){return t(a,e)})),ai&&Ja(a,g),l}return function e(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===I&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case k:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===I){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&Xi(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=Ki(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===I?((i=Fc(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Mc(o.type,o.key,o.props,null,r.mode,u)).ref=Ki(r,i,o),u.return=r,r=u)}return s(r);case w:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=zc(o,r.mode,u)).return=r,r=i}return s(r);case R:return e(r,i,(l=o._init)(o._payload),u)}if(te(o))return v(r,i,o,u);if(M(o))return g(r,i,o,u);qi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=jc(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var Zi=Yi(!0),Qi=Yi(!1),Ji={},$i=Ca(Ji),eo=Ca(Ji),to=Ca(Ji);function no(e){if(e===Ji)throw Error(i(174));return e}function ro(e,t){switch(Sa(to,t),Sa(eo,e),Sa($i,Ji),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Aa($i),Sa($i,t)}function ao(){Aa($i),Aa(eo),Aa(to)}function io(e){no(to.current);var t=no($i.current),n=ue(t,e.type);t!==n&&(Sa(eo,e),Sa($i,n))}function oo(e){eo.current===e&&(Aa($i),Aa(eo))}var so=Ca(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var fo=x.ReactCurrentDispatcher,ho=x.ReactCurrentBatchConfig,po=0,vo=null,go=null,mo=null,yo=!1,bo=!1,xo=0,ko=0;function wo(){throw Error(i(321))}function Io(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function Co(e,t,n,r,a,o){if(po=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fo.current=null===e||null===e.memoizedState?ss:us,e=n(r,a),bo){o=0;do{if(bo=!1,xo=0,25<=o)throw Error(i(301));o+=1,mo=go=null,t.updateQueue=null,fo.current=cs,e=n(r,a)}while(bo)}if(fo.current=os,t=null!==go&&null!==go.next,po=0,mo=go=vo=null,yo=!1,t)throw Error(i(300));return e}function Ao(){var e=0!==xo;return xo=0,e}function So(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?vo.memoizedState=mo=e:mo=mo.next=e,mo}function _o(){if(null===go){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=go.next;var t=null===mo?vo.memoizedState:mo.next;if(null!==t)mo=t,go=e;else{if(null===e)throw Error(i(310));e={memoizedState:(go=e).memoizedState,baseState:go.baseState,baseQueue:go.baseQueue,queue:go.queue,next:null},null===mo?vo.memoizedState=mo=e:mo=mo.next=e}return mo}function Eo(e,t){return"function"===typeof t?t(e):t}function To(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=go,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,c=null,l=o;do{var f=l.lane;if((po&f)===f)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var h={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=h,s=r):c=c.next=h,vo.lanes|=f,Lu|=f}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,vo.lanes|=o,Lu|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function No(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Oo(){}function Ro(e,t){var n=vo,r=_o(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,xs=!0),r=r.queue,Go(Mo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==mo&&1&mo.memoizedState.tag){if(n.flags|=2048,zo(9,Do.bind(null,n,r,a,t),void 0,null),null===Nu)throw Error(i(349));0!==(30&po)||Po(n,t,a)}return a}function Po(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Do(e,t,n,r){t.value=n,t.getSnapshot=r,Fo(t)&&Lo(e)}function Mo(e,t,n){return n((function(){Fo(t)&&Lo(e)}))}function Fo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Lo(e){var t=Ti(e,1);null!==t&&rc(t,e,1,-1)}function jo(e){var t=So();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,vo,e),[t.memoizedState,e]}function zo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Uo(){return _o().memoizedState}function Bo(e,t,n,r){var a=So();vo.flags|=e,a.memoizedState=zo(1|t,n,void 0,void 0===r?null:r)}function Wo(e,t,n,r){var a=_o();r=void 0===r?null:r;var i=void 0;if(null!==go){var o=go.memoizedState;if(i=o.destroy,null!==r&&Io(r,o.deps))return void(a.memoizedState=zo(t,n,i,r))}vo.flags|=e,a.memoizedState=zo(1|t,n,i,r)}function Vo(e,t){return Bo(8390656,8,e,t)}function Go(e,t){return Wo(2048,8,e,t)}function Ho(e,t){return Wo(4,2,e,t)}function Ko(e,t){return Wo(4,4,e,t)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Wo(4,4,qo.bind(null,t,e),n)}function Yo(){}function Zo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Io(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Io(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),vo.lanes|=n,Lu|=n,e.baseState=!0),t)}function $o(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ho.transition;ho.transition={};try{e(!1),t()}finally{bt=n,ho.transition=r}}function es(){return _o().memoizedState}function ts(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))as(t,n);else if(null!==(n=Ei(e,t,n,r))){rc(n,e,r,tc()),is(n,t,r)}}function ns(e,t,n){var r=nc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))as(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var u=t.interleaved;return null===u?(a.next=a,_i(t)):(a.next=u.next,u.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ei(e,t,a,r))&&(rc(n,e,r,a=tc()),is(n,t,r))}}function rs(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function as(e,t){bo=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var os={readContext:Ai,useCallback:wo,useContext:wo,useEffect:wo,useImperativeHandle:wo,useInsertionEffect:wo,useLayoutEffect:wo,useMemo:wo,useReducer:wo,useRef:wo,useState:wo,useDebugValue:wo,useDeferredValue:wo,useTransition:wo,useMutableSource:wo,useSyncExternalStore:wo,useId:wo,unstable_isNewReconciler:!1},ss={readContext:Ai,useCallback:function(e,t){return So().memoizedState=[e,void 0===t?null:t],e},useContext:Ai,useEffect:Vo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Bo(4194308,4,qo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Bo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bo(4,2,e,t)},useMemo:function(e,t){var n=So();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=So();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},So().memoizedState=e},useState:jo,useDebugValue:Yo,useDeferredValue:function(e){return So().memoizedState=e},useTransition:function(){var e=jo(!1),t=e[0];return e=$o.bind(null,e[1]),So().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,a=So();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Nu)throw Error(i(349));0!==(30&po)||Po(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Vo(Mo.bind(null,r,o,e),[e]),r.flags|=2048,zo(9,Do.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=So(),t=Nu.identifierPrefix;if(ai){var n=Qa;t=":"+t+"R"+(n=(Za&~(1<<32-ot(Za)-1)).toString(32)+n),0<(n=xo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ko++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Ai,useCallback:Zo,useContext:Ai,useEffect:Go,useImperativeHandle:Xo,useInsertionEffect:Ho,useLayoutEffect:Ko,useMemo:Qo,useReducer:To,useRef:Uo,useState:function(){return To(Eo)},useDebugValue:Yo,useDeferredValue:function(e){return Jo(_o(),go.memoizedState,e)},useTransition:function(){return[To(Eo)[0],_o().memoizedState]},useMutableSource:Oo,useSyncExternalStore:Ro,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ai,useCallback:Zo,useContext:Ai,useEffect:Go,useImperativeHandle:Xo,useInsertionEffect:Ho,useLayoutEffect:Ko,useMemo:Qo,useReducer:No,useRef:Uo,useState:function(){return No(Eo)},useDebugValue:Yo,useDeferredValue:function(e){var t=_o();return null===go?t.memoizedState=e:Jo(t,go.memoizedState,e)},useTransition:function(){return[No(Eo)[0],_o().memoizedState]},useMutableSource:Oo,useSyncExternalStore:Ro,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function fs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Pi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hu||(Hu=!0,Ku=r),hs(0,t)},n}function vs(e,t,n){(n=Pi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){hs(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===qu?qu=new Set([this]):qu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Pi(-1,1)).tag=2,Di(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=x.ReactCurrentOwner,xs=!1;function ks(e,t,n,r){t.child=null===e?Qi(t,null,n,r):Zi(t,e.child,n,r)}function ws(e,t,n,r,a){n=n.render;var i=t.ref;return Ci(t,a),r=Co(e,t,n,r,i,a),n=Ao(),null===e||xs?(ai&&n&&ei(t),t.flags|=1,ks(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Is(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Pc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Cs(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Hs(e,t,a)}return t.flags|=1,(e=Dc(i,r)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Hs(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return _s(e,t,n,r,a)}function As(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sa(Du,Pu),Pu|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sa(Du,Pu),Pu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Sa(Du,Pu),Pu|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Sa(Du,Pu),Pu|=r;return ks(e,t,a,n),t.child}function Ss(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _s(e,t,n,r,a){var i=Ra(n)?Na:Ea.current;return i=Oa(t,i),Ci(t,a),n=Co(e,t,n,r,i,a),r=Ao(),null===e||xs?(ai&&r&&ei(t),t.flags|=1,ks(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Es(e,t,n,r,a){if(Ra(n)){var i=!0;Fa(t)}else i=!1;if(Ci(t,a),null===t.stateNode)Gs(e,t),Vi(t,n,r),Hi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ai(c):c=Oa(t,c=Ra(n)?Na:Ea.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Gi(t,o,r,c),Ni=!1;var h=t.memoizedState;o.state=h,Li(t,r,o,a),u=t.memoizedState,s!==r||h!==u||Ta.current||Ni?("function"===typeof l&&(Ui(t,n,l,r),u=t.memoizedState),(s=Ni||Wi(t,n,s,r,h,u,c))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ri(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:gi(t.type,s),o.props=c,f=t.pendingProps,h=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ai(u):u=Oa(t,u=Ra(n)?Na:Ea.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==f||h!==u)&&Gi(t,o,r,u),Ni=!1,h=t.memoizedState,o.state=h,Li(t,r,o,a);var p=t.memoizedState;s!==f||h!==p||Ta.current||Ni?("function"===typeof d&&(Ui(t,n,d,r),p=t.memoizedState),(c=Ni||Wi(t,n,c,r,h,p,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ts(e,t,n,r,i,a)}function Ts(e,t,n,r,a,i){Ss(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&La(t,n,!1),Hs(e,t,i);r=t.stateNode,bs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Zi(t,e.child,null,i),t.child=Zi(t,null,s,i)):ks(e,t,s,i),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function Ns(e){var t=e.stateNode;t.pendingContext?Da(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Da(0,t.context,!1),ro(e,t.containerInfo)}function Os(e,t,n,r,a){return di(),pi(a),t.flags|=256,ks(e,t,n,r),t.child}var Rs,Ps,Ds,Ms,Fs={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function js(e,t,n){var r,a=t.pendingProps,o=so.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Sa(so,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=a.children,e=a.fallback,s?(a=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Lc(u,a,0,null),e=Fc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=Fs,e):zs(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Us(e,t,s,r=fs(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Lc({mode:"visible",children:r.children},a,0,null),(o=Fc(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Zi(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Fs,o);if(0===(1&t.mode))return Us(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var u=r.dgst;return r=u,Us(e,t,s,r=fs(o=Error(i(419)),r,void 0))}if(u=0!==(s&e.childLanes),xs||u){if(null!==(r=Nu)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ti(e,a),rc(r,e,a,-1))}return gc(),Us(e,t,s,r=fs(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(qa[Xa++]=Za,qa[Xa++]=Qa,qa[Xa++]=Ya,Za=e.id,Qa=e.overflow,Ya=t),t=zs(t,r.children),t.flags|=4096,t)}(e,t,u,a,r,o,n);if(s){s=a.fallback,u=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&u)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Dc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Dc(r,s):(s=Fc(s,u,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,u=null===(u=e.child.memoizedState)?Ls(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Fs,a}return e=(s=e.child).sibling,a=Dc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function zs(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Us(e,t,n,r){return null!==r&&pi(r),Zi(t,e.child,null,n),(e=zs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ii(e.return,t,n)}function Ws(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Vs(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ks(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bs(e,n,t);else if(19===e.tag)Bs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Sa(so,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ws(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===uo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ws(t,!0,n,null,i);break;case"together":Ws(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ks(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xs(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Ra(t.type)&&Pa(),qs(t),null;case 3:return r=t.stateNode,ao(),Aa(Ta),Aa(Ea),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sc(ii),ii=null))),Ps(e,t),qs(t),null;case 5:oo(t);var a=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Ds(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qs(t),null}if(e=no($i.current),fi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[ha]=t,r[da]=o,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(a=0;a<Mr.length;a++)zr(Mr[a],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":Z(r,o),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},zr("invalid",r);break;case"textarea":ae(r,o),zr("invalid",r)}for(var u in ye(n,o),a=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&zr("scroll",r)}switch(n){case"input":K(r),$(r,o,!0);break;case"textarea":K(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=$r)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[ha]=t,e[da]=r,Rs(e,t,!1,!1),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),a=r;break;case"iframe":case"object":case"embed":zr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Mr.length;a++)zr(Mr[a],e);a=r;break;case"source":zr("error",e),a=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),a=r;break;case"details":zr("toggle",e),a=r;break;case"input":Z(e,r),a=Y(e,r),zr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),zr("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ge(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&fe(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&he(e,l):"number"===typeof l&&he(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&zr("scroll",e):null!=l&&b(e,o,l,u))}switch(n){case"input":K(e),$(e,r,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Ms(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=no(to.current),no($i.current),fi(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return qs(t),null;case 13:if(Aa(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),di(),t.flags|=98560,o=!1;else if(o=fi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[ha]=t}else di(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),o=!1}else null!==ii&&(sc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Mu&&(Mu=3):gc())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return ao(),Ps(e,t),null===e&&Wr(t.stateNode.containerInfo),qs(t),null;case 10:return wi(t.type._context),qs(t),null;case 19:if(Aa(so),null===(o=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)Ks(o,!1);else{if(0!==Mu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=uo(e))){for(t.flags|=128,Ks(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Sa(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>Vu&&(t.flags|=128,r=!0,Ks(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ks(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ai)return qs(t),null}else 2*Qe()-o.renderingStartTime>Vu&&1073741824!==n&&(t.flags|=128,r=!0,Ks(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=so.current,Sa(so,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pu)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ys(e,t){switch(ti(t),t.tag){case 1:return Ra(t.type)&&Pa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),Aa(Ta),Aa(Ea),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Aa(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));di()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Aa(so),null;case 4:return ao(),null;case 10:return wi(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Rs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(){},Ds=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,no($i.current);var i,o=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),o=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var u=a[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&zr("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ms=function(e,t,n,r){n!==r&&(t.flags|=4)};var Zs=!1,Qs=!1,Js="function"===typeof WeakSet?WeakSet:Set,$s=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ac(e,t,r)}else n.current=null}function tu(e,t,n){try{n()}catch(r){Ac(e,t,r)}}var nu=!1;function ru(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&tu(t,n,i)}a=a.next}while(a!==r)}}function au(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function iu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ou(e){var t=e.alternate;null!==t&&(e.alternate=null,ou(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[da],delete t[va],delete t[ga],delete t[ma])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}var fu=null,hu=!1;function du(e,t,n){for(n=n.child;null!==n;)pu(e,t,n),n=n.sibling}function pu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Qs||eu(n,t);case 6:var r=fu,a=hu;fu=null,du(e,t,n),hu=a,null!==(fu=r)&&(hu?(e=fu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):fu.removeChild(n.stateNode));break;case 18:null!==fu&&(hu?(e=fu,n=n.stateNode,8===e.nodeType?ua(e.parentNode,n):1===e.nodeType&&ua(e,n),Wt(e)):ua(fu,n.stateNode));break;case 4:r=fu,a=hu,fu=n.stateNode.containerInfo,hu=!0,du(e,t,n),fu=r,hu=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&tu(n,t,o),a=a.next}while(a!==r)}du(e,t,n);break;case 1:if(!Qs&&(eu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Ac(n,t,s)}du(e,t,n);break;case 21:du(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,du(e,t,n),Qs=r):du(e,t,n);break;default:du(e,t,n)}}function vu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach((function(t){var r=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:fu=u.stateNode,hu=!1;break e;case 3:case 4:fu=u.stateNode.containerInfo,hu=!0;break e}u=u.return}if(null===fu)throw Error(i(160));pu(o,s,a),fu=null,hu=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Ac(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gu(t,e),yu(e),4&r){try{ru(3,e,e.return),au(3,e)}catch(g){Ac(e,e.return,g)}try{ru(5,e,e.return)}catch(g){Ac(e,e.return,g)}}break;case 1:gu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return);break;case 5:if(gu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Ac(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&Q(a,o),be(u,s);var l=be(u,o);for(s=0;s<c.length;s+=2){var f=c[s],h=c[s+1];"style"===f?ge(a,h):"dangerouslySetInnerHTML"===f?fe(a,h):"children"===f?he(a,h):b(a,f,h,l)}switch(u){case"input":J(a,o);break;case"textarea":ie(a,o);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(a,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[da]=o}catch(g){Ac(e,e.return,g)}}break;case 6:if(gu(t,e),yu(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(g){Ac(e,e.return,g)}}break;case 3:if(gu(t,e),yu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(g){Ac(e,e.return,g)}break;case 4:default:gu(t,e),yu(e);break;case 13:gu(t,e),yu(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Wu=Qe())),4&r&&vu(e);break;case 22:if(f=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(l=Qs)||f,gu(t,e),Qs=l):gu(t,e),yu(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!f&&0!==(1&e.mode))for($s=e,f=e.child;null!==f;){for(h=$s=f;null!==$s;){switch(p=(d=$s).child,d.tag){case 0:case 11:case 14:case 15:ru(4,d,d.return);break;case 1:eu(d,d.return);var v=d.stateNode;if("function"===typeof v.componentWillUnmount){r=d,n=d.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Ac(r,n,g)}}break;case 5:eu(d,d.return);break;case 22:if(null!==d.memoizedState){wu(h);continue}}null!==p?(p.return=d,$s=p):wu(h)}f=f.sibling}e:for(f=null,h=e;;){if(5===h.tag){if(null===f){f=h;try{a=h.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=h.stateNode,s=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ve("display",s))}catch(g){Ac(e,e.return,g)}}}else if(6===h.tag){if(null===f)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(g){Ac(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gu(t,e),yu(e),4&r&&vu(e);case 21:}}function yu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),lu(e,uu(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;cu(e,uu(e),o);break;default:throw Error(i(161))}}catch(s){Ac(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bu(e,t,n){$s=e,xu(e,t,n)}function xu(e,t,n){for(var r=0!==(1&e.mode);null!==$s;){var a=$s,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Zs;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=Zs;var c=Qs;if(Zs=o,(Qs=u)&&!c)for($s=a;null!==$s;)u=(o=$s).child,22===o.tag&&null!==o.memoizedState?Iu(a):null!==u?(u.return=o,$s=u):Iu(a);for(;null!==i;)$s=i,xu(i,t,n),i=i.sibling;$s=a,Zs=s,Qs=c}ku(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,$s=i):ku(e)}}function ku(e){for(;null!==$s;){var t=$s;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||au(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:gi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ji(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}ji(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var f=l.memoizedState;if(null!==f){var h=f.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(i(163))}Qs||512&t.flags&&iu(t)}catch(d){Ac(t,t.return,d)}}if(t===e){$s=null;break}if(null!==(n=t.sibling)){n.return=t.return,$s=n;break}$s=t.return}}function wu(e){for(;null!==$s;){var t=$s;if(t===e){$s=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$s=n;break}$s=t.return}}function Iu(e){for(;null!==$s;){var t=$s;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{au(4,t)}catch(u){Ac(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(u){Ac(t,a,u)}}var i=t.return;try{iu(t)}catch(u){Ac(t,i,u)}break;case 5:var o=t.return;try{iu(t)}catch(u){Ac(t,o,u)}}}catch(u){Ac(t,t.return,u)}if(t===e){$s=null;break}var s=t.sibling;if(null!==s){s.return=t.return,$s=s;break}$s=t.return}}var Cu,Au=Math.ceil,Su=x.ReactCurrentDispatcher,_u=x.ReactCurrentOwner,Eu=x.ReactCurrentBatchConfig,Tu=0,Nu=null,Ou=null,Ru=0,Pu=0,Du=Ca(0),Mu=0,Fu=null,Lu=0,ju=0,zu=0,Uu=null,Bu=null,Wu=0,Vu=1/0,Gu=null,Hu=!1,Ku=null,qu=null,Xu=!1,Yu=null,Zu=0,Qu=0,Ju=null,$u=-1,ec=0;function tc(){return 0!==(6&Tu)?Qe():-1!==$u?$u:$u=Qe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Tu)&&0!==Ru?Ru&-Ru:null!==vi.transition?(0===ec&&(ec=vt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function rc(e,t,n,r){if(50<Qu)throw Qu=0,Ju=null,Error(i(185));mt(e,n,r),0!==(2&Tu)&&e===Nu||(e===Nu&&(0===(2&Tu)&&(ju|=n),4===Mu&&uc(e,Ru)),ac(e,r),1===n&&0===Tu&&0===(1&t.mode)&&(Vu=Qe()+500,za&&Wa()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=dt(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ht(e,e===Nu?Ru:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){za=!0,Ba(e)}(cc.bind(null,e)):Ba(cc.bind(null,e)),oa((function(){0===(6&Tu)&&Wa()})),n=null;else{switch(xt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if($u=-1,ec=0,0!==(6&Tu))throw Error(i(327));var n=e.callbackNode;if(Ic()&&e.callbackNode!==n)return null;var r=ht(e,e===Nu?Ru:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var a=Tu;Tu|=2;var o=vc();for(Nu===e&&Ru===t||(Gu=null,Vu=Qe()+500,dc(e,t));;)try{bc();break}catch(u){pc(e,u)}ki(),Su.current=o,Tu=a,null!==Ou?t=0:(Nu=null,Ru=0,t=Mu)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=oc(e,a))),1===t)throw n=Fu,dc(e,0),uc(e,r),ac(e,Qe()),n;if(6===t)uc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=mc(e,r))&&(0!==(o=pt(e))&&(r=o,t=oc(e,o))),1===t))throw n=Fu,dc(e,0),uc(e,r),ac(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,Bu,Gu);break;case 3:if(uc(e,r),(130023424&r)===r&&10<(t=Wu+500-Qe())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,Bu,Gu),t);break}wc(e,Bu,Gu);break;case 4:if(uc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Au(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,Bu,Gu),r);break}wc(e,Bu,Gu);break;default:throw Error(i(329))}}}return ac(e,Qe()),e.callbackNode===n?ic.bind(null,e):null}function oc(e,t){var n=Uu;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Bu,Bu=n,null!==t&&sc(t)),e}function sc(e){null===Bu?Bu=e:Bu.push.apply(Bu,e)}function uc(e,t){for(t&=~zu,t&=~ju,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Tu))throw Error(i(327));Ic();var t=ht(e,0);if(0===(1&t))return ac(e,Qe()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Fu,dc(e,0),uc(e,t),ac(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Bu,Gu),ac(e,Qe()),null}function lc(e,t){var n=Tu;Tu|=1;try{return e(t)}finally{0===(Tu=n)&&(Vu=Qe()+500,za&&Wa())}}function fc(e){null!==Yu&&0===Yu.tag&&0===(6&Tu)&&Ic();var t=Tu;Tu|=1;var n=Eu.transition,r=bt;try{if(Eu.transition=null,bt=1,e)return e()}finally{bt=r,Eu.transition=n,0===(6&(Tu=t))&&Wa()}}function hc(){Pu=Du.current,Aa(Du)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Ou)for(n=Ou.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Pa();break;case 3:ao(),Aa(Ta),Aa(Ea),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Aa(so);break;case 10:wi(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Nu=e,Ou=e=Dc(e.current,null),Ru=Pu=t,Mu=0,Fu=null,zu=ju=Lu=0,Bu=Uu=null,null!==Si){for(t=0;t<Si.length;t++)if(null!==(r=(n=Si[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Si=null}return e}function pc(e,t){for(;;){var n=Ou;try{if(ki(),fo.current=os,yo){for(var r=vo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yo=!1}if(po=0,mo=go=vo=null,bo=!1,xo=0,_u.current=null,null===n||null===n.return){Mu=1,Fu=t,Ou=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Ru,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,f=u,h=f.tag;if(0===(1&f.mode)&&(0===h||11===h||15===h)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,ys(p,s,u,0,t),1&p.mode&&gs(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}if(0===(1&t)){gs(o,l,t),gc();break e}c=Error(i(426))}else if(ai&&1&u.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ys(m,s,u,0,t),pi(ls(c,u));break e}}o=c=ls(c,u),4!==Mu&&(Mu=2),null===Uu?Uu=[o]:Uu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Fi(o,ps(0,c,t));break e;case 1:u=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qu||!qu.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Fi(o,vs(o,u,t));break e}}o=o.return}while(null!==o)}kc(n)}catch(x){t=x,Ou===n&&null!==n&&(Ou=n=n.return);continue}break}}function vc(){var e=Su.current;return Su.current=os,null===e?os:e}function gc(){0!==Mu&&3!==Mu&&2!==Mu||(Mu=4),null===Nu||0===(268435455&Lu)&&0===(268435455&ju)||uc(Nu,Ru)}function mc(e,t){var n=Tu;Tu|=2;var r=vc();for(Nu===e&&Ru===t||(Gu=null,dc(e,t));;)try{yc();break}catch(a){pc(e,a)}if(ki(),Tu=n,Su.current=r,null!==Ou)throw Error(i(261));return Nu=null,Ru=0,Mu}function yc(){for(;null!==Ou;)xc(Ou)}function bc(){for(;null!==Ou&&!Ye();)xc(Ou)}function xc(e){var t=Cu(e.alternate,e,Pu);e.memoizedProps=e.pendingProps,null===t?kc(e):Ou=t,_u.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xs(n,t,Pu)))return void(Ou=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Ou=n);if(null===e)return Mu=6,void(Ou=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ou=t);Ou=t=e}while(null!==t);0===Mu&&(Mu=5)}function wc(e,t,n){var r=bt,a=Eu.transition;try{Eu.transition=null,bt=1,function(e,t,n,r){do{Ic()}while(null!==Yu);if(0!==(6&Tu))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Nu&&(Ou=Nu=null,Ru=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xu||(Xu=!0,Nc(tt,(function(){return Ic(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Eu.transition,Eu.transition=null;var s=bt;bt=1;var u=Tu;Tu|=4,_u.current=null,function(e,t){if(ea=Gt,dr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(k){n=null;break e}var s=0,u=-1,c=-1,l=0,f=0,h=e,d=null;t:for(;;){for(var p;h!==n||0!==a&&3!==h.nodeType||(u=s+a),h!==o||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)d=h,h=p;for(;;){if(h===e)break t;if(d===n&&++l===a&&(u=s),d===o&&++f===r&&(c=s),null!==(p=h.nextSibling))break;d=(h=d).parentNode}h=p}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Gt=!1,$s=t;null!==$s;)if(e=(t=$s).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$s=e;else for(;null!==$s;){t=$s;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var g=v.memoizedProps,m=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:gi(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(k){Ac(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,$s=e;break}$s=t.return}v=nu,nu=!1}(e,n),mu(n,e),pr(ta),Gt=!!ea,ta=ea=null,e.current=n,bu(n,e,a),Ze(),Tu=u,bt=s,Eu.transition=o}else e.current=n;if(Xu&&(Xu=!1,Yu=e,Zu=a),o=e.pendingLanes,0===o&&(qu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Hu)throw Hu=!1,e=Ku,Ku=null,e;0!==(1&Zu)&&0!==e.tag&&Ic(),o=e.pendingLanes,0!==(1&o)?e===Ju?Qu++:(Qu=0,Ju=e):Qu=0,Wa()}(e,t,n,r)}finally{Eu.transition=a,bt=r}return null}function Ic(){if(null!==Yu){var e=xt(Zu),t=Eu.transition,n=bt;try{if(Eu.transition=null,bt=16>e?16:e,null===Yu)var r=!1;else{if(e=Yu,Yu=null,Zu=0,0!==(6&Tu))throw Error(i(331));var a=Tu;for(Tu|=4,$s=e.current;null!==$s;){var o=$s,s=o.child;if(0!==(16&$s.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for($s=l;null!==$s;){var f=$s;switch(f.tag){case 0:case 11:case 15:ru(8,f,o)}var h=f.child;if(null!==h)h.return=f,$s=h;else for(;null!==$s;){var d=(f=$s).sibling,p=f.return;if(ou(f),f===l){$s=null;break}if(null!==d){d.return=p,$s=d;break}$s=p}}}var v=o.alternate;if(null!==v){var g=v.child;if(null!==g){v.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}$s=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,$s=s;else e:for(;null!==$s;){if(0!==(2048&(o=$s).flags))switch(o.tag){case 0:case 11:case 15:ru(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,$s=y;break e}$s=o.return}}var b=e.current;for($s=b;null!==$s;){var x=(s=$s).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,$s=x;else e:for(s=b;null!==$s;){if(0!==(2048&(u=$s).flags))try{switch(u.tag){case 0:case 11:case 15:au(9,u)}}catch(w){Ac(u,u.return,w)}if(u===s){$s=null;break e}var k=u.sibling;if(null!==k){k.return=u.return,$s=k;break e}$s=u.return}}if(Tu=a,Wa(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(w){}r=!0}return r}finally{bt=n,Eu.transition=t}}return!1}function Cc(e,t,n){e=Di(e,t=ps(0,t=ls(n,t),1),1),t=tc(),null!==e&&(mt(e,1,t),ac(e,t))}function Ac(e,t,n){if(3===e.tag)Cc(e,e,n);else for(;null!==t;){if(3===t.tag){Cc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qu||!qu.has(r))){t=Di(t,e=vs(t,e=ls(n,e),1),1),e=tc(),null!==t&&(mt(t,1,e),ac(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Nu===e&&(Ru&n)===n&&(4===Mu||3===Mu&&(130023424&Ru)===Ru&&500>Qe()-Wu?dc(e,0):zu|=n),ac(e,t)}function _c(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tc();null!==(e=Ti(e,t))&&(mt(e,t,n),ac(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),_c(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),_c(e,n)}function Nc(e,t){return qe(e,t)}function Oc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Oc(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Pc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case I:return Fc(n.children,a,o,t);case C:s=8,a|=8;break;case A:return(e=Rc(12,n,t,2|a)).elementType=A,e.lanes=o,e;case T:return(e=Rc(13,n,t,a)).elementType=T,e.lanes=o,e;case N:return(e=Rc(19,n,t,a)).elementType=N,e.lanes=o,e;case P:return Lc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case _:s=9;break e;case E:s=11;break e;case O:s=14;break e;case R:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Rc(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Fc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function jc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function zc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,a,i,o,s,u){return e=new Uc(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Rc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oi(i),e}function Wc(e){if(!e)return _a;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ra(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ra(n))return Ma(e,n,t)}return t}function Vc(e,t,n,r,a,i,o,s,u){return(e=Bc(n,r,!0,e,0,i,0,s,u)).context=Wc(null),n=e.current,(i=Pi(r=tc(),a=nc(n))).callback=void 0!==t&&null!==t?t:null,Di(n,i,a),e.current.lanes=a,mt(e,a,r),ac(e,r),e}function Gc(e,t,n,r){var a=t.current,i=tc(),o=nc(a);return n=Wc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Pi(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Di(a,t,o))&&(rc(e,a,o,i),Mi(e,a,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}Cu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:Ns(t),di();break;case 5:io(t);break;case 1:Ra(t.type)&&Fa(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Sa(mi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Sa(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?js(e,t,n):(Sa(so,1&so.current),null!==(e=Hs(e,t,n))?e.sibling:null);Sa(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vs(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Sa(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,As(e,t,n)}return Hs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ai&&0!==(1048576&t.flags)&&$a(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Gs(e,t),e=t.pendingProps;var a=Oa(t,Ea.current);Ci(t,n),a=Co(null,t,r,e,a,n);var o=Ao();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ra(r)?(o=!0,Fa(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Oi(t),a.updater=Bi,t.stateNode=a,a._reactInternals=t,Hi(t,r,e,n),t=Ts(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),ks(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Gs(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===O)return 14}return 2}(r),e=gi(r,e),a){case 0:t=_s(null,t,r,e,n);break e;case 1:t=Es(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=Is(null,t,r,gi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,_s(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 1:return r=t.type,a=t.pendingProps,Es(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 3:e:{if(Ns(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Ri(e,t),Li(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Os(e,t,r,n,a=ls(Error(i(423)),t));break e}if(r!==a){t=Os(e,t,r,n,a=ls(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Qi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(di(),r===a){t=Hs(e,t,n);break e}ks(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),Ss(e,t),ks(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return js(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Zi(t,null,r,n):ks(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ws(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 7:return ks(e,t,t.pendingProps,n),t.child;case 8:case 12:return ks(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Sa(mi,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Ta.current){t=Hs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Pi(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var f=(l=l.shared).pending;null===f?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ii(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Ii(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ks(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ci(t,n),r=r(a=Ai(a)),t.flags|=1,ks(e,t,r,n),t.child;case 14:return a=gi(r=t.type,t.pendingProps),Is(e,t,r,a=gi(r.type,a),n);case 15:return Cs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gi(r,a),Gs(e,t),t.tag=1,Ra(r)?(e=!0,Fa(t)):e=!1,Ci(t,n),Vi(t,r,a),Hi(t,r,a,n),Ts(null,t,r,!0,e,n);case 19:return Vs(e,t,n);case 22:return As(e,t,n)}throw Error(i(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Zc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Hc(o);s.call(e)}}Gc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Hc(o);i.call(e)}}var o=Vc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=o,e[pa]=o.current,Wr(8===e.nodeType?e.parentNode:e),fc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Hc(u);s.call(e)}}var u=Bc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=u,e[pa]=u.current,Wr(8===e.nodeType?e.parentNode:e),fc((function(){Gc(t,u,n,r)})),u}(n,t,e,a,r);return Hc(o)}Zc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Gc(e,t,null,null)},Zc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fc((function(){Gc(null,e,null,null)})),t[pa]=null}},Zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Lt(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ft(t.pendingLanes);0!==n&&(yt(t,1|n),ac(t,Qe()),0===(6&Tu)&&(Vu=Qe()+500,Wa()))}break;case 13:fc((function(){var t=Ti(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),qc(e,1)}},wt=function(e){if(13===e.tag){var t=Ti(e,134217728);if(null!==t)rc(t,e,134217728,tc());qc(e,134217728)}},It=function(e){if(13===e.tag){var t=nc(e),n=Ti(e,t);if(null!==n)rc(n,e,t,tc());qc(e,t)}},Ct=function(){return bt},At=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=ka(r);if(!a)throw Error(i(90));q(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=lc,Te=fc;var tl={usingClientEntryPoint:!1,Events:[ba,xa,ka,Se,_e,lc]},nl={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(i(299));var n=!1,r="",a=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,Wr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return fc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,a,0,o,s),e[pa]=t.current,Wr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Zc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(fc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},8180:function(e,t,n){"use strict";n(7981)},3688:function(e,t,n){"use strict";function r(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function a(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function i(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}function o(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!==typeof e.getDerivedStateFromProps&&"function"!==typeof t.getSnapshotBeforeUpdate)return e;var n=null,o=null,s=null;if("function"===typeof t.componentWillMount?n="componentWillMount":"function"===typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"===typeof t.componentWillReceiveProps?o="componentWillReceiveProps":"function"===typeof t.UNSAFE_componentWillReceiveProps&&(o="UNSAFE_componentWillReceiveProps"),"function"===typeof t.componentWillUpdate?s="componentWillUpdate":"function"===typeof t.UNSAFE_componentWillUpdate&&(s="UNSAFE_componentWillUpdate"),null!==n||null!==o||null!==s){var u=e.displayName||e.name,c="function"===typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+u+" uses "+c+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==o?"\n  "+o:"")+(null!==s?"\n  "+s:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"===typeof e.getDerivedStateFromProps&&(t.componentWillMount=r,t.componentWillReceiveProps=a),"function"===typeof t.getSnapshotBeforeUpdate){if("function"!==typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=i;var l=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;l.call(this,e,t,r)}}return e}n.r(t),n.d(t,{polyfill:function(){return o}}),r.__suppressDeprecationWarning=!0,a.__suppressDeprecationWarning=!0,i.__suppressDeprecationWarning=!0},8459:function(e,t){"use strict";var n,r=Symbol.for("react.element"),a=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.server_context"),f=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function m(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case i:case s:case o:case h:case d:return e;default:switch(e=e&&e.$$typeof){case l:case c:case f:case v:case p:case u:return e;default:return t}}case a:return t}}}n=Symbol.for("react.module.reference")},6900:function(e,t,n){"use strict";n(8459)},6664:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}t.default=e}(n(2007));var r=s(n(8354)),a=s(n(2910)),i=s(n(2791)),o=s(n(119));n(7890);function s(e){return e&&e.__esModule?e:{default:e}}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}var c=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return(0,r.default)(e,t)}))},l=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return(0,a.default)(e,t)}))},f=function(e){var t,n;function r(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).onEnter=function(e,n){var r=t.getClassNames(n?"appear":"enter").className;t.removeClasses(e,"exit"),c(e,r),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.getClassNames(n?"appear":"enter").activeClassName;t.reflowAndAddClass(e,r),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.getClassNames("appear").doneClassName,a=t.getClassNames("enter").doneClassName,i=n?r+" "+a:a;t.removeClasses(e,n?"appear":"enter"),c(e,i),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.getClassNames("exit").className;t.removeClasses(e,"appear"),t.removeClasses(e,"enter"),c(e,n),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.getClassNames("exit").activeClassName;t.reflowAndAddClass(e,n),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.getClassNames("exit").doneClassName;t.removeClasses(e,"exit"),c(e,n),t.props.onExited&&t.props.onExited(e)},t.getClassNames=function(e){var n=t.props.classNames,r="string"===typeof n,a=r?(r&&n?n+"-":"")+e:n[e];return{className:a,activeClassName:r?a+"-active":n[e+"Active"],doneClassName:r?a+"-done":n[e+"Done"]}},t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.removeClasses=function(e,t){var n=this.getClassNames(t),r=n.className,a=n.activeClassName,i=n.doneClassName;r&&l(e,r),a&&l(e,a),i&&l(e,i)},a.reflowAndAddClass=function(e,t){t&&(e&&e.scrollTop,c(e,t))},a.render=function(){var e=u({},this.props);return delete e.classNames,i.default.createElement(o.default,u({},e,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},r}(i.default.Component);f.defaultProps={classNames:""},f.propTypes={};var h=f;t.default=h,e.exports=t.default},8162:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;o(n(2007));var r=o(n(2791)),a=n(4164),i=o(n(2326));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t,n;function o(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleEnter=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEnter",0,n)},t.handleEntering=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEntering",0,n)},t.handleEntered=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEntered",0,n)},t.handleExit=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExit",1,n)},t.handleExiting=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExiting",1,n)},t.handleExited=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExited",1,n)},t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var s=o.prototype;return s.handleLifecycle=function(e,t,n){var i,o=this.props.children,s=r.default.Children.toArray(o)[t];s.props[e]&&(i=s.props)[e].apply(i,n),this.props[e]&&this.props[e]((0,a.findDOMNode)(this))},s.render=function(){var e=this.props,t=e.children,n=e.in,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["children","in"]),o=r.default.Children.toArray(t),s=o[0],u=o[1];return delete a.onEnter,delete a.onEntering,delete a.onEntered,delete a.onExit,delete a.onExiting,delete a.onExited,r.default.createElement(i.default,a,n?r.default.cloneElement(s,{key:"first",onEnter:this.handleEnter,onEntering:this.handleEntering,onEntered:this.handleEntered}):r.default.cloneElement(u,{key:"second",onEnter:this.handleExit,onEntering:this.handleExiting,onEntered:this.handleExited}))},o}(r.default.Component);s.propTypes={};var u=s;t.default=u,e.exports=t.default},119:function(e,t,n){"use strict";t.__esModule=!0,t.default=t.EXITING=t.ENTERED=t.ENTERING=t.EXITED=t.UNMOUNTED=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(2007)),a=s(n(2791)),i=s(n(4164)),o=n(3688);n(7890);function s(e){return e&&e.__esModule?e:{default:e}}var u="unmounted";t.UNMOUNTED=u;var c="exited";t.EXITED=c;var l="entering";t.ENTERING=l;var f="entered";t.ENTERED=f;var h="exiting";t.EXITING=h;var d=function(e){var t,n;function r(t,n){var r;r=e.call(this,t,n)||this;var a,i=n.transitionGroup,o=i&&!i.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?o?(a=c,r.appearStatus=l):a=f:a=t.unmountOnExit||t.mountOnEnter?u:c,r.state={status:a},r.nextCallback=null,r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=r.prototype;return o.getChildContext=function(){return{transitionGroup:null}},r.getDerivedStateFromProps=function(e,t){return e.in&&t.status===u?{status:c}:null},o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==l&&n!==f&&(t=l):n!==l&&n!==f||(t=h)}this.updateStatus(!1,t)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},o.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){this.cancelNextCallback();var n=i.default.findDOMNode(this);t===l?this.performEnter(n,e):this.performExit(n)}else this.props.unmountOnExit&&this.state.status===c&&this.setState({status:u})},o.performEnter=function(e,t){var n=this,r=this.props.enter,a=this.context.transitionGroup?this.context.transitionGroup.isMounting:t,i=this.getTimeouts(),o=a?i.appear:i.enter;t||r?(this.props.onEnter(e,a),this.safeSetState({status:l},(function(){n.props.onEntering(e,a),n.onTransitionEnd(e,o,(function(){n.safeSetState({status:f},(function(){n.props.onEntered(e,a)}))}))}))):this.safeSetState({status:f},(function(){n.props.onEntered(e)}))},o.performExit=function(e){var t=this,n=this.props.exit,r=this.getTimeouts();n?(this.props.onExit(e),this.safeSetState({status:h},(function(){t.props.onExiting(e),t.onTransitionEnd(e,r.exit,(function(){t.safeSetState({status:c},(function(){t.props.onExited(e)}))}))}))):this.safeSetState({status:c},(function(){t.props.onExited(e)}))},o.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},o.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},o.onTransitionEnd=function(e,t,n){this.setNextCallback(n);var r=null==t&&!this.props.addEndListener;e&&!r?(this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback),null!=t&&setTimeout(this.nextCallback,t)):setTimeout(this.nextCallback,0)},o.render=function(){var e=this.state.status;if(e===u)return null;var t=this.props,n=t.children,r=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(t,["children"]);if(delete r.in,delete r.mountOnEnter,delete r.unmountOnExit,delete r.appear,delete r.enter,delete r.exit,delete r.timeout,delete r.addEndListener,delete r.onEnter,delete r.onEntering,delete r.onEntered,delete r.onExit,delete r.onExiting,delete r.onExited,"function"===typeof n)return n(e,r);var i=a.default.Children.only(n);return a.default.cloneElement(i,r)},r}(a.default.Component);function p(){}d.contextTypes={transitionGroup:r.object},d.childContextTypes={transitionGroup:function(){}},d.propTypes={},d.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:p,onEntering:p,onEntered:p,onExit:p,onExiting:p,onExited:p},d.UNMOUNTED=0,d.EXITED=1,d.ENTERING=2,d.ENTERED=3,d.EXITING=4;var v=(0,o.polyfill)(d);t.default=v},2326:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=s(n(2007)),a=s(n(2791)),i=n(3688),o=n(8546);function s(e){return e&&e.__esModule?e:{default:e}}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var l=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},f=function(e){var t,n;function r(t,n){var r,a=(r=e.call(this,t,n)||this).handleExited.bind(c(c(r)));return r.state={handleExited:a,firstRender:!0},r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.getChildContext=function(){return{transitionGroup:{isMounting:!this.appeared}}},i.componentDidMount=function(){this.appeared=!0,this.mounted=!0},i.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(e,t){var n=t.children,r=t.handleExited;return{children:t.firstRender?(0,o.getInitialChildMapping)(e,r):(0,o.getNextChildMapping)(e,n,r),firstRender:!1}},i.handleExited=function(e,t){var n=(0,o.getChildMapping)(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=u({},t.children);return delete n[e.key],{children:n}})))},i.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["component","childFactory"]),i=l(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?i:a.default.createElement(t,r,i)},r}(a.default.Component);f.childContextTypes={transitionGroup:r.default.object.isRequired},f.propTypes={},f.defaultProps={component:"div",childFactory:function(e){return e}};var h=(0,i.polyfill)(f);t.default=h,e.exports=t.default},8267:function(e,t,n){"use strict";var r=s(n(6664)),a=s(n(8162)),i=s(n(2326)),o=s(n(119));function s(e){return e&&e.__esModule?e:{default:e}}e.exports={Transition:o.default,TransitionGroup:i.default,ReplaceTransition:a.default,CSSTransition:r.default}},8546:function(e,t,n){"use strict";t.__esModule=!0,t.getChildMapping=a,t.mergeChildMappings=i,t.getInitialChildMapping=function(e,t){return a(e.children,(function(n){return(0,r.cloneElement)(n,{onExited:t.bind(null,n),in:!0,appear:o(n,"appear",e),enter:o(n,"enter",e),exit:o(n,"exit",e)})}))},t.getNextChildMapping=function(e,t,n){var s=a(e.children),u=i(t,s);return Object.keys(u).forEach((function(a){var i=u[a];if((0,r.isValidElement)(i)){var c=a in t,l=a in s,f=t[a],h=(0,r.isValidElement)(f)&&!f.props.in;!l||c&&!h?l||!c||h?l&&c&&(0,r.isValidElement)(f)&&(u[a]=(0,r.cloneElement)(i,{onExited:n.bind(null,i),in:f.props.in,exit:o(i,"exit",e),enter:o(i,"enter",e)})):u[a]=(0,r.cloneElement)(i,{in:!1}):u[a]=(0,r.cloneElement)(i,{onExited:n.bind(null,i),in:!0,exit:o(i,"exit",e),enter:o(i,"enter",e)})}})),u};var r=n(2791);function a(e,t){var n=Object.create(null);return e&&r.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&(0,r.isValidElement)(e)?t(e):e}(e)})),n}function i(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,a=Object.create(null),i=[];for(var o in e)o in t?i.length&&(a[o]=i,i=[]):i.push(o);var s={};for(var u in t){if(a[u])for(r=0;r<a[u].length;r++){var c=a[u][r];s[a[u][r]]=n(c)}s[u]=n(u)}for(r=0;r<i.length;r++)s[i[r]]=n(i[r]);return s}function o(e,t,n){return null!=n[t]?n[t]:e.props[t]}},7890:function(e,t,n){"use strict";t.__esModule=!0,t.classNamesShape=t.timeoutsShape=void 0;var r;(r=n(2007))&&r.__esModule;t.timeoutsShape=null;t.classNamesShape=null},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var x=b.prototype=new y;x.constructor=b,v(x,m.prototype),x.isPureReactComponent=!0;var k=Array.isArray,w=Object.prototype.hasOwnProperty,I={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,a)&&!C.hasOwnProperty(a)&&(i[a]=t[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in u=e.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:I.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===i?"."+E(u,0):i,k(o)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),T(o,t,a,"",(function(e){return e}))):null!=o&&(S(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",k(e))for(var c=0;c<e.length;c++){var l=i+E(s=e[c],c);u+=T(s,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=T(s=s.value,t,a,l=i+E(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function N(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},P={transition:null},D={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:P,ReactCurrentOwner:I};t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=I.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)w.call(t,c)&&!C.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=A,t.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},9609:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function k(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case f:case i:case s:case o:case d:return e;default:switch(e=e&&e.$$typeof){case c:case h:case g:case v:case u:return e;default:return t}}case a:return t}}}function w(e){return k(e)===f}t.isFragment=function(e){return k(e)===i}},8493:function(e,t,n){"use strict";e.exports=n(9609)},2692:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(82)),a=n(7905),i=s(n(4849)),o=s(n(4170));function s(e){return e&&e.__esModule?e:{default:e}}var u=/((?:\-[a-z]+\-)?calc)/;t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return(0,r.default)(e).walk((function(e){if("function"===e.type&&u.test(e.value)){var n=r.default.stringify(e.nodes);if(!(n.indexOf("constant")>=0||n.indexOf("env")>=0)){var s=a.parser.parse(n),c=(0,i.default)(s,t);e.type="word",e.value=(0,o.default)(e.value,c,t)}}}),!0).toString()},e.exports=t.default},8334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(4890),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(e,t,n){switch(e.type){case"LengthValue":case"AngleValue":case"TimeValue":case"FrequencyValue":case"ResolutionValue":return function(e,t,n){t.type===e.type&&(t={type:e.type,value:(0,i.default)(t.value,t.unit,e.unit,n),unit:e.unit});return{left:e,right:t}}(e,t,n);default:return{left:e,right:t}}},e.exports=t.default},4849:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flip=c;var r,a=n(8334),i=(r=a)&&r.__esModule?r:{default:r};function o(e,t){return"MathExpression"===e.type?function(e,t){switch(e=function(e,t){var n=(0,i.default)(e.left,e.right,t),r=o(n.left,t),a=o(n.right,t);"MathExpression"===r.type&&"MathExpression"===a.type&&("/"===r.operator&&"*"===a.operator||"-"===r.operator&&"+"===a.operator||"*"===r.operator&&"/"===a.operator||"+"===r.operator&&"-"===a.operator)&&(s(r.right,a.right)?n=(0,i.default)(r.left,a.left,t):s(r.right,a.left)&&(n=(0,i.default)(r.left,a.right,t)),r=o(n.left,t),a=o(n.right,t));return e.left=r,e.right=a,e}(e,t),e.operator){case"+":case"-":return function(e,t){var n=e,r=n.left,a=n.right,i=n.operator;if("CssVariable"===r.type||"CssVariable"===a.type)return e;if(0===a.value)return r;if(0===r.value&&"+"===i)return a;if(0===r.value&&"-"===i)return l(a);r.type===a.type&&u(r.type)&&((e=Object.assign({},r)).value="+"===i?r.value+a.value:r.value-a.value);if(u(r.type)&&("+"===a.operator||"-"===a.operator)&&"MathExpression"===a.type){if(r.type===a.left.type)return(e=Object.assign({},e)).left=o({type:"MathExpression",operator:i,left:r,right:a.left},t),e.right=a.right,e.operator="-"===i?c(a.operator):a.operator,o(e,t);if(r.type===a.right.type)return(e=Object.assign({},e)).left=o({type:"MathExpression",operator:"-"===i?c(a.operator):a.operator,left:r,right:a.right},t),e.right=a.left,o(e,t)}if("MathExpression"===r.type&&("+"===r.operator||"-"===r.operator)&&u(a.type)){if(a.type===r.left.type)return(e=Object.assign({},r)).left=o({type:"MathExpression",operator:i,left:r.left,right:a},t),o(e,t);if(a.type===r.right.type)return e=Object.assign({},r),"-"===r.operator?(e.right=o({type:"MathExpression",operator:"-"===i?"+":"-",left:a,right:r.right},t),e.operator="-"===i?"-":"+"):e.right=o({type:"MathExpression",operator:i,left:r.right,right:a},t),e.right.value<0&&(e.right.value*=-1,e.operator="-"===e.operator?"+":"-"),o(e,t)}return e}(e,t);case"/":return function(e,t){if(!u(e.right.type))return e;if("Value"!==e.right.type)throw new Error('Cannot divide by "'+e.right.unit+'", number expected');if(0===e.right.value)throw new Error("Cannot divide by zero");if("MathExpression"===e.left.type)return u(e.left.left.type)&&u(e.left.right.type)?(e.left.left.value/=e.right.value,e.left.right.value/=e.right.value,o(e.left,t)):e;if(u(e.left.type))return e.left.value/=e.right.value,e.left;return e}(e,t);case"*":return function(e){if("MathExpression"===e.left.type&&"Value"===e.right.type){if(u(e.left.left.type)&&u(e.left.right.type))return e.left.left.value*=e.right.value,e.left.right.value*=e.right.value,e.left}else{if(u(e.left.type)&&"Value"===e.right.type)return e.left.value*=e.right.value,e.left;if("Value"===e.left.type&&"MathExpression"===e.right.type){if(u(e.right.left.type)&&u(e.right.right.type))return e.right.left.value*=e.left.value,e.right.right.value*=e.left.value,e.right}else if("Value"===e.left.type&&u(e.right.type))return e.right.value*=e.left.value,e.right}return e}(e)}return e}(e,t):"Calc"===e.type?o(e.value,t):e}function s(e,t){return e.type===t.type&&e.value===t.value}function u(e){switch(e){case"LengthValue":case"AngleValue":case"TimeValue":case"FrequencyValue":case"ResolutionValue":case"EmValue":case"ExValue":case"ChValue":case"RemValue":case"VhValue":case"VwValue":case"VminValue":case"VmaxValue":case"PercentageValue":case"Value":return!0}return!1}function c(e){return"+"===e?"-":"+"}function l(e){return u(e.type)?e.value=-e.value:"MathExpression"==e.type&&(e.left=l(e.left),e.right=l(e.right)),e}t.default=o},4170:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=o(t,n);return"MathExpression"===t.type&&(r=e+"("+r+")"),r};var r=n(4849),a={"*":0,"/":0,"+":1,"-":1};function i(e,t){if(!1!==t){var n=Math.pow(10,t);return Math.round(e*n)/n}return e}function o(e,t){switch(e.type){case"MathExpression":var n=e.left,s=e.right,u=e.operator,c="";return"MathExpression"===n.type&&a[u]<a[n.operator]?c+="("+o(n,t)+")":c+=o(n,t),c+=" "+e.operator+" ","MathExpression"===s.type&&a[u]<a[s.operator]?c+="("+o(s,t)+")":"MathExpression"===s.type&&"-"===u&&["+","-"].includes(s.operator)?(s.operator=(0,r.flip)(s.operator),c+=o(s,t)):c+=o(s,t),c;case"Value":return i(e.value,t);case"CssVariable":return e.fallback?"var("+e.value+", "+o(e.fallback,t)+")":"var("+e.value+")";case"Calc":return e.prefix?"-"+e.prefix+"-calc("+o(e.value,t)+")":"calc("+o(e.value,t)+")";default:return i(e.value,t)+e.unit}}e.exports=t.default},7905:function(e,t){var n=function(){function e(e,t){var n;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonParserError"}),null==e&&(e="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:e}),this.hash=t,t&&t.exception instanceof Error){var r=t.exception;this.message=r.message||e,n=r.stack}n||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):n=new Error(e).stack),n&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:n})}function t(e,t,n){n=n||0;for(var r=0;r<t;r++)this.push(e),e+=n}function n(e,t){for(t+=e=this.length-e;e<t;e++)this.push(this[e])}function r(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];"function"===typeof a?(n++,a.apply(t,e[n])):t.push(a)}return t}"function"===typeof Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,Error.prototype):e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.prototype.name="JisonParserError";var a={trace:function(){},JisonParserError:e,yy:{},options:{type:"lalr",hasPartialLrUpgradeOnConflict:!0,errorRecoveryTokenDiscardCount:3},symbols_:{$accept:0,$end:1,ADD:3,ANGLE:16,CHS:22,COMMA:14,CSS_CPROP:13,CSS_VAR:12,DIV:6,EMS:20,EOF:1,EXS:21,FREQ:18,LENGTH:15,LPAREN:7,MUL:5,NESTED_CALC:9,NUMBER:11,PERCENTAGE:28,PREFIX:10,REMS:23,RES:19,RPAREN:8,SUB:4,TIME:17,VHS:24,VMAXS:27,VMINS:26,VWS:25,css_value:33,css_variable:32,error:2,expression:29,math_expression:30,value:31},terminals_:{1:"EOF",2:"error",3:"ADD",4:"SUB",5:"MUL",6:"DIV",7:"LPAREN",8:"RPAREN",9:"NESTED_CALC",10:"PREFIX",11:"NUMBER",12:"CSS_VAR",13:"CSS_CPROP",14:"COMMA",15:"LENGTH",16:"ANGLE",17:"TIME",18:"FREQ",19:"RES",20:"EMS",21:"EXS",22:"CHS",23:"REMS",24:"VHS",25:"VWS",26:"VMINS",27:"VMAXS",28:"PERCENTAGE"},TERROR:2,EOF:1,originalQuoteName:null,originalParseError:null,cleanupAfterParse:null,constructParseErrorInfo:null,yyMergeLocationInfo:null,__reentrant_call_depth:0,__error_infos:[],__error_recovery_infos:[],quoteName:function(e){return'"'+e+'"'},getSymbolName:function(e){if(this.terminals_[e])return this.terminals_[e];var t=this.symbols_;for(var n in t)if(t[n]===e)return n;return null},describeSymbol:function(e){if(e!==this.EOF&&this.terminal_descriptions_&&this.terminal_descriptions_[e])return this.terminal_descriptions_[e];if(e===this.EOF)return"end of input";var t=this.getSymbolName(e);return t?this.quoteName(t):null},collect_expected_token_set:function(e,t){var n=this.TERROR,r=[],a={};if(!t&&this.state_descriptions_&&this.state_descriptions_[e])return[this.state_descriptions_[e]];for(var i in this.table[e])if((i=+i)!==n){var o=t?i:this.describeSymbol(i);o&&!a[o]&&(r.push(o),a[o]=!0)}return r},productions_:function(e){for(var t=[],n=e.pop,r=e.rule,a=0,i=n.length;a<i;a++)t.push([n[a],r[a]]);return t}({pop:r([29,t,[30,10],31,31,32,32,t,[33,15]]),rule:r([2,t,[3,5],4,7,t,[1,4],2,4,6,t,[1,14],2])}),performAction:function(e,t,n){var r=this.yy;r.parser,r.lexer;switch(e){case 0:case 6:this.$=n[t-1];break;case 1:return this.$=n[t-1],n[t-1];case 2:case 3:case 4:case 5:this.$={type:"MathExpression",operator:n[t-1],left:n[t-2],right:n[t]};break;case 7:this.$={type:"Calc",value:n[t-1]};break;case 8:this.$={type:"Calc",value:n[t-1],prefix:n[t-5]};break;case 9:case 10:case 11:this.$=n[t];break;case 12:this.$={type:"Value",value:parseFloat(n[t])};break;case 13:this.$={type:"Value",value:-1*parseFloat(n[t])};break;case 14:this.$={type:"CssVariable",value:n[t-1]};break;case 15:this.$={type:"CssVariable",value:n[t-3],fallback:n[t-1]};break;case 16:this.$={type:"LengthValue",value:parseFloat(n[t]),unit:/[a-z]+/.exec(n[t])[0]};break;case 17:this.$={type:"AngleValue",value:parseFloat(n[t]),unit:/[a-z]+/.exec(n[t])[0]};break;case 18:this.$={type:"TimeValue",value:parseFloat(n[t]),unit:/[a-z]+/.exec(n[t])[0]};break;case 19:this.$={type:"FrequencyValue",value:parseFloat(n[t]),unit:/[a-z]+/.exec(n[t])[0]};break;case 20:this.$={type:"ResolutionValue",value:parseFloat(n[t]),unit:/[a-z]+/.exec(n[t])[0]};break;case 21:this.$={type:"EmValue",value:parseFloat(n[t]),unit:"em"};break;case 22:this.$={type:"ExValue",value:parseFloat(n[t]),unit:"ex"};break;case 23:this.$={type:"ChValue",value:parseFloat(n[t]),unit:"ch"};break;case 24:this.$={type:"RemValue",value:parseFloat(n[t]),unit:"rem"};break;case 25:this.$={type:"VhValue",value:parseFloat(n[t]),unit:"vh"};break;case 26:this.$={type:"VwValue",value:parseFloat(n[t]),unit:"vw"};break;case 27:this.$={type:"VminValue",value:parseFloat(n[t]),unit:"vmin"};break;case 28:this.$={type:"VmaxValue",value:parseFloat(n[t]),unit:"vmax"};break;case 29:this.$={type:"PercentageValue",value:parseFloat(n[t]),unit:"%"};break;case 30:var a=n[t];a.value*=-1,this.$=a}},table:function(e){for(var t=[],n=e.len,r=e.symbol,a=e.type,i=e.state,o=e.mode,s=e.goto,u=0,c=n.length;u<c;u++){for(var l=n[u],f={},h=0;h<l;h++){var d=r.shift();switch(a.shift()){case 2:f[d]=[o.shift(),s.shift()];break;case 0:f[d]=i.shift();break;default:f[d]=[3]}}t.push(f)}return t}({len:r([24,1,5,23,1,18,t,[0,3],1,t,[0,16],t,[23,4],n,[28,3],0,0,16,1,6,6,t,[0,3],5,1,2,n,[37,3],n,[20,3],5,0,0]),symbol:r([4,7,9,11,12,t,[15,19,1],1,1,t,[3,4,1],n,[30,19],n,[29,4],7,4,10,11,n,[22,14],n,[19,3],n,[43,22],n,[23,69],n,[139,4],8,n,[51,24],4,n,[138,15],13,n,[186,5],8,n,[6,6],n,[5,5],9,8,14,n,[159,47],n,[60,10]]),type:r([t,[2,19],t,[0,5],1,t,[2,24],t,[0,4],n,[22,19],n,[43,42],n,[23,70],n,[28,25],n,[45,25],n,[113,54]]),state:r([1,2,8,6,7,30,n,[4,3],33,37,n,[5,3],38,n,[4,3],39,n,[4,3],40,n,[4,3],42,n,[21,4],50,n,[5,3],51,n,[4,3]]),mode:r([t,[1,179],t,[2,3],n,[5,5],n,[6,4],t,[1,57]]),goto:r([5,3,4,24,t,[9,15,1],t,[25,5,1],n,[24,19],31,35,32,34,n,[18,14],36,n,[38,19],n,[19,57],n,[118,4],41,n,[24,19],43,35,n,[16,14],44,t,[2,3],28,29,2,t,[3,3],28,29,3,n,[53,4],t,[45,5,1],n,[100,42],52,n,[5,4],53])}),defaultActions:function(e){for(var t={},n=e.idx,r=e.goto,a=0,i=n.length;a<i;a++){t[n[a]]=r[a]}return t}({idx:r([6,7,8,t,[10,16,1],33,34,39,40,41,45,47,52,53]),goto:r([9,10,11,t,[16,14,1],12,1,30,13,t,[4,4,1],14,15,8])}),parseError:function(e,t,n){if(!t.recoverable)throw"function"===typeof this.trace&&this.trace(e),n||(n=this.JisonParserError),new n(e,t);"function"===typeof this.trace&&this.trace(e),t.destroy()},parse:function(e){var t,n=this,r=new Array(128),a=new Array(128),i=new Array(128),o=this.table,s=0,u=0,c=(this.TERROR,this.EOF),l=(this.options.errorRecoveryTokenDiscardCount,[0,54]);t=this.__lexer__?this.__lexer__:this.__lexer__=Object.create(this.lexer);var f={parseError:void 0,quoteName:void 0,lexer:void 0,parser:void 0,pre_parse:void 0,post_parse:void 0,pre_lex:void 0,post_lex:void 0};function h(){var e=t.fastLex();return"number"!==typeof e&&(e=n.symbols_[e]||e),e||c}"function"!==typeof assert||assert,this.yyGetSharedState=function(){return f},function(e,t){for(var n in t)"undefined"===typeof e[n]&&Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}(f,this.yy),f.lexer=t,f.parser=this,"function"===typeof f.parseError?this.parseError=function(e,t,n){return n||(n=this.JisonParserError),f.parseError.call(this,e,t,n)}:this.parseError=this.originalParseError,"function"===typeof f.quoteName?this.quoteName=function(e){return f.quoteName.call(this,e)}:this.quoteName=this.originalQuoteName,this.cleanupAfterParse=function(e,n,o){var u,c;n&&((f.post_parse||this.post_parse)&&(c=this.constructParseErrorInfo(null,null,null,!1)),f.post_parse&&"undefined"!==typeof(u=f.post_parse.call(this,f,e,c))&&(e=u),this.post_parse&&"undefined"!==typeof(u=this.post_parse.call(this,f,e,c))&&(e=u),c&&c.destroy&&c.destroy());if(this.__reentrant_call_depth>1)return e;if(t.cleanupAfterLex&&t.cleanupAfterLex(o),f&&(f.lexer=void 0,f.parser=void 0,t.yy===f&&(t.yy=void 0)),f=void 0,this.parseError=this.originalParseError,this.quoteName=this.originalQuoteName,r.length=0,a.length=0,i.length=0,s=0,!o){for(var l=this.__error_infos.length-1;l>=0;l--){var h=this.__error_infos[l];h&&"function"===typeof h.destroy&&h.destroy()}this.__error_infos.length=0}return e},this.constructParseErrorInfo=function(e,n,o,c){var l={errStr:e,exception:n,text:t.match,value:t.yytext,token:this.describeSymbol(u)||u,token_id:u,line:t.yylineno,expected:o,recoverable:c,state:d,action:p,new_state:x,symbol_stack:r,state_stack:a,value_stack:i,stack_pointer:s,yy:f,lexer:t,parser:this,destroy:function(){var e=!!this.recoverable;for(var t in this)this.hasOwnProperty(t)&&"object"===typeof t&&(this[t]=void 0);this.recoverable=e}};return this.__error_infos.push(l),l};var d,p,v,g,m,y,b,x,k=function(){var e=t.lex();return"number"!==typeof e&&(e=n.symbols_[e]||e),e||c},w={$:!0,_$:void 0,yy:f},I=!1;try{if(this.__reentrant_call_depth++,t.setInput(e,f),"function"===typeof t.canIUse)t.canIUse().fastLex&&(k=h);for(i[s]=null,a[s]=0,r[s]=0,++s,this.pre_parse&&this.pre_parse.call(this,f),f.pre_parse&&f.pre_parse.call(this,f),x=a[s-1];;){if(d=x,this.defaultActions[d])p=2,x=this.defaultActions[d];else if(u||(u=k()),g=o[d]&&o[d][u]||l,x=g[1],!(p=g[0])){var C,A=this.describeSymbol(u)||u,S=this.collect_expected_token_set(d);C="number"===typeof t.yylineno?"Parse error on line "+(t.yylineno+1)+": ":"Parse error: ","function"===typeof t.showPosition&&(C+="\n"+t.showPosition(69,10)+"\n"),S.length?C+="Expecting "+S.join(", ")+", got unexpected "+A:C+="Unexpected "+A,m=this.constructParseErrorInfo(C,null,S,!1),"undefined"!==typeof(v=this.parseError(m.errStr,m,this.JisonParserError))&&(I=v);break}switch(p){default:if(p instanceof Array){m=this.constructParseErrorInfo("Parse Error: multiple actions possible at state: "+d+", token: "+u,null,null,!1),"undefined"!==typeof(v=this.parseError(m.errStr,m,this.JisonParserError))&&(I=v);break}m=this.constructParseErrorInfo("Parsing halted. No viable error recovery approach available due to internal system failure.",null,null,!1),"undefined"!==typeof(v=this.parseError(m.errStr,m,this.JisonParserError))&&(I=v);break;case 1:r[s]=u,i[s]=t.yytext,a[s]=x,++s,u=0;continue;case 2:if(y=(b=this.productions_[x-1])[1],"undefined"!==typeof(v=this.performAction.call(w,x,s-1,i))){I=v;break}s-=y;var _=b[0];r[s]=_,i[s]=w.$,x=o[a[s-1]][_],a[s]=x,++s;continue;case 3:-2!==s&&(I=!0,s--,"undefined"!==typeof i[s]&&(I=i[s]))}break}}catch(E){if(E instanceof this.JisonParserError)throw E;if(t&&"function"===typeof t.JisonLexerError&&E instanceof t.JisonLexerError)throw E;m=this.constructParseErrorInfo("Parsing aborted due to exception.",E,null,!1),I=!1,"undefined"!==typeof(v=this.parseError(m.errStr,m,this.JisonParserError))&&(I=v)}finally{I=this.cleanupAfterParse(I,!0,!0),this.__reentrant_call_depth--}return I}};a.originalParseError=a.parseError,a.originalQuoteName=a.quoteName;var i=function(){function e(e,t){var n;if(Object.defineProperty(this,"name",{enumerable:!1,writable:!1,value:"JisonLexerError"}),null==e&&(e="???"),Object.defineProperty(this,"message",{enumerable:!1,writable:!0,value:e}),this.hash=t,t&&t.exception instanceof Error){var r=t.exception;this.message=r.message||e,n=r.stack}n||(Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):n=new Error(e).stack),n&&Object.defineProperty(this,"stack",{enumerable:!1,writable:!1,value:n})}"function"===typeof Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,Error.prototype):e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.prototype.name="JisonLexerError";var t={EOF:1,ERROR:2,__currentRuleSet__:null,__error_infos:[],__decompressed:!1,done:!1,_backtrack:!1,_input:"",_more:!1,_signaled_error_token:!1,conditionStack:[],match:"",matched:"",matches:!1,yytext:"",offset:0,yyleng:0,yylineno:0,yylloc:null,constructLexErrorInfo:function(e,t,n){if(e=""+e,void 0==n&&(n=!(e.indexOf("\n")>0&&e.indexOf("^")>0)),this.yylloc&&n)if("function"===typeof this.prettyPrintRange){this.prettyPrintRange(this.yylloc);/\n\s*$/.test(e)||(e+="\n"),e+="\n  Erroneous area:\n"+this.prettyPrintRange(this.yylloc)}else if("function"===typeof this.showPosition){var r=this.showPosition();r&&(e.length&&"\n"!==e[e.length-1]&&"\n"!==r[0]?e+="\n"+r:e+=r)}var a={errStr:e,recoverable:!!t,text:this.match,token:null,line:this.yylineno,loc:this.yylloc,yy:this.yy,lexer:this,destroy:function(){var e=!!this.recoverable;for(var t in this)this.hasOwnProperty(t)&&"object"===typeof t&&(this[t]=void 0);this.recoverable=e}};return this.__error_infos.push(a),a},parseError:function(e,t,n){if(n||(n=this.JisonLexerError),this.yy){if(this.yy.parser&&"function"===typeof this.yy.parser.parseError)return this.yy.parser.parseError.call(this,e,t,n)||this.ERROR;if("function"===typeof this.yy.parseError)return this.yy.parseError.call(this,e,t,n)||this.ERROR}throw new n(e,t)},yyerror:function(e){var t="";this.yylloc&&(t=" on line "+(this.yylineno+1));var n=this.constructLexErrorInfo("Lexical error"+t+": "+e,this.options.lexerErrorsAreRecoverable),r=Array.prototype.slice.call(arguments,1);return r.length&&(n.extra_error_attributes=r),this.parseError(n.errStr,n,this.JisonLexerError)||this.ERROR},cleanupAfterLex:function(e){if(this.setInput("",{}),!e){for(var t=this.__error_infos.length-1;t>=0;t--){var n=this.__error_infos[t];n&&"function"===typeof n.destroy&&n.destroy()}this.__error_infos.length=0}return this},clear:function(){this.yytext="",this.yyleng=0,this.match="",this.matches=!1,this._more=!1,this._backtrack=!1;var e=this.yylloc?this.yylloc.last_column:0;this.yylloc={first_line:this.yylineno+1,first_column:e,last_line:this.yylineno+1,last_column:e,range:[this.offset,this.offset]}},setInput:function(e,t){if(this.yy=t||this.yy||{},!this.__decompressed){for(var n=this.rules,r=0,a=n.length;r<a;r++){"number"===typeof(h=n[r])&&(n[r]=n[h])}var i=this.conditions;for(var o in i){var s=i[o],u=s.rules,c=(a=u.length,new Array(a+1)),l=new Array(a+1);for(r=0;r<a;r++){var f=u[r],h=n[f];c[r+1]=h,l[r+1]=f}s.rules=l,s.__rule_regexes=c,s.__rule_count=a}this.__decompressed=!0}return this._input=e||"",this.clear(),this._signaled_error_token=!1,this.done=!1,this.yylineno=0,this.matched="",this.conditionStack=["INITIAL"],this.__currentRuleSet__=null,this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]},this.offset=0,this},editRemainingInput:function(e,t){var n=e.call(this,this._input,t);return"string"!==typeof n?n&&(this._input=""+n):this._input=n,this},input:function(){if(!this._input)return null;var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=1,n=!1;if("\n"===e)n=!0;else if("\r"===e){n=!0;var r=this._input[1];"\n"===r&&(t++,e+=r,this.yytext+=r,this.yyleng++,this.offset++,this.match+=r,this.matched+=r,this.yylloc.range[1]++)}return n?(this.yylineno++,this.yylloc.last_line++,this.yylloc.last_column=0):this.yylloc.last_column++,this.yylloc.range[1]++,this._input=this._input.slice(t),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);if(this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.yyleng=this.yytext.length,this.offset-=t,this.match=this.match.substr(0,this.match.length-t),this.matched=this.matched.substr(0,this.matched.length-t),n.length>1){this.yylineno-=n.length-1,this.yylloc.last_line=this.yylineno+1;var r=this.match,a=r.split(/(?:\r\n?|\n)/g);1===a.length&&(a=(r=this.matched).split(/(?:\r\n?|\n)/g)),this.yylloc.last_column=a[a.length-1].length}else this.yylloc.last_column-=t;return this.yylloc.range[1]=this.yylloc.range[0]+this.yyleng,this.done=!1,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else{var e="";this.yylloc&&(e=" on line "+(this.yylineno+1));var t=this.constructLexErrorInfo("Lexical error"+e+": You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).",!1);this._signaled_error_token=this.parseError(t.errStr,t,this.JisonLexerError)||this.ERROR}return this},less:function(e){return this.unput(this.match.slice(e))},pastInput:function(e,t){var n=this.matched.substring(0,this.matched.length-this.match.length);e<0?e=n.length:e||(e=20),t<0?t=n.length:t||(t=1);var r=(n=n.substr(2*-e-2)).replace(/\r\n|\r/g,"\n").split("\n");return(n=(r=r.slice(-t)).join("\n")).length>e&&(n="..."+n.substr(-e)),n},upcomingInput:function(e,t){var n=this.match;e<0?e=n.length+this._input.length:e||(e=20),t<0?t=e:t||(t=1),n.length<2*e+2&&(n+=this._input.substring(0,2*e+2));var r=n.replace(/\r\n|\r/g,"\n").split("\n");return(n=(r=r.slice(0,t)).join("\n")).length>e&&(n=n.substring(0,e)+"..."),n},showPosition:function(e,t){var n=this.pastInput(e).replace(/\s/g," "),r=new Array(n.length+1).join("-");return n+this.upcomingInput(t).replace(/\s/g," ")+"\n"+r+"^"},deriveLocationInfo:function(e,t,n,r){var a={first_line:1,first_column:0,last_line:1,last_column:0,range:[0,0]};return e&&(a.first_line=0|e.first_line,a.last_line=0|e.last_line,a.first_column=0|e.first_column,a.last_column=0|e.last_column,e.range&&(a.range[0]=0|e.range[0],a.range[1]=0|e.range[1])),(a.first_line<=0||a.last_line<a.first_line)&&(a.first_line<=0&&t&&(a.first_line=0|t.last_line,a.first_column=0|t.last_column,t.range&&(a.range[0]=0|e.range[1])),(a.last_line<=0||a.last_line<a.first_line)&&n&&(a.last_line=0|n.first_line,a.last_column=0|n.first_column,n.range&&(a.range[1]=0|e.range[0])),a.first_line<=0&&r&&(a.last_line<=0||r.last_line<=a.last_line)&&(a.first_line=0|r.first_line,a.first_column=0|r.first_column,r.range&&(a.range[0]=0|r.range[0])),a.last_line<=0&&r&&(a.first_line<=0||r.first_line>=a.first_line)&&(a.last_line=0|r.last_line,a.last_column=0|r.last_column,r.range&&(a.range[1]=0|r.range[1]))),a.last_line<=0&&(a.first_line<=0?(a.first_line=this.yylloc.first_line,a.last_line=this.yylloc.last_line,a.first_column=this.yylloc.first_column,a.last_column=this.yylloc.last_column,a.range[0]=this.yylloc.range[0],a.range[1]=this.yylloc.range[1]):(a.last_line=this.yylloc.last_line,a.last_column=this.yylloc.last_column,a.range[1]=this.yylloc.range[1])),a.first_line<=0&&(a.first_line=a.last_line,a.first_column=0,a.range[1]=a.range[0]),a.first_column<0&&(a.first_column=0),a.last_column<0&&(a.last_column=a.first_column>0?a.first_column:80),a},prettyPrintRange:function(e,t,n){e=this.deriveLocationInfo(e,t,n);var r=(this.matched+this._input).split("\n"),a=Math.max(1,t?t.first_line:e.first_line-3),i=Math.max(1,n?n.last_line:e.last_line+1),o=1+Math.log10(1|i)|0,s=new Array(o).join(" "),u=[],c=r.slice(a-1,i+1).map((function(t,n){var r=n+a,i=(s+r).substr(-o)+": "+t,c=new Array(o+1).join("^"),l=3,f=0;(r===e.first_line?(l+=e.first_column,f=Math.max(2,(r===e.last_line?e.last_column:t.length)-e.first_column+1)):r===e.last_line?f=Math.max(2,e.last_column+1):r>e.first_line&&r<e.last_line&&(f=Math.max(2,t.length+1)),f)&&(i+="\n"+c+new Array(l).join(".")+new Array(f).join("^"),t.trim().length>0&&u.push(n));return i=i.replace(/\t/g," ")}));if(u.length>4){var l=u[1]+1,f=u[u.length-2]-1,h=new Array(o+1).join(" ")+"  (...continued...)";h+="\n"+new Array(o+1).join("-")+"  (---------------)",c.splice(l,f-l+1,h)}return c.join("\n")},describeYYLLOC:function(e,t){var n,r=e.first_line,a=e.last_line,i=e.first_column,o=e.last_column;if(0===a-r?(n="line "+r+", ",n+=o-i<=1?"column "+i:"columns "+i+" .. "+o):n="lines "+r+"(column "+i+") .. "+a+"(column "+o+")",e.range&&t){var s=e.range[0],u=e.range[1]-1;n+=u<=s?" {String Offset: "+s+"}":" {String Offset range: "+s+" .. "+u+"}"}return n},test_match:function(e,t){var n,r,a,i,o;if(this.options.backtrack_lexer&&(a={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.yylloc.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column,range:this.yylloc.range.slice(0)},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done}),o=(i=e[0]).length,(r=i.split(/(?:\r\n?|\n)/g)).length>1?(this.yylineno+=r.length-1,this.yylloc.last_line=this.yylineno+1,this.yylloc.last_column=r[r.length-1].length):this.yylloc.last_column+=o,this.yytext+=i,this.match+=i,this.matched+=i,this.matches=e,this.yyleng=this.yytext.length,this.yylloc.range[1]+=o,this.offset+=o,this._more=!1,this._backtrack=!1,this._input=this._input.slice(o),n=this.performAction.call(this,this.yy,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var s in a)this[s]=a[s];return this.__currentRuleSet__=null,!1}return!!this._signaled_error_token&&(n=this._signaled_error_token,this._signaled_error_token=!1,n)},next:function(){if(this.done)return this.clear(),this.EOF;var e,t,n,r;this._input||(this.done=!0),this._more||this.clear();var a=this.__currentRuleSet__;if(!a&&(!(a=this.__currentRuleSet__=this._currentRules())||!a.rules)){var i="";this.options.trackPosition&&(i=" on line "+(this.yylineno+1));var o=this.constructLexErrorInfo("Internal lexer engine error"+i+': The lex grammar programmer pushed a non-existing condition name "'+this.topState()+'"; this is a fatal error and should be reported to the application programmer team!',!1);return this.parseError(o.errStr,o,this.JisonLexerError)||this.ERROR}for(var s=a.rules,u=a.__rule_regexes,c=a.__rule_count,l=1;l<=c;l++)if((n=this._input.match(u[l]))&&(!t||n[0].length>t[0].length)){if(t=n,r=l,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,s[l])))return e;if(this._backtrack){t=void 0;continue}return!1}if(!this.options.flex)break}if(t)return!1!==(e=this.test_match(t,s[r]))&&e;if(this._input){i="";this.options.trackPosition&&(i=" on line "+(this.yylineno+1));o=this.constructLexErrorInfo("Lexical error"+i+": Unrecognized text.",this.options.lexerErrorsAreRecoverable);var f=this._input,h=this.topState(),d=this.conditionStack.length;return(e=this.parseError(o.errStr,o,this.JisonLexerError)||this.ERROR)===this.ERROR&&(this.matches||f!==this._input||h!==this.topState()||d!==this.conditionStack.length||this.input()),e}return this.done=!0,this.clear(),this.EOF},lex:function(){var e;for("function"===typeof this.pre_lex&&(e=this.pre_lex.call(this,0)),"function"===typeof this.options.pre_lex&&(e=this.options.pre_lex.call(this,e)||e),this.yy&&"function"===typeof this.yy.pre_lex&&(e=this.yy.pre_lex.call(this,e)||e);!e;)e=this.next();return this.yy&&"function"===typeof this.yy.post_lex&&(e=this.yy.post_lex.call(this,e)||e),"function"===typeof this.options.post_lex&&(e=this.options.post_lex.call(this,e)||e),"function"===typeof this.post_lex&&(e=this.post_lex.call(this,e)||e),e},fastLex:function(){for(var e;!e;)e=this.next();return e},canIUse:function(){return{fastLex:!("function"===typeof this.pre_lex||"function"===typeof this.options.pre_lex||this.yy&&"function"===typeof this.yy.pre_lex||this.yy&&"function"===typeof this.yy.post_lex||"function"===typeof this.options.post_lex||"function"===typeof this.post_lex)&&"function"===typeof this.fastLex}},begin:function(e){return this.pushState(e)},pushState:function(e){return this.conditionStack.push(e),this.__currentRuleSet__=null,this},popState:function(){return this.conditionStack.length-1>0?(this.__currentRuleSet__=null,this.conditionStack.pop()):this.conditionStack[0]},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL},stateStackSize:function(){return this.conditionStack.length},options:{trackPosition:!0},JisonLexerError:e,performAction:function(e,t,n){if(1!==t)return this.simpleCaseActionClusters[t]},simpleCaseActionClusters:{0:13,2:5,3:6,4:3,5:4,6:15,7:15,8:15,9:15,10:15,11:15,12:16,13:16,14:16,15:16,16:17,17:17,18:18,19:18,20:19,21:19,22:19,23:20,24:21,25:22,26:23,27:25,28:24,29:26,30:27,31:28,32:11,33:9,34:12,35:10,36:7,37:8,38:14,39:1},rules:[/^(?:(--[\d\-A-Za-z]*))/,/^(?:\s+)/,/^(?:\*)/,/^(?:\/)/,/^(?:\+)/,/^(?:-)/,/^(?:(\d+(\.\d*)?|\.\d+)px\b)/,/^(?:(\d+(\.\d*)?|\.\d+)cm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)mm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)in\b)/,/^(?:(\d+(\.\d*)?|\.\d+)pt\b)/,/^(?:(\d+(\.\d*)?|\.\d+)pc\b)/,/^(?:(\d+(\.\d*)?|\.\d+)deg\b)/,/^(?:(\d+(\.\d*)?|\.\d+)grad\b)/,/^(?:(\d+(\.\d*)?|\.\d+)rad\b)/,/^(?:(\d+(\.\d*)?|\.\d+)turn\b)/,/^(?:(\d+(\.\d*)?|\.\d+)s\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ms\b)/,/^(?:(\d+(\.\d*)?|\.\d+)Hz\b)/,/^(?:(\d+(\.\d*)?|\.\d+)kHz\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dpi\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dpcm\b)/,/^(?:(\d+(\.\d*)?|\.\d+)dppx\b)/,/^(?:(\d+(\.\d*)?|\.\d+)em\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ex\b)/,/^(?:(\d+(\.\d*)?|\.\d+)ch\b)/,/^(?:(\d+(\.\d*)?|\.\d+)rem\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vw\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vh\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vmin\b)/,/^(?:(\d+(\.\d*)?|\.\d+)vmax\b)/,/^(?:(\d+(\.\d*)?|\.\d+)%)/,/^(?:(\d+(\.\d*)?|\.\d+)\b)/,/^(?:(calc))/,/^(?:(var))/,/^(?:([a-z]+))/,/^(?:\()/,/^(?:\))/,/^(?:,)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],inclusive:!0}}};return t}();function o(){this.yy={}}return a.lexer=i,o.prototype=a,a.Parser=o,new o}();t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)}},82:function(e,t,n){var r=n(3257),a=n(2993),i=n(9581);function o(e){return this instanceof o?(this.nodes=r(e),this):new o(e)}o.prototype.toString=function(){return Array.isArray(this.nodes)?i(this.nodes):""},o.prototype.walk=function(e,t){return a(this.nodes,e,t),this},o.unit=n(4119),o.walk=a,o.stringify=i,e.exports=o},3257:function(e){var t="(".charCodeAt(0),n=")".charCodeAt(0),r="'".charCodeAt(0),a='"'.charCodeAt(0),i="\\".charCodeAt(0),o="/".charCodeAt(0),s=",".charCodeAt(0),u=":".charCodeAt(0),c="*".charCodeAt(0);e.exports=function(e){for(var l,f,h,d,p,v,g,m,y=[],b=e,x=0,k=b.charCodeAt(x),w=b.length,I=[{nodes:y}],C=0,A="",S="",_="";x<w;)if(k<=32){l=x;do{l+=1,k=b.charCodeAt(l)}while(k<=32);d=b.slice(x,l),h=y[y.length-1],k===n&&C?_=d:h&&"div"===h.type?h.after=d:k===s||k===u||k===o&&b.charCodeAt(l+1)!==c?S=d:y.push({type:"space",sourceIndex:x,value:d}),x=l}else if(k===r||k===a){l=x,d={type:"string",sourceIndex:x,quote:f=k===r?"'":'"'};do{if(p=!1,~(l=b.indexOf(f,l+1)))for(v=l;b.charCodeAt(v-1)===i;)v-=1,p=!p;else l=(b+=f).length-1,d.unclosed=!0}while(p);d.value=b.slice(x+1,l),y.push(d),x=l+1,k=b.charCodeAt(x)}else if(k===o&&b.charCodeAt(x+1)===c)d={type:"comment",sourceIndex:x},-1===(l=b.indexOf("*/",x))&&(d.unclosed=!0,l=b.length),d.value=b.slice(x+2,l),y.push(d),x=l+2,k=b.charCodeAt(x);else if(k===o||k===s||k===u)d=b[x],y.push({type:"div",sourceIndex:x-S.length,value:d,before:S,after:""}),S="",x+=1,k=b.charCodeAt(x);else if(t===k){l=x;do{l+=1,k=b.charCodeAt(l)}while(k<=32);if(d={type:"function",sourceIndex:x-A.length,value:A,before:b.slice(x+1,l)},x=l,"url"===A&&k!==r&&k!==a){l-=1;do{if(p=!1,~(l=b.indexOf(")",l+1)))for(v=l;b.charCodeAt(v-1)===i;)v-=1,p=!p;else l=(b+=")").length-1,d.unclosed=!0}while(p);g=l;do{g-=1,k=b.charCodeAt(g)}while(k<=32);d.nodes=x!==g+1?[{type:"word",sourceIndex:x,value:b.slice(x,g+1)}]:[],d.unclosed&&g+1!==l?(d.after="",d.nodes.push({type:"space",sourceIndex:g+1,value:b.slice(g+1,l)})):d.after=b.slice(g+1,l),x=l+1,k=b.charCodeAt(x),y.push(d)}else C+=1,d.after="",y.push(d),I.push(d),y=d.nodes=[],m=d;A=""}else if(n===k&&C)x+=1,k=b.charCodeAt(x),m.after=_,_="",C-=1,I.pop(),y=(m=I[C]).nodes;else{l=x;do{k===i&&(l+=1),l+=1,k=b.charCodeAt(l)}while(l<w&&!(k<=32||k===r||k===a||k===s||k===u||k===o||k===t||k===n&&C));d=b.slice(x,l),t===k?A=d:y.push({type:"word",sourceIndex:x,value:d}),x=l}for(x=I.length-1;x;x-=1)I[x].unclosed=!0;return I[0].nodes}},9581:function(e){function t(e,t){var r,a,i=e.type,o=e.value;return t&&void 0!==(a=t(e))?a:"word"===i||"space"===i?o:"string"===i?(r=e.quote||"")+o+(e.unclosed?"":r):"comment"===i?"/*"+o+(e.unclosed?"":"*/"):"div"===i?(e.before||"")+o+(e.after||""):Array.isArray(e.nodes)?(r=n(e.nodes),"function"!==i?r:o+"("+(e.before||"")+r+(e.after||"")+(e.unclosed?"":")")):o}function n(e,n){var r,a;if(Array.isArray(e)){for(r="",a=e.length-1;~a;a-=1)r=t(e[a],n)+r;return r}return t(e,n)}e.exports=n},4119:function(e){var t="-".charCodeAt(0),n="+".charCodeAt(0),r=".".charCodeAt(0),a="e".charCodeAt(0),i="E".charCodeAt(0);e.exports=function(e){for(var o,s=0,u=e.length,c=!1,l=-1,f=!1;s<u;){if((o=e.charCodeAt(s))>=48&&o<=57)f=!0;else if(o===a||o===i){if(l>-1)break;l=s}else if(o===r){if(c)break;c=!0}else{if(o!==n&&o!==t)break;if(0!==s)break}s+=1}return l+1===s&&s--,!!f&&{number:e.slice(0,s),unit:e.slice(s)}}},2993:function(e){e.exports=function e(t,n,r){var a,i,o,s;for(a=0,i=t.length;a<i;a+=1)o=t[a],r||(s=n(o,a,t)),!1!==s&&"function"===o.type&&Array.isArray(o.nodes)&&e(o.nodes,n,r),r&&n(o,a,t)}},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<a&&0>i(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],f=1,h=null,d=3,p=!1,v=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function k(e){if(g=!1,x(e),!v)if(null!==r(c))v=!0,P(w);else{var t=r(l);null!==t&&D(k,t.startTime-e)}}function w(e,n){v=!1,g&&(g=!1,y(S),S=-1),p=!0;var i=d;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var o=h.callback;if("function"===typeof o){h.callback=null,d=h.priorityLevel;var s=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(c)&&a(c),x(n)}else a(c);h=r(c)}if(null!==h)var u=!0;else{var f=r(l);null!==f&&D(k,f.startTime-n),u=!1}return u}finally{h=null,d=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var I,C=!1,A=null,S=-1,_=5,E=-1;function T(){return!(t.unstable_now()-E<_)}function N(){if(null!==A){var e=t.unstable_now();E=e;var n=!0;try{n=A(!0,e)}finally{n?I():(C=!1,A=null)}}else C=!1}if("function"===typeof b)I=function(){b(N)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,R=O.port2;O.port1.onmessage=N,I=function(){R.postMessage(null)}}else I=function(){m(N,0)};function P(e){A=e,C||(C=!0,I())}function D(e,n){S=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,P(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:f++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(g?(y(S),S=-1):g=!0,D(k,i-o))):(e.sortIndex=s,n(c,e),v||p||(v=!0,P(w))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},1561:function(e,t,n){"use strict";var r=n(2791);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=r.useState,o=r.useEffect,s=r.useLayoutEffect,u=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(r){return!0}}var l="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),a=r[0].inst,l=r[1];return s((function(){a.value=n,a.getSnapshot=t,c(a)&&l({inst:a})}),[e,n,t]),o((function(){return c(a)&&l({inst:a}),e((function(){c(a)&&l({inst:a})}))}),[e]),u(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:l},7595:function(e,t,n){"use strict";var r=n(2791),a=n(7248);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=a.useSyncExternalStore,s=r.useRef,u=r.useEffect,c=r.useMemo,l=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var f=s(null);if(null===f.current){var h={hasValue:!1,value:null};f.current=h}else h=f.current;f=c((function(){function e(e){if(!u){if(u=!0,o=e,e=r(e),void 0!==a&&h.hasValue){var t=h.value;if(a(t,e))return s=t}return s=e}if(t=s,i(o,e))return t;var n=r(e);return void 0!==a&&a(t,n)?t:(o=e,s=n)}var o,s,u=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,a]);var d=o(e,f[0],f[1]);return u((function(){h.hasValue=!0,h.value=d}),[d]),l(d),d}},7248:function(e,t,n){"use strict";e.exports=n(1561)},327:function(e,t,n){"use strict";e.exports=n(7595)},613:function(){},4240:function(){},6227:function(){},8072:function(){},8090:function(){},3706:function(){},4836:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".884d5cc5.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="redflix:";n.l=function(r,a,i,o){if(e[r])e[r].push(a);else{var s,u;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var f=c[l];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==t+i){s=f;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[a];var h=function(t,n){s.onerror=s.onload=null,clearTimeout(d);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((function(e){return e(n)})),t)return t(n)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/redflix-public/",function(){var e={179:0};n.f.j=function(t,r){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((function(n,r){a=e[t]=[n,r]}));r.push(a[2]=i);var o=n.p+n.u(t),s=new Error;n.l(o,(function(r){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var a,i,o=r[0],s=r[1],u=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(u)u(n)}for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkredflix=self.webpackChunkredflix||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e={};n.r(e),n.d(e,{browserFiles:function(){return yk},browserHTTPRequest:function(){return Nk},concatenateArrayBuffers:function(){return Tb},copyModel:function(){return bx},decodeWeights:function(){return Ib},encodeWeights:function(){return kb},fromMemory:function(){return Dk},fromMemorySync:function(){return Mk},getLoadHandlers:function(){return Wb},getModelArtifactsForJSON:function(){return Pb},getModelArtifactsForJSONSync:function(){return Rb},getModelArtifactsInfoForJSON:function(){return Mb},getSaveHandlers:function(){return Bb},getWeightSpecs:function(){return Fb},http:function(){return Tk},isHTTPScheme:function(){return _k},listModels:function(){return vx},loadWeights:function(){return wk},moveModel:function(){return kx},registerLoadRouter:function(){return Ub},registerSaveRouter:function(){return zb},removeModel:function(){return mx},weightsLoaderFactory:function(){return Ck},withSaveHandler:function(){return Fk},withSaveHandlerSync:function(){return Lk}});var t={};n.r(t),n.d(t,{scaleBand:function(){return v9},scaleDiverging:function(){return kre},scaleDivergingLog:function(){return wre},scaleDivergingPow:function(){return Cre},scaleDivergingSqrt:function(){return Are},scaleDivergingSymlog:function(){return Ire},scaleIdentity:function(){return dee},scaleImplicit:function(){return d9},scaleLinear:function(){return hee},scaleLog:function(){return wee},scaleOrdinal:function(){return p9},scalePoint:function(){return m9},scalePow:function(){return Oee},scaleQuantile:function(){return Vee},scaleQuantize:function(){return Gee},scaleRadial:function(){return Dee},scaleSequential:function(){return pre},scaleSequentialLog:function(){return vre},scaleSequentialPow:function(){return mre},scaleSequentialQuantile:function(){return bre},scaleSequentialSqrt:function(){return yre},scaleSequentialSymlog:function(){return gre},scaleSqrt:function(){return Ree},scaleSymlog:function(){return See},scaleThreshold:function(){return Hee},scaleTime:function(){return lre},scaleUtc:function(){return fre},tickFormat:function(){return lee}});var r=n(2791),a=n(1250),i=n(7248),o=n(327),s=n(4164);var u=function(e){e()},c=function(){return u},l=(0,r.createContext)(null);function f(){return(0,r.useContext)(l)}var h=function(){throw new Error("uSES not initialized!")},d=h,p=function(e,t){return e===t};function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=e===l?f:function(){return(0,r.useContext)(e)};return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;var a=t(),i=a.store,o=a.subscription,s=a.getServerState,u=d(o.addNestedSub,i.getState,s||i.getState,e,n);return(0,r.useDebugValue)(u),u}}var g=v();n(2110),n(6900);var m={notify:function(){},get:function(){return[]}};function y(e,t){var n,r=m;function a(){o.onStateChange&&o.onStateChange()}function i(){n||(n=t?t.addNestedSub(a):e.subscribe(a),r=function(){var e=c(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,a=n={callback:e,next:null,prev:n};return a.prev?a.prev.next=a:t=a,function(){r&&null!==t&&(r=!1,a.next?a.next.prev=a.prev:n=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}())}var o={addNestedSub:function(e){return i(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:a,isSubscribed:function(){return Boolean(n)},trySubscribe:i,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=m)},getListeners:function(){return r}};return o}var b=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement)?r.useLayoutEffect:r.useEffect;var x=function(e){var t=e.store,n=e.context,a=e.children,i=e.serverState,o=(0,r.useMemo)((function(){var e=y(t);return{store:t,subscription:e,getServerState:i?function(){return i}:void 0}}),[t,i]),s=(0,r.useMemo)((function(){return t.getState()}),[t]);b((function(){var e=o.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),s!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=void 0}}),[o,s]);var u=n||l;return r.createElement(u.Provider,{value:o},a)};function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=e===l?f:function(){return(0,r.useContext)(e)};return function(){return t().store}}var w=k();function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=e===l?w:k(e);return function(){return t().dispatch}}var C,A=I();function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _(e,t){if(e){if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(l){c=!0,a=l}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}!function(e){d=e}(o.useSyncExternalStoreWithSelector),function(e){e}(i.useSyncExternalStore),C=s.unstable_batchedUpdates,u=C;var T="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADHCAYAAABcDhxLAAAJYHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHja7ZhbliO5DUT/uQovgSRIgFwO+DrHO/DyfZlS1Uz1dM+0j9v+GmVJTKUy+UAEAsEK+1//POEfvCQVDaVa064aeZVeenZOWny9/PlMsTyfz2t+/Ja+Xg/T3j9kLgmtvL42fd//cT19dvBqnLP6u47afP8wvv7Qy7v/9k1H+dXIndE9X++O+rsjya8f0rsDfy0ram/2+yWM/Wr3xxLb6x3uR57v2943f/u9GNFblXEk5y1JIp8i+TUBuW8J4pwkPrMUbryH812f6/aOGQH5XpziReY92/AFCfnth+f6BxAfrx7juUsrf+w0fAvv59k38J79fXSrv+4IXPiKin62372e6jfX5WNGF6vfjawfZ/nr9V3e9Ixf0brvc1YL55kzq/CiYKPvRX0s8TnjxkFg5HlMOYx35dyeo3O0wDgT7qw44+CYqacMvieVtJKnk/bTzjSZYsk7G23OM8tzrYnlnqfEANTlHulkky5LGkSYD0+K5M+5pGfc/gw3U2PglbgzJzpLPJHD/fgVxw87OufmTkpPMPcTK+aVL5uZxkXufnIXgKTzwaP6BPjj+PZ1cRUQrE+YGwv0OF5djJre3ApPVlyghRsr7Stpk613B4SIsSuTSQhYipqkJk3RcraUiGMDH6ejdpNsAEGqNS9mmYuIAk7Ld2yesfTcm2t+XUb8AKKSjwY0XRysCgoJf6w0OORVaqm1arXaaq+uokWrqppeFXUTK1ZNzaxZN2/SSqtNm7UWWm/ecxdUtnbt1lvv3Z1BnZ6dp50b3EceMsqoQ4eNNvrwCX1mmXXqtNnC7NNXXrIQnKXLVlt9+U4bKu2y69Ztu+2+/UC1I6ecevTYaacf/0QthResfzh+HrX0gVp+kLo32idqPGr20UW6clIvZiCWSwJxuwhA6Hwxiy2VksOF7mIWO3opNTPLesFZ6SIGgmWnXE/6xO435L7gFkr5r3DLH8iFC92vQC5c6H6A3B9x+w5q68rdjBIehG4a3qBGIf2Qn9w8j10pnveseaHcVf7ij9vwVzf8bPt3R//vjlQR5gfzn2mhTSc3LRspWxeMygdha77X8rP3Vc2pq7VVTsm2dFSEsK/aDyrr1fAxc8xs7osrozWyq61J6pCsJ7hVt7Wtyag6SOOdUraK5ymzrCVHZjW3lu6B4fQ98nFuTY5qkx8dAlMlg2+vtd30L0pOj7FO8t1GSqOevUh0WSP70Fyn4aCOyT6dzmOtG50ga11k14DQ+3yFTFGfn47UR0t+ypnC0hAHZIUZpUS9szU3Y7WDWexxMBNXDIYgfPWInHE8+sFAbCkNSSJKJbu3eaXWih/K+2iCFJnMo9cojr6VwRoBQ4tkzbHLHGdPnOE82yMrKOhAXqO4opBblNgTXmt+1FnnwUK2nq4M2UQK8WSGzq7pU8YWqtBpVU/FUKO7ujvPx4DGeO7lqYZXv5hdjnO+5CPGP7Rj5TNTnowhWGQmsFc/c4ZlHY6UvpNwamUMF3Qr9TOEux1R2/1U33MmZDj62Id5GOoL3KmsgqEqJYbd8FaFWTTIoRGbTJlJ23WsjbwzPGoeTzx131WMaEdS3VdL4fQV2pQWbiXojYUV9dXNEkTdq87GTsfa8ZH6KiPvpib64sh1et9LuPBnmWjKWFHrWqbjoO7pTCgLKLksimOlOKiXzh4jYf36zhTIRRhxIxk491HSZI3pUBx7s2z0lty9UrFINaltrEgxIOFyrKBPdobVTE6vfNlRyzJEPw/qIUQf2g4FbeWoo3W5CRHPmoRk0OuCi0JNgnGmgqu9va45gc6hSzuTkS7Up7tuXppfK80/zJO81lCyH8XQMQgHvpZBDqUvU51ORhim+vG2VtbZoStWmd9dizykrIzoVLayl4bR9n7Tr12Hd0eP/3lLjPTyUFRn9VtdrwfYFMfRKxlVK/WS/CZeEYdIDMnTjq+RdaNVKc4UeOtnBYXAPZdd+uzH7sSw8kRssA9oz4BE5yeUO/wa6f+fdERUNkVBQAbv2wtrVWWPAqDHeyKxd9yWb+EoCX5juicwkldsqdwCAtOcgA8R3IzPnlLrTsLmVhSykV0Z/qH+j4/L2ldObeJtcj89HRzjqGY1oHrbGI8q0nXf/ReW7Yy9ElKzZA5bnpdeH7fFWs2V9N+kws2PGnupq5PcZP+Ln1igLxrGRlgaNYkJtHvligBaot5tgzhJnLN3/BdFqNhWCOmXzZOpXHN9HH+olMtscPvWJcdM+pDVtd09yNxZF/Zuk92o2F5EiQK5kBFlYeNKhCDOBFbsmJG2FNhhN6HPrQ0Z55juu81CHrNhUUgZ7+8LEi4LnuiYWlH3gaYDCabq+hxJpuRRqKYdiytk9gFDvKZRGybbyLVzGoCA3A+8QMjiicQmHUbtj4ZSr9okE+/+9OFJYQf1o1rw2YZvLvgivOCivdtIC8pMRkLfRmOJDhvkmmBEE2HH+gL3yBQzthDUAEG/+kAfJiygVtax7zYOyzELz+4p9ZCdhfLVMBmMuFubhg8/t+zmtlXCQlMyTgZeMxwFl+IdG+k70UGiCc/mmoqg0s9atXGDY73nBYi0roNKCz5BMf5ChYsorF2hrtVLnd7OKQC3aJEBZB9RH1nqbouHqTgEXmBoYqKweGIisl5fRfCvKKLj8I4d/lkLzYVsdN0vEov93bVf2ZsWbNYkCntFJyupWju07WwQ7m5SgW+DZUbS6S22a7AOV+x+A+Fz6KUrImvsfM+BJFvteKEE7sBQrSsOrWuCXMTopIgr8/h0xmarHmoMLme2G172bAcjQm6nebdA5c5rxBxuLdK74SF/EFxE92Drpi3kNpUh+85BNwYSLsDmPbpPH2xM2eeI4iSg3zYJGw/wjL0pCLQmIJhhTnv9O07v5jHff/uABhLBhPETG6vGBqxRGfX+S+X0QAAqozABqhLnONErIRlDhUnAo+VbAlotTBLCLMDZLGyTyu20IeX+F4atYiioS7k1HfJCJurIQY+QQUwZEkUmdrapgtERdJJ6OSIuiocch4aEUGGArQt6VDrSV7Y+WYIylr9OrO+04U9uYM8NV69oLne4PYfjj73OCaUxfCgDzhRGFLQ54DMULlXbJJIY7C4JuWLXeq5hXSxJztr9RtGx8KRcxYxmtgr2Elcq6Uf2l19Qj8Iv2hz93dHfHX3Pqp9zVg//BhMI7FzpegnAAAABhWlDQ1BJQ0MgcHJvZmlsZQAAeJx9kT1Iw1AUhU9TiyJVBzsUEclQnSyIijhKFYtgobQVWnUweekfNGlIUlwcBdeCgz+LVQcXZ10dXAVB8AfE1cVJ0UVKvC8ptIjxwuN9nHfP4b37AKFRYarZNQGommWk4jExm1sVu1/hQxgB9GNEYqaeSC9m4Flf99RNdRflWd59f1afkjcZ4BOJ55huWMQbxDObls55nzjESpJCfE48btAFiR+5Lrv8xrnosMAzQ0YmNU8cIhaLHSx3MCsZKvE0cURRNcoXsi4rnLc4q5Uaa92TvzCY11bSXKc1jDiWkEASImTUUEYFFqK0a6SYSNF5zMM/5PiT5JLJVQYjxwKqUCE5fvA/+D1bszA16SYFY0DgxbY/RoHuXaBZt+3vY9tungD+Z+BKa/urDWD2k/R6W4scAQPbwMV1W5P3gMsdIPykS4bkSH5aQqEAvJ/RN+WAwVugd82dW+scpw9Ahma1fAMcHAJjRcpe93h3T+fc/u1pze8HSq9ylxXHysYAAA12aVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjg1MWM1NWJiLThlYWYtNGZiMy1hY2VhLTQ2YTI1MmZiOGMyZCIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4ZWQzNWI5ZS00YzExLTQ1NzMtYjBkMC1hYTcxMGYzNThkODAiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkMzUwMTliYi00ZWEwLTRjYmYtOTcwOS1kYzU4Zjc5MmQ0NDEiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJXaW5kb3dzIgogICBHSU1QOlRpbWVTdGFtcD0iMTY3NDUzNzM3MDA1NTc4MyIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjMyIgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICB4bXA6Q3JlYXRvclRvb2w9IkdJTVAgMi4xMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMzowMToyNFQwMDoxNjowNy0wNTowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjM6MDE6MjRUMDA6MTY6MDctMDU6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDozMTEzMjNjYy05ODY2LTQ3ZTMtODVjOS0yMTgwOTJhZjcwOTAiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoV2luZG93cykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjMtMDEtMjRUMDA6MTY6MTAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+JTBQqQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cBGAUQCsOE7v4AAAmRSURBVHja7d1LiGR3Fcfxc+7t6sc8MjMmJJMxQYnRZJX4WGlWIqLizoVZCS5EwV1EEDQIUXDlSrcRAxIw4ELjQiQqIWogE1EjEc3bTDLv7p5+1PPe///8XFR1d/VMT/oxPTNV3d/PUNMzXV3Fved/zv0/bhd/MwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMB58nA621bv0sHv5oLt6M40jj9F8e8tc69RDZTHxCSmWjx246+dEZBPL3dkHQ2leilpSaJ1IUm5n9f5DpMZXqPm3UPedUN0MpRQKZdW9rN5cVvPlpNlfEqUNA5cuDQpjE5FDuV1H80miNj4qNf8aqptXXPf6bapQilDdyepezGq/0425XxO11eKoz2vjyF29TJRbod7rRG/0JbX/mVUvbdaiUlYM/qSoU1b73X0fPCl3tXOR1H2BFBxdWe2/h1Ir1l0BY4PiGHo2Vsql6mYt3tD2LUarONKCWTF1LYsOpU1+vF3P3U8qjp5unv2yW+Met2LG7b1WiNaelczczSKbuTWmwiZuq3Th8X0XvFbv4gP9a8VuSJdIx1EcOlcXpMg7Gxv0e5EUvaWs5Zf2XQ9yYPLYc/1rxa6c1iHScbTUsfykW3nEzHeWc25mMit84rBb40Qrnf3hjThuH52rS267FTO7NlqzvFz4xBFSc1SGz/WC2XbaQ4O/ZZJZMairkMw917L6fOkH7t43PYibT+9u4XtBWo6SYnqHeWGFu4VkMrPC3WRFw608vN8m6bHLBTdFUo5QD2Lqbn9ws/Yo3MxNZiZzUzKzcr8VyC4P9xSk5UiZ2K306JfMjRkh7OECsZqcHCXXvgAjrfZGVSha+61AtMsjthZJOVrT9J2/UoMSW70/0p+KMAfZeWvU0fkxSTlS6u1fBIcLY7X3GDyRZ/dV9JKqN7RrIpGPo9iHbPcmYWzwCygRod5sszrz8L7qQSZ88kNmyrszO69Oko4jWCCW57bXi/j6AZrMzCKF1W8dmjzx1DhOjK9JVvV2YY27r+24ouVecid9dHuRun9h3v4qlEwmS3OlT952o453pG6mlT75gbDqtR32JDKLHsUx2qrc/K6ZuttvY5ksL2Zr/4bZXLSeknJP0lbHrBHKy6TfeGjXc/dJaXlrH4jrfyguq7rYi4WfEb2BTj3/OSl3tvDBqUjq/oOIjZ9QfXHziXukUD1LtK5aKEs/COVO/zPokdceihTVG0Ro/CV1/x3KneiPGkKKyJGWQol7WQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANjYfOvtD8633jpOJIAhzerij0LdC6HefFL7zVDz1dD800QG+1o7Lf42q26HcmTlkHJIKaQUOVLOav2PKI25UPe/oXouVF8MVeeSmk8RlfdWaemZrNQOxWBn25VtxLIU0d9BJEuhOrf09iNEbHyL47X+DkkruyhFhFJTSgudauE7RGi9pO6pUM4rhZEl5f5eSYoYlEpIOefBP7sLlc78lMiNZXF0/jXYZ3HjLRUVScrtZvfc0X09jKrPfzrUeTWUOrHhbnurpaKI3C+OwfeT2udqnXvieh7fBKl8fciKW9x8UjLz1U2tNdgj3N3MSjOfOTB1+1wo13V0/jhVHvrifolPrc5LhZV3FVYetv6238VK5FZ2AZfC3N1yDivLwtzd+rvdmkWWeVke7VmaJ9vGsgepl2LT/Ucvv1amdlLn5T07t8jN34XqZijXoYjVDmKD3qL/WJ19KCIplBTKg69JSc1T1/uY6UGuV4FYXiisOGjmxVC3YuZrV8jLuZUzpRX3S7kni1ZSdXKyOPj5se4povV84ZP3uRWHzbx0s2Ld+fv6CAx/Q0O9iLmbLFeytOSmniwtzS6f+hKZNqZ6uvSLrGphu73I8NW0f6VN7VB9Ian13Dicd7N34d6s7iuh+lIo90I5aQcxiKFHnateUq9Zq/l60tyzi9WbXyPD9sSqzNIfQnVrXZHEYI6+LgU2T5VQToOtktuhtFjl9p9H4kKQlp/Iqk6HUnNwfJWU19Zjr0j5jUpg6DwjVl+ZJaXISqpzUvv0Un3qUbJqr427tfj7rOpSKJTXpUwoIlXbv7rGcNFUoXoxVJ0PVafraD/b7M1+6rqsNvUufaWOzouh+kIotfqrTrlaKYSVP9s7j5Ul3LV5RygrR1JWUlavmdQ+s9B75/s3q/2cFL5BV9pYer7hMw+Y+bSZuxTdwospMy/NfHjxZktrZP0f1tpQffB1ZbXM+8/HZS9Sf/XMTGZhpuTmhfo/Vw5Sohh6TdE/PtPaKtPQotxVDlgaPONbPRcN/z9kuVWrdbLZmf3erQc/8sLNbDcK5Ib3KEt/Ka3xQbNi2q087FZM7rwZNFpNuKPDyQqlOXMr3KKTrPvKpL/vM6NyShTIzRt6Pec2fX9hE7e5Fe7XnJkbNee1FNC6Xuoq76P3TKf194DWXqPV1ymH5WW3tNyN5V8dLI9/a9TaiQK5ydpp/umpcuajbsUhWTHp5lNmxYRv2jTXo/fQFlLk8oLRpj8/uLWXZNF2U20WXZnatarXpotjI31zlAIZpXmKzj06YTOfNZu4061xXFYcdCsKv+rV2zcplK30AsM5vlHyr9299iveoz/Z6PcUvvot+cpXmVtIFgtmacmsfjdb98VJv2NsfsGQAhnZYrn4eGnTH3ObOGFWzLiVB818QjK5u/uOmk6DoY/MzU1u5vK15Pct1t2V77jaVwx+nSabqTLLy7L6fK32MzPFHd8ex3agQMZAK05/fdoPfdWscdysPGJWHjMr3MyvfmN+cNfezdf1A1fWgF9RExruSNa9v9YWzry4bD4RXVmaM0uzZvnshB/9wl6IPQUyhha6Zx45OHXLNworj8q8dCumzbwxaNLCzMLMG762NLuuuTWoAHcfmkj7cA+jfhe1slQc2cxisDRcmSkNyqiWRbeb2s+020vfvP3IPXmvxZoC2SMuLL86cejgkccmfeohs+KwW3HArDxqVkz1i8cbZkXDzIqrD89CZur1KyW6smiZRdMsL4bls3V0T3Z6rZ/ceuDe1n6JKwWyz5ydf/PORqPxycLL9/dHWFrOkU/XVe9PJ279cCJCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwBj6P1DeTfGJxCK/AAAAAElFTkSuQmCC",N="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAA2CAMAAAC1HibFAAADXnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHja7ZZbsuQmDIbfWUWWYN2QWA7Xquwgy8+P7e6c7ulU5kxexy4DxlgS/wey0/zrz5X+wEHiR1LzyCXnA4cWLVzRiOM66lnSoWd5Hv3xjF77k+T7AaNLUMt1G3c/PfrpaeCqKlr2xVD0+0F7fVD0th9vhm5HsiNiNMZtqNyGhK8HdBuo17SOXMK/TqHNq77fv2TAlXYBrfiM6jbyfq8O9YahU5inkBwoRfgKQPYlSerZqLggB9oFbZVAKfKYKgT5pNPzKIho7VD146AXKs/WGy21W6N3Wsr3EHkTOT/rj/2J7DOVU/qvnuNu8Wv/0c47RPSm/r7WGrHOOWMWVTOkzvekHlM8WxjX4GK7joTQ8uG4DCb8PAvOwKruoDaODp8N7UIMXIuUBlVaNM+6U0eIyjOxo8HcAW13hjgX7qBHYIeTFjtIDnBk6Sd2FX7GQqfbcvR0egt4HoShTDBGeOXbZ/ruC2vtrUC0tVQ7tUJczFtshLHJ7RLDwIDWLaqdAj/O92NzFTCzrfLeIgXCtstEM/onE8gJWjDQUF/bhXzcBhAQXBuCIQEBUCMxynQ4sxNByACgitBZlBsIkBkPBMkqksEmeLvGK07nUDZGd0I/khlImGRxsMFeAyxVw/pxDayhamJqZtncworVLFmz5Zw976RYXVyTm2d3Dy9eQ0LDIodHRIlauAiSppVcvEQppVb4rLBc8XbFgFobN2naLLXcvEUrrXYsn67deu7eo5deBw8ZyB8jDx8xyqiTJpbS1GkzT58xy6wLS21JWrps5eUrVln1Se3G+sP5DWp0U+OT1B7oT2rodX+YoJ1ObDMDME5KIO4bARY0b2ZHkCpvcpvZUXhnOEaQtpkN2sRAUCexLXqwS3wR3eT+F7fk+sKNf5Vc2ui+Se5Hbp+ojf0Z6iexaxduUQ/B7utc8V5vaoNgSzlgYYp1jbwoVT3qyB16mFKRjNTjq7UlhjS0v+eNIMKs8F4hN2LMhXesbrNkjDRp8B/49iNd+Vo7TUGvtbwf+44wBc6qMR25UXzMqB2bzxf+FbwO8K07BzoEwhblFEOr+4RsmHXLC2EfFYPwMzHjaiHz/Hedfnbgb0O/Df1bLWulsX+S/gapLn5e5mwAhwAAAYVpQ0NQSUNDIHByb2ZpbGUAAHicfZE9SMNAHMVfU6UiVQcrqDhkqE5WREUcpYpFsFDaCq06mFz6ITRpSFJcHAXXgoMfi1UHF2ddHVwFQfADxNXFSdFFSvxfUmgR48FxP97de9y9A4Raialm2zigapaRjEXFTHZFDLxCQB+6MYYBiZl6PLWQhuf4uoePr3cRnuV97s/RpeRMBvhE4lmmGxbxOvH0pqVz3icOsaKkEJ8Tjxp0QeJHrssuv3EuOCzwzJCRTs4Rh4jFQgvLLcyKhko8RRxWVI3yhYzLCuctzmqpwhr35C8M5rTlFNdpDiGGRcSRgAgZFWygBAsRWjVSTCRpP+rhH3T8CXLJ5NoAI8c8ylAhOX7wP/jdrZmfnHCTglGg/cW2P4aBwC5Qr9r297Ft108A/zNwpTX95Row80l6tamFj4CebeDiuqnJe8DlDtD/pEuG5Eh+mkI+D7yf0Tdlgd5boHPV7a2xj9MHIE1dLd0AB4fASIGy1zze3dHa279nGv39AJ+jcrl9lTlcAAAOVWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9ImdpbXA6ZG9jaWQ6Z2ltcDoyMGIxNDVlNy04MTAwLTQ2YjItYTNkMy1lNTU5NTUzYmY1MDkiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MGMzMjg5NGEtNGUzYS00ZGJmLWE2N2MtMTE4N2JhMjVhNzBjIgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZWFkNTkyYWUtOGMyNi00YmQ3LWI4ZDMtZWRjMWU5YWZlNDkwIgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iV2luZG93cyIKICAgR0lNUDpUaW1lU3RhbXA9IjE2NzY5OTA5MTY3ODAwOTAiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMiIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiCiAgIHhtcDpNZXRhZGF0YURhdGU9IjIwMjM6MDI6MjFUMDk6NDg6MzUtMDU6MDAiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDIzOjAyOjIxVDA5OjQ4OjM1LTA1OjAwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZTIxOGYyM2EtY2IzMC00NzA4LTlkNDAtOTQ3OGZhZmNmYzRhIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTAyLTIwVDE1OjAwOjQ1Ii8+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InNhdmVkIgogICAgICBzdEV2dDpjaGFuZ2VkPSIvIgogICAgICBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjE3MzQ0ZGQ0LTBjZWMtNGFiOS1hNjk2LWRmNjM5MWI3ZjhkYiIKICAgICAgc3RFdnQ6c29mdHdhcmVBZ2VudD0iR2ltcCAyLjEwIChXaW5kb3dzKSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyMy0wMi0yMVQwOTo0ODozNiIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz5NTg4qAAADAFBMVEXpKSzpKSz////pKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSzpKSyay26YAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfnAhUOMCQzSYp/AAABn0lEQVRo3u3a2w7CIBAE0Jn+/0cbH0yqhWVnYSmoJCa2lpYj5bYtALCUcEqkcUglj5QXZs7K9mUnzWspkFKhxkFglcxwnI6XIB/FmgZ5fTuO4/l5pvoZfBBmQ2hVSAnCIIQ5ELgg1s0lQzgHQjeEUQhTIKhdGnkQLg2BPFBUev/PH2OQypZRHs/1LidTyuqFVOrAMV6KkEIXmQex7rNGHTogyIWURsAkCCLtKwKhC4I4BLMh2BKC9qg9DKLn7YLgD7kXguZcyLjCr0LQmDn0QaBAlLWTDuFAiGvWvylEW1jdCIG0FP0uCNaEtGbs0nJ1JwhWhVCDIA2CmW1EHoBbkGEju9rY14Wo40gcwpsh7VpbcNLomVZtAXHGU0OQuUtdJXj/oxDOhdAzje+CJAfo0iHTIo2OcFAoflvr9NJiv1mQVo038qZAzNsj+qBH+BOcf7Ej9pvx6G0sBD4IuiGYCeF2ELMOUiBYBYIuSKCHdUHsHeMhWAmC6JsPkJMbwvEQTEliL2Ys8c/H47akvq6F9ZPvBTpsma4Q7A95aw37ch4dmxOj8DqqPQAAAABJRU5ErkJggg==",O=n(184);function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function P(){return P="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},P.apply(this,arguments)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e,t){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M(e,t)}function F(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}function L(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function z(e){var t=L();return function(){var n,r=R(e);if(t){var a=R(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===j(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return D(e)}(this,n)}}function U(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function B(){B=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(E){u=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof h?t:h,o=Object.create(i.prototype),s=new A(a||[]);return r(o,"_invoke",{value:k(e,n,s)}),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(E){return{type:"throw",arg:E}}}e.wrap=c;var f={};function h(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(S([])));m&&m!==t&&n.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function a(r,i,o,s){var u=l(e[r],e,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==j(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(f).then((function(e){c.value=e,o(c)}),(function(e){return a("throw",e,o,s)}))}s(u.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function k(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return _()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=w(o,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var a=l(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,f;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function S(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:_}}function _(){return{value:void 0,done:!0}}return d.prototype=p,r(y,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:d,configurable:!0}),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,u(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(x.prototype),u(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new x(c(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(y),u(y,s,"Generator"),u(y,i,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;C(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}function W(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(bu){return void n(bu)}s.done?t(u):Promise.resolve(u).then(r,a)}function V(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){W(i,r,a,o,s,"next",e)}function s(e){W(i,r,a,o,s,"throw",e)}o(void 0)}))}}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e){var t=function(e,t){if("object"!==j(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===j(t)?t:String(t)}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,H(r.key),r)}}function q(e,t,n){return t&&K(e.prototype,t),n&&K(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function X(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t,n){return(t=H(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z(e,t,n){return Z=L()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&M(a,n.prototype),a},Z.apply(null,arguments)}function Q(e){var t="function"===typeof Map?new Map:void 0;return Q=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Z(e,arguments,R(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),M(n,e)},Q(e)}var J={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},$=function(e,t){if(!e)throw ee(t)},ee=function(e){return new Error("Firebase Database ("+J.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},te=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},ne={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],a=0;a<e.length;a+=3){var i=e[a],o=a+1<e.length,s=o?e[a+1]:0,u=a+2<e.length,c=u?e[a+2]:0,l=i>>2,f=(3&i)<<4|s>>4,h=(15&s)<<2|c>>6,d=63&c;u||(d=64,o||(h=64)),r.push(n[l],n[f],n[h],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(te(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){var i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){var o=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],a=0;a<e.length;){var i=n[e.charAt(a++)],o=a<e.length?n[e.charAt(a)]:0,s=++a<e.length?n[e.charAt(a)]:64,u=++a<e.length?n[e.charAt(a)]:64;if(++a,null==i||null==o||null==s||null==u)throw Error();var c=i<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var f=s<<6&192|u;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},re=function(e){var t=te(e);return ne.encodeByteArray(t,!0)},ae=function(e){return re(e).replace(/\./g,"")},ie=function(e){try{return ne.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function oe(e){return se(void 0,e)}function se(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=se(e[n],t[n]));return e}var ue=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},ce=function(){try{return ue()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"/redflix-public",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}var t=e&&ie(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},le=function(e){var t,n;return null===(n=null===(t=ce())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},fe=function(e){var t=le(e);if(t){var n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));var r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]}},he=function(){var e;return null===(e=ce())||void 0===e?void 0:e.config},de=function(e){var t;return null===(t=ce())||void 0===t?void 0:t["_".concat(e)]},pe=function(){function e(){var t=this;G(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return q(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function ve(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function ge(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ve())}function me(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function ye(){return!0===J.NODE_CLIENT||!0===J.NODE_ADMIN}function be(){try{return"object"===typeof indexedDB}catch(e){return!1}}var xe="FirebaseError",ke=function(e){F(n,e);var t=z(n);function n(e,r,a){var i;return G(this,n),(i=t.call(this,r)).code=e,i.customData=a,i.name=xe,Object.setPrototypeOf(D(i),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(D(i),we.prototype.create),i}return q(n)}(Q(Error)),we=function(){function e(t,n,r){G(this,e),this.service=t,this.serviceName=n,this.errors=r}return q(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?function(e,t){return e.replace(Ie,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,").");return new ke(n,i,t)}}]),e}();var Ie=/\{\$([^}]+)}/g;function Ce(e){return JSON.parse(e)}function Ae(e){return JSON.stringify(e)}var Se=function(e){var t={},n={},r={},a="";try{var i=e.split(".");t=Ce(ie(i[0])||""),n=Ce(ie(i[1])||""),a=i[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:a}};function _e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ee(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Te(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Ne(e,t,n){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=t.call(n,e[a],a,e));return r}function Oe(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),a=0,i=n;a<i.length;a++){var o=i[a];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(Re(s)&&Re(u)){if(!Oe(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function Re(e){return null!==e&&"object"===typeof e}function Pe(e){for(var t=[],n=function(){var e=E(a[r],2),n=e[0],i=e[1];Array.isArray(i)?i.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))},r=0,a=Object.entries(e);r<a.length;r++)n();return t.length?"&"+t.join("&"):""}function De(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=E(e.split("="),2),r=n[0],a=n[1];t[decodeURIComponent(r)]=decodeURIComponent(a)}})),t}function Me(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var Fe=function(){function e(){G(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return q(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var a=0;a<16;a++)n[a]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var i=16;i<80;i++){var o=n[i-3]^n[i-8]^n[i-14]^n[i-16];n[i]=4294967295&(o<<1|o>>>31)}for(var s,u,c=this.chain_[0],l=this.chain_[1],f=this.chain_[2],h=this.chain_[3],d=this.chain_[4],p=0;p<80;p++){p<40?p<20?(s=h^l&(f^h),u=1518500249):(s=l^f^h,u=1859775393):p<60?(s=l&f|h&(l|f),u=2400959708):(s=l^f^h,u=3395469782);var v=(c<<5|c>>>27)+s+d+u+n[p]&4294967295;d=h,h=f,f=4294967295&(l<<30|l>>>2),l=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+f&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,a=this.buf_,i=this.inbuf_;r<t;){if(0===i)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(a[i]=e.charCodeAt(r),++r,++i===this.blockSize){this.compress_(a),i=0;break}}else for(;r<t;)if(a[i]=e[r],++r,++i===this.blockSize){this.compress_(a),i=0;break}}this.inbuf_=i,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,a=0;a<5;a++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[a]>>i&255,++r;return e}}]),e}();var Le=function(){function e(t,n){var r=this;G(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return q(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,a=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=U(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a in e&&"function"===typeof e[a])return!0}}catch(i){r.e(i)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=je),void 0===r.error&&(r.error=je),void 0===r.complete&&(r.complete=je);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{a.finalError?r.error(a.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function je(){}function ze(e,t){return"".concat(e," failed: ").concat(t," argument ")}var Ue=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Be(e){return e&&e._delegate?e._delegate:e}var We=function(){function e(t,n,r){G(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return q(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),Ve="[DEFAULT]",Ge=function(){function e(t,n){G(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return q(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new pe;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(a){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(r)return null;throw a}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Ve})}catch(u){}var t,n=U(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=E(t.value,2),a=r[0],i=r[1],o=this.normalizeInstanceIdentifier(a);try{var s=this.getOrInitializeService({instanceIdentifier:o});i.resolve(s)}catch(u){}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(X(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),X(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a,i=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=U(this.instancesDeferred.entries());try{for(o.s();!(a=o.n()).done;){var s=E(a.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(i)}}catch(l){o.e(l)}finally{o.f()}return i}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);var i=this.instances.get(r);return i&&e(i,r),function(){a.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,a=U(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;try{i(e,t)}catch(o){}}}catch(s){a.e(s)}finally{a.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,a=void 0===r?{}:r,i=this.instances.get(n);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Ve?void 0:t),options:a}),this.instances.set(n,i),this.instancesOptions.set(n,a),this.invokeOnInitCallbacks(i,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,i)}catch(o){}return i||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve;return this.component?this.component.multipleInstances?e:Ve:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var He,Ke,qe=function(){function e(t){G(this,e),this.name=t,this.providers=new Map}return q(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Ge(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),Xe=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Ke||(Ke={}));var Ye={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},Ze=Ke.INFO,Qe=(Y(He={},Ke.DEBUG,"log"),Y(He,Ke.VERBOSE,"log"),Y(He,Ke.INFO,"info"),Y(He,Ke.WARN,"warn"),Y(He,Ke.ERROR,"error"),He),Je=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=Qe[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a,i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];(a=console)[r].apply(a,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},$e=function(){function e(t){G(this,e),this.name=t,this._logLevel=Ze,this._logHandler=Je,this._userLogHandler=null,Xe.push(this)}return q(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in Ke))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?Ye[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ke.DEBUG].concat(t)),this._logHandler.apply(this,[this,Ke.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ke.VERBOSE].concat(t)),this._logHandler.apply(this,[this,Ke.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ke.INFO].concat(t)),this._logHandler.apply(this,[this,Ke.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ke.WARN].concat(t)),this._logHandler.apply(this,[this,Ke.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ke.ERROR].concat(t)),this._logHandler.apply(this,[this,Ke.ERROR].concat(t))}}]),e}();function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nt,rt,at=function(e,t){return t.some((function(t){return e instanceof t}))};var it=new WeakMap,ot=new WeakMap,st=new WeakMap,ut=new WeakMap,ct=new WeakMap;var lt={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ot.get(e);if("objectStoreNames"===t)return e.objectStoreNames||st.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return dt(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function ft(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(rt||(rt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(pt(this),n),dt(it.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return dt(e.apply(pt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.call.apply(e,[pt(this),t].concat(r));return st.set(i,t.sort?t.sort():[t]),dt(i)}}function ht(e){return"function"===typeof e?ft(e):(e instanceof IDBTransaction&&function(e){if(!ot.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=function(){t(),r()},i=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));ot.set(e,t)}}(e),at(e,nt||(nt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,lt):e)}function dt(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",a),e.removeEventListener("error",i)},a=function(){t(dt(e.result)),r()},i=function(){n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((function(t){t instanceof IDBCursor&&it.set(t,e)})).catch((function(){})),ct.set(t,e),t}(e);if(ut.has(e))return ut.get(e);var t=ht(e);return t!==e&&(ut.set(e,t),ct.set(t,e)),t}var pt=function(e){return ct.get(e)};var vt,gt,mt=["get","getKey","getAll","getAllKeys","count"],yt=["put","add","delete","clear"],bt=new Map;function xt(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(bt.get(t))return bt.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,a=yt.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(a||mt.includes(n))){var i=function(){var e=V(B().mark((function e(t){var i,o,s,u,c,l,f=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,a?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(i=s)[n].apply(i,c),a&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return bt.set(t,i),i}}}lt=function(e){return tt(tt({},e),{},{get:function(t,n,r){return xt(t,n)||e.get(t,n,r)},has:function(t,n){return!!xt(t,n)||e.has(t,n)}})}(lt);var kt=function(){function e(t){G(this,e),this.container=t}return q(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var wt="@firebase/app",It="0.9.3",Ct=new $e("@firebase/app"),At="[DEFAULT]",St=(Y(vt={},wt,"fire-core"),Y(vt,"@firebase/app-compat","fire-core-compat"),Y(vt,"@firebase/analytics","fire-analytics"),Y(vt,"@firebase/analytics-compat","fire-analytics-compat"),Y(vt,"@firebase/app-check","fire-app-check"),Y(vt,"@firebase/app-check-compat","fire-app-check-compat"),Y(vt,"@firebase/auth","fire-auth"),Y(vt,"@firebase/auth-compat","fire-auth-compat"),Y(vt,"@firebase/database","fire-rtdb"),Y(vt,"@firebase/database-compat","fire-rtdb-compat"),Y(vt,"@firebase/functions","fire-fn"),Y(vt,"@firebase/functions-compat","fire-fn-compat"),Y(vt,"@firebase/installations","fire-iid"),Y(vt,"@firebase/installations-compat","fire-iid-compat"),Y(vt,"@firebase/messaging","fire-fcm"),Y(vt,"@firebase/messaging-compat","fire-fcm-compat"),Y(vt,"@firebase/performance","fire-perf"),Y(vt,"@firebase/performance-compat","fire-perf-compat"),Y(vt,"@firebase/remote-config","fire-rc"),Y(vt,"@firebase/remote-config-compat","fire-rc-compat"),Y(vt,"@firebase/storage","fire-gcs"),Y(vt,"@firebase/storage-compat","fire-gcs-compat"),Y(vt,"@firebase/firestore","fire-fst"),Y(vt,"@firebase/firestore-compat","fire-fst-compat"),Y(vt,"fire-js","fire-js"),Y(vt,"firebase","fire-js-all"),vt),_t=new Map,Et=new Map;function Tt(e,t){try{e.container.addComponent(t)}catch(n){Ct.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Nt(e){var t=e.name;if(Et.has(t))return Ct.debug("There were multiple attempts to register component ".concat(t,".")),!1;Et.set(t,e);var n,r=U(_t.values());try{for(r.s();!(n=r.n()).done;){Tt(n.value,e)}}catch(a){r.e(a)}finally{r.f()}return!0}function Ot(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var Rt=(Y(gt={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),Y(gt,"bad-app-name","Illegal App name: '{$appName}"),Y(gt,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),Y(gt,"app-deleted","Firebase App named '{$appName}' already deleted"),Y(gt,"no-options","Need to provide options, when not being deployed to hosting via source."),Y(gt,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),Y(gt,"invalid-log-argument","First argument to `onLog` must be null or a function."),Y(gt,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),Y(gt,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),Y(gt,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),Y(gt,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),gt),Pt=new we("app","Firebase",Rt),Dt=function(){function e(t,n,r){var a=this;G(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new We("app",(function(){return a}),"PUBLIC"))}return q(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Pt.create("app-deleted",{appName:this._name})}}]),e}(),Mt="9.17.1";function Ft(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;"object"!==typeof t&&(t={name:t});var r=Object.assign({name:At,automaticDataCollectionEnabled:!1},t),a=r.name;if("string"!==typeof a||!a)throw Pt.create("bad-app-name",{appName:String(a)});if(n||(n=he()),!n)throw Pt.create("no-options");var i=_t.get(a);if(i){if(Oe(n,i.options)&&Oe(r,i.config))return i;throw Pt.create("duplicate-app",{appName:a})}var o,s=new qe(a),u=U(Et.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s.addComponent(c)}}catch(f){u.e(f)}finally{u.f()}var l=new Dt(n,r,s);return _t.set(a,l),l}function Lt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,t=_t.get(e);if(!t&&e===At)return Ft();if(!t)throw Pt.create("no-app",{appName:e});return t}function jt(e,t,n){var r,a=null!==(r=St[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));var i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){var s=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&s.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Ct.warn(s.join(" "))}Nt(new We("".concat(a,"-version"),(function(){return{library:a,version:t}}),"VERSION"))}var zt="firebase-heartbeat-database",Ut=1,Bt="firebase-heartbeat-store",Wt=null;function Vt(){return Wt||(Wt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,a=n.upgrade,i=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=dt(s);return a&&s.addEventListener("upgradeneeded",(function(e){a(dt(s.result),e.oldVersion,e.newVersion,dt(s.transaction))})),r&&s.addEventListener("blocked",(function(){return r()})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),i&&e.addEventListener("versionchange",(function(){return i()}))})).catch((function(){})),u}(zt,Ut,{upgrade:function(e,t){if(0===t)e.createObjectStore(Bt)}}).catch((function(e){throw Pt.create("idb-open",{originalErrorMessage:e.message})}))),Wt}function Gt(e){return Ht.apply(this,arguments)}function Ht(){return Ht=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Vt();case 3:return n=e.sent,e.abrupt("return",n.transaction(Bt).objectStore(Bt).get(Xt(t)));case 7:e.prev=7,e.t0=e.catch(0),e.t0 instanceof ke?Ct.warn(e.t0.message):(r=Pt.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),Ct.warn(r.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Ht.apply(this,arguments)}function Kt(e,t){return qt.apply(this,arguments)}function qt(){return qt=V(B().mark((function e(t,n){var r,a,i,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Vt();case 3:return r=e.sent,a=r.transaction(Bt,"readwrite"),i=a.objectStore(Bt),e.next=8,i.put(n,Xt(t));case 8:return e.abrupt("return",a.done);case 11:e.prev=11,e.t0=e.catch(0),e.t0 instanceof ke?Ct.warn(e.t0.message):(o=Pt.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),Ct.warn(o.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),qt.apply(this,arguments)}function Xt(e){return"".concat(e.name,"!").concat(e.options.appId)}var Yt=1024,Zt=function(){function e(t){var n=this;G(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new en(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return q(e,[{key:"triggerHeartbeat",value:function(){var e=V(B().mark((function e(){var t,n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=Qt(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=Qt(),n=Jt(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,a=n.unsentEntries,i=ae(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(a.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=a,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Qt(){return(new Date).toISOString().substring(0,10)}function Jt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yt,r=[],a=e.slice(),i=U(e);try{var o=function(){var e=t.value,i=r.find((function(t){return t.agent===e.agent}));if(i){if(i.dates.push(e.date),tn(r)>n)return i.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),tn(r)>n)return r.pop(),"break";a=a.slice(1)};for(i.s();!(t=i.n()).done;){if("break"===o())break}}catch(s){i.e(s)}finally{i.f()}return{heartbeatsToSend:r,unsentEntries:a}}var $t,en=function(){function e(t){G(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return q(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(be()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=function(){a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=function(){n=!1},a.onerror=function(){var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(bu){t(bu)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Gt(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Kt(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Kt(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(X(r.heartbeats),X(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function tn(e){return ae(JSON.stringify({version:2,heartbeats:e})).length}$t="",Nt(new We("platform-logger",(function(e){return new kt(e)}),"PRIVATE")),Nt(new We("heartbeat",(function(e){return new Zt(e)}),"PRIVATE")),jt(wt,It,$t),jt(wt,It,"esm2017"),jt("fire-js","");function nn(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;var rn;Object.create;function an(){return Y({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var on=an,sn=new we("auth","Firebase",an()),un=new $e("@firebase/auth");function cn(e){if(un.logLevel<=Ke.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];un.error.apply(un,["Auth (".concat(Mt,"): ").concat(e)].concat(n))}}function ln(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw dn.apply(void 0,[e].concat(n))}function fn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return dn.apply(void 0,[e].concat(n))}function hn(e,t,n){var r=Object.assign(Object.assign({},on()),Y({},t,n));return new we("auth","Firebase",r).create(t,{appName:e.name})}function dn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var a,i=n[0],o=X(n.slice(1));return o[0]&&(o[0].appName=e.name),(a=e._errorFactory).create.apply(a,[i].concat(X(o)))}return sn.create.apply(sn,[e].concat(n))}function pn(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw dn.apply(void 0,[t].concat(r))}}function vn(e){var t="INTERNAL ASSERTION FAILED: "+e;throw cn(t),new Error(t)}function gn(e,t){e||vn(t)}var mn=new Map;function yn(e){gn(e instanceof Function,"Expected a class definition");var t=mn.get(e);return t?(gn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,mn.set(e,t),t)}function bn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function xn(){return"http:"===kn()||"https:"===kn()}function kn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function wn(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(xn()||function(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}var In=function(){function e(t,n){G(this,e),this.shortDelay=t,this.longDelay=n,gn(n>t,"Short delay should be less than long delay!"),this.isMobile=ge()||me()}return q(e,[{key:"get",value:function(){return wn()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}]),e}();function Cn(e,t){gn(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var An=function(){function e(){G(this,e)}return q(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),Sn=(Y(rn={},"CREDENTIAL_MISMATCH","custom-token-mismatch"),Y(rn,"MISSING_CUSTOM_TOKEN","internal-error"),Y(rn,"INVALID_IDENTIFIER","invalid-email"),Y(rn,"MISSING_CONTINUE_URI","internal-error"),Y(rn,"INVALID_PASSWORD","wrong-password"),Y(rn,"MISSING_PASSWORD","internal-error"),Y(rn,"EMAIL_EXISTS","email-already-in-use"),Y(rn,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),Y(rn,"INVALID_IDP_RESPONSE","invalid-credential"),Y(rn,"INVALID_PENDING_TOKEN","invalid-credential"),Y(rn,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),Y(rn,"MISSING_REQ_TYPE","internal-error"),Y(rn,"EMAIL_NOT_FOUND","user-not-found"),Y(rn,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),Y(rn,"EXPIRED_OOB_CODE","expired-action-code"),Y(rn,"INVALID_OOB_CODE","invalid-action-code"),Y(rn,"MISSING_OOB_CODE","internal-error"),Y(rn,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),Y(rn,"INVALID_ID_TOKEN","invalid-user-token"),Y(rn,"TOKEN_EXPIRED","user-token-expired"),Y(rn,"USER_NOT_FOUND","user-token-expired"),Y(rn,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),Y(rn,"INVALID_CODE","invalid-verification-code"),Y(rn,"INVALID_SESSION_INFO","invalid-verification-id"),Y(rn,"INVALID_TEMPORARY_PROOF","invalid-credential"),Y(rn,"MISSING_SESSION_INFO","missing-verification-id"),Y(rn,"SESSION_EXPIRED","code-expired"),Y(rn,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),Y(rn,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),Y(rn,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),Y(rn,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),Y(rn,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),Y(rn,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),Y(rn,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),Y(rn,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),Y(rn,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),Y(rn,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),Y(rn,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),rn),_n=new In(3e4,6e4);function En(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Tn(e,t,n,r){return Nn.apply(this,arguments)}function Nn(){return Nn=V(B().mark((function e(t,n,r,a){var i,o=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",On(t,i,V(B().mark((function e(){var i,o,s,u;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},o={},a&&("GET"===n?o=a:i={body:JSON.stringify(a)}),s=Pe(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(u=e.sent)["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",An.fetch()(Mn(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},i)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),Nn.apply(this,arguments)}function On(e,t,n){return Rn.apply(this,arguments)}function Rn(){return Rn=V(B().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h,d;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,a=Object.assign(Object.assign({},Sn),n),e.prev=2,i=new Fn(t),e.next=6,Promise.race([r(),i.promise]);case 6:return o=e.sent,i.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw Ln(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=17;break}return e.abrupt("return",s);case 17:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=E(c,2),f=l[0],h=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=23;break}throw Ln(t,"credential-already-in-use",s);case 23:if("EMAIL_EXISTS"!==f){e.next=27;break}throw Ln(t,"email-already-in-use",s);case 27:if("USER_DISABLED"!==f){e.next=29;break}throw Ln(t,"user-disabled",s);case 29:if(d=a[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!h){e.next=34;break}throw hn(t,d,h);case 34:ln(t,d);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof ke)){e.next=41;break}throw e.t0;case 41:ln(t,"network-request-failed");case 42:case"end":return e.stop()}}),e,null,[[2,37]])}))),Rn.apply(this,arguments)}function Pn(e,t,n,r){return Dn.apply(this,arguments)}function Dn(){return Dn=V(B().mark((function e(t,n,r,a){var i,o,s=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,Tn(t,n,r,a,i);case 3:return"mfaPendingCredential"in(o=e.sent)&&ln(t,"multi-factor-auth-required",{_serverResponse:o}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),Dn.apply(this,arguments)}function Mn(e,t,n,r){var a="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Cn(e.config,a):"".concat(e.config.apiScheme,"://").concat(a)}var Fn=function(){function e(t){var n=this;G(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(fn(n.auth,"network-request-failed"))}),_n.get())}))}return q(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Ln(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var a=fn(e,t,r);return a.customData._tokenResponse=n,a}function jn(e,t){return zn.apply(this,arguments)}function zn(){return zn=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tn(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)}))),zn.apply(this,arguments)}function Un(e,t){return Bn.apply(this,arguments)}function Bn(){return Bn=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tn(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)}))),Bn.apply(this,arguments)}function Wn(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function Vn(){return Vn=V(B().mark((function e(t){var n,r,a,i,o,s,u=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=Be(t),e.next=4,r.getIdToken(n);case 4:return a=e.sent,pn((i=Hn(a))&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error"),o="object"===typeof i.firebase?i.firebase:void 0,s=null===o||void 0===o?void 0:o.sign_in_provider,e.abrupt("return",{claims:i,token:a,authTime:Wn(Gn(i.auth_time)),issuedAtTime:Wn(Gn(i.iat)),expirationTime:Wn(Gn(i.exp)),signInProvider:s||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),Vn.apply(this,arguments)}function Gn(e){return 1e3*Number(e)}function Hn(e){var t=E(e.split("."),3),n=t[0],r=t[1],a=t[2];if(void 0===n||void 0===r||void 0===a)return cn("JWT malformed, contained fewer than 3 sections"),null;try{var i=ie(r);return i?JSON.parse(i):(cn("Failed to decode base64 JWT payload"),null)}catch(o){return cn("Caught error parsing JWT payload as JSON",null===o||void 0===o?void 0:o.toString()),null}}function Kn(e,t){return qn.apply(this,arguments)}function qn(){return qn=V(B().mark((function e(t,n){var r=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof ke&&Xn(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),qn.apply(this,arguments)}function Xn(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var Yn=function(){function e(t){G(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return q(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(V(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Zn=function(){function e(t,n){G(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return q(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=Wn(this.lastLoginAt),this.creationTime=Wn(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function Qn(e){return Jn.apply(this,arguments)}function Jn(){return Jn=V(B().mark((function e(t){var n,r,a,i,o,s,u,c,l,f,h;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return a=e.sent,e.next=6,Kn(t,Un(r,{idToken:a}));case 6:pn(null===(i=e.sent)||void 0===i?void 0:i.users.length,r,"internal-error"),o=i.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?o.providerUserInfo.map((function(e){var t=e.providerId,n=nn(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],u=er(t.providerData,s),c=t.isAnonymous,l=!(t.email&&o.passwordHash)&&!(null===u||void 0===u?void 0:u.length),f=!!c&&l,h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Zn(o.createdAt,o.lastLoginAt),isAnonymous:f},Object.assign(t,h);case 17:case"end":return e.stop()}}),e)}))),Jn.apply(this,arguments)}function $n(){return($n=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Be(t),e.next=3,Qn(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function er(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat(X(n),X(t))}function tr(e,t){return nr.apply(this,arguments)}function nr(){return nr=V(B().mark((function e(t,n){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,On(t,{},V(B().mark((function e(){var r,a,i,o,s,u;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pe({grant_type:"refresh_token",refresh_token:n}).slice(1),a=t.config,i=a.tokenApiHost,o=a.apiKey,s=Mn(t,i,"/v1/token","key=".concat(o)),e.next=5,t._getAdditionalHeaders();case 5:return(u=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",An.fetch()(s,{method:"POST",headers:u,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)}))),nr.apply(this,arguments)}var rr=function(){function e(){G(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return q(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){pn(e.idToken,"internal-error"),pn("undefined"!==typeof e.idToken,"internal-error"),pn("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=Hn(e);return pn(t,"internal-error"),pn("undefined"!==typeof t.exp,"internal-error"),pn("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=V(B().mark((function e(t){var n,r=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],pn(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=V(B().mark((function e(t,n){var r,a,i,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tr(t,n);case 2:r=e.sent,a=r.accessToken,i=r.refreshToken,o=r.expiresIn,this.updateTokensAndExpiration(a,i,Number(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return vn("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,a=n.accessToken,i=n.expirationTime,o=new e;return r&&(pn("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),a&&(pn("string"===typeof a,"internal-error",{appName:t}),o.accessToken=a),i&&(pn("number"===typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}}]),e}();function ar(e,t){pn("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var ir=function(){function e(t){G(this,e);var n=t.uid,r=t.auth,a=t.stsTokenManager,i=nn(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Yn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?X(i.providerData):[],this.metadata=new Zn(i.createdAt||void 0,i.lastLoginAt||void 0)}return q(e,[{key:"getIdToken",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kn(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(pn(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return Vn.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return $n.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(pn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){pn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=V(B().mark((function e(t){var n,r,a=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,Qn(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,Kn(this,jn(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,a,i,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(a=n.email)&&void 0!==a?a:void 0,d=null!==(i=n.phoneNumber)&&void 0!==i?i:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,y=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,b=n.uid,x=n.emailVerified,k=n.isAnonymous,w=n.providerData,I=n.stsTokenManager;pn(b&&I,t,"internal-error");var C=rr.fromJSON(this.name,I);pn("string"===typeof b,t,"internal-error"),ar(f,t.name),ar(h,t.name),pn("boolean"===typeof x,t,"internal-error"),pn("boolean"===typeof k,t,"internal-error"),ar(d,t.name),ar(p,t.name),ar(v,t.name),ar(g,t.name),ar(m,t.name),ar(y,t.name);var A=new e({uid:b,auth:t,email:h,emailVerified:x,displayName:f,isAnonymous:k,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:C,createdAt:m,lastLoginAt:y});return w&&Array.isArray(w)&&(A.providerData=w.map((function(e){return Object.assign({},e)}))),g&&(A._redirectEventId=g),A}},{key:"_fromIdTokenResponse",value:function(){var t=V(B().mark((function t(n,r){var a,i,o,s=arguments;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>2&&void 0!==s[2]&&s[2],(i=new rr).updateFromServerResponse(r),o=new e({uid:r.localId,auth:n,stsTokenManager:i,isAnonymous:a}),t.next=6,Qn(o);case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),or=function(){function e(){G(this,e),this.type="NONE",this.storage={}}return q(e,[{key:"_isAvailable",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();or.type="NONE";var sr=or;function ur(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var cr=function(){function e(t,n,r){G(this,e),this.persistence=t,this.auth=n,this.userKey=r;var a=this.auth,i=a.config,o=a.name;this.fullUserKey=ur(this.userKey,i.apiKey,o),this.fullPersistenceKey=ur("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return q(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?ir._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=V(B().mark((function t(n,r){var a,i,o,s,u,c,l,f,h,d,p,v=arguments;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=v.length>2&&void 0!==v[2]?v[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(yn(sr),n,a));case 3:return t.next=5,Promise.all(r.map(function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:i=t.sent.filter((function(e){return e})),o=i[0]||yn(sr),s=ur(a,n.config.apiKey,n.name),u=null,c=U(r),t.prev=10,c.s();case 12:if((l=c.n()).done){t.next=29;break}return f=l.value,t.prev=14,t.next=17,f._get(s);case 17:if(!(h=t.sent)){t.next=23;break}return d=ir._fromJSON(n,h),f!==o&&(u=d),o=f,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),c.e(t.t1);case 34:return t.prev=34,c.f(),t.finish(34);case 37:if(p=i.filter((function(e){return e._shouldAllowMigration})),o._shouldAllowMigration&&p.length){t.next=40;break}return t.abrupt("return",new e(o,n,a));case 40:if(o=p[0],!u){t.next=44;break}return t.next=44,o._set(s,u.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(o,n,a));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function lr(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(pr(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(fr(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(gr(t))return"Blackberry";if(mr(t))return"Webos";if(hr(t))return"Safari";if((t.includes("chrome/")||dr(t))&&!t.includes("edge/"))return"Chrome";if(vr(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function fr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve();return/firefox\//i.test(e)}function hr(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve();return/crios\//i.test(e)}function pr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve();return/iemobile/i.test(e)}function vr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve();return/android/i.test(e)}function gr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve();return/blackberry/i.test(e)}function mr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve();return/webos/i.test(e)}function yr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function br(){return function(){var e=ve();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function xr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve();return yr(e)||vr(e)||mr(e)||gr(e)||/windows phone/i.test(e)||pr(e)}function kr(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=lr(ve());break;case"Worker":t="".concat(lr(ve()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Mt,"/").concat(r)}var wr=function(){function e(t){G(this,e),this.auth=t,this.queue=[]}return q(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(a){r(a)}}))};r.onAbort=t,this.queue.push(r);var a=this.queue.length-1;return function(){n.queue[a]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=V(B().mark((function e(t){var n,r,a,i,o,s,u;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:n=[],e.prev=3,r=U(this.queue),e.prev=5,r.s();case 7:if((a=r.n()).done){e.next=14;break}return i=a.value,e.next=11,i(t);case 11:i.onAbort&&n.push(i.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),n.reverse(),o=U(n);try{for(o.s();!(s=o.n()).done;){u=s.value;try{u()}catch(No){}}}catch(c){o.e(c)}finally{o.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ir=function(){function e(t,n,r){G(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ar(this),this.idTokenSubscription=new Ar(this),this.beforeStateQueue=new wr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sn,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return q(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=yn(t)),this._initializationPromise=this.queue(V(B().mark((function r(){var a,i;return B().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,cr.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(a=n._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(i=n.currentUser)||void 0===i?void 0:i.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=V(B().mark((function e(t){var n,r,a,i,o,s,u;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,a=r,i=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return o=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,s=null===a||void 0===a?void 0:a._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:u=e.sent,o&&o!==s||!(null===u||void 0===u?void 0:u.user)||(a=u.user,i=!0);case 14:if(a){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(a._redirectEventId){e.next=32;break}if(!i){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(a);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),a=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!a){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return pn(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==a._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(a));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qn(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?Be(t):null)&&pn(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=V(B().mark((function e(t){var n,r=this,a=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&pn(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue(V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue(V(B().mark((function n(){return B().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(yn(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new we("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=V(B().mark((function e(t,n){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return pn(n=t&&yn(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,cr.create(this,[yn(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue(V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=V(B().mark((function e(t){var n=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue(V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var a=this;if(this._deleted)return function(){};var i="function"===typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return pn(o,this,"internal-error"),o.then((function(){return i(a.currentUser)})),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,!t){e.next=8;break}return e.next=6,this.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,this.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return pn(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kr(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=V(B().mark((function e(){var t,n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Y({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Cr(e){return Be(e)}var Ar=function(){function e(t){var n=this;G(this,e),this.auth=t,this.observer=null,this.addObserver=function(e,t){var n=new Le(e,t);return n.subscribe.bind(n)}((function(e){return n.observer=e}))}return q(e,[{key:"next",get:function(){return pn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function Sr(e,t,n){var r=Cr(e);pn(r._canInitEmulator,r,"emulator-config-failed"),pn(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var a=!!(null===n||void 0===n?void 0:n.disableWarnings),i=_r(t),o=function(e){var t=_r(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){var i=a[1];return{host:i,port:Er(r.substr(i.length+1))}}var o=E(r.split(":"),2);return{host:o[0],port:Er(o[1])}}(t),s=o.host,u=o.port,c=null===u?"":":".concat(u);r.config.emulator={url:"".concat(i,"//").concat(s).concat(c,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function _r(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Er(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var Tr=function(){function e(t,n){G(this,e),this.providerId=t,this.signInMethod=n}return q(e,[{key:"toJSON",value:function(){return vn("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return vn("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return vn("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return vn("not implemented")}}]),e}();function Nr(e,t){return Or.apply(this,arguments)}function Or(){return Or=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tn(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)}))),Or.apply(this,arguments)}function Rr(e,t){return Pr.apply(this,arguments)}function Pr(){return Pr=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pn(t,"POST","/v1/accounts:signInWithPassword",En(t,n)));case 1:case"end":return e.stop()}}),e)}))),Pr.apply(this,arguments)}function Dr(e,t){return Mr.apply(this,arguments)}function Mr(){return Mr=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pn(t,"POST","/v1/accounts:signInWithEmailLink",En(t,n)));case 1:case"end":return e.stop()}}),e)}))),Mr.apply(this,arguments)}function Fr(e,t){return Lr.apply(this,arguments)}function Lr(){return Lr=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pn(t,"POST","/v1/accounts:signInWithEmailLink",En(t,n)));case 1:case"end":return e.stop()}}),e)}))),Lr.apply(this,arguments)}var jr=function(e){F(n,e);var t=z(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return G(this,n),(i=t.call(this,"password",a))._email=e,i._password=r,i._tenantId=o,i}return q(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Rr(t,{returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",Dr(t,{email:this._email,oobCode:this._password}));case 5:ln(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Nr(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",Fr(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:ln(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){return new n(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(Tr);function zr(e,t){return Ur.apply(this,arguments)}function Ur(){return Ur=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pn(t,"POST","/v1/accounts:signInWithIdp",En(t,n)));case 1:case"end":return e.stop()}}),e)}))),Ur.apply(this,arguments)}var Br=function(e){F(n,e);var t=z(n);function n(){var e;return G(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return q(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return zr(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,zr(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,zr(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Pe(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ln("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,a=t.signInMethod,i=nn(t,["providerId","signInMethod"]);if(!r||!a)return null;var o=new n(r,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}}]),n}(Tr);function Wr(e,t){return Vr.apply(this,arguments)}function Vr(){return Vr=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tn(t,"POST","/v1/accounts:sendVerificationCode",En(t,n)));case 1:case"end":return e.stop()}}),e)}))),Vr.apply(this,arguments)}function Gr(){return Gr=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pn(t,"POST","/v1/accounts:signInWithPhoneNumber",En(t,n)));case 1:case"end":return e.stop()}}),e)}))),Gr.apply(this,arguments)}function Hr(){return Hr=V(B().mark((function e(t,n){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pn(t,"POST","/v1/accounts:signInWithPhoneNumber",En(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw Ln(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),Hr.apply(this,arguments)}var Kr=Y({},"USER_NOT_FOUND","user-not-found");function qr(){return qr=V(B().mark((function e(t,n){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",Pn(t,"POST","/v1/accounts:signInWithPhoneNumber",En(t,r),Kr));case 2:case"end":return e.stop()}}),e)}))),qr.apply(this,arguments)}var Xr=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,"phone","phone")).params=e,r}return q(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return Gr.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return Hr.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return qr.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,a=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:a}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,a=t.verificationCode,i=t.phoneNumber,o=t.temporaryProof;return a||r||i||o?new n({verificationId:r,verificationCode:a,phoneNumber:i,temporaryProof:o}):null}}]),n}(Tr);var Yr=function(){function e(t){var n,r,a,i,o,s;G(this,e);var u=De(Me(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=u.mode)&&void 0!==a?a:null);pn(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return q(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=De(Me(e)).link,n=t?De(Me(t)).deep_link_id:null,r=De(Me(e)).deep_link_id;return(r?De(Me(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}();var Zr=function(){function e(){G(this,e),this.providerId=e.PROVIDER_ID}return q(e,null,[{key:"credential",value:function(e,t){return jr._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=Yr.parseLink(t);return pn(n,"argument-error"),jr._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();Zr.PROVIDER_ID="password",Zr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Zr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var Qr=function(){function e(t){G(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return q(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),Jr=function(e){F(n,e);var t=z(n);function n(){var e;return G(this,n),(e=t.apply(this,arguments)).scopes=[],e}return q(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return X(this.scopes)}}]),n}(Qr),$r=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.call(this,"facebook.com")}return q(n,null,[{key:"credential",value:function(e){return Br._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(r){return null}}}]),n}(Jr);$r.FACEBOOK_SIGN_IN_METHOD="facebook.com",$r.PROVIDER_ID="facebook.com";var ea=function(e){F(n,e);var t=z(n);function n(){var e;return G(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return q(n,null,[{key:"credential",value:function(e,t){return Br._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,a=t.oauthAccessToken;if(!r&&!a)return null;try{return n.credential(r,a)}catch(i){return null}}}]),n}(Jr);ea.GOOGLE_SIGN_IN_METHOD="google.com",ea.PROVIDER_ID="google.com";var ta=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.call(this,"github.com")}return q(n,null,[{key:"credential",value:function(e){return Br._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(r){return null}}}]),n}(Jr);ta.GITHUB_SIGN_IN_METHOD="github.com",ta.PROVIDER_ID="github.com";var na=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.call(this,"twitter.com")}return q(n,null,[{key:"credential",value:function(e,t){return Br._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,a=t.oauthTokenSecret;if(!r||!a)return null;try{return n.credential(r,a)}catch(i){return null}}}]),n}(Jr);function ra(e,t){return aa.apply(this,arguments)}function aa(){return aa=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pn(t,"POST","/v1/accounts:signUp",En(t,n)));case 1:case"end":return e.stop()}}),e)}))),aa.apply(this,arguments)}na.TWITTER_SIGN_IN_METHOD="twitter.com",na.PROVIDER_ID="twitter.com";var ia=function(){function e(t){G(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return q(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=V(B().mark((function t(n,r,a){var i,o,s,u,c=arguments;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>3&&void 0!==c[3]&&c[3],t.next=3,ir._fromIdTokenResponse(n,a,i);case 3:return o=t.sent,s=oa(a),u=new e({user:o,providerId:s,_tokenResponse:a,operationType:r}),t.abrupt("return",u);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=V(B().mark((function t(n,r,a){var i;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(a,!0);case 2:return i=oa(a),t.abrupt("return",new e({user:n,providerId:i,_tokenResponse:a,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function oa(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var sa=function(e){F(n,e);var t=z(n);function n(e,r,a,i){var o,s;return G(this,n),(o=t.call(this,r.code,r.message)).operationType=a,o.user=i,Object.setPrototypeOf(D(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:a},o}return q(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,a){return new n(e,t,r,a)}}]),n}(ke);function ua(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw sa._fromErrorAndOperation(e,n,t,r);throw n}))}function ca(e,t){return la.apply(this,arguments)}function la(){return la=V(B().mark((function e(t,n){var r,a,i=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],e.t0=Kn,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",ia._forOperation(t,"link",a));case 14:case"end":return e.stop()}}),e)}))),la.apply(this,arguments)}function fa(e,t){return ha.apply(this,arguments)}function ha(){return ha=V(B().mark((function e(t,n){var r,a,i,o,s,u,c=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],a=t.auth,i="reauthenticate",e.prev=3,e.next=6,Kn(t,ua(a,i,n,t),r);case 6:return pn((o=e.sent).idToken,a,"internal-error"),pn(s=Hn(o.idToken),a,"internal-error"),u=s.sub,pn(t.uid===u,a,"user-mismatch"),e.abrupt("return",ia._forOperation(t,i,o));case 15:throw e.prev=15,e.t0=e.catch(3),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("user-not-found")&&ln(a,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),ha.apply(this,arguments)}function da(e,t){return pa.apply(this,arguments)}function pa(){return pa=V(B().mark((function e(t,n){var r,a,i,o,s=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],a="signIn",e.next=4,ua(t,a,n);case 4:return i=e.sent,e.next=7,ia._fromIdTokenResponse(t,a,i);case 7:if(o=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(o.user);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)}))),pa.apply(this,arguments)}function va(e,t){return ga.apply(this,arguments)}function ga(){return ga=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",da(Cr(t),n));case 1:case"end":return e.stop()}}),e)}))),ga.apply(this,arguments)}function ma(){return ma=V(B().mark((function e(t,n,r){var a,i,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Cr(t),e.next=3,ra(a,{returnSecureToken:!0,email:n,password:r});case 3:return i=e.sent,e.next=6,ia._fromIdTokenResponse(a,"signIn",i);case 6:return o=e.sent,e.next=9,a._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)}))),ma.apply(this,arguments)}function ya(e,t){return Tn(e,"POST","/v2/accounts/mfaEnrollment:start",En(e,t))}new WeakMap;var ba="__sak",xa=function(){function e(t,n){G(this,e),this.storageRetriever=t,this.type=n}return q(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(ba,"1"),this.storage.removeItem(ba),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var ka=10,wa=function(e){F(n,e);var t=z(n);function n(){var e;return G(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=ve();return hr(e)||yr(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=xr(),e._shouldAllowMigration=!0,e}return q(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],a=this.storage.getItem(r),i=this.localCache[r];a!==i&&e(r,i,a)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var a=this.storage.getItem(r);if(e.newValue!==a)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var i=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},o=this.storage.getItem(r);br()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,ka):i()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,a=Array.from(n);r<a.length;r++){(0,a[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=V(B().mark((function e(t,r){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(R(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=V(B().mark((function e(t){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(R(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(R(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(xa);wa.type="LOCAL";var Ia=wa,Ca=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return q(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(xa);Ca.type="SESSION";var Aa=Ca;function Sa(e){return Promise.all(e.map(function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var _a=function(){function e(t){G(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return q(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=V(B().mark((function e(t){var n,r,a,i,o,s,u,c;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,a=r.eventId,i=r.eventType,o=r.data,null===(s=this.handlersMap[i])||void 0===s?void 0:s.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:a,eventType:i}),u=Array.from(s).map(function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,o));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,Sa(u);case 9:c=e.sent,n.ports[0].postMessage({status:"done",eventId:a,eventType:i,response:c});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function Ea(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}_a.receivers=[];var Ta=function(){function e(t){G(this,e),this.target=t,this.handlers=new Set}return q(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=V(B().mark((function e(t,n){var r,a,i,o,s=this,u=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:50,a="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,u){var c=Ea("",20);a.port1.start();var l=setTimeout((function(){u(new Error("unsupported_event"))}),r);o={messageChannel:a,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),i=setTimeout((function(){u(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),e(n.data.response);break;default:clearTimeout(l),clearTimeout(i),u(new Error("invalid_response"))}}},s.handlers.add(o),a.port1.addEventListener("message",o.onMessage),s.target.postMessage({eventType:t,eventId:c,data:n},[a.port2])})).finally((function(){o&&s.removeMessageHandler(o)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function Na(){return window}function Oa(){return"undefined"!==typeof Na().WorkerGlobalScope&&"function"===typeof Na().importScripts}function Ra(){return Pa.apply(this,arguments)}function Pa(){return(Pa=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function Da(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var Ma="firebaseLocalStorageDb",Fa=1,La="firebaseLocalStorage",ja="fbase_key",za=function(){function e(t){G(this,e),this.request=t}return q(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function Ua(e,t){return e.transaction([La],t?"readwrite":"readonly").objectStore(La)}function Ba(){var e=indexedDB.deleteDatabase(Ma);return new za(e).toPromise()}function Wa(){var e=indexedDB.open(Ma,Fa);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(La,{keyPath:ja})}catch(r){n(r)}})),e.addEventListener("success",V(B().mark((function n(){var r;return B().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(La)){n.next=12;break}return r.close(),n.next=5,Ba();case 5:return n.t0=t,n.next=8,Wa();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function Va(e,t,n){return Ga.apply(this,arguments)}function Ga(){return Ga=V(B().mark((function e(t,n,r){var a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ua(t,!0).put((Y(a={},ja,n),Y(a,"value",r),a)),e.abrupt("return",new za(i).toPromise());case 2:case"end":return e.stop()}}),e)}))),Ga.apply(this,arguments)}function Ha(e,t){return Ka.apply(this,arguments)}function Ka(){return(Ka=V(B().mark((function e(t,n){var r,a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ua(t,!1).get(n),e.next=3,new za(r).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qa(e,t){var n=Ua(e,!0).delete(t);return new za(n).toPromise()}var Xa=function(){function e(){G(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return q(e,[{key:"_openDb",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,Wa();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oa()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=_a._getInstance(Oa()?self:null),this.receiver._subscribe("keyChanged",function(){var e=V(B().mark((function e(n,r){var a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=V(B().mark((function e(){var t,n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ra();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new Ta(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&Da()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Wa();case 5:return t=e.sent,e.next=8,Va(t,ba,"1");case 8:return e.next=10,qa(t,ba);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=V(B().mark((function e(t,n){var r=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return Va(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return Ha(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=V(B().mark((function e(t){var n=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return qa(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o,s,u,c,l,f;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=Ua(e,!1).getAll();return new za(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,a=U(t);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.fbase_key,u=o.value,r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(u)&&(this.notifyListeners(s,u),n.push(s))}catch(h){a.e(h)}finally{a.f()}for(c=0,l=Object.keys(this.localCache);c<l.length;c++)f=l[c],this.localCache[f]&&!r.has(f)&&(this.notifyListeners(f,null),n.push(f));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,a=Array.from(n);r<a.length;r++){(0,a[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(V(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();Xa.type="LOCAL";var Ya=Xa;function Za(e,t){return Tn(e,"POST","/v2/accounts/mfaSignIn:start",En(e,t))}function Qa(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=fn("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Ja(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}Ja("rcb"),new In(3e4,6e4);var $a="recaptcha";function ei(e,t,n){return ti.apply(this,arguments)}function ti(){return ti=V(B().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(i=e.sent,e.prev=3,pn("string"===typeof i,t,"argument-error"),pn(r.type===$a,t,"argument-error"),!("session"in(o="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(s=o.session,!("phoneNumber"in o)){e.next=17;break}return pn("enroll"===s.type,t,"internal-error"),e.next=13,ya(t,{idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:i}});case 13:return u=e.sent,e.abrupt("return",u.phoneSessionInfo.sessionInfo);case 17:return pn("signin"===s.type,t,"internal-error"),pn(c=(null===(a=o.multiFactorHint)||void 0===a?void 0:a.uid)||o.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,Za(t,{mfaPendingCredential:s.credential,mfaEnrollmentId:c,phoneSignInInfo:{recaptchaToken:i}});case 22:return l=e.sent,e.abrupt("return",l.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,Wr(t,{phoneNumber:o.phoneNumber,recaptchaToken:i});case 28:return f=e.sent,h=f.sessionInfo,e.abrupt("return",h);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])}))),ti.apply(this,arguments)}var ni=function(){function e(t){G(this,e),this.providerId=e.PROVIDER_ID,this.auth=Cr(t)}return q(e,[{key:"verifyPhoneNumber",value:function(e,t){return ei(this.auth,e,Be(t))}}],[{key:"credential",value:function(e,t){return Xr._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?Xr._fromTokenResponse(n,r):null}}]),e}();function ri(e,t){return t?yn(t):(pn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}ni.PROVIDER_ID="phone",ni.PHONE_SIGN_IN_METHOD="phone";var ai=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,"custom","custom")).params=e,r}return q(n,[{key:"_getIdTokenResponse",value:function(e){return zr(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return zr(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return zr(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(Tr);function ii(e){return da(e.auth,new ai(e),e.bypassAuthState)}function oi(e){var t=e.auth,n=e.user;return pn(n,t,"internal-error"),fa(n,new ai(e),e.bypassAuthState)}function si(e){return ui.apply(this,arguments)}function ui(){return ui=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,pn(r=t.user,n,"internal-error"),e.abrupt("return",ca(r,new ai(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)}))),ui.apply(this,arguments)}var ci=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];G(this,e),this.auth=t,this.resolver=r,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return q(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=V(B().mark((function t(n,r){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=V(B().mark((function e(t){var n,r,a,i,o,s,u;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,a=t.postBody,i=t.tenantId,o=t.error,s=t.type,!o){e.next=4;break}return this.reject(o),e.abrupt("return");case 4:return u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(s)(u);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ii;case"linkViaPopup":case"linkViaRedirect":return si;case"reauthViaPopup":case"reauthViaRedirect":return oi;default:ln(this.auth,"internal-error")}}},{key:"resolve",value:function(e){gn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){gn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),li=new In(2e3,1e4);var fi=function(e){F(n,e);var t=z(n);function n(e,r,a,i,o){var s;return G(this,n),(s=t.call(this,e,r,i,o)).provider=a,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=D(s),s}return q(n,[{key:"executeNotNull",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return pn(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=V(B().mark((function e(){var t,n=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gn(1===this.filter.length,"Popup operations only handle one event"),t=Ea(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(fn(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(fn(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(fn(e.auth,"popup-closed-by-user"))}),2e3):e.pollId=window.setTimeout(t,li.get())}()}}]),n}(ci);fi.currentPopupAction=null;var hi="pendingRedirect",di=new Map,pi=function(e){F(n,e);var t=z(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return G(this,n),(a=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i)).eventId=null,a}return q(n,[{key:"execute",value:function(){var e=V(B().mark((function e(){var t,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=di.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,vi(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,P(R(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:di.set(this.auth._key(),t);case 21:return this.bypassAuthState||di.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=V(B().mark((function e(t){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",P(R(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",P(R(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(ci);function vi(e,t){return gi.apply(this,arguments)}function gi(){return gi=V(B().mark((function e(t,n){var r,a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=bi(n),a=yi(t),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(r);case 8:return e.t0=e.sent,i="true"===e.t0,e.next=12,a._remove(r);case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)}))),gi.apply(this,arguments)}function mi(e,t){di.set(e._key(),t)}function yi(e){return yn(e._redirectPersistence)}function bi(e){return ur(hi,e.config.apiKey,e.name)}function xi(e,t){return ki.apply(this,arguments)}function ki(){return ki=V(B().mark((function e(t,n){var r,a,i,o,s,u=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]&&u[2],a=Cr(t),i=ri(a,n),o=new pi(a,i,r),e.next=6,o.execute();case 6:if(!(s=e.sent)||r){e.next=13;break}return delete s.user._redirectEventId,e.next=11,a._persistUserIfCurrent(s.user);case 11:return e.next=13,a._setRedirectUser(null,n);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)}))),ki.apply(this,arguments)}var wi=function(){function e(t){G(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return q(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ci(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!Ci(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(fn(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ii(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(Ii(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function Ii(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function Ci(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function Ai(e){return Si.apply(this,arguments)}function Si(){return Si=V(B().mark((function e(t){var n,r=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",Tn(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),Si.apply(this,arguments)}var _i=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ei=/^https?/;function Ti(){return Ti=V(B().mark((function e(t){var n,r,a,i,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ai(t);case 4:n=e.sent,r=n.authorizedDomains,a=U(r),e.prev=7,a.s();case 9:if((i=a.n()).done){e.next=20;break}if(o=i.value,e.prev=11,!Ni(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),a.e(e.t1);case 25:return e.prev=25,a.f(),e.finish(25);case 28:ln(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])}))),Ti.apply(this,arguments)}function Ni(e){var t=bn(),n=new URL(t),r=n.protocol,a=n.hostname;if(e.startsWith("chrome-extension://")){var i=new URL(e);return""===i.hostname&&""===a?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===a}if(!Ei.test(r))return!1;if(_i.test(e))return a===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}var Oi=new In(3e4,6e4);function Ri(){var e=Na().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=X(e.H[r].L),e.CP)for(var a=0;a<e.CP.length;a++)e.CP[a]=null}}var Pi=null;function Di(e){return Pi=Pi||function(e){return new Promise((function(t,n){var r,a,i;function o(){Ri(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){Ri(),n(fn(e,"network-request-failed"))},timeout:Oi.get()})}if(null===(a=null===(r=Na().gapi)||void 0===r?void 0:r.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=Na().gapi)||void 0===i?void 0:i.load)){var s=Ja("iframefcb");return Na()[s]=function(){gapi.load?o():n(fn(e,"network-request-failed"))},Qa("https://apis.google.com/js/api.js?onload=".concat(s)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw Pi=null,e}))}(e),Pi}var Mi=new In(5e3,15e3),Fi="__/auth/iframe",Li="emulator/auth/iframe",ji={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ui(e){var t=e.config;pn(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Cn(t,Li):"https://".concat(e.config.authDomain,"/").concat(Fi),r={apiKey:t.apiKey,appName:e.name,v:Mt},a=zi.get(e.config.apiHost);a&&(r.eid=a);var i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(Pe(r).slice(1))}function Bi(e){return Wi.apply(this,arguments)}function Wi(){return Wi=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Di(t);case 2:return n=e.sent,pn(r=Na().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:Ui(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ji,dontclear:!0},(function(e){return new Promise(function(){var n=V(B().mark((function n(r,a){var i,o,s;return B().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){Na().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:i=fn(t,"network-request-failed"),o=Na().setTimeout((function(){a(i)}),Mi.get()),e.ping(s).then(s,(function(){a(i)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),Wi.apply(this,arguments)}var Vi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Gi=500,Hi=600,Ki="_blank",qi="http://localhost",Xi=function(){function e(t){G(this,e),this.window=t,this.associatedEvent=null}return q(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function Yi(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gi,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Hi,i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},Vi),{width:r.toString(),height:a.toString(),top:i,left:o}),c=ve().toLowerCase();n&&(s=dr(c)?Ki:n),fr(c)&&(t=t||qi,u.scrollbars="yes");var l=Object.entries(u).reduce((function(e,t){var n=E(t,2),r=n[0],a=n[1];return"".concat(e).concat(r,"=").concat(a,",")}),"");if(function(){var e;return yr(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new Xi(null);var f=window.open(t||"",s,l);pn(f,e,"popup-blocked");try{f.focus()}catch(h){}return new Xi(f)}var Zi="__/auth/handler",Qi="emulator/auth/handler";function Ji(e,t,n,r,a,i){pn(e.config.authDomain,e,"auth-domain-config-required"),pn(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Mt,eventId:a};if(t instanceof Qr){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",Te(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(i||{});s<u.length;s++){var c=E(u[s],2),l=c[0],f=c[1];o[l]=f}}if(t instanceof Jr){var h=t.getScopes().filter((function(e){return""!==e}));h.length>0&&(o.scopes=h.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,p=0,v=Object.keys(d);p<v.length;p++){var g=v[p];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Zi);return Cn(t,Qi)}(e),"?").concat(Pe(d).slice(1))}var $i="webStorageSupport",eo=function(){function e(){G(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Aa,this._completeRedirectFn=xi,this._overrideRedirectResult=mi}return q(e,[{key:"_openPopup",value:function(){var e=V(B().mark((function e(t,n,r,a){var i,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gn(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),o=Ji(t,n,r,bn(),a),e.abrupt("return",Yi(t,o,Ea()));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=V(B().mark((function e(t,n,r,a){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return i=Ji(t,n,r,bn(),a),Na().location.href=i,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var i}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],a=r.manager,i=r.promise;return a?Promise.resolve(a):(gn(i,"If manager is not set, promise should be"),i)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bi(t);case 2:return n=e.sent,r=new wi(t),n.register("authEvent",(function(e){return pn(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send($i,{type:$i},(function(n){var r,a=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[$i];void 0!==a&&t(!!a),ln(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Ti.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return xr()||hr()||yr()}}]),e}(),to=eo,no=function(){function e(t){G(this,e),this.factorId=t}return q(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return vn("unexpected MultiFactorSessionType")}}}]),e}(),ro=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,"phone")).credential=e,r}return q(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return Tn(e,"POST","/v2/accounts/mfaEnrollment:finalize",En(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return Tn(e,"POST","/v2/accounts/mfaSignIn:finalize",En(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(no);(function(){function e(){G(this,e)}return q(e,null,[{key:"assertion",value:function(e){return ro._fromCredential(e)}}]),e}()).FACTOR_ID="phone";var ao="@firebase/auth",io="0.21.3",oo=function(){function e(t){G(this,e),this.auth=t,this.internalListeners=new Map}return q(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){pn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();var so,uo=de("authIdTokenMaxAge")||300,co=null,lo=function(e){return function(){var t=V(B().mark((function t(n){var r,a,i;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n,!t.t0){t.next=5;break}return t.next=4,n.getIdTokenResult();case 4:t.t0=t.sent;case 5:if(r=t.t0,!((a=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3)&&a>uo)){t.next=9;break}return t.abrupt("return");case 9:if(i=null===r||void 0===r?void 0:r.token,co!==i){t.next=12;break}return t.abrupt("return");case 12:return co=i,t.next=15,fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:"Bearer ".concat(i)}:{}});case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};function fo(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ho(e){return!!e&&!!e[ns]}function po(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===rs}(e)||Array.isArray(e)||!!e[ts]||!!(null===(t=e.constructor)||void 0===t?void 0:t[ts])||ko(e)||wo(e))}function vo(e,t,n){void 0===n&&(n=!1),0===go(e)?(n?Object.keys:as)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function go(e){var t=e[ns];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:ko(e)?2:wo(e)?3:0}function mo(e,t){return 2===go(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function yo(e,t){return 2===go(e)?e.get(t):e[t]}function bo(e,t,n){var r=go(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function xo(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function ko(e){return Qo&&e instanceof Map}function wo(e){return Jo&&e instanceof Set}function Io(e){return e.o||e.t}function Co(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=is(e);delete t[ns];for(var n=as(t),r=0;r<n.length;r++){var a=n[r],i=t[a];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]})}return Object.create(Object.getPrototypeOf(e),t)}function Ao(e,t){return void 0===t&&(t=!1),_o(e)||ho(e)||!po(e)||(go(e)>1&&(e.set=e.add=e.clear=e.delete=So),Object.freeze(e),t&&vo(e,(function(e,t){return Ao(t,!0)}),!0)),e}function So(){fo(2)}function _o(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Eo(e){var t=os[e];return t||fo(18,e),t}function To(e,t){os[e]||(os[e]=t)}function No(){return Yo}function Oo(e,t){t&&(Eo("Patches"),e.u=[],e.s=[],e.v=t)}function Ro(e){Po(e),e.p.forEach(Mo),e.p=null}function Po(e){e===Yo&&(Yo=e.l)}function Do(e){return Yo={p:[],l:Yo,h:e,m:!0,_:0}}function Mo(e){var t=e[ns];0===t.i||1===t.i?t.j():t.O=!0}function Fo(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||Eo("ES5").S(t,e,r),r?(n[ns].P&&(Ro(t),fo(4)),po(e)&&(e=Lo(t,e),t.l||zo(t,e)),t.u&&Eo("Patches").M(n[ns].t,e,t.u,t.s)):e=Lo(t,n,[]),Ro(t),t.u&&t.v(t.u,t.s),e!==es?e:void 0}function Lo(e,t,n){if(_o(t))return t;var r=t[ns];if(!r)return vo(t,(function(a,i){return jo(e,r,t,a,i,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return zo(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var a=4===r.i||5===r.i?r.o=Co(r.k):r.o,i=a,o=!1;3===r.i&&(i=new Set(a),a.clear(),o=!0),vo(i,(function(t,i){return jo(e,r,a,t,i,n,o)})),zo(e,a,!1),n&&e.u&&Eo("Patches").N(r,n,e.u,e.s)}return r.o}function jo(e,t,n,r,a,i,o){if(ho(a)){var s=Lo(e,a,i&&t&&3!==t.i&&!mo(t.R,r)?i.concat(r):void 0);if(bo(n,r,s),!ho(s))return;e.m=!1}else o&&n.add(a);if(po(a)&&!_o(a)){if(!e.h.D&&e._<1)return;Lo(e,a),t&&t.A.l||zo(e,a)}}function zo(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&Ao(t,n)}function Uo(e,t){var n=e[ns];return(n?Io(n):e)[t]}function Bo(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Wo(e){e.P||(e.P=!0,e.l&&Wo(e.l))}function Vo(e){e.o||(e.o=Co(e.t))}function Go(e,t,n){var r=ko(t)?Eo("MapSet").F(t,n):wo(t)?Eo("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:No(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},a=r,i=ss;n&&(a=[r],i=us);var o=Proxy.revocable(a,i),s=o.revoke,u=o.proxy;return r.k=u,r.j=s,u}(t,n):Eo("ES5").J(t,n);return(n?n.A:No()).p.push(r),r}function Ho(e){return ho(e)||fo(22,e),function e(t){if(!po(t))return t;var n,r=t[ns],a=go(t);if(r){if(!r.P&&(r.i<4||!Eo("ES5").K(r)))return r.t;r.I=!0,n=Ko(t,a),r.I=!1}else n=Ko(t,a);return vo(n,(function(t,a){r&&yo(r.t,t)===a||bo(n,t,e(a))})),3===a?new Set(n):n}(e)}function Ko(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Co(e)}function qo(){function e(e,t){var n=a[e];return n?n.enumerable=t:a[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[ns];return ss.get(t,e)},set:function(t){var n=this[ns];ss.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var a=e[t][ns];if(!a.P)switch(a.i){case 5:r(a)&&Wo(a);break;case 4:n(a)&&Wo(a)}}}function n(e){for(var t=e.t,n=e.k,r=as(n),a=r.length-1;a>=0;a--){var i=r[a];if(i!==ns){var o=t[i];if(void 0===o&&!mo(t,i))return!0;var s=n[i],u=s&&s[ns];if(u?u.t!==o:!xo(s,o))return!0}}var c=!!t[ns];return r.length!==as(t).length+(c?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var a={};To("ES5",{J:function(t,n){var r=Array.isArray(t),a=function(t,n){if(t){for(var r=Array(n.length),a=0;a<n.length;a++)Object.defineProperty(r,""+a,e(a,!0));return r}var i=is(n);delete i[ns];for(var o=as(i),s=0;s<o.length;s++){var u=o[s];i[u]=e(u,t||!!i[u].enumerable)}return Object.create(Object.getPrototypeOf(n),i)}(r,t),i={i:r?5:4,A:n?n.A:No(),P:!1,I:!1,R:{},l:n,t:t,k:a,o:null,O:!1,C:!1};return Object.defineProperty(a,ns,{value:i,writable:!0}),a},S:function(e,n,a){a?ho(n)&&n[ns].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[ns];if(n){var a=n.t,i=n.k,o=n.R,s=n.i;if(4===s)vo(i,(function(t){t!==ns&&(void 0!==a[t]||mo(a,t)?o[t]||e(i[t]):(o[t]=!0,Wo(n)))})),vo(a,(function(e){void 0!==i[e]||mo(i,e)||(o[e]=!1,Wo(n))}));else if(5===s){if(r(n)&&(Wo(n),o.length=!0),i.length<a.length)for(var u=i.length;u<a.length;u++)o[u]=!1;else for(var c=a.length;c<i.length;c++)o[c]=!0;for(var l=Math.min(i.length,a.length),f=0;f<l;f++)i.hasOwnProperty(f)||(o[f]=!0),void 0===o[f]&&e(i[f])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}so="Browser",Nt(new We("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=r.options,o=i.apiKey,s=i.authDomain;return function(e,t){pn(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),pn(!(null===s||void 0===s?void 0:s.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:s,clientPlatform:so,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kr(so)},a=new Ir(e,t,r);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(yn);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(a,n),a}(r,a)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),Nt(new We("auth-internal",(function(e){return function(e){return new oo(e)}(Cr(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),jt(ao,io,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(so)),jt(ao,io,"esm2017");var Xo,Yo,Zo="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Qo="undefined"!=typeof Map,Jo="undefined"!=typeof Set,$o="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,es=Zo?Symbol.for("immer-nothing"):((Xo={})["immer-nothing"]=!0,Xo),ts=Zo?Symbol.for("immer-draftable"):"__$immer_draftable",ns=Zo?Symbol.for("immer-state"):"__$immer_state",rs=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),as="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,is=Object.getOwnPropertyDescriptors||function(e){var t={};return as(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},os={},ss={get:function(e,t){if(t===ns)return e;var n=Io(e);if(!mo(n,t))return function(e,t,n){var r,a=Bo(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!po(r)?r:r===Uo(e.t,t)?(Vo(e),e.o[t]=Go(e.A.h,r,e)):r},has:function(e,t){return t in Io(e)},ownKeys:function(e){return Reflect.ownKeys(Io(e))},set:function(e,t,n){var r=Bo(Io(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var a=Uo(Io(e),t),i=null==a?void 0:a[ns];if(i&&i.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(xo(n,a)&&(void 0!==n||mo(e.t,t)))return!0;Vo(e),Wo(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==Uo(e.t,t)||t in e.t?(e.R[t]=!1,Vo(e),Wo(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Io(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){fo(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){fo(12)}},us={};vo(ss,(function(e,t){us[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),us.deleteProperty=function(e,t){return us.set.call(this,e,t,void 0)},us.set=function(e,t,n){return ss.set.call(this,e[0],t,n,e[0])};var cs=function(){function e(e){var t=this;this.g=$o,this.D=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var a=n;n=e;var i=t;return function(e){var t=this;void 0===e&&(e=a);for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return i.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(o))}))}}var o;if("function"!=typeof n&&fo(6),void 0!==r&&"function"!=typeof r&&fo(7),po(e)){var s=Do(t),u=Go(t,e,void 0),c=!0;try{o=n(u),c=!1}finally{c?Ro(s):Po(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return Oo(s,r),Fo(e,s)}),(function(e){throw Ro(s),e})):(Oo(s,r),Fo(o,s))}if(!e||"object"!=typeof e){if(void 0===(o=n(e))&&(o=e),o===es&&(o=void 0),t.D&&Ao(o,!0),r){var l=[],f=[];Eo("Patches").M(e,o,l,f),r(l,f)}return o}fo(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,a=Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(a))}))};var r,a,i=t.produce(e,n,(function(e,t){r=e,a=t}));return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return[e,r,a]})):[i,r,a]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){po(e)||fo(8),ho(e)&&(e=Ho(e));var t=Do(this),n=Go(this,e,void 0);return n[ns].C=!0,Po(t),n},t.finishDraft=function(e,t){var n=(e&&e[ns]).A;return Oo(n,t),Fo(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!$o&&fo(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var a=Eo("Patches").$;return ho(e)?a(e,t):this.produce(e,(function(e){return a(e,t)}))},e}(),ls=new cs,fs=ls.produce,hs=(ls.produceWithPatches.bind(ls),ls.setAutoFreeze.bind(ls),ls.setUseProxies.bind(ls),ls.applyPatches.bind(ls),ls.createDraft.bind(ls),ls.finishDraft.bind(ls),fs);function ds(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var ps="function"===typeof Symbol&&Symbol.observable||"@@observable",vs=function(){return Math.random().toString(36).substring(7).split("").join(".")},gs={INIT:"@@redux/INIT"+vs(),REPLACE:"@@redux/REPLACE"+vs(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+vs()}};function ms(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function ys(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(ds(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(ds(1));return n(ys)(e,t)}if("function"!==typeof e)throw new Error(ds(2));var a=e,i=t,o=[],s=o,u=!1;function c(){s===o&&(s=o.slice())}function l(){if(u)throw new Error(ds(3));return i}function f(e){if("function"!==typeof e)throw new Error(ds(4));if(u)throw new Error(ds(5));var t=!0;return c(),s.push(e),function(){if(t){if(u)throw new Error(ds(6));t=!1,c();var n=s.indexOf(e);s.splice(n,1),o=null}}}function h(e){if(!ms(e))throw new Error(ds(7));if("undefined"===typeof e.type)throw new Error(ds(8));if(u)throw new Error(ds(9));try{u=!0,i=a(i,e)}finally{u=!1}for(var t=o=s,n=0;n<t.length;n++){(0,t[n])()}return e}return h({type:gs.INIT}),(r={dispatch:h,subscribe:f,getState:l,replaceReducer:function(e){if("function"!==typeof e)throw new Error(ds(10));a=e,h({type:gs.REPLACE})}})[ps]=function(){var e,t=f;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(ds(11));function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[ps]=function(){return this},e},r}function bs(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var a=t[r];0,"function"===typeof e[a]&&(n[a]=e[a])}var i,o=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:gs.INIT}))throw new Error(ds(12));if("undefined"===typeof n(void 0,{type:gs.PROBE_UNKNOWN_ACTION()}))throw new Error(ds(13))}))}(n)}catch(s){i=s}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,a={},s=0;s<o.length;s++){var u=o[s],c=n[u],l=e[u],f=c(l,t);if("undefined"===typeof f){t&&t.type;throw new Error(ds(14))}a[u]=f,r=r||f!==l}return(r=r||o.length!==Object.keys(e).length)?a:e}}function xs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function ks(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(ds(15))},a={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map((function(e){return e(a)}));return r=xs.apply(void 0,i)(n.dispatch),tt(tt({},n),{},{dispatch:r})}}}function ws(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(a){return"function"===typeof a?a(n,r,e):t(a)}}}}var Is=ws();Is.withExtraArgument=ws;var Cs=Is,As=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ss=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(s){i=[6,s],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},_s=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},Es=Object.defineProperty,Ts=Object.defineProperties,Ns=Object.getOwnPropertyDescriptors,Os=Object.getOwnPropertySymbols,Rs=Object.prototype.hasOwnProperty,Ps=Object.prototype.propertyIsEnumerable,Ds=function(e,t,n){return t in e?Es(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Ms=function(e,t){for(var n in t||(t={}))Rs.call(t,n)&&Ds(e,n,t[n]);if(Os)for(var r=0,a=Os(t);r<a.length;r++){n=a[r];Ps.call(t,n)&&Ds(e,n,t[n])}return e},Fs=function(e,t){return Ts(e,Ns(t))},Ls=function(e,t,n){return new Promise((function(r,a){var i=function(e){try{s(n.next(e))}catch(t){a(t)}},o=function(e){try{s(n.throw(e))}catch(t){a(t)}},s=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(i,o)};s((n=n.apply(e,t)).next())}))},js="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?xs:xs.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function zs(e){if("object"!==typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}var Us=function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a=e.apply(this,n)||this;return Object.setPrototypeOf(a,t.prototype),a}return As(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,_s([void 0],e[0].concat(this)))):new(t.bind.apply(t,_s([void 0],e.concat(this))))},t}(Array);function Bs(e){return po(e)?hs(e,(function(){})):e}function Ws(){return function(e){return function(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t,r=(e.immutableCheck,e.serializableCheck,new Us);n&&(!function(e){return"boolean"===typeof e}(n)?r.push(Cs.withExtraArgument(n.extraArgument)):r.push(Cs));0;return r}(e)}}var Vs=!0;function Gs(e,t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(t){var a=t.apply(void 0,n);if(!a)throw new Error("prepareAction did not return an object");return Ms(Ms({type:e,payload:a.payload},"meta"in a&&{meta:a.meta}),"error"in a&&{error:a.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function Hs(e){var t,n={},r=[],a={addCase:function(e,t){var r="string"===typeof e?e:e.type;if(r in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[r]=t,a},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),a},addDefaultCase:function(e){return t=e,a}};return e(a),[n,r,t]}function Ks(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");var n,r="function"==typeof e.initialState?e.initialState:Bs(e.initialState),a=e.reducers||{},i=Object.keys(a),o={},s={},u={};function c(){var t="function"===typeof e.extraReducers?Hs(e.extraReducers):[e.extraReducers],n=t[0],a=void 0===n?{}:n,i=t[1],o=void 0===i?[]:i,u=t[2],c=void 0===u?void 0:u,l=Ms(Ms({},a),s);return function(e,t,n,r){void 0===n&&(n=[]);var a,i="function"===typeof t?Hs(t):[t,n,r],o=i[0],s=i[1],u=i[2];if(function(e){return"function"===typeof e}(e))a=function(){return Bs(e())};else{var c=Bs(e);a=function(){return c}}function l(e,t){void 0===e&&(e=a());var n=_s([o[t.type]],s.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===n.filter((function(e){return!!e})).length&&(n=[u]),n.reduce((function(e,n){if(n){var r;if(ho(e))return void 0===(r=n(e,t))?e:r;if(po(e))return hs(e,(function(e){return n(e,t)}));if(void 0===(r=n(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}return e}),e)}return l.getInitialState=a,l}(r,(function(e){for(var t in l)e.addCase(t,l[t]);for(var n=0,r=o;n<r.length;n++){var a=r[n];e.addMatcher(a.matcher,a.reducer)}c&&e.addDefaultCase(c)}))}return i.forEach((function(e){var n,r,i=a[e],c=function(e,t){return e+"/"+t}(t,e);"reducer"in i?(n=i.reducer,r=i.prepare):n=i,o[e]=n,s[c]=n,u[e]=r?Gs(c,r):Gs(c)})),{name:t,reducer:function(e,t){return n||(n=c()),n(e,t)},actions:u,caseReducers:o,getInitialState:function(){return n||(n=c()),n.getInitialState()}}}var qs=function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},Xs=["name","message","stack","code"],Ys=function(e,t){this.payload=e,this.meta=t},Zs=function(e,t){this.payload=e,this.meta=t},Qs=function(e){if("object"===typeof e&&null!==e){for(var t={},n=0,r=Xs;n<r.length;n++){var a=r[n];"string"===typeof e[a]&&(t[a]=e[a])}return t}return{message:String(e)}};!function(){function e(e,t,n){var r=Gs(e+"/fulfilled",(function(e,t,n,r){return{payload:e,meta:Fs(Ms({},r||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})}})),a=Gs(e+"/pending",(function(e,t,n){return{payload:void 0,meta:Fs(Ms({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})}})),i=Gs(e+"/rejected",(function(e,t,r,a,i){return{payload:a,error:(n&&n.serializeError||Qs)(e||"Rejected"),meta:Fs(Ms({},i||{}),{arg:r,requestId:t,rejectedWithValue:!!a,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}})),o="undefined"!==typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){0},e}();return Object.assign((function(e){return function(s,u,c){var l,f=(null==n?void 0:n.idGenerator)?n.idGenerator(e):qs(),h=new o;function d(e){l=e,h.abort()}var p=function(){return Ls(this,null,(function(){var o,p,v,g,m,y;return Ss(this,(function(b){switch(b.label){case 0:return b.trys.push([0,4,,5]),function(e){return null!==e&&"object"===typeof e&&"function"===typeof e.then}(g=null==(o=null==n?void 0:n.condition)?void 0:o.call(n,e,{getState:u,extra:c}))?[4,g]:[3,2];case 1:g=b.sent(),b.label=2;case 2:if(!1===g||h.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return!0,m=new Promise((function(e,t){return h.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:l||"Aborted"})}))})),s(a(f,e,null==(p=null==n?void 0:n.getPendingMeta)?void 0:p.call(n,{requestId:f,arg:e},{getState:u,extra:c}))),[4,Promise.race([m,Promise.resolve(t(e,{dispatch:s,getState:u,extra:c,requestId:f,signal:h.signal,abort:d,rejectWithValue:function(e,t){return new Ys(e,t)},fulfillWithValue:function(e,t){return new Zs(e,t)}})).then((function(t){if(t instanceof Ys)throw t;return t instanceof Zs?r(t.payload,f,e,t.meta):r(t,f,e)}))])];case 3:return v=b.sent(),[3,5];case 4:return y=b.sent(),v=y instanceof Ys?i(null,f,e,y.payload,y.meta):i(y,f,e),[3,5];case 5:return n&&!n.dispatchConditionRejection&&i.match(v)&&v.meta.condition||s(v),[2,v]}}))}))}();return Object.assign(p,{abort:d,requestId:f,arg:e,unwrap:function(){return p.then(Js)}})}}),{pending:a,rejected:i,fulfilled:r,typePrefix:e})}e.withTypes=function(){return e}}();function Js(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}Object.assign;var $s="listenerMiddleware";Gs($s+"/add"),Gs($s+"/removeAll"),Gs($s+"/remove");"function"===typeof queueMicrotask&&queueMicrotask.bind("undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:globalThis);var eu,tu=function(e){return function(t){setTimeout(t,e)}};"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:tu(10);qo();jt("firebase","9.17.1","app");var nu="@firebase/database",ru="0.14.3",au="";var iu=function(){function e(t){G(this,e),this.domStorage_=t,this.prefix_="firebase:"}return q(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ae(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Ce(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),ou=function(){function e(){G(this,e),this.cache_={},this.isInMemoryStorage=!0}return q(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return _e(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),su=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new iu(t)}}catch(n){}return new ou},uu=su("localStorage"),cu=su("sessionStorage"),lu=new $e("@firebase/database"),fu=function(){var e=1;return function(){return e++}}(),hu=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var a=e.charCodeAt(r);if(a>=55296&&a<=56319){var i=a-55296;r++,$(r<e.length,"Surrogate pair missing trail surrogate."),a=65536+(i<<10)+(e.charCodeAt(r)-56320)}a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):a<65536?(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t}(e),n=new Fe;n.update(t);var r=n.digest();return ne.encodeByteArray(r)},du=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"===typeof r&&"number"===typeof r.length?t+=e.apply(null,r):t+="object"===typeof r?Ae(r):r,t+=" "}return t},pu=null,vu=!0,gu=function(e,t){$(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(lu.logLevel=Ke.VERBOSE,pu=lu.log.bind(lu),t&&cu.set("logging_enabled",!0)):"function"===typeof e?pu=e:(pu=null,cu.remove("logging_enabled"))},mu=function(){if(!0===vu&&(vu=!1,null===pu&&!0===cu.get("logging_enabled")&&gu(!0)),pu){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=du.apply(null,t);pu(r)}},yu=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];mu.apply(void 0,[e].concat(n))}},bu=function(){var e="FIREBASE INTERNAL ERROR: "+du.apply(void 0,arguments);lu.error(e)},xu=function(){var e="FIREBASE FATAL ERROR: ".concat(du.apply(void 0,arguments));throw lu.error(e),new Error(e)},ku=function(){var e="FIREBASE WARNING: "+du.apply(void 0,arguments);lu.warn(e)},wu=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Iu="[MIN_NAME]",Cu="[MAX_NAME]",Au=function(e,t){if(e===t)return 0;if(e===Iu||t===Cu)return-1;if(t===Iu||e===Cu)return 1;var n=Pu(e),r=Pu(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},Su=function(e,t){return e===t?0:e<t?-1:1},_u=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Ae(t))},Eu=function e(t){if("object"!==typeof t||null===t)return Ae(t);var n=[];for(var r in t)n.push(r);n.sort();for(var a="{",i=0;i<n.length;i++)0!==i&&(a+=","),a+=Ae(n[i]),a+=":",a+=e(t[n[i]]);return a+="}"},Tu=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],a=0;a<n;a+=t)a+t>n?r.push(e.substring(a,n)):r.push(e.substring(a,a+t));return r};function Nu(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var Ou=function(e){$(!wu(e),"Invalid JSON number");var t,n,r,a,i,o=1023;0===e?(n=0,r=0,t=1/e===-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(a=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-a)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(i=52;i;i-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(i=11;i;i-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(i=0;i<64;i+=8){var l=parseInt(u.substr(i,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()};var Ru=new RegExp("^-?(0*)\\d{1,10}$"),Pu=function(e){if(Ru.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Du=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw ku("Exception was thrown by user callback.",e),t}),Math.floor(0))}},Mu=function(){return("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Fu=function(e,t){var n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n},Lu=function(){function e(t,n){var r=this;G(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null===n||void 0===n?void 0:n.getImmediate({optional:!0}),this.appCheck||null===n||void 0===n||n.get().then((function(e){return r.appCheck=e}))}return q(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){ku('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),e}(),ju=function(){function e(t,n,r){var a=this;G(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit((function(e){return a.auth_=e}))}return q(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(mu("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ku(e)}}]),e}(),zu=function(){function e(t){G(this,e),this.accessToken=t}return q(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();zu.OWNER="owner";var Uu="5",Bu=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Wu="ac",Vu="websocket",Gu="long_polling",Hu=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];G(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=a,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.isUsingEmulator=u,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=uu.get("host:"+t)||this._host}return q(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&uu.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),e}();function Ku(e,t,n){var r;if($("string"===typeof t,"typeof type must == string"),$("object"===typeof n,"typeof params must == object"),t===Vu)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Gu)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var a=[];return Nu(n,(function(e,t){a.push(e+"="+t)})),r+a.join("&")}var qu=function(){function e(){G(this,e),this.counters_={}}return q(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;_e(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return oe(this.counters_)}}]),e}(),Xu={},Yu={};function Zu(e){var t=e.toString();return Xu[t]||(Xu[t]=new qu),Xu[t]}var Qu=function(){function e(t){G(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return q(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&Du((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),Ju="start",$u="close",ec="pLPCommand",tc="pRTLPCB",nc=function(){function e(t,n,r,a,i,o,s){var u=this;G(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=a,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=yu(t),this.stats_=Zu(n),this.urlFn=function(e){return u.appCheckToken&&(e[Wu]=u.appCheckToken),Ku(n,Gu,e)}}return q(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Qu(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(ye()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new rc((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=t[0],i=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,a===Ju)n.id=i,n.password=o;else{if(a!==$u)throw new Error("Unrecognized command received: "+a);i?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(i,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=t[0],i=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(a,i)}),(function(){n.onClosed_()}),n.urlFn);var e={};e[Ju]="t",e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v=Uu,n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e[Wu]=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&Bu.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=Ae(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=re(t),r=Tu(n,1840),a=0;a<r.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[a]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!ye()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=Ae(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!ye()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}}]),e}(),rc=function(){function e(t,n,r,a){if(G(this,e),this.onDisconnect=r,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,ye())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=fu(),window[ec+this.uniqueCallbackIdentifier]=t,window[tc+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var i="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))i='<script>document.domain="'+document.domain+'";<\/script>';var o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){mu("frame writing exception"),s.stack&&mu(s.stack),mu(s)}}}return q(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var a=this.pendingSegs.shift();n=n+"&seg"+r+"="+a.seg+"&ts"+r+"="+a.ts+"&d"+r+"="+a.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},a=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(a),r()}))}},{key:"addTag",value:function(e,t){var n=this;ye()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){mu("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(a){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||mu("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),ac=null;"undefined"!==typeof MozWebSocket?ac=MozWebSocket:"undefined"!==typeof WebSocket&&(ac=WebSocket);var ic=function(){function e(t,n,r,a,i,o,s){G(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=a,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=yu(this.connId),this.stats_=Zu(n),this.connURL=e.connectionURL_(n,o,s,a,r),this.nodeAdmin=n.nodeAdmin}return q(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,uu.set("previous_websocket_failure",!0);try{var r;if(ye()){var a=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":"Firebase/".concat(Uu,"/").concat(au,"/").concat(process.platform,"/").concat(a),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);var i={NODE_ENV:"production",PUBLIC_URL:"/redflix-public",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},o=0===this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;o&&(r.proxy={origin:o})}this.mySock=new ac(this.connURL,[],r)}catch(u){this.log_("Error instantiating WebSocket.");var s=u.message||u.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){uu.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Ce(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if($(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=Ae(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=Tu(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,a){var i={};return i.v=Uu,!ye()&&"undefined"!==typeof location&&location.hostname&&Bu.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i[Wu]=r),a&&(i.p=a),Ku(e,Vu,i)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==ac&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return uu.isInMemoryStorage||!0===uu.get("previous_websocket_failure")}}]),e}();ic.responsesRequiredToBeHealthy=2,ic.healthyTimeout=3e4;var oc=function(){function e(t){G(this,e),this.initTransports_(t)}return q(e,[{key:"initTransports_",value:function(t){var n=ic&&ic.isAvailable(),r=n&&!ic.previouslyFailed();if(t.webSocketOnly&&(n||ku("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ic];else{var a,i=this.transports_=[],o=U(e.ALL_TRANSPORTS);try{for(o.s();!(a=o.n()).done;){var s=a.value;s&&s.isAvailable()&&i.push(s)}}catch(u){o.e(u)}finally{o.f()}e.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[nc,ic]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),e}();oc.globalTransportInitialized_=!1;var sc=function(){function e(t,n,r,a,i,o,s,u,c,l){G(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=a,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=yu("c:"+this.id+":"),this.transportManager_=new oc(n),this.log_("Connection created"),this.start_()}return q(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var a=t.healthyTimeout||0;a>0&&(this.healthyTimeout_=Fu((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(a)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=_u("t",e),n=_u("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=_u("t",e),n=_u("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=_u("t",e);if("d"in e){var n=e.d;if("h"===t){var r=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var a=0;a<this.pendingDataMessages.length;++a)this.onDataMessage_(this.pendingDataMessages[a]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?bu("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):bu("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Uu!==n&&ku("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Fu((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Fu((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(uu.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),uc=function(){function e(){G(this,e)}return q(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),cc=function(){function e(t){G(this,e),this.allowedEvents_=t,this.listeners_={},$(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return q(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=X(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var i=0;i<t.length;i++)t[i].callback.apply(t[i].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],a=0;a<r.length;a++)if(r[a].callback===t&&(!n||n===r[a].context))return void r.splice(a,1)}},{key:"validateEventType_",value:function(e){$(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),e}(),lc=function(e){F(n,e);var t=z(n);function n(){var e;return G(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||ge()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return q(n,[{key:"getInitialEvent",value:function(e){return $("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(cc),fc=32,hc=768,dc=function(){function e(t,n){if(G(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[r]=this.pieces_[a],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return q(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function pc(){return new dc("")}function vc(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function gc(e){return e.pieces_.length-e.pieceNum_}function mc(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new dc(e.pieces_,t)}function yc(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function bc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function xc(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new dc(t,0)}function kc(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof dc)for(var a=t.pieceNum_;a<t.pieces_.length;a++)n.push(t.pieces_[a]);else for(var i=t.split("/"),o=0;o<i.length;o++)i[o].length>0&&n.push(i[o]);return new dc(n,0)}function wc(e){return e.pieceNum_>=e.pieces_.length}function Ic(e,t){var n=vc(e),r=vc(t);if(null===n)return t;if(n===r)return Ic(mc(e),mc(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Cc(e,t){if(gc(e)!==gc(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Ac(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(gc(e)>gc(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var Sc=q((function e(t,n){G(this,e),this.errorPrefix_=n,this.parts_=bc(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=Ue(this.parts_[r]);_c(this)}));function _c(e){if(e.byteLength_>hc)throw new Error(e.errorPrefix_+"has a key path longer than "+hc+" bytes ("+e.byteLength_+").");if(e.parts_.length>fc)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+fc+") or object contains a cycle "+Ec(e))}function Ec(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var Tc=function(e){F(n,e);var t=z(n);function n(){var e,r,a;return G(this,n),e=t.call(this,["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(a="visibilitychange",r="hidden"):"undefined"!==typeof document.mozHidden?(a="mozvisibilitychange",r="mozHidden"):"undefined"!==typeof document.msHidden?(a="msvisibilitychange",r="msHidden"):"undefined"!==typeof document.webkitHidden&&(a="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,a&&document.addEventListener(a,(function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))}),!1),e}return q(n,[{key:"getInitialEvent",value:function(e){return $("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(cc),Nc=1e3,Oc=3e5,Rc=function(e){F(n,e);var t=z(n);function n(e,r,a,i,o,s,u,c){var l;if(G(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=a,l.onConnectStatus_=i,l.onServerInfoUpdate_=o,l.authTokenProvider_=s,l.appCheckTokenProvider_=u,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=yu("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=Nc,l.maxReconnectDelay_=Oc,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!ye())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Tc.getInstance().on("visible",l.onVisible_,D(l)),-1===e.host.indexOf("fblocal")&&lc.getInstance().on("online",l.onOnline_,D(l)),l}return q(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,a={r:r,a:e,b:t};this.log_(Ae(a)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){this.initConnection_();var t=new pe,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:function(e){var n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;var r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var a=e._queryIdentifier,i=e._path.toString();this.log_("Listen called for "+i+" "+a),this.listens.has(i)||this.listens.set(i,new Map),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(i).has(a),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(i).set(a,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,r=e.query,a=r._path.toString(),i=r._queryIdentifier;this.log_("Listen on "+a+" for "+i);var o={p:a};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var s=o.d,u=o.s;n.warnOnListenWarnings_(s,r),(t.listens.get(a)&&t.listens.get(a).get(i))===e&&(t.log_("listen response",o),"ok"!==u&&t.removeListen_(a,i),e.onComplete&&e.onComplete(u,s))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=Se(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=Se(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,a=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,a))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var a={p:e};r&&(a.q=n,a.t=r),this.sendRequest("n",a)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var a={p:t,d:n};this.log_("onDisconnect "+e,a),this.sendRequest(e,a,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,a){this.initConnection_();var i={p:t,d:n};void 0!==a&&(i.h=a),this.outstandingPuts_.push({action:e,request:i,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,a=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),a&&a(r.s,r.d)}))}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+Ae(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):bu("Unrecognized action received from server: "+Ae(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Nc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Nc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Nc),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=V(B().mark((function e(){var t,r,a,i,o,s,u,c,l,f,h,d,p,v,g=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldReconnect_()){e.next=30;break}return this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),a=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,a())},l=function(e){$(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(e)},this.realtime_={close:c,sendRequest:l},f=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,e.prev=16,e.next=19,Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);case 19:h=e.sent,d=E(h,2),p=d[0],v=d[1],s?mu("getToken() completed but was canceled"):(mu("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=v&&v.token,u=new sc(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,a,(function(e){ku(e+" ("+g.repoInfo_.toString()+")"),g.interrupt("server_kill")}),o)),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(16),this.log_("Failed to get token: "+e.t0),s||(this.repoInfo_.nodeAdmin&&ku(e.t0),c());case 30:case"end":return e.stop()}}),e,this,[[16,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"interrupt",value:function(e){mu("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){mu("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Te(this.interruptReasons_)&&(this.reconnectDelay_=Nc,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return Eu(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new dc(e).toString();if(this.listens.has(r)){var a=this.listens.get(r);n=a.get(t),a.delete(t),0===a.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){mu("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){mu("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=U(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=U(e.value.values());try{for(r.s();!(n=r.n()).done;){var a=n.value;this.sendListen_(a)}}catch(u){r.e(u)}finally{r.f()}}}catch(u){t.e(u)}finally{t.f()}for(var i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var s=0;s<this.outstandingGets_.length;s++)this.outstandingGets_[s]&&this.sendGet_(s)}},{key:"sendConnectStats_",value:function(){var e={},t="js";ye()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+au.replace(/\./g,"-")]=1,ge()?e["framework.cordova"]=1:me()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=lc.getInstance().currentlyOnline();return Te(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"===typeof e&&_e(e,"w")){var n=Ee(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',a=t._path.toString();ku("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(a," to your security rules for better performance."))}}}}]),n}(uc);Rc.nextPersistentConnectionId_=0,Rc.nextConnectionId_=0;var Pc,Dc=function(){function e(t,n){G(this,e),this.name=t,this.node=n}return q(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),Mc=function(){function e(){G(this,e)}return q(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new Dc(Iu,e),r=new Dc(Iu,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return Dc.MIN}}]),e}(),Fc=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"compare",value:function(e,t){return Au(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw ee("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return Dc.MIN}},{key:"maxPost",value:function(){return new Dc(Cu,Pc)}},{key:"makePost",value:function(e,t){return $("string"===typeof e,"KeyIndex indexValue must always be a string."),new Dc(e,Pc)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return Pc},set:function(e){Pc=e}}]),n}(Mc),Lc=new Fc,jc=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;G(this,e),this.isReverse_=a,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(o=n?r(t.key,n):1,a&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return q(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),zc=function(){function e(t,n,r,a,i){G(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=a?a:Wc.EMPTY_NODE,this.right=null!=i?i:Wc.EMPTY_NODE}return q(e,[{key:"copy",value:function(t,n,r,a,i){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=a?a:this.left,null!=i?i:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,a=n(e,r.key);return(r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return Wc.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Wc.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();zc.RED=!0,zc.BLACK=!1;var Uc,Bc=function(){function e(){G(this,e)}return q(e,[{key:"copy",value:function(e,t,n,r,a){return this}},{key:"insert",value:function(e,t,n){return new zc(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}(),Wc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;G(this,e),this.comparator_=t,this.root_=n}return q(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,zc.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,zc.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new jc(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new jc(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new jc(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new jc(this.root_,null,this.comparator_,!0,e)}}]),e}();function Vc(e,t){return Au(e.name,t.name)}function Gc(e,t){return Au(e,t)}Wc.EMPTY_NODE=new Bc;var Hc,Kc,qc,Xc=function(e){return"number"===typeof e?"number:"+Ou(e):"string:"+e},Yc=function(e){if(e.isLeafNode()){var t=e.val();$("string"===typeof t||"number"===typeof t||"object"===typeof t&&_e(t,".sv"),"Priority must be a string or number.")}else $(e===Uc||e.isEmpty(),"priority of unexpected type.");$(e===Uc||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Zc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;G(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,$(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Yc(this.priorityNode_)}return q(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return wc(t)?this:".priority"===vc(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=vc(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:($(".priority"!==r||1===gc(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(mc(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Xc(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?Ou(this.value_):this.value_,this.lazyHash_=hu(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:($(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,a=e.VALUE_TYPE_ORDER.indexOf(n),i=e.VALUE_TYPE_ORDER.indexOf(r);return $(a>=0,"Unknown leaf type: "+n),$(i>=0,"Unknown leaf type: "+r),a===i?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:i-a}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return Hc},set:function(e){Hc=e}}]),e}();Zc.VALUE_TYPE_ORDER=["object","boolean","number","string"];var Qc,Jc,$c=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),a=n.compareTo(r);return 0===a?Au(e.name,t.name):a}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return Dc.MIN}},{key:"maxPost",value:function(){return new Dc(Cu,new Zc("[PRIORITY-POST]",qc))}},{key:"makePost",value:function(e,t){var n=Kc(e);return new Dc(t,new Zc("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(Mc),el=new $c,tl=Math.log(2),nl=function(){function e(t){G(this,e);var n;this.count=(n=t+1,parseInt(Math.log(n)/tl,10)),this.current_=this.count-1;var r,a=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=t+1&a}return q(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),rl=function(e,t,n,r){e.sort(t);var a=function t(r,a){var i,o,s=a-r;if(0===s)return null;if(1===s)return i=e[r],o=n?n(i):i,new zc(o,i.node,zc.BLACK,null,null);var u=parseInt(s/2,10)+r,c=t(r,u),l=t(u+1,a);return i=e[u],o=n?n(i):i,new zc(o,i.node,zc.BLACK,c,l)},i=function(t){for(var r=null,i=null,o=e.length,s=function(t,r){var i=o-t,s=o;o-=t;var c=a(i+1,s),l=e[i],f=n?n(l):l;u(new zc(f,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(i=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),f=Math.pow(2,t.count-(c+1));l?s(f,zc.BLACK):(s(f,zc.BLACK),s(f,zc.RED))}return i}(new nl(e.length));return new Wc(r||t,i)},al={},il=function(){function e(t,n){G(this,e),this.indexes_=t,this.indexSet_=n}return q(e,[{key:"get",value:function(e){var t=Ee(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Wc?t:null}},{key:"hasIndex",value:function(e){return _e(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){$(t!==Lc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,a=[],i=!1,o=n.getIterator(Dc.Wrap),s=o.getNext();s;)i=i||t.isDefinedOn(s.node),a.push(s),s=o.getNext();r=i?rl(a,t.getCompare()):al;var u=t.toString(),c=Object.assign({},this.indexSet_);c[u]=t;var l=Object.assign({},this.indexes_);return l[u]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(Ne(this.indexes_,(function(e,a){var i=Ee(r.indexSet_,a);if($(i,"Missing index implementation for "+a),e===al){if(i.isDefinedOn(t.node)){for(var o=[],s=n.getIterator(Dc.Wrap),u=s.getNext();u;)u.name!==t.name&&o.push(u),u=s.getNext();return o.push(t),rl(o,i.getCompare())}return al}var c=n.get(t.name),l=e;return c&&(l=l.remove(new Dc(t.name,c))),l.insert(t,t.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(Ne(this.indexes_,(function(e){if(e===al)return e;var r=n.get(t.name);return r?e.remove(new Dc(t.name,r)):e})),this.indexSet_)}}],[{key:"Default",get:function(){return $(al&&el,"ChildrenNode.ts has not been loaded"),Qc=Qc||new e({".priority":al},{".priority":el})}}]),e}(),ol=function(){function e(t,n,r){G(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Yc(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return q(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||Jc}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?Jc:t}},{key:"getChild",value:function(e){var t=vc(e);return null===t?this:this.getImmediateChild(t).getChild(mc(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if($(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,a,i=new Dc(t,n);n.isEmpty()?(r=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(t,n),a=this.indexMap_.addToIndexes(i,this.children_));var o=r.isEmpty()?Jc:this.priorityNode_;return new e(r,o,a)}},{key:"updateChild",value:function(e,t){var n=vc(e);if(null===n)return t;$(".priority"!==vc(e)||1===gc(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(mc(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,a=0,i=!0;if(this.forEachChild(el,(function(o,s){n[o]=s.val(t),r++,i&&e.INTEGER_REGEXP_.test(o)?a=Math.max(a,Number(o)):i=!1})),!t&&i&&a<2*r){var o=[];for(var s in n)o[s]=n[s];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Xc(this.getPriority().val())+":"),this.forEachChild(el,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":hu(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var a=r.getPredecessorKey(new Dc(e,t));return a?a.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new Dc(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new Dc(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,Dc.Wrap),a=r.peek();null!=a&&t.compare(a,e)<0;)r.getNext(),a=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,Dc.Wrap),a=r.peek();null!=a&&t.compare(a,e)>0;)r.getNext(),a=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===sl?-1:0}},{key:"withIndex",value:function(t){if(t===Lc||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===Lc||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(el),r=t.getIterator(el),a=n.getNext(),i=r.getNext();a&&i;){if(a.name!==i.name||!a.node.equals(i.node))return!1;a=n.getNext(),i=r.getNext()}return null===a&&null===i}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===Lc?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return Jc||(Jc=new e(new Wc(Gc),null,il.Default))}}]),e}();ol.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var sl=new(function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.call(this,new Wc(Gc),ol.EMPTY_NODE,il.Default)}return q(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return ol.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(ol));Object.defineProperties(Dc,{MIN:{value:new Dc(Iu,ol.EMPTY_NODE)},MAX:{value:new Dc(Cu,sl)}}),Fc.__EMPTY_NODE=ol.EMPTY_NODE,Zc.__childrenNodeConstructor=ol,Uc=sl,function(e){qc=e}(sl);var ul=!0;function cl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return ol.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),$(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e)return new Zc(e,cl(t));if(e instanceof Array||!ul){var n=ol.EMPTY_NODE;return Nu(e,(function(t,r){if(_e(e,t)&&"."!==t.substring(0,1)){var a=cl(r);!a.isLeafNode()&&a.isEmpty()||(n=n.updateImmediateChild(t,a))}})),n.updatePriority(cl(t))}var r=[],a=!1;if(Nu(e,(function(e,t){if("."!==e.substring(0,1)){var n=cl(t);n.isEmpty()||(a=a||!n.getPriority().isEmpty(),r.push(new Dc(e,n)))}})),0===r.length)return ol.EMPTY_NODE;var i=rl(r,Vc,(function(e){return e.name}),Gc);if(a){var o=rl(r,el.getCompare());return new ol(i,cl(t),new il({".priority":o},{".priority":el}))}return new ol(i,cl(t),il.Default)}!function(e){Kc=e}(cl);var ll=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).indexPath_=e,$(!wc(e)&&".priority"!==vc(e),"Can't create PathIndex with empty path or .priority key"),r}return q(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),a=n.compareTo(r);return 0===a?Au(e.name,t.name):a}},{key:"makePost",value:function(e,t){var n=cl(e),r=ol.EMPTY_NODE.updateChild(this.indexPath_,n);return new Dc(t,r)}},{key:"maxPost",value:function(){var e=ol.EMPTY_NODE.updateChild(this.indexPath_,sl);return new Dc(Cu,e)}},{key:"toString",value:function(){return bc(this.indexPath_,0).join("/")}}]),n}(Mc),fl=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?Au(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return Dc.MIN}},{key:"maxPost",value:function(){return Dc.MAX}},{key:"makePost",value:function(e,t){var n=cl(e);return new Dc(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(Mc),hl=new fl;function dl(e){return{type:"value",snapshotNode:e}}function pl(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function vl(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function gl(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var ml=function(){function e(t){G(this,e),this.index_=t}return q(e,[{key:"updateChild",value:function(e,t,n,r,a,i){$(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=i&&(n.isEmpty()?e.hasChild(t)?i.trackChildChange(vl(t,o)):$(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?i.trackChildChange(pl(t,n)):i.trackChildChange(gl(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}},{key:"updateFullNode",value:function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(el,(function(e,r){t.hasChild(e)||n.trackChildChange(vl(e,r))})),t.isLeafNode()||t.forEachChild(el,(function(t,r){if(e.hasChild(t)){var a=e.getImmediateChild(t);a.equals(r)||n.trackChildChange(gl(t,r,a))}else n.trackChildChange(pl(t,r))}))),t.withIndex(this.index_)}},{key:"updatePriority",value:function(e,t){return e.isEmpty()?ol.EMPTY_NODE:e.updatePriority(t)}},{key:"filtersNodes",value:function(){return!1}},{key:"getIndexedFilter",value:function(){return this}},{key:"getIndex",value:function(){return this.index_}}]),e}(),yl=function(){function e(t){G(this,e),this.indexedFilter_=new ml(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}return q(e,[{key:"getStartPost",value:function(){return this.startPost_}},{key:"getEndPost",value:function(){return this.endPost_}},{key:"matches",value:function(e){var t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}},{key:"updateChild",value:function(e,t,n,r,a,i){return this.matches(new Dc(t,n))||(n=ol.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,a,i)}},{key:"updateFullNode",value:function(e,t,n){t.isLeafNode()&&(t=ol.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(ol.EMPTY_NODE);var a=this;return t.forEachChild(el,(function(e,t){a.matches(new Dc(e,t))||(r=r.updateImmediateChild(e,ol.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.indexedFilter_}},{key:"getIndex",value:function(){return this.index_}}],[{key:"getStartPost_",value:function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}},{key:"getEndPost_",value:function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}]),e}(),bl=function(){function e(t){var n=this;G(this,e),this.withinDirectionalStart=function(e){return n.reverse_?n.withinEndPost(e):n.withinStartPost(e)},this.withinDirectionalEnd=function(e){return n.reverse_?n.withinStartPost(e):n.withinEndPost(e)},this.withinStartPost=function(e){var t=n.index_.compare(n.rangedFilter_.getStartPost(),e);return n.startIsInclusive_?t<=0:t<0},this.withinEndPost=function(e){var t=n.index_.compare(e,n.rangedFilter_.getEndPost());return n.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new yl(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}return q(e,[{key:"updateChild",value:function(e,t,n,r,a,i){return this.rangedFilter_.matches(new Dc(t,n))||(n=ol.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,a,i):this.fullLimitUpdateChild_(e,t,n,a,i)}},{key:"updateFullNode",value:function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=ol.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var a;r=ol.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var i=0;a.hasNext()&&i<this.limit_;){var o=a.getNext();if(this.withinDirectionalStart(o)){if(!this.withinDirectionalEnd(o))break;r=r.updateImmediateChild(o.name,o.node),i++}}}else{var s;r=(r=t.withIndex(this.index_)).updatePriority(ol.EMPTY_NODE),s=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);for(var u=0;s.hasNext();){var c=s.getNext();u<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?u++:r=r.updateImmediateChild(c.name,ol.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.rangedFilter_.getIndexedFilter()}},{key:"getIndex",value:function(){return this.index_}},{key:"fullLimitUpdateChild_",value:function(e,t,n,r,a){var i;if(this.reverse_){var o=this.index_.getCompare();i=function(e,t){return o(t,e)}}else i=this.index_.getCompare();var s=e;$(s.numChildren()===this.limit_,"");var u=new Dc(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var f=s.getImmediateChild(t),h=r.getChildAfterChild(this.index_,c,this.reverse_);null!=h&&(h.name===t||s.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);var d=null==h?1:i(h,u);if(l&&!n.isEmpty()&&d>=0)return null!=a&&a.trackChildChange(gl(t,n,f)),s.updateImmediateChild(t,n);null!=a&&a.trackChildChange(vl(t,f));var p=s.updateImmediateChild(t,ol.EMPTY_NODE);return null!=h&&this.rangedFilter_.matches(h)?(null!=a&&a.trackChildChange(pl(h.name,h.node)),p.updateImmediateChild(h.name,h.node)):p}return n.isEmpty()?e:l&&i(c,u)>=0?(null!=a&&(a.trackChildChange(vl(c.name,c.node)),a.trackChildChange(pl(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,ol.EMPTY_NODE)):e}}]),e}(),xl=function(){function e(){G(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=el}return q(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Iu}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Cu}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===el}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function kl(e){var t,n={};if(e.isDefault())return n;if(e.index_===el?t="$priority":e.index_===hl?t="$value":e.index_===Lc?t="$key":($(e.index_ instanceof ll,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Ae(t),e.startSet_){var r=e.startAfterSet_?"startAfter":"startAt";n[r]=Ae(e.indexStartValue_),e.startNameSet_&&(n[r]+=","+Ae(e.indexStartName_))}if(e.endSet_){var a=e.endBeforeSet_?"endBefore":"endAt";n[a]=Ae(e.indexEndValue_),e.endNameSet_&&(n[a]+=","+Ae(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_),n}function wl(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==el&&(t.i=e.index_.toString()),t}var Il=function(e){F(n,e);var t=z(n);function n(e,r,a,i){var o;return G(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=a,o.appCheckTokenProvider_=i,o.log_=yu("p:rest:"),o.listens_={},o}return q(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,a){var i=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=n.getListenId_(e,r),u={};this.listens_[s]=u;var c=kl(e._queryParams);this.restRequest_(o+".json",c,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&i.onDataUpdate_(o,n,!1,r),Ee(i.listens_,s)===u)&&a(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=kl(e._queryParams),r=e._path.toString(),a=new pe;return this.restRequest_(r+".json",n,(function(e,n){var i=n;404===e&&(i=null,e=null),null===e?(t.onDataUpdate_(r,i,!1,null),a.resolve(i)):a.reject(new Error(i))})),a.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(a){var i=E(a,2),o=i[0],s=i[1];o&&o.accessToken&&(n.auth=o.accessToken),s&&s.token&&(n.ac=s.token);var u=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+Pe(n);t.log_("Sending REST request for "+u);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(r&&4===c.readyState){t.log_("REST Response for "+u+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=Ce(c.responseText)}catch(n){ku("Failed to parse JSON response for "+u+": "+c.responseText)}r(null,e)}else 401!==c.status&&404!==c.status&&ku("Got unsuccessful REST response for "+u+" Status: "+c.status),r(c.status);r=null}},c.open("GET",u,!0),c.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(uc),Cl=function(){function e(){G(this,e),this.rootNode_=ol.EMPTY_NODE}return q(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function Al(){return{value:null,children:new Map}}function Sl(e,t,n){if(wc(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=vc(t);e.children.has(r)||e.children.set(r,Al()),Sl(e.children.get(r),t=mc(t),n)}}function _l(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}(e,(function(e,r){_l(r,new dc(t.toString()+"/"+e),n)}))}var El,Tl=function(){function e(t){G(this,e),this.collection_=t,this.last_=null}return q(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Nu(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),e}(),Nl=1e4,Ol=3e4,Rl=function(){function e(t,n){G(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new Tl(t);var r=Nl+(Ol-Nl)*Math.random();Fu(this.reportStats_.bind(this),Math.floor(r))}return q(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;Nu(t,(function(t,a){a>0&&_e(e.statsToReport_,t)&&(n[t]=a,r=!0)})),r&&this.server_.reportStats(n),Fu(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}();function Pl(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(El||(El={}));var Dl,Ml=function(){function e(t,n,r){G(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=El.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return q(e,[{key:"operationForChild",value:function(t){if(wc(this.path)){if(null!=this.affectedTree.value)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new dc(t));return new e(pc(),n,this.revert)}return $(vc(this.path)===t,"operationForChild called for unrelated child."),new e(mc(this.path),this.affectedTree,this.revert)}}]),e}(),Fl=function(){function e(t,n){G(this,e),this.source=t,this.path=n,this.type=El.LISTEN_COMPLETE}return q(e,[{key:"operationForChild",value:function(t){return wc(this.path)?new e(this.source,pc()):new e(this.source,mc(this.path))}}]),e}(),Ll=function(){function e(t,n,r){G(this,e),this.source=t,this.path=n,this.snap=r,this.type=El.OVERWRITE}return q(e,[{key:"operationForChild",value:function(t){return wc(this.path)?new e(this.source,pc(),this.snap.getImmediateChild(t)):new e(this.source,mc(this.path),this.snap)}}]),e}(),jl=function(){function e(t,n,r){G(this,e),this.source=t,this.path=n,this.children=r,this.type=El.MERGE}return q(e,[{key:"operationForChild",value:function(t){if(wc(this.path)){var n=this.children.subtree(new dc(t));return n.isEmpty()?null:n.value?new Ll(this.source,pc(),n.value):new e(this.source,pc(),n)}return $(vc(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,mc(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),zl=function(){function e(t,n,r){G(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return q(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(wc(e))return this.isFullyInitialized()&&!this.filtered_;var t=vc(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}(),Ul=q((function e(t){G(this,e),this.query_=t,this.index_=this.query_._queryParams.getIndex()}));function Bl(e,t,n,r,a,i){var o=r.filter((function(e){return e.type===n}));o.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw ee("Should only compare child_ events.");var r=new Dc(t.childName,t.snapshotNode),a=new Dc(n.childName,n.snapshotNode);return e.index_.compare(r,a)}(e,t,n)})),o.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,i);a.forEach((function(a){a.respondsTo(n.type)&&t.push(a.createEvent(r,e.query_))}))}))}function Wl(e,t){return{eventCache:e,serverCache:t}}function Vl(e,t,n,r){return Wl(new zl(t,n,r),e.serverCache)}function Gl(e,t,n,r){return Wl(e.eventCache,new zl(t,n,r))}function Hl(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Kl(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var ql=function(){return Dl||(Dl=new Wc(Su)),Dl},Xl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ql();G(this,e),this.value=t,this.children=n}return q(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:pc(),value:this.value};if(wc(e))return null;var n=vc(e),r=this.children.get(n);if(null!==r){var a=r.findRootMostMatchingPathAndValue(mc(e),t);return null!=a?{path:kc(new dc(n),a.path),value:a.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(t){if(wc(t))return this;var n=vc(t),r=this.children.get(n);return null!==r?r.subtree(mc(t)):new e(null)}},{key:"set",value:function(t,n){if(wc(t))return new e(n,this.children);var r=vc(t),a=(this.children.get(r)||new e(null)).set(mc(t),n),i=this.children.insert(r,a);return new e(this.value,i)}},{key:"remove",value:function(t){if(wc(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=vc(t),r=this.children.get(n);if(r){var a,i=r.remove(mc(t));return a=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&a.isEmpty()?new e(null):new e(this.value,a)}return this}},{key:"get",value:function(e){if(wc(e))return this.value;var t=vc(e),n=this.children.get(t);return n?n.get(mc(e)):null}},{key:"setTree",value:function(t,n){if(wc(t))return n;var r,a=vc(t),i=(this.children.get(a)||new e(null)).setTree(mc(t),n);return r=i.isEmpty()?this.children.remove(a):this.children.insert(a,i),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(pc(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,a){n[r]=a.fold_(kc(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,pc(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(wc(e))return null;var a=vc(e),i=this.children.get(a);return i?i.findOnPath_(mc(e),kc(t,a),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,pc(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(wc(t))return this;this.value&&r(n,this.value);var a=vc(t),i=this.children.get(a);return i?i.foreachOnPath_(mc(t),kc(n,a),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(pc(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(kc(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(t){var n=new e(null);return Nu(t,(function(e,t){n=n.set(new dc(e),t)})),n}}]),e}(),Yl=function(){function e(t){G(this,e),this.writeTree_=t}return q(e,null,[{key:"empty",value:function(){return new e(new Xl(null))}}]),e}();function Zl(e,t,n){if(wc(t))return new Yl(new Xl(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var a=r.path,i=r.value,o=Ic(a,t);return i=i.updateChild(o,n),new Yl(e.writeTree_.set(a,i))}var s=new Xl(n),u=e.writeTree_.setTree(t,s);return new Yl(u)}function Ql(e,t,n){var r=e;return Nu(n,(function(e,n){r=Zl(r,kc(t,e),n)})),r}function Jl(e,t){if(wc(t))return Yl.empty();var n=e.writeTree_.setTree(t,new Xl(null));return new Yl(n)}function $l(e,t){return null!=ef(e,t)}function ef(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Ic(n.path,t)):null}function tf(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(el,(function(e,n){t.push(new Dc(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new Dc(e,n.value))})),t}function nf(e,t){if(wc(t))return e;var n=ef(e,t);return new Yl(null!=n?new Xl(n):e.writeTree_.subtree(t))}function rf(e){return e.writeTree_.isEmpty()}function af(e,t){return of(pc(),e.writeTree_,t)}function of(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,a){".priority"===t?($(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):n=of(kc(e,t),a,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(kc(e,".priority"),r)),n}function sf(e,t){return xf(t,e)}function uf(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));$(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var a=r.visible,i=!1,o=e.allWrites.length-1;a&&o>=0;){var s=e.allWrites[o];s.visible&&(o>=n&&cf(s,r.path)?a=!1:Ac(r.path,s.path)&&(i=!0)),o--}if(a){if(i)return function(e){e.visibleWrites=ff(e.allWrites,lf,pc()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=Jl(e.visibleWrites,r.path):Nu(r.children,(function(t){e.visibleWrites=Jl(e.visibleWrites,kc(r.path,t))}));return!0}return!1}function cf(e,t){if(e.snap)return Ac(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&Ac(kc(e.path,n),t))return!0;return!1}function lf(e){return e.visible}function ff(e,t,n){for(var r=Yl.empty(),a=0;a<e.length;++a){var i=e[a];if(t(i)){var o=i.path,s=void 0;if(i.snap)Ac(n,o)?r=Zl(r,s=Ic(n,o),i.snap):Ac(o,n)&&(s=Ic(o,n),r=Zl(r,pc(),i.snap.getChild(s)));else{if(!i.children)throw ee("WriteRecord should have .snap or .children");if(Ac(n,o))r=Ql(r,s=Ic(n,o),i.children);else if(Ac(o,n))if(wc(s=Ic(o,n)))r=Ql(r,pc(),i.children);else{var u=Ee(i.children,vc(s));if(u){var c=u.getChild(mc(s));r=Zl(r,pc(),c)}}}}}return r}function hf(e,t,n,r,a){if(r||a){var i=nf(e.visibleWrites,t);if(!a&&rf(i))return n;if(a||null!=n||$l(i,pc())){return af(ff(e.allWrites,(function(e){return(e.visible||a)&&(!r||!~r.indexOf(e.writeId))&&(Ac(e.path,t)||Ac(t,e.path))}),t),n||ol.EMPTY_NODE)}return null}var o=ef(e.visibleWrites,t);if(null!=o)return o;var s=nf(e.visibleWrites,t);return rf(s)?n:null!=n||$l(s,pc())?af(s,n||ol.EMPTY_NODE):null}function df(e,t,n,r){return hf(e.writeTree,e.treePath,t,n,r)}function pf(e,t){return function(e,t,n){var r=ol.EMPTY_NODE,a=ef(e.visibleWrites,t);if(a)return a.isLeafNode()||a.forEachChild(el,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var i=nf(e.visibleWrites,t);return n.forEachChild(el,(function(e,t){var n=af(nf(i,new dc(e)),t);r=r.updateImmediateChild(e,n)})),tf(i).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return tf(nf(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function vf(e,t,n,r){return function(e,t,n,r,a){$(r||a,"Either existingEventSnap or existingServerSnap must exist");var i=kc(t,n);if($l(e.visibleWrites,i))return null;var o=nf(e.visibleWrites,i);return rf(o)?a.getChild(n):af(o,a.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function gf(e,t){return function(e,t){return ef(e.visibleWrites,t)}(e.writeTree,kc(e.treePath,t))}function mf(e,t,n,r,a,i){return function(e,t,n,r,a,i,o){var s,u=nf(e.visibleWrites,t),c=ef(u,pc());if(null!=c)s=c;else{if(null==n)return[];s=af(u,n)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var l=[],f=o.getCompare(),h=i?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),d=h.getNext();d&&l.length<a;)0!==f(d,r)&&l.push(d),d=h.getNext();return l}(e.writeTree,e.treePath,t,n,r,a,i)}function yf(e,t,n){return function(e,t,n,r){var a=kc(t,n),i=ef(e.visibleWrites,a);return null!=i?i:r.isCompleteForChild(n)?af(nf(e.visibleWrites,a),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function bf(e,t){return xf(kc(e.treePath,t),e.writeTree)}function xf(e,t){return{treePath:e,writeTree:t}}var kf=function(){function e(){G(this,e),this.changeMap=new Map}return q(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;$("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),$(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var a=r.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(n,gl(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(n,vl(n,r.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(n,pl(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw ee("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,gl(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),wf=new(function(){function e(){G(this,e)}return q(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),If=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;G(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return q(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new zl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return yf(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Kl(this.viewCache_),a=mf(this.writes_,r,t,1,n,e);return 0===a.length?null:a[0]}}]),e}();function Cf(e,t,n,r,a){var i,o,s=new kf;if(n.type===El.OVERWRITE){var u=n;u.source.fromUser?i=_f(e,t,u.path,u.snap,r,a,s):($(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.serverCache.isFiltered()&&!wc(u.path),i=Sf(e,t,u.path,u.snap,r,a,o,s))}else if(n.type===El.MERGE){var c=n;c.source.fromUser?i=function(e,t,n,r,a,i,o){var s=t;return r.foreach((function(r,u){var c=kc(n,r);Ef(t,vc(c))&&(s=_f(e,s,c,u,a,i,o))})),r.foreach((function(r,u){var c=kc(n,r);Ef(t,vc(c))||(s=_f(e,s,c,u,a,i,o))})),s}(e,t,c.path,c.children,r,a,s):($(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),i=Nf(e,t,c.path,c.children,r,a,o,s))}else if(n.type===El.ACK_USER_WRITE){var l=n;i=l.revert?function(e,t,n,r,a,i){var o;if(null!=gf(r,n))return t;var s,u=new If(r,t,a),c=t.eventCache.getNode();if(wc(n)||".priority"===vc(n)){var l;if(t.serverCache.isFullyInitialized())l=df(r,Kl(t));else{var f=t.serverCache.getNode();$(f instanceof ol,"serverChildren would be complete if leaf node"),l=pf(r,f)}s=e.filter.updateFullNode(c,l,i)}else{var h=vc(n),d=yf(r,h,t.serverCache);null==d&&t.serverCache.isCompleteForChild(h)&&(d=c.getImmediateChild(h)),(s=null!=d?e.filter.updateChild(c,h,d,mc(n),u,i):t.eventCache.getNode().hasChild(h)?e.filter.updateChild(c,h,ol.EMPTY_NODE,mc(n),u,i):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=df(r,Kl(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,o,i))}return o=t.serverCache.isFullyInitialized()||null!=gf(r,pc()),Vl(t,s,o,e.filter.filtersNodes())}(e,t,l.path,r,a,s):function(e,t,n,r,a,i,o){if(null!=gf(a,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(wc(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Sf(e,t,n,u.getNode().getChild(n),a,i,s,o);if(wc(n)){var c=new Xl(null);return u.getNode().forEachChild(Lc,(function(e,t){c=c.set(new dc(e),t)})),Nf(e,t,n,c,a,i,s,o)}return t}var l=new Xl(null);return r.foreach((function(e,t){var r=kc(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))})),Nf(e,t,n,l,a,i,s,o)}(e,t,l.path,l.affectedTree,r,a,s)}else{if(n.type!==El.LISTEN_COMPLETE)throw ee("Unknown operation type: "+n.type);i=function(e,t,n,r,a){var i=t.serverCache,o=Gl(t,i.getNode(),i.isFullyInitialized()||wc(n),i.isFiltered());return Af(e,o,n,r,wf,a)}(e,t,n.path,r,s)}var f=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var a=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Hl(e);(n.length>0||!e.eventCache.isFullyInitialized()||a&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(dl(Hl(t)))}}(t,i,f),{viewCache:i,changes:f}}function Af(e,t,n,r,a,i){var o,s,u=t.eventCache;if(null!=gf(r,n))return t;if(wc(n))if($(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=Kl(t),l=pf(r,c instanceof ol?c:ol.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,i)}else{var f=df(r,Kl(t));o=e.filter.updateFullNode(t.eventCache.getNode(),f,i)}else{var h=vc(n);if(".priority"===h){$(1===gc(n),"Can't have a priority with additional path components");var d=u.getNode(),p=vf(r,n,d,s=t.serverCache.getNode());o=null!=p?e.filter.updatePriority(d,p):u.getNode()}else{var v,g=mc(n);if(u.isCompleteForChild(h)){s=t.serverCache.getNode();var m=vf(r,n,u.getNode(),s);v=null!=m?u.getNode().getImmediateChild(h).updateChild(g,m):u.getNode().getImmediateChild(h)}else v=yf(r,h,t.serverCache);o=null!=v?e.filter.updateChild(u.getNode(),h,v,g,a,i):u.getNode()}}return Vl(t,o,u.isFullyInitialized()||wc(n),e.filter.filtersNodes())}function Sf(e,t,n,r,a,i,o,s){var u,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(wc(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var f=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),f,null)}else{var h=vc(n);if(!c.isCompleteForPath(n)&&gc(n)>1)return t;var d=mc(n),p=c.getNode().getImmediateChild(h).updateChild(d,r);u=".priority"===h?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),h,p,d,wf,null)}var v=Gl(t,u,c.isFullyInitialized()||wc(n),l.filtersNodes());return Af(e,v,n,a,new If(a,v,i),s)}function _f(e,t,n,r,a,i,o){var s,u,c=t.eventCache,l=new If(a,t,i);if(wc(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),s=Vl(t,u,!0,e.filter.filtersNodes());else{var f=vc(n);if(".priority"===f)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=Vl(t,u,c.isFullyInitialized(),c.isFiltered());else{var h,d=mc(n),p=c.getNode().getImmediateChild(f);if(wc(d))h=r;else{var v=l.getCompleteChild(f);h=null!=v?".priority"===yc(d)&&v.getChild(xc(d)).isEmpty()?v:v.updateChild(d,r):ol.EMPTY_NODE}if(p.equals(h))s=t;else s=Vl(t,e.filter.updateChild(c.getNode(),f,h,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function Ef(e,t){return e.eventCache.isCompleteForChild(t)}function Tf(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function Nf(e,t,n,r,a,i,o,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=wc(n)?r:new Xl(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=Tf(0,t.serverCache.getNode().getImmediateChild(n),r);c=Sf(e,c,new dc(n),u,a,i,o,s)}})),u.children.inorderTraversal((function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!u){var f=Tf(0,t.serverCache.getNode().getImmediateChild(n),r);c=Sf(e,c,new dc(n),f,a,i,o,s)}})),c}var Of,Rf=function(){function e(t,n){G(this,e),this.query_=t,this.eventRegistrations_=[];var r,a=this.query_._queryParams,i=new ml(a.getIndex()),o=(r=a).loadsAllData()?new ml(r.getIndex()):r.hasLimit()?new bl(r):new yl(r);this.processor_=function(e){return{filter:e}}(o);var s=n.serverCache,u=n.eventCache,c=i.updateFullNode(ol.EMPTY_NODE,s.getNode(),null),l=o.updateFullNode(ol.EMPTY_NODE,u.getNode(),null),f=new zl(c,s.isFullyInitialized(),i.filtersNodes()),h=new zl(l,u.isFullyInitialized(),o.filtersNodes());this.viewCache_=Wl(h,f),this.eventGenerator_=new Ul(this.query_)}return q(e,[{key:"query",get:function(){return this.query_}}]),e}();function Pf(e,t){var n=Kl(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!wc(t)&&!n.getImmediateChild(vc(t)).isEmpty())?n.getChild(t):null}function Df(e){return 0===e.eventRegistrations_.length}function Mf(e,t,n){var r=[];if(n){$(null==t,"A cancel should cancel all event registrations.");var a=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,a);t&&r.push(t)}))}if(t){for(var i=[],o=0;o<e.eventRegistrations_.length;++o){var s=e.eventRegistrations_[o];if(s.matches(t)){if(t.hasAnyCallback()){i=i.concat(e.eventRegistrations_.slice(o+1));break}}else i.push(s)}e.eventRegistrations_=i}else e.eventRegistrations_=[];return r}function Ff(e,t,n,r){t.type===El.MERGE&&null!==t.source.queryId&&($(Kl(e.viewCache_),"We should always have a full cache before handling merges"),$(Hl(e.viewCache_),"Missing event cache, even though we have a server cache"));var a,i,o=e.viewCache_,s=Cf(e.processor_,o,t,n,r);return a=e.processor_,i=s.viewCache,$(i.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),$(i.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),$(s.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Lf(e,s.changes,s.viewCache.eventCache.getNode(),null)}function Lf(e,t,n,r){var a=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var a=[],i=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&i.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Bl(e,a,"child_removed",t,r,n),Bl(e,a,"child_added",t,r,n),Bl(e,a,"child_moved",i,r,n),Bl(e,a,"child_changed",t,r,n),Bl(e,a,"value",t,r,n),a}(e.eventGenerator_,t,n,a)}var jf,zf=q((function e(){G(this,e),this.views=new Map}));function Uf(e,t,n,r){var a=t.source.queryId;if(null!==a){var i=e.views.get(a);return $(null!=i,"SyncTree gave us an op for an invalid query."),Ff(i,t,n,r)}var o,s=[],u=U(e.views.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s=s.concat(Ff(c,t,n,r))}}catch(l){u.e(l)}finally{u.f()}return s}function Bf(e,t,n,r,a){var i=t._queryIdentifier,o=e.views.get(i);if(!o){var s=df(n,a?r:null),u=!1;s?u=!0:r instanceof ol?(s=pf(n,r),u=!1):(s=ol.EMPTY_NODE,u=!1);var c=Wl(new zl(s,u,!1),new zl(r,a,!1));return new Rf(t,c)}return o}function Wf(e,t,n,r,a,i){var o=Bf(e,t,r,a,i);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(el,(function(e,t){r.push(pl(e,t))})),n.isFullyInitialized()&&r.push(dl(n.getNode())),Lf(e,r,n.getNode(),t)}(o,n)}function Vf(e,t,n,r){var a=t._queryIdentifier,i=[],o=[],s=Xf(e);if("default"===a){var u,c=U(e.views.entries());try{for(c.s();!(u=c.n()).done;){var l=E(u.value,2),f=l[0],h=l[1];o=o.concat(Mf(h,n,r)),Df(h)&&(e.views.delete(f),h.query._queryParams.loadsAllData()||i.push(h.query))}}catch(p){c.e(p)}finally{c.f()}}else{var d=e.views.get(a);d&&(o=o.concat(Mf(d,n,r)),Df(d)&&(e.views.delete(a),d.query._queryParams.loadsAllData()||i.push(d.query)))}return s&&!Xf(e)&&i.push(new($(Of,"Reference.ts has not been loaded"),Of)(t._repo,t._path)),{removed:i,events:o}}function Gf(e){var t,n=[],r=U(e.views.values());try{for(r.s();!(t=r.n()).done;){var a=t.value;a.query._queryParams.loadsAllData()||n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function Hf(e,t){var n,r=null,a=U(e.views.values());try{for(a.s();!(n=a.n()).done;){var i=n.value;r=r||Pf(i,t)}}catch(o){a.e(o)}finally{a.f()}return r}function Kf(e,t){if(t._queryParams.loadsAllData())return Yf(e);var n=t._queryIdentifier;return e.views.get(n)}function qf(e,t){return null!=Kf(e,t)}function Xf(e){return null!=Yf(e)}function Yf(e){var t,n=U(e.views.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.query._queryParams.loadsAllData())return r}}catch(a){n.e(a)}finally{n.f()}return null}var Zf=1,Qf=q((function e(t){G(this,e),this.listenProvider_=t,this.syncPointTree_=new Xl(null),this.pendingWriteTree_={visibleWrites:Yl.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}));function Jf(e,t,n,r,a){return function(e,t,n,r,a){$(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===a&&(a=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:a}),a&&(e.visibleWrites=Zl(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,a),a?oh(e,new Ll({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function $f(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(uf(e.pendingWriteTree_,t)){var a=new Xl(null);return null!=r.snap?a=a.set(pc(),!0):Nu(r.children,(function(e){a=a.set(new dc(e),!0)})),oh(e,new Ml(r.path,a,n))}return[]}function eh(e,t,n){return oh(e,new Ll({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function th(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t._path,o=e.syncPointTree_.get(i),s=[];if(o&&("default"===t._queryIdentifier||qf(o,t))){var u=Vf(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));var c=u.removed;if(s=u.events,!a){var l=-1!==c.findIndex((function(e){return e._queryParams.loadsAllData()})),f=e.syncPointTree_.findOnPath(i,(function(e,t){return Xf(t)}));if(l&&!f){var h=e.syncPointTree_.subtree(i);if(!h.isEmpty())for(var d=function(e){return e.fold((function(e,t,n){if(t&&Xf(t))return[Yf(t)];var r=[];return t&&(r=Gf(t)),Nu(n,(function(e,t){r=r.concat(t)})),r}))}(h),p=0;p<d.length;++p){var v=d[p],g=v.query,m=ch(e,v);e.listenProvider_.startListening(vh(g),lh(e,g),m.hashFn,m.onComplete)}}if(!f&&c.length>0&&!r)if(l){e.listenProvider_.stopListening(vh(t),null)}else c.forEach((function(t){var n=e.queryToTagMap.get(fh(t));e.listenProvider_.stopListening(vh(t),n)}))}!function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var a=fh(r),i=e.queryToTagMap.get(a);e.queryToTagMap.delete(a),e.tagToQueryMap.delete(i)}}}(e,c)}return s}function nh(e,t,n,r){var a=hh(e,r);if(null!=a){var i=dh(a),o=i.path,s=i.queryId,u=Ic(o,t);return ph(e,o,new Ll(Pl(s),u,n))}return[]}function rh(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t._path,i=null,o=!1;e.syncPointTree_.foreachOnPath(a,(function(e,t){var n=Ic(e,a);i=i||Hf(t,n),o=o||Xf(t)}));var s,u=e.syncPointTree_.get(a);(u?(o=o||Xf(u),i=i||Hf(u,pc())):(u=new zf,e.syncPointTree_=e.syncPointTree_.set(a,u)),null!=i)?s=!0:(s=!1,i=ol.EMPTY_NODE,e.syncPointTree_.subtree(a).foreachChild((function(e,t){var n=Hf(t,pc());n&&(i=i.updateImmediateChild(e,n))})));var c=qf(u,t);if(!c&&!t._queryParams.loadsAllData()){var l=fh(t);$(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");var f=Zf++;e.queryToTagMap.set(l,f),e.tagToQueryMap.set(f,l)}var h=Wf(u,t,n,sf(e.pendingWriteTree_,a),i,s);if(!c&&!o&&!r){var d=Kf(u,t);h=h.concat(function(e,t,n){var r=t._path,a=lh(e,t),i=ch(e,n),o=e.listenProvider_.startListening(vh(t),a,i.hashFn,i.onComplete),s=e.syncPointTree_.subtree(r);if(a)$(!Xf(s.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold((function(e,t,n){if(!wc(e)&&t&&Xf(t))return[Yf(t).query];var r=[];return t&&(r=r.concat(Gf(t).map((function(e){return e.query})))),Nu(n,(function(e,t){r=r.concat(t)})),r})),c=0;c<u.length;++c){var l=u[c];e.listenProvider_.stopListening(vh(l),lh(e,l))}return o}(e,t,d))}return h}function ah(e,t,n){var r=e.pendingWriteTree_,a=e.syncPointTree_.findOnPath(t,(function(e,n){var r=Hf(n,Ic(e,t));if(r)return r}));return hf(r,t,a,n,!0)}function ih(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var a=Ic(e,n);r=r||Hf(t,a)}));var a=e.syncPointTree_.get(n);a?r=r||Hf(a,pc()):(a=new zf,e.syncPointTree_=e.syncPointTree_.set(n,a));var i=null!=r,o=i?new zl(r,!0,!1):null;return function(e){return Hl(e.viewCache_)}(Bf(a,t,sf(e.pendingWriteTree_,t._path),i?o.getNode():ol.EMPTY_NODE,i))}function oh(e,t){return sh(t,e.syncPointTree_,null,sf(e.pendingWriteTree_,pc()))}function sh(e,t,n,r){if(wc(e.path))return uh(e,t,n,r);var a=t.get(pc());null==n&&null!=a&&(n=Hf(a,pc()));var i=[],o=vc(e.path),s=e.operationForChild(o),u=t.children.get(o);if(u&&s){var c=n?n.getImmediateChild(o):null,l=bf(r,o);i=i.concat(sh(s,u,c,l))}return a&&(i=i.concat(Uf(a,e,r,n))),i}function uh(e,t,n,r){var a=t.get(pc());null==n&&null!=a&&(n=Hf(a,pc()));var i=[];return t.children.inorderTraversal((function(t,a){var o=n?n.getImmediateChild(t):null,s=bf(r,t),u=e.operationForChild(t);u&&(i=i.concat(uh(u,a,o,s)))})),a&&(i=i.concat(Uf(a,e,r,n))),i}function ch(e,t){var n=t.query,r=lh(e,n);return{hashFn:function(){var e=function(e){return e.viewCache_.serverCache.getNode()}(t)||ol.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=hh(e,n);if(r){var a=dh(r),i=a.path,o=a.queryId,s=Ic(i,t);return ph(e,i,new Fl(Pl(o),s))}return[]}(e,n._path,r):function(e,t){return oh(e,new Fl({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var a=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return th(e,n,null,a)}}}function lh(e,t){var n=fh(t);return e.queryToTagMap.get(n)}function fh(e){return e._path.toString()+"$"+e._queryIdentifier}function hh(e,t){return e.tagToQueryMap.get(t)}function dh(e){var t=e.indexOf("$");return $(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new dc(e.substr(0,t))}}function ph(e,t,n){var r=e.syncPointTree_.get(t);return $(r,"Missing sync point for query tag that we're tracking"),Uf(r,n,sf(e.pendingWriteTree_,t),null)}function vh(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new($(jf,"Reference.ts has not been loaded"),jf)(e._repo,e._path):e}var gh=function(){function e(t){G(this,e),this.node_=t}return q(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),mh=function(){function e(t,n){G(this,e),this.syncTree_=t,this.path_=n}return q(e,[{key:"getImmediateChild",value:function(t){var n=kc(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return ah(this.syncTree_,this.path_)}}]),e}(),yh=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},bh=function(e,t,n){return e&&"object"===typeof e?($(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?xh(e[".sv"],t,n):"object"===typeof e[".sv"]?kh(e[".sv"],t):void $(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},xh=function(e,t,n){if("timestamp"===e)return n.timestamp;$(!1,"Unexpected server value: "+e)},kh=function(e,t,n){e.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!==typeof r&&$(!1,"Unexpected increment value: "+r);var a=t.node();if($(null!==a&&"undefined"!==typeof a,"Expected ChildrenNode.EMPTY_NODE for nulls"),!a.isLeafNode())return r;var i=a.getValue();return"number"!==typeof i?r:i+r},wh=function(e,t,n,r){return Ch(t,new mh(n,e),r)},Ih=function(e,t,n){return Ch(e,new gh(t),n)};function Ch(e,t,n){var r,a=e.getPriority().val(),i=bh(a,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,s=bh(o.getValue(),t,n);return s!==o.getValue()||i!==o.getPriority().val()?new Zc(s,cl(i)):e}var u=e;return r=u,i!==u.getPriority().val()&&(r=r.updatePriority(new Zc(i))),u.forEachChild(el,(function(e,a){var i=Ch(a,t.getImmediateChild(e),n);i!==a&&(r=r.updateImmediateChild(e,i))})),r}var Ah=q((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};G(this,e),this.name=t,this.parent=n,this.node=r}));function Sh(e,t){for(var n=t instanceof dc?t:new dc(t),r=e,a=vc(n);null!==a;){var i=Ee(r.node.children,a)||{children:{},childCount:0};r=new Ah(a,r,i),a=vc(n=mc(n))}return r}function _h(e){return e.node.value}function Eh(e,t){e.node.value=t,Ph(e)}function Th(e){return e.node.childCount>0}function Nh(e,t){Nu(e.node.children,(function(n,r){t(new Ah(n,e,r))}))}function Oh(e,t,n,r){n&&!r&&t(e),Nh(e,(function(e){Oh(e,t,!0,r)})),n&&r&&t(e)}function Rh(e){return new dc(null===e.parent?e.name:Rh(e.parent)+"/"+e.name)}function Ph(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===_h(e)&&!Th(e)}(n),a=_e(e.node.children,t);r&&a?(delete e.node.children[t],e.node.childCount--,Ph(e)):r||a||(e.node.children[t]=n.node,e.node.childCount++,Ph(e))}(e.parent,e.name,e)}var Dh=/[\[\].#$\/\u0000-\u001F\u007F]/,Mh=/[\[\].#$\u0000-\u001F\u007F]/,Fh=10485760,Lh=function(e){return"string"===typeof e&&0!==e.length&&!Dh.test(e)},jh=function(e){return"string"===typeof e&&0!==e.length&&!Mh.test(e)},zh=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!wu(e)||e&&"object"===typeof e&&_e(e,".sv")},Uh=function(e,t,n,r){r&&void 0===t||Bh(ze(e,"value"),t,n)},Bh=function e(t,n,r){var a=r instanceof dc?new Sc(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+Ec(a));if("function"===typeof n)throw new Error(t+"contains a function "+Ec(a)+" with contents = "+n.toString());if(wu(n))throw new Error(t+"contains "+n.toString()+" "+Ec(a));if("string"===typeof n&&n.length>Fh/3&&Ue(n)>Fh)throw new Error(t+"contains a string greater than "+Fh+" utf8 bytes "+Ec(a)+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var i=!1,o=!1;if(Nu(n,(function(n,r){if(".value"===n)i=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!Lh(n)))throw new Error(t+" contains an invalid key ("+n+") "+Ec(a)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var s,u;u=n,(s=a).parts_.length>0&&(s.byteLength_+=1),s.parts_.push(u),s.byteLength_+=Ue(u),_c(s),e(t,r,a),function(e){var t=e.parts_.pop();e.byteLength_-=Ue(t),e.parts_.length>0&&(e.byteLength_-=1)}(a)})),i&&o)throw new Error(t+' contains ".value" child '+Ec(a)+" in addition to actual children.")}},Wh=function(e,t,n,r){if((!r||void 0!==n)&&!jh(n))throw new Error(ze(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Vh=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Wh(e,t,n,r)},Gh=function(e,t){if(".info"===vc(t))throw new Error(e+" failed = Can't modify data under /.info/")},Hh=function(e,t){var n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!Lh(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),jh(e)}(n))throw new Error(ze(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Kh=q((function e(){G(this,e),this.eventLists_=[],this.recursionDepth_=0}));function qh(e,t){for(var n=null,r=0;r<t.length;r++){var a=t[r],i=a.getPath();null===n||Cc(i,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:i}),n.events.push(a)}n&&e.eventLists_.push(n)}function Xh(e,t,n){qh(e,n),Zh(e,(function(e){return Cc(e,t)}))}function Yh(e,t,n){qh(e,n),Zh(e,(function(e){return Ac(e,t)||Ac(t,e)}))}function Zh(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var a=e.eventLists_[r];if(a)t(a.path)?(Qh(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function Qh(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();pu&&mu("event: "+n.toString()),Du(r)}}}var Jh="repo_interrupt",$h=25,ed=function(){function e(t,n,r,a){G(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Kh,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Al(),this.transactionQueueTree_=new Ah,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return q(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function td(e,t,n){if(e.stats_=Zu(e.repoInfo_),e.forceRestClient_||Mu())e.server_=new Il(e.repoInfo_,(function(t,n,r,a){ad(e,t,n,r,a)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return id(e,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ae(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new Rc(e.repoInfo_,t,(function(t,n,r,a){ad(e,t,n,r,a)}),(function(t){id(e,t)}),(function(t){!function(e,t){Nu(t,(function(t,n){od(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){var n=e.toString();return Yu[n]||(Yu[n]=t()),Yu[n]}(e.repoInfo_,(function(){return new Rl(e.stats_,e.server_)})),e.infoData_=new Cl,e.infoSyncTree_=new Qf({startListening:function(t,n,r,a){var i=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(i=eh(e.infoSyncTree_,t._path,o),setTimeout((function(){a("ok")}),0)),i},stopListening:function(){}}),od(e,"connected",!1),e.serverSyncTree_=new Qf({startListening:function(t,n,r,a){return e.server_.listen(t,r,n,(function(n,r){var i=a(n,r);Yh(e.eventQueue_,t._path,i)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function nd(e){var t=e.infoData_.getNode(new dc(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function rd(e){return yh({timestamp:nd(e)})}function ad(e,t,n,r,a){e.dataUpdateCount++;var i=new dc(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(a)if(r){var s=Ne(n,(function(e){return cl(e)}));o=function(e,t,n,r){var a=hh(e,r);if(a){var i=dh(a),o=i.path,s=i.queryId,u=Ic(o,t),c=Xl.fromObject(n);return ph(e,o,new jl(Pl(s),u,c))}return[]}(e.serverSyncTree_,i,s,a)}else{var u=cl(n);o=nh(e.serverSyncTree_,i,u,a)}else if(r){var c=Ne(n,(function(e){return cl(e)}));o=function(e,t,n){var r=Xl.fromObject(n);return oh(e,new jl({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,i,c)}else{var l=cl(n);o=eh(e.serverSyncTree_,i,l)}var f=i;o.length>0&&(f=vd(e,i)),Yh(e.eventQueue_,f,o)}function id(e,t){od(e,"connected",t),!1===t&&function(e){fd(e,"onDisconnectEvents");var t=rd(e),n=Al();_l(e.onDisconnect_,pc(),(function(r,a){var i=wh(r,a,e.serverSyncTree_,t);Sl(n,r,i)}));var r=[];_l(n,pc(),(function(t,n){r=r.concat(eh(e.serverSyncTree_,t,n));var a=xd(e,t);vd(e,a)})),e.onDisconnect_=Al(),Yh(e.eventQueue_,pc(),r)}(e)}function od(e,t,n){var r=new dc("/.info/"+t),a=cl(n);e.infoData_.updateSnapshot(r,a);var i=eh(e.infoSyncTree_,r,a);Yh(e.eventQueue_,r,i)}function sd(e){return e.nextWriteId_++}function ud(e,t,n,r,a){fd(e,"set",{path:t.toString(),value:n,priority:r});var i=rd(e),o=cl(n,r),s=ah(e.serverSyncTree_,t),u=Ih(o,s,i),c=sd(e),l=Jf(e.serverSyncTree_,t,u,c,!0);qh(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),(function(n,r){var i="ok"===n;i||ku("set at "+t+" failed: "+n);var o=$f(e.serverSyncTree_,c,!i);Yh(e.eventQueue_,t,o),hd(e,a,n,r)}));var f=xd(e,t);vd(e,f),Yh(e.eventQueue_,f,[])}function cd(e,t,n){var r;r=".info"===vc(t._path)?th(e.infoSyncTree_,t,n):th(e.serverSyncTree_,t,n),Xh(e.eventQueue_,t._path,r)}function ld(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Jh)}function fd(e){var t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];mu.apply(void 0,[t].concat(r))}function hd(e,t,n,r){t&&Du((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),a=e;r&&(a+=": "+r);var i=new Error(a);i.code=e,t(i)}}))}function dd(e,t,n){return ah(e.serverSyncTree_,t,n)||ol.EMPTY_NODE}function pd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||bd(e,t),_h(t)){var n=md(e,t);$(n.length>0,"Sending zero length transaction queue"),n.every((function(e){return 0===e.status}))&&function(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),a=dd(e,t,r),i=a,o=a.hash(),s=0;s<n.length;s++){var u=n[s];$(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=Ic(t,u.path);i=i.updateChild(c,u.currentOutputSnapshotRaw)}var l=i.val(!0),f=t;e.server_.put(f.toString(),l,(function(r){fd(e,"transaction put response",{path:f.toString(),status:r});var a=[];if("ok"===r){for(var i=[],o=function(t){n[t].status=2,a=a.concat($f(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&i.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},s=0;s<n.length;s++)o(s);bd(e,Sh(e.transactionQueueTree_,t)),pd(e,e.transactionQueueTree_),Yh(e.eventQueue_,t,a);for(var u=0;u<i.length;u++)Du(i[u])}else{if("datastale"===r)for(var c=0;c<n.length;c++)3===n[c].status?n[c].status=4:n[c].status=0;else{ku("transaction at "+f.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}vd(e,t)}}),o)}(e,Rh(t),n)}else Th(t)&&Nh(t,(function(t){pd(e,t)}))}function vd(e,t){var n=gd(e,t),r=Rh(n);return function(e,t,n){if(0===t.length)return;for(var r=[],a=[],i=t.filter((function(e){return 0===e.status})),o=i.map((function(e){return e.currentWriteId})),s=function(i){var s,u,c=t[i],l=Ic(n,c.path),f=!1;if($(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)f=!0,s=c.abortReason,a=a.concat($f(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=$h)f=!0,s="maxretry",a=a.concat($f(e.serverSyncTree_,c.currentWriteId,!0));else{var h=dd(e,c.path,o);c.currentInputSnapshot=h;var d=t[i].update(h.val());if(void 0!==d){Bh("transaction failed: Data returned ",d,c.path);var p=cl(d);"object"===typeof d&&null!=d&&_e(d,".priority")||(p=p.updatePriority(h.getPriority()));var v=c.currentWriteId,g=rd(e),m=Ih(p,h,g);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=m,c.currentWriteId=sd(e),o.splice(o.indexOf(v),1),a=(a=a.concat(Jf(e.serverSyncTree_,c.path,m,c.currentWriteId,c.applyLocally))).concat($f(e.serverSyncTree_,v,!0))}else f=!0,s="nodata",a=a.concat($f(e.serverSyncTree_,c.currentWriteId,!0))}Yh(e.eventQueue_,n,a),a=[],f&&(t[i].status=2,u=t[i].unwatcher,setTimeout(u,Math.floor(0)),t[i].onComplete&&("nodata"===s?r.push((function(){return t[i].onComplete(null,!1,t[i].currentInputSnapshot)})):r.push((function(){return t[i].onComplete(new Error(s),!1,null)}))))},u=0;u<t.length;u++)s(u);bd(e,e.transactionQueueTree_);for(var c=0;c<r.length;c++)Du(r[c]);pd(e,e.transactionQueueTree_)}(e,md(e,n),r),r}function gd(e,t){var n,r=e.transactionQueueTree_;for(n=vc(t);null!==n&&void 0===_h(r);)r=Sh(r,n),n=vc(t=mc(t));return r}function md(e,t){var n=[];return yd(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function yd(e,t,n){var r=_h(t);if(r)for(var a=0;a<r.length;a++)n.push(r[a]);Nh(t,(function(t){yd(e,t,n)}))}function bd(e,t){var n=_h(t);if(n){for(var r=0,a=0;a<n.length;a++)2!==n[a].status&&(n[r]=n[a],r++);n.length=r,Eh(t,n.length>0?n:void 0)}Nh(t,(function(t){bd(e,t)}))}function xd(e,t){var n=Rh(gd(e,t)),r=Sh(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){kd(e,t)})),kd(e,r),Oh(r,(function(t){kd(e,t)})),n}function kd(e,t){var n=_h(t);if(n){for(var r=[],a=[],i=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?($(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):($(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),a=a.concat($f(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===i?Eh(t,void 0):n.length=i+1,Yh(e.eventQueue_,Rh(t),a);for(var s=0;s<r.length;s++)Du(r[s])}}var wd=function(e,t){var n=Id(e),r=n.namespace;"firebase.com"===n.domain&&xu(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||xu("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ku("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var a="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Hu(n.host,n.secure,r,a,t,"",r!==n.subdomain),path:new dc(n.pathString)}},Id=function(e){var t="",n="",r="",a="",i="",o=!0,s="https",u=443;if("string"===typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var f=e.indexOf("?");-1===f&&(f=e.length),t=e.substring(0,Math.min(l,f)),l<f&&(a=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var a=n[r];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch(i){}t+="/"+a}return t}(e.substring(l,f)));var h=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=U(e.split("&"));try{for(r.s();!(n=r.n()).done;){var a=n.value;if(0!==a.length){var i=a.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ku("Invalid query segment '".concat(a,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,f)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=t.indexOf(".");r=t.substring(0,p).toLowerCase(),n=t.substring(p+1),i=r}"ns"in h&&(i=h.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:o,scheme:s,pathString:a,namespace:i}},Cd="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Ad=function(){var e=0,t=[];return function(n){var r,a=n===e;e=n;var i=new Array(8);for(r=7;r>=0;r--)i[r]=Cd.charAt(n%64),n=Math.floor(n/64);$(0===n,"Cannot push at time == 0");var o=i.join("");if(a){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)o+=Cd.charAt(t[r]);return $(20===o.length,"nextPushId: Length should be 20."),o}}(),Sd=function(){function e(t,n,r,a){G(this,e),this.eventType=t,this.eventRegistration=n,this.snapshot=r,this.prevName=a}return q(e,[{key:"getPath",value:function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}},{key:"getEventType",value:function(){return this.eventType}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.getPath().toString()+":"+this.eventType+":"+Ae(this.snapshot.exportVal())}}]),e}(),_d=function(){function e(t,n,r){G(this,e),this.eventRegistration=t,this.error=n,this.path=r}return q(e,[{key:"getPath",value:function(){return this.path}},{key:"getEventType",value:function(){return"cancel"}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.path.toString()+":cancel"}}]),e}(),Ed=function(){function e(t,n){G(this,e),this.snapshotCallback=t,this.cancelCallback=n}return q(e,[{key:"onValue",value:function(e,t){this.snapshotCallback.call(null,e,t)}},{key:"onCancel",value:function(e){return $(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}},{key:"hasCancelCallback",get:function(){return!!this.cancelCallback}},{key:"matches",value:function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}]),e}(),Td=function(){function e(t,n,r,a){G(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=a}return q(e,[{key:"key",get:function(){return wc(this._path)?null:yc(this._path)}},{key:"ref",get:function(){return new Nd(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=wl(this._queryParams),t=Eu(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return wl(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=Be(t))instanceof e))return!1;var n=this._repo===t._repo,r=Cc(this._path,t._path),a=this._queryIdentifier===t._queryIdentifier;return n&&r&&a}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}();var Nd=function(e){F(n,e);var t=z(n);function n(e,r){return G(this,n),t.call(this,e,r,new xl,!1)}return q(n,[{key:"parent",get:function(){var e=xc(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(Td),Od=function(){function e(t,n,r){G(this,e),this._node=t,this.ref=n,this._index=r}return q(e,[{key:"priority",get:function(){return this._node.getPriority().val()}},{key:"key",get:function(){return this.ref.key}},{key:"size",get:function(){return this._node.numChildren()}},{key:"child",value:function(t){var n=new dc(t),r=Pd(this.ref,t);return new e(this._node.getChild(n),r,el)}},{key:"exists",value:function(){return!this._node.isEmpty()}},{key:"exportVal",value:function(){return this._node.val(!0)}},{key:"forEach",value:function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,a){return t(new e(a,Pd(n.ref,r),el))}))}},{key:"hasChild",value:function(e){var t=new dc(e);return!this._node.getChild(t).isEmpty()}},{key:"hasChildren",value:function(){return!this._node.isLeafNode()&&!this._node.isEmpty()}},{key:"toJSON",value:function(){return this.exportVal()}},{key:"val",value:function(){return this._node.val()}}]),e}();function Rd(e,t){return(e=Be(e))._checkNotDeleted("ref"),void 0!==t?Pd(e._root,t):e._root}function Pd(e,t){return null===vc((e=Be(e))._path)?Vh("child","path",t,!1):Wh("child","path",t,!1),new Nd(e._repo,kc(e._path,t))}function Dd(e,t){e=Be(e),Gh("push",e._path),Uh("push",t,e._path,!0);var n,r=nd(e._repo),a=Ad(r),i=Pd(e,a),o=Pd(e,a);return n=null!=t?Fd(o,t).then((function(){return o})):Promise.resolve(o),i.then=n.then.bind(n),i.catch=n.then.bind(n,void 0),i}function Md(e){return Gh("remove",e._path),Fd(e,null)}function Fd(e,t){e=Be(e),Gh("set",e._path),Uh("set",t,e._path,!1);var n=new pe;return ud(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function Ld(e){e=Be(e);var t=new Ed((function(){})),n=new jd(t);return function(e,t,n){var r=ih(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((function(r){var a,i=cl(r).withIndex(t._queryParams.getIndex());if(rh(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())a=eh(e.serverSyncTree_,t._path,i);else{var o=lh(e.serverSyncTree_,t);a=nh(e.serverSyncTree_,t._path,i,o)}return Yh(e.eventQueue_,t._path,a),th(e.serverSyncTree_,t,n,null,!0),i}),(function(n){return fd(e,"get for query "+Ae(t)+" failed: "+n),Promise.reject(new Error(n))}))}(e._repo,e,n).then((function(t){return new Od(t,new Nd(e._repo,e._path),e._queryParams.getIndex())}))}var jd=function(){function e(t){G(this,e),this.callbackContext=t}return q(e,[{key:"respondsTo",value:function(e){return"value"===e}},{key:"createEvent",value:function(e,t){var n=t._queryParams.getIndex();return new Sd("value",this,new Od(e.snapshotNode,new Nd(t._repo,t._path),n))}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new _d(this,e,t):null}},{key:"matches",value:function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}},{key:"hasAnyCallback",value:function(){return null!==this.callbackContext}}]),e}(),zd=function(){function e(t,n){G(this,e),this.eventType=t,this.callbackContext=n}return q(e,[{key:"respondsTo",value:function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new _d(this,e,t):null}},{key:"createEvent",value:function(e,t){$(null!=e.childName,"Child events should have a childName.");var n=Pd(new Nd(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Sd(e.type,this,new Od(e.snapshotNode,n,r),e.prevName)}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}}},{key:"matches",value:function(t){return t instanceof e&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))}},{key:"hasAnyCallback",value:function(){return!!this.callbackContext}}]),e}();function Ud(e,t,n,r,a){var i;if("object"===typeof r&&(i=void 0,a=r),"function"===typeof r&&(i=r),a&&a.onlyOnce){var o=n,s=function(t,n){cd(e._repo,e,c),o(t,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new Ed(n,i||void 0),c="value"===t?new jd(u):new zd(t,u);return function(e,t,n){var r;r=".info"===vc(t._path)?rh(e.infoSyncTree_,t,n):rh(e.serverSyncTree_,t,n),Xh(e.eventQueue_,t._path,r)}(e._repo,e,c),function(){return cd(e._repo,e,c)}}function Bd(e,t,n,r){return Ud(e,"value",t,n,r)}!function(e){$(!Of,"__referenceConstructor has already been defined"),Of=e}(Nd),function(e){$(!jf,"__referenceConstructor has already been defined"),jf=e}(Nd);var Wd="FIREBASE_DATABASE_EMULATOR_HOST",Vd={},Gd=!1;function Hd(e,t,n,r,a){var i=r||e.options.databaseURL;void 0===i&&(e.options.projectId||xu("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),mu("Using default host for project ",e.options.projectId),i="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,s=wd(i,a),u=s.repoInfo,c=void 0;"undefined"!==typeof process&&(c={NODE_ENV:"production",PUBLIC_URL:"/redflix-public",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[Wd]),c?(o=!0,i="http://".concat(c,"?ns=").concat(u.namespace),u=(s=wd(i,a)).repoInfo):o=!s.repoInfo.secure;var l=a&&o?new zu(zu.OWNER):new ju(e.name,e.options,t);Hh("Invalid Firebase Database URL",s),wc(s.path)||xu("Database URL must point to the root of a Firebase Database (not including a child path).");var f=function(e,t,n,r){var a=Vd[t.name];a||(a={},Vd[t.name]=a);var i=a[e.toURLString()];i&&xu("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return i=new ed(e,Gd,n,r),a[e.toURLString()]=i,i}(u,e,l,new Lu(e.name,n));return new Kd(f,e)}var Kd=function(){function e(t,n){G(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return q(e,[{key:"_repo",get:function(){return this._instanceStarted||(td(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new Nd(this._repo,pc())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(!function(e,t){var n=Vd[t];n&&n[e.key]===e||xu("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),ld(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&xu("Cannot call "+e+" on a deleted database.")}}]),e}();function qd(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=Be(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&xu("Cannot call useEmulator() after instance has already been initialized.");var a=e._repoInternal,i=void 0;if(a.repoInfo_.nodeAdmin)r.mockUserToken&&xu('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new zu(zu.OWNER);else if(r.mockUserToken){var o="string"===typeof r.mockUserToken?r.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ae(JSON.stringify({alg:"none",type:"JWT"})),ae(JSON.stringify(i)),""].join(".")}(r.mockUserToken,e.app.options.projectId);i=new zu(o)}!function(e,t,n,r){e.repoInfo_=new Hu("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(a,t,n,i)}var Xd=function(){function e(t,n){G(this,e),this.committed=t,this.snapshot=n}return q(e,[{key:"toJSON",value:function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),e}();function Yd(e,t,n){var r;if(e=Be(e),Gh("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var a=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,i=new pe,o=Bd(e,(function(){}));return function(e,t,n,r,a,i){fd(e,"transaction on "+t);var o={path:t,update:n,onComplete:r,status:null,order:fu(),applyLocally:i,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=dd(e,t,void 0);o.currentInputSnapshot=s;var u=o.update(s.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Bh("transaction failed: Data returned ",u,o.path),o.status=0;var c,l=Sh(e.transactionQueueTree_,t),f=_h(l)||[];f.push(o),Eh(l,f),"object"===typeof u&&null!==u&&_e(u,".priority")?(c=Ee(u,".priority"),$(zh(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):c=(ah(e.serverSyncTree_,t)||ol.EMPTY_NODE).getPriority().val();var h=rd(e),d=cl(u,c),p=Ih(d,s,h);o.currentOutputSnapshotRaw=d,o.currentOutputSnapshotResolved=p,o.currentWriteId=sd(e);var v=Jf(e.serverSyncTree_,t,p,o.currentWriteId,o.applyLocally);Yh(e.eventQueue_,t,v),pd(e,e.transactionQueueTree_)}}(e._repo,e._path,t,(function(t,n,r){var a=null;t?i.reject(t):(a=new Od(r,new Nd(e._repo,e._path),el),i.resolve(new Xd(n,a)))}),o,a),i.promise}Rc.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Rc.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){!function(e){au=e}(Mt),Nt(new We("database",(function(e,t){var n=t.instanceIdentifier;return Hd(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),jt(nu,ru,e),jt(nu,ru,"esm2017")}();n(8180);var Zd=function(){function e(t,n){G(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return q(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),Qd=function(){function e(){G(this,e)}return q(e,[{key:"refCount",value:function(e){return Jd("refCount")}},{key:"incRef",value:function(e){return Jd("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return Jd("time")}},{key:"read",value:function(e){return Jd("read")}},{key:"readSync",value:function(e){return Jd("readSync")}},{key:"readToGPU",value:function(e,t){return Jd("readToGPU")}},{key:"numDataIds",value:function(){return Jd("numDataIds")}},{key:"disposeData",value:function(e,t){return Jd("disposeData")}},{key:"write",value:function(e,t,n){return Jd("write")}},{key:"move",value:function(e,t,n,r,a){return Jd("move")}},{key:"createTensorFromGPUData",value:function(e,t,n){return Jd("createTensorFromGPUData")}},{key:"memory",value:function(){return Jd("memory")}},{key:"floatPrecision",value:function(){return Jd("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return Jd("dispose")}}]),e}();function Jd(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function $d(e){for(var t=e.length,n=0;t>0;)n=Math.random()*t|0,np(e,--t,n)}function ep(e,t,n){return Math.max(e,Math.min(t,n))}function tp(e){return e%2===0?e:e+1}function np(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function rp(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function ap(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function ip(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";ap(up(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function op(e){ap(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function sp(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function up(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function cp(e){return e%1===0}function lp(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function fp(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function hp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((function(a,i){var o=0;!function s(){if(e())a();else{o++;var u=t(o);null!=n&&o>=n?i():null!=r?r(s,u):setTimeout(s,u)}}()}))}function dp(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function pp(e,t){var n=t.length;return e=null==e?t.map((function(e,t){return t})):[].concat(e),ap(e.every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),ap(e.every((function(e){return cp(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function vp(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:pp(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function gp(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function mp(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function yp(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function bp(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function xp(e){return"string"===typeof e||e instanceof String}function kp(e){return"number"===typeof e}function wp(e){return Array.isArray(e)?wp(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":kp(e)?"float32":xp(e)?"string":function(e){return"boolean"===typeof e}(e)?"bool":"float32"}function Ip(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Cp(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function Ap(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Sp(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===t.length)for(var i=t[0]*(r?2:1),o=0;o<i;o++)a[o]=n[e+o];else for(var s=t[0],u=t.slice(1),c=u.reduce((function(e,t){return e*t}))*(r?2:1),l=0;l<s;l++)a[l]=Sp(e+l*c,u,n,r);return a}function _p(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];var r=e.reduce((function(e,t){return e*t}))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return Sp(0,e,t,n)}function Ep(e,t){for(var n=Tp(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Tp(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function Np(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return _p(e,new Float32Array(n));if("int32"===t)return _p(e,new Int32Array(n));if("bool"===t)return _p(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function Op(e){e.forEach((function(t){ap(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function Rp(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function Pp(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Dp(e){return e&&e.then&&"function"===typeof e.then}var Mp="tfjsflags",Fp=function(){function e(t){G(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Lp,this.populateURLFlags()}return q(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&(jp().getBool("IS_TEST")||jp().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];jp().getBool("IS_TEST")||jp().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(Dp(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=this.getQueryParams(this.global.location.search);if(Mp in t)t[Mp].split(",").forEach((function(t){var n=E(t.split(":"),2),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(r,a)}))}}}]),e}();function Lp(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")})),t}function jp(){return Up}var zp,Up=null;function Bp(){if(null==zp){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}zp=e}return zp}function Wp(e,t){var n=function(){var e=Bp();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}var Vp="Abs",Gp="Acos",Hp="Acosh",Kp="Add",qp="AddN",Xp="All",Yp="Any",Zp="ArgMax",Qp="ArgMin",Jp="Asin",$p="Asinh",ev="Atan",tv="Atanh",nv="Atan2",rv="AvgPool",av="AvgPoolGrad",iv="AvgPool3D",ov="AvgPool3DGrad",sv="BatchMatMul",uv="BatchToSpaceND",cv="Bincount",lv="BroadcastArgs",fv="Cast",hv="Ceil",dv="ClipByValue",pv="Complex",vv="ComplexAbs",gv="Concat",mv="Conv2D",yv="Conv2DBackpropFilter",bv="Conv2DBackpropInput",xv="Conv3D",kv="Conv3DBackpropFilterV2",wv="Conv3DBackpropInputV2",Iv="Cos",Cv="Cosh",Av="Cumprod",Sv="Cumsum",_v="CropAndResize",Ev="DenseBincount",Tv="DepthToSpace",Nv="DepthwiseConv2dNative",Ov="DepthwiseConv2dNativeBackpropFilter",Rv="DepthwiseConv2dNativeBackpropInput",Pv="Diag",Dv="Dilation2D",Mv="Dilation2DBackpropInput",Fv="Dilation2DBackpropFilter",Lv="RealDiv",jv="Einsum",zv="Elu",Uv="EluGrad",Bv="Erf",Wv="Equal",Vv="Exp",Gv="ExpandDims",Hv="Expm1",Kv="FFT",qv="Fill",Xv="FlipLeftRight",Yv="Floor",Zv="FloorDiv",Qv="FusedBatchNorm",Jv="GatherV2",$v="GatherNd",eg="Greater",tg="GreaterEqual",ng="Identity",rg="IFFT",ag="Imag",ig="IsFinite",og="IsInf",sg="IsNan",ug="LeakyRelu",cg="Less",lg="LessEqual",fg="LinSpace",hg="Log",dg="Log1p",pg="LogicalAnd",vg="LogicalNot",gg="LogicalOr",mg="LRN",yg="LRNGrad",bg="Max",xg="Maximum",kg="MaxPool",wg="MaxPoolGrad",Ig="MaxPool3D",Cg="MaxPool3DGrad",Ag="MaxPoolWithArgmax",Sg="Mean",_g="Min",Eg="Minimum",Tg="MirrorPad",Ng="Mod",Og="Multinomial",Rg="Multiply",Pg="Neg",Dg="NotEqual",Mg="NonMaxSuppressionV3",Fg="NonMaxSuppressionV4",Lg="NonMaxSuppressionV5",jg="OnesLike",zg="OneHot",Ug="Pack",Bg="PadV2",Wg="Pow",Vg="Prelu",Gg="Prod",Hg="RaggedGather",Kg="RaggedRange",qg="RaggedTensorToTensor",Xg="Range",Yg="Real",Zg="Reciprocal",Qg="Relu",Jg="Reshape",$g="ResizeNearestNeighbor",em="ResizeNearestNeighborGrad",tm="ResizeBilinear",nm="ResizeBilinearGrad",rm="Relu6",am="Reverse",im="Round",om="Rsqrt",sm="ScatterNd",um="SearchSorted",cm="Select",lm="Selu",fm="Slice",hm="Sin",dm="Sinh",pm="Sign",vm="Sigmoid",gm="Softplus",mm="Sqrt",ym="Sum",bm="SpaceToBatchND",xm="SplitV",km="Softmax",wm="SparseFillEmptyRows",Im="SparseReshape",Cm="SparseSegmentMean",Am="SparseSegmentSum",Sm="SparseToDense",_m="SquaredDifference",Em="Square",Tm="StridedSlice",Nm="StringNGrams",Om="StringSplit",Rm="StringToHashBucketFast",Pm="Sub",Dm="Tan",Mm="Tanh",Fm="Tile",Lm="TopK",jm="Transform",zm="Transpose",Um="Unique",Bm="Unpack",Wm="UnsortedSegmentSum",Vm="ZerosLike",Gm="Step",Hm="RotateWithOffset",Km="_FusedMatMul",qm="FusedConv2D",Xm="FusedDepthwiseConv2D";function Ym(){var e;jp().getBool("IS_TEST")||jp().getBool("PROD")||(e=console).warn.apply(e,arguments)}var Zm=Wp("kernelRegistry",(function(){return new Map})),Qm=Wp("gradRegistry",(function(){return new Map}));function Jm(e,t){var n=ry(e,t);return Zm.get(n)}function $m(e){return Qm.get(e)}function ey(e){for(var t=Zm.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=E(i,2),s=o[0],u=o[1];E(s.split("_"),1)[0]===e&&n.push(u)}return n}function ty(e){var t=e.kernelName,n=e.backendName,r=ry(t,n);Zm.has(r)&&Ym("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),Zm.set(r,e)}function ny(e){var t=e.kernelName;Qm.has(t)&&jp().getBool("DEBUG")&&Ym("Overriding the gradient for '".concat(t,"'")),Qm.set(t,e)}function ry(e,t){return"".concat(t,"_").concat(e)}var ay=n(2957),iy=n.n(ay)()||ay;function oy(e){return iy.fromString(e,!0,16)}var sy=oy("c3a5c85c97cb3127"),uy=oy("b492b66fbe98f273"),cy=oy("9ae16a3b2f90404f");function ly(e){return e.xor(e.shru(47))}function fy(e,t,n){var r=e.slice(t,t+n);return iy.fromBytes(Array.from(r),!0,!0)}function hy(e,t){return fy(e,t,8)}function dy(e,t){return fy(e,t,4)}function py(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function vy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:oy("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));var a=t.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function gy(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=py(i.add(a).add(r),21);var o=a;return a=(a=a.add(t)).add(n),i=i.add(py(a,44)),[a.add(r),i.add(o)]}(hy(e,t),hy(e,t+8),hy(e,t+16),hy(e,t+24),n,r)}function my(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=iy.fromNumber(81,!0);if(t<=32)return t<=16?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){var n=cy.add(2*t),r=hy(e,0).add(cy),a=hy(e,t-8);return vy(py(a,37).mul(n).add(r),py(r,25).add(a).mul(n),n)}if(t>=4){var i=cy.add(2*t);return vy(dy(e,0).shl(3).add(t),dy(e,t-4),i)}if(t>0){var o=e[0]+(e[t>>1]<<8),s=t+(e[t-1]<<2);return ly(cy.mul(o).xor(sy.mul(s))).mul(cy)}return cy}(e,t):function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=cy.add(2*t),r=hy(e,0).mul(uy),a=hy(e,8),i=hy(e,t-8).mul(n),o=hy(e,t-16).mul(cy);return vy(py(r.add(a),43).add(py(i,30)).add(o),r.add(py(a.add(cy),18)).add(i),n)}(e,t);if(t<=64)return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=cy.add(2*t),r=hy(e,0).mul(cy),a=hy(e,8),i=hy(e,t-8).mul(n),o=hy(e,t-16).mul(cy),s=py(r.add(a),43).add(py(i,30)).add(o),u=vy(s,r.add(py(a.add(cy),18)).add(i),n),c=hy(e,16).mul(n),l=hy(e,24),f=s.add(hy(e,t-32)).mul(n),h=u.add(hy(e,t-24)).mul(n);return vy(py(c.add(l),43).add(py(f,30)).add(h),c.add(py(l.add(r),18)).add(f),n)}(e,t);var r=n,a=n.mul(uy).add(113),i=ly(a.mul(cy).add(113)).mul(cy),o=[iy.UZERO,iy.UZERO],s=[iy.UZERO,iy.UZERO];r=r.mul(cy).add(hy(e,0));var u=0,c=64*(t-1>>6),l=c+(t-1&63)-63;do{r=py(r.add(a).add(o[0]).add(hy(e,u+8)),37).mul(uy),a=py(a.add(o[1]).add(hy(e,u+48)),42).mul(uy),r=r.xor(s[1]),a=a.add(o[0]).add(hy(e,u+40)),i=py(i.add(s[0]),33).mul(uy),o=gy(e,u,o[1].mul(uy),r.add(s[0])),s=gy(e,u+32,i.add(s[1]),a.add(hy(e,u+16)));var f=[r,i];i=f[0],r=f[1],u+=64}while(u!==c);var h=uy.add(i.and(255).shl(1));u=l,s[0]=s[0].add(t-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=py(r.add(a).add(o[0]).add(hy(e,u+8)),37).mul(h),a=py(a.add(o[1]).add(hy(e,u+48)),42).mul(h),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(hy(e,u+40))),i=py(i.add(s[0]),33).mul(h),o=gy(e,u,o[1].mul(h),r.add(s[0])),s=gy(e,u+32,i.add(s[1]),a.add(hy(e,u+16)));var d=[r,i];return i=d[0],r=d[1],vy(vy(o[0],s[0],h).add(ly(a).mul(sy)).add(i),vy(o[1],s[1],h).add(r),h)}function yy(e,t){return"string"===t?ky(e):by([e],t)}function by(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Cy(e)),jp().getBool("DEBUG")&&function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),r=0;r<n.length;++r)0!==Math.round(e[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(t))}function xy(){return jp().platform.now()}function ky(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",jp().platform.encode(e,t)}function wy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",jp().platform.decode(e,t)}function Iy(e){return jp().platform.isTypedArray(e)}function Cy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||Dp(e)||null==e||Iy(e)&&n)t.push(e);else if(Array.isArray(e)||Iy(e))for(var r=0;r<e.length;++r)Cy(e[r],t,n);else{for(var a=-1,i=0,o=Object.keys(e);i<o.length;i++){var s=o[i];/^([1-9]+[0-9]*|0)$/.test(s)&&(a=Math.max(a,Number(s)))}for(var u=0;u<=a;u++)Cy(e[u],t,n)}return t}var Ay=function(){function e(t,n){G(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new Sy)}return q(e,[{key:"profileKernel",value:function(e,t,n){var r,a,i=function(){r=n()},o=xy();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();var s,u=U(r);try{for(u.s();!(s=u.n()).done;){s.value.dataSync()}}catch(f){u.e(f)}finally{u.f()}a=Promise.resolve({kernelMs:xy()-o})}if(jp().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var c=function(){var t=r[l];t.data().then((function(n){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(n,t.dtype,e)}))},l=0;l<r.length;l++)c();return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((function(e){return e.kernelMs})),extraInfo:a.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var Sy=function(){function e(){G(this,e)}return q(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?fp("".concat(r,"ms"),9):r.error,s=fp(e,25),u=t.rank,c=t.size,l=fp(t.shape.toString(),14),f="";for(var h in a){var d=a[h];if(null!=d){var p=d.shape||t.shape,v=p.length;f+="".concat(h,": ").concat(v,"D ").concat(v>0?p:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(f,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();var _y=20,Ey=3,Ty=7;function Ny(e,t,n,r){var a=Ap(t),i=function(e,t,n,r){var a=sp(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?Dy(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,f=0;f<i;f++)o[f]=Math.max(o[f],Oy(u[l+f],0,n).length);return o}(e,t,n,a),o=t.length,s=Py(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function Oy(e,t,n){return fp(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(Ty))," + ")+"".concat(parseFloat(e[1].toFixed(Ty)),"j"):xp(e)?"'".concat(e,"'"):"bool"===n?Ry(e):parseFloat(e.toFixed(Ty)).toString(),t)}function Ry(e){return 0===e?"false":"true"}function Py(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=t[0],u=t.length;if(0===u)return"complex64"===n?[Oy(Dy(e)[0],0,n)]:"bool"===n?[Ry(e[0])]:[e[0].toString()];if(1===u){if(s>_y){var c=Ey*o,l=Array.from(e.slice(0,c)),f=Array.from(e.slice((s-Ey)*o,s*o));return"complex64"===n&&(l=Dy(l),f=Dy(f)),["["+l.map((function(e,t){return Oy(e,a[t],n)})).join(", ")+", ..., "+f.map((function(e,t){return Oy(e,a[s-Ey+t],n)})).join(", ")+"]"]}return["["+("complex64"===n?Dy(e):Array.from(e)).map((function(e,t){return Oy(e,a[t],n)})).join(", ")+"]"]}var h=t.slice(1),d=r.slice(1),p=r[0]*o,v=[];if(s>_y){for(var g=0;g<Ey;g++){var m=g*p,y=m+p;v.push.apply(v,X(Py(e.slice(m,y),h,n,d,a,!1)))}v.push("...");for(var b=s-Ey;b<s;b++){var x=b*p,k=x+p;v.push.apply(v,X(Py(e.slice(x,k),h,n,d,a,b===s-1)))}}else for(var w=0;w<s;w++){var I=w*p,C=I+p;v.push.apply(v,X(Py(e.slice(I,C),h,n,d,a,w===s-1)))}var A=2===u?",":"";v[0]="["+(s>0?v[0]+A:"");for(var S=1;S<v.length-1;S++)v[S]=" "+v[S]+A;for(var _=",\n",E=2;E<u;E++)_+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(i?"":_),v}function Dy(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var My=function(){function e(t,n,r){var a=this;if(G(this,e),this.dtype=n,this.shape=t.slice(),this.size=sp(t),null!=r){var i=r.length;ap(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||mp(n,this.size),this.strides=Ap(t)}return q(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),ap(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return Fy().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),Fy=null,Ly=null;var jy=function(){function e(t,n,r,a){G(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=sp(t),this.strides=Ap(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return q(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Ly.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return Ly.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",_p(this.shape,t,"complex64"===this.dtype));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return _p(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var e=V(B().mark((function e(){var t,n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=Fy().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return wy(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataToGPU",value:function(e){return this.throwIfDisposed(),Fy().readToGPU(this.dataId,e)}},{key:"dataSync",value:function(){this.throwIfDisposed();var e=Fy().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return wy(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,Fy().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(Fy().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Ly.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),Ly.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Ny(this.dataSync(),this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),Ly.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),Fy().makeVariable(this,e,t,n)}}]),e}();function zy(){return Wp("Tensor",(function(){return jy}))}Object.defineProperty(jy,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),zy();var Uy,By,Wy,Vy,Gy,Hy=function(e){F(n,e);var t=z(n);function n(e,r,a,i){var o;return G(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return q(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!up(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));Fy().disposeTensor(this),this.dataId=e.dataId,Fy().incRef(this,null)}},{key:"dispose",value:function(){Fy().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(jy);Object.defineProperty(Hy,Symbol.hasInstance,{value:function(e){return e instanceof jy&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Uy||(Uy={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(By||(By={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Wy||(Wy={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Vy||(Vy={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Gy||(Gy={}));var Ky={float32:Vy,int32:By,bool:Wy,complex64:Gy};function qy(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return Ky[e][t]}function Xy(e){return qy(e,"int32")}function Yy(e,t){if(e.dtype===t.dtype)return[e,t];var n=qy(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Zy(e,t){return t.some((function(t){return t.id===e.id}))}function Qy(e){var t=[];return Jy(e,t,new Set),t}function Jy(e,t,n){if(null!=e)if(e instanceof jy)t.push(e);else if(r=e,Array.isArray(r)||"object"===typeof r){var r,a=e;for(var i in a){var o=a[i];n.has(o)||(n.add(o),Jy(o,t,n))}}}function $y(e){return null!=e.kernelName}var eb=function(){function e(){G(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return q(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),tb=function(){function e(t){G(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new eb}return q(e,[{key:"ready",value:function(){var e=V(B().mark((function e(){var t,n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(Ym("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Ay(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;ey(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;ey(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof Qd||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,Ym("Initialization of backend ".concat(e," failed")),Ym(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return Ym("Initialization of backend ".concat(e," failed")),Ym(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=ab.runKernel(ng,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return ab.runKernel(fv,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(null==this.backendName&&this.backend,!(null!=Jm(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=$y(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if($y(e)){var l=e.kernelName,f=e.inputs,h=e.attrs;null==this.backendName&&this.backend;var d=Jm(l,this.backendName);ap(null!=d,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=d.kernelFunc({inputs:f,attrs:h,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){return null!=e.rank?e:a.makeTensorFromTensorInfo(e)}));if(o){var s=a.getTensorsForGradient(l,f,n);i=a.saveTensorsForBackwardMode(s)}return n}}else{var p=e.forwardFunc,v=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return p(a.backend,v)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,e,t),t}}var g,m=e.inputs,y=e.attrs,b=$y(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(g=a.profiler.profileKernel(c,m,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(g),t=g.outputs):t=n()})),o&&this.addTapeNode(c,m,t,b,i,y),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(m).map((function(e){return null!=m[e]?m[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=$m(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(ap(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&xp(e[0])&&(a=e.map((function(e){return ky(e)})));var i=r.write(a,t,n),o=new jy(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=function(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}},{key:"makeTensorFromTensorInfo",value:function(e,t){var n=e.dataId,r=e.shape,a=e.dtype,i=new jy(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new Hy(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*bp(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Hy||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*bp(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=V(B().mark((function e(t){var n,r,a,i,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,X(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,a=U(this.state.activeProfile.kernels),e.prev=12,a.s();case 14:if((i=a.n()).done){e.next=24;break}return o=i.value,e.next=18,o.kernelTimeMs;case 18:return o.kernelTimeMs=e.sent,e.next=21,o.extraInfo;case 21:o.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),a.e(e.t0);case 29:return e.prev=29,a.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=$m(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=Tp(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=Qy(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(ap(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));ap(i instanceof jy,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var c in u){for(var l=u[c],f=!1,h=0;h<t.length;h++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),f=!0,a[s.id]=!0;break}if(f)break}}var d={};d[n.id]=!0;for(var p={},v=e.length-1;v>=0;v--)for(var g=e[v],m=g.inputs,y=0;y<g.outputs.length;y++)if(d[g.outputs[y].id]){for(var b in m)d[m[b].id]=!0,p[g.id]=!0;break}for(var x=[],k=0;k<e.length;k++){var w=e[k];if(a[w.id]&&p[w.id]){var I={};for(var C in w.inputs){var A=w.inputs[C];r[A.id]&&(I[C]=A)}var S=Object.assign({},w);S.inputs=I,S.outputs=w.outputs,x.push(S)}}return x}(this.state.activeTape,t,i);if(!a&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[i.id]=null==n?function(e){var t=Ep(sp(e),"float32");return ab.makeTensor(t,e,"float32")}(i.shape):n,function(e,t,n,r){for(var a=function(){var a=t[i],o=[];if(a.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var s=a.gradient(o),u=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var i=n((function(){return s[t]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=a.inputs[t];if(!up(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=i;else{var u=e[o.id];e[o.id]=r(u,i),u.dispose()}};for(var c in a.inputs)u(c)},i=t.length-1;i>=0;i--)a()}(e,o,(function(e){return r.tidy(e)}),ib);var a=t.map((function(t){return e[t.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=U(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:i,grads:a}}))}},{key:"customGrad",value:function(e){var t=this;return ap(Ip(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;ap(r.every((function(e){return e instanceof jy})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));return t.runKernelFunc({forwardFunc:function(t,n){return ap((i=e.apply(void 0,[].concat(r,[n]))).value instanceof jy,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),ap(Ip(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},backwardsFunc:function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];ap(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),ap(a.every((function(e){return e instanceof jy})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o},inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"readToGPU",value:function(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}},{key:"time",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=xy(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=xy()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new eb,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function nb(){var e=Bp();if(null==e._tfengine){var t=new Fp(e);e._tfengine=new tb(t)}return function(e){Up=e}(e._tfengine.ENV),function(e){Fy=e}((function(){return e._tfengine})),e._tfengine}tb.nextTensorId=0,tb.nextVariableId=0;var rb,ab=nb();function ib(e,t){var n={a:e,b:t};return ab.runKernel(Kp,n)}function ob(e){if(void 0!==rb)return rb;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;var t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){var n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function sb(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var ub=jp();function cb(e,t){var n=e;if(Iy(e))return"string"===t?[]:[e.length];if("object"===typeof e){if("texture"in e){var r=e.channels||"RGBA";return[e.height,e.width*r.length]}if("buffer"in e&&!(e.buffer instanceof ArrayBuffer))return[e.buffer.size/(null==t?4:bp(t))]}if(!Array.isArray(e))return[];for(var a=[];Array.isArray(n)||Iy(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&jp().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&lb(e,a,[]),a}function lb(e,t,n){if(n=n||[],Array.isArray(e)||Iy(e)){ap(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),ap(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)lb(e[a],r,n.concat(a))}else ap(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function fb(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function hb(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof jy)return fb(r,e.dtype,t,n),e;var a=wp(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),fb(r,a,t,n),null==e||!Iy(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(i,"'"))}var o=cb(e,a);Iy(e)||Array.isArray(e)||(e=[e]);var s="string"!==a?by(e,a):Cy(e,[],!0);return ab.makeTensor(s,o,a)}function db(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((function(e,a){return hb(e,"".concat(t,"[").concat(a,"]"),n,r)}))}ub.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),ub.registerFlag("IS_BROWSER",(function(){return sb()})),ub.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),ub.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),ub.registerFlag("PROD",(function(){return!1})),ub.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return ub.getBool("DEBUG")})),ub.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),ub.registerFlag("IS_TEST",(function(){return!1})),ub.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),ub.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),ub.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),ub.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));var pb="__op";function vb(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=pb;var a=function(){ab.startScope(n);try{var e=r.apply(void 0,arguments);return Dp(e)&&console.error("Cannot return a Promise inside of tidy."),ab.endScope(e),e}catch(t){throw ab.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var gb=vb({complex_:function(e,t){var n=hb(e,"real","complex"),r=hb(t,"imag","complex");ip(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var a={real:n,imag:r};return ab.runKernel(pv,a)}});function mb(e,t,n,r){if(null==r)r=wp(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if("object"===typeof e&&("texture"in e||"buffer"in e&&!(e.buffer instanceof ArrayBuffer))){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return ab.backend.createTensorFromGPUData(e,t||n,r)}if(!Iy(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Op(t);var a=sp(t),i=sp(n);ap(a===i,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(a," values but has ").concat(i)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==sp(t.slice(o));ap(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return Iy(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?by(e,r):Cy(e,[],!0),ab.makeTensor(e,t,r)}function yb(e,t,n){return mb(e,t,cb(e,n),n)}var bb={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},xb=4;function kb(e,t){return wb.apply(this,arguments)}function wb(){return wb=V(B().mark((function e(t,n){var r,a,i,o,s,u;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=B().mark((function e(){var o,u,c,l;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i[s],"float32"===(u=Array.isArray(t)?t[s].tensor:t[o]).dtype||"int32"===u.dtype||"bool"===u.dtype||"string"===u.dtype||"complex64"===u.dtype){e.next=4;break}throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(u.dtype));case 4:c={name:o,shape:u.shape,dtype:u.dtype},"string"===u.dtype?(l=new Promise(function(){var e=V(B().mark((function e(t){var n,r,a,i,o,s,c;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+xb*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)s=n[o],c=new Uint8Array(new Uint32Array([s.length]).buffer),a.set(c,i),i+=xb,a.set(s,i),i+=s.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.push(l)):a.push(u.data()),null!=n&&(c.group=n),r.push(c);case 8:case"end":return e.stop()}}),e)})),s=0;case 5:if(!(s<i.length)){e.next=10;break}return e.delegateYield(o(),"t0",7);case 7:++s,e.next=5;break;case 10:return e.next=12,Promise.all(a);case 12:return u=e.sent,e.abrupt("return",{data:Cb(u),specs:r});case 14:case"end":return e.stop()}}),e)}))),wb.apply(this,arguments)}function Ib(e,t){var n,r,a={},i=0,o=U(t);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.name,c=s.dtype,l=s.shape,f=sp(l),h=void 0;if("quantization"in s){var d=s.quantization;if("uint8"===d.dtype||"uint16"===d.dtype){if(!("min"in d)||!("scale"in d))throw new Error("Weight ".concat(s.name," with quantization ").concat(d.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==d.dtype)throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(d.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==c)throw new Error("Weight ".concat(s.name," is quantized with ").concat(d.dtype," ")+"which only supports weights of type float32 not ".concat(c,"."))}var p=bb[d.dtype],v=e.slice(i,i+f*p),g="uint8"===d.dtype?new Uint8Array(v):new Uint16Array(v);if("float32"===c)if("uint8"===d.dtype||"uint16"===d.dtype){h=new Float32Array(g.length);for(var m=0;m<g.length;m++){var y=g[m];h[m]=y*d.scale+d.min}}else{if("float16"!==d.dtype)throw new Error("Unsupported quantization type ".concat(d.dtype," ")+"for weight type float32.");void 0===n&&(n=Lb()),h=n(g)}else{if("int32"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));if("uint8"!==d.dtype&&"uint16"!==d.dtype)throw new Error("Unsupported quantization type ".concat(d.dtype," ")+"for weight type int32.");h=new Int32Array(g.length);for(var b=0;b<g.length;b++){var x=g[b];h[b]=Math.round(x*d.scale+d.min)}}i+=f*p}else if("string"===c){var k=sp(s.shape);h=[];for(var w=0;w<k;w++){var I=new Uint32Array(e.slice(i,i+xb))[0];i+=xb;var C=new Uint8Array(e.slice(i,i+I));h.push(C),i+=I}}else{var A=bb[c],S=e.slice(i,i+f*A);if("float32"===c)h=new Float32Array(S);else if("int32"===c)h=new Int32Array(S);else if("bool"===c)h=new Uint8Array(S);else{if("complex64"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));h=new Float32Array(S);for(var _=new Float32Array(h.length/2),E=new Float32Array(h.length/2),T=0;T<_.length;T++)_[T]=h[2*T],E[T]=h[2*T+1];var N=yb(_,l,"float32"),O=yb(E,l,"float32");a[u]=gb(N,O),N.dispose(),O.dispose()}i+=f*A}"complex64"!==c&&(a[u]=yb(h,l,c))}}catch(R){o.e(R)}finally{o.f()}return a}function Cb(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var Ab="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function Sb(e){return Ab?Buffer.byteLength(e):new Blob([e]).size}function _b(e){if(Ab)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function Eb(e){if(Ab){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function Tb(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Nb(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Ob(e,t){var n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function Rb(e,t,n){var r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}function Pb(e,t){return Db.apply(this,arguments)}function Db(){return Db=V(B().mark((function e(t,n){var r,a,i,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.weightsManifest){e.next=7;break}return e.next=3,n(t.weightsManifest);case 3:i=e.sent,o=E(i,2),r=o[0],a=o[1];case 7:return e.abrupt("return",Rb(t,r,a));case 8:case"end":return e.stop()}}),e)}))),Db.apply(this,arguments)}function Mb(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Sb(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Sb(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function Fb(e){var t,n=[],r=U(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push.apply(n,X(a.weights))}}catch(i){r.e(i)}finally{r.f()}return n}function Lb(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],u=e[n[s>>10]+(1023&s)]+t[s>>10];i[o]=u}return new Float32Array(a)}}var jb=function(){function e(){G(this,e),this.saveRouters=[],this.loadRouters=[]}return q(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),zb=function(e){return jb.registerSaveRouter(e)},Ub=function(e){return jb.registerLoadRouter(e)},Bb=function(e){return jb.getSaveHandlers(e)},Wb=function(e,t){return jb.getLoadHandlers(e,t)},Vb="tensorflowjs",Gb="models_store",Hb="model_info_store";function Kb(){if(!jp().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function qb(e){var t=e.result;t.createObjectStore(Gb,{keyPath:"modelPath"}),t.createObjectStore(Hb,{keyPath:"modelPath"})}var Xb=function(){function e(t){if(G(this,e),this.indexedDB=Kb(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return q(e,[{key:"save",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(Vb,1);a.onupgradeneeded=function(){return qb(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(Gb,"readonly"),s=o.objectStore(Gb).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=Mb(t),l=i.transaction(Hb,"readwrite"),f=l.objectStore(Hb),h=f.put({modelPath:n.modelPath,modelArtifactsInfo:c});h.onsuccess=function(){var a=(u=i.transaction(Gb,"readwrite")).objectStore(Gb).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(f=l.objectStore(Hb)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},h.onerror=function(e){return i.close(),r(h.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();Xb.URL_SCHEME="indexeddb://";var Yb=function(e){return jp().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Xb.URL_SCHEME)?(t=e.slice(Xb.URL_SCHEME.length),new Xb(t)):null;var t};jb.registerSaveRouter(Yb),jb.registerLoadRouter(Yb);var Zb=function(){function e(){G(this,e),this.indexedDB=Kb()}return q(e,[{key:"listModels",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(Vb,1);r.onupgradeneeded=function(){return qb(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(Hb,"readonly"),i=a.objectStore(Hb).getAll();i.onsuccess=function(){var t,n={},r=U(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=V(B().mark((function e(t){var n=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(Xb.URL_SCHEME)?r.slice(Xb.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(Vb,1);a.onupgradeneeded=function(){return qb(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(Hb,"readwrite"),s=o.objectStore(Hb),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(n=i.transaction(Gb,"readwrite")).objectStore(Gb).delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Qb="/",Jb="tensorflowjs_models",$b="info",ex="model_topology",tx="weight_specs",nx="weight_data",rx="model_metadata";function ax(e){return{info:[Jb,e,$b].join(Qb),topology:[Jb,e,ex].join(Qb),weightSpecs:[Jb,e,tx].join(Qb),weightData:[Jb,e,nx].join(Qb),modelMetadata:[Jb,e,rx].join(Qb)}}function ix(e){for(var t=0,n=Object.values(e);t<n.length;t++){var r=n[t];window.localStorage.removeItem(r)}}function ox(e){var t=e.split(Qb);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(Qb)}var sx=function(){function e(t){if(G(this,e),!jp().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=ax(this.modelPath)}return q(e,[{key:"save",value:function(){var e=V(B().mark((function e(t){var n,r,a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Mb(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,_b(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),e.abrupt("return",{modelArtifactsInfo:a});case 17:throw e.prev=17,e.t0=e.catch(7),ix(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 21:case"end":return e.stop()}}),e,this,[[7,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o,s;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer),null!=o.initializerSignature&&(n.initializerSignature=o.initializerSignature),null!=o.trainingConfig&&(n.trainingConfig=o.trainingConfig)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=Eb(s),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();sx.URL_SCHEME="localstorage://";var ux=function(e){return jp().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(sx.URL_SCHEME)?(t=e.slice(sx.URL_SCHEME.length),new sx(t)):null;var t};jb.registerSaveRouter(ux),jb.registerLoadRouter(ux);var cx=function(){function e(){G(this,e),ap(jp().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),ap("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return q(e,[{key:"listModels",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=Jb+Qb,r=Qb+$b,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=ox(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(sx.URL_SCHEME)?a.slice(sx.URL_SCHEME.length):a,n=ax(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),ix(n),e.abrupt("return",r);case 7:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),lx="://",fx=function(){function e(){G(this,e),this.managers={}}return q(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){ap(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(lx)&&(t=t.slice(0,t.indexOf(lx))),ap(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();ap(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(t){var n=e.getInstance().managers[t];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return n}},{key:"getSchemes",value:function(){return Object.keys(e.getInstance().managers)}}]),e}();function hx(e){if(-1===e.indexOf(lx))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(fx.getSchemes().join(",")));return{scheme:e.split(lx)[0],path:e.split(lx)[1]}}function dx(e,t){return px.apply(this,arguments)}function px(){return px=V(B().mark((function e(t,n){var r,a,i,o,s,u,c,l,f,h,d=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.length>2&&void 0!==d[2]&&d[2],ap(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),ap((a=jb.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),ap(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],ap((o=jb.getSaveHandlers(n)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),ap(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=hx(t).scheme,c=hx(t).path,l=u===hx(t).scheme,e.next=15,i.load();case 15:if(f=e.sent,!r||!l){e.next=19;break}return e.next=19,fx.getManager(u).removeModel(c);case 19:return e.next=21,s.save(f);case 21:if(h=e.sent,!r||l){e.next=25;break}return e.next=25,fx.getManager(u).removeModel(c);case 25:return e.abrupt("return",h.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),px.apply(this,arguments)}function vx(){return gx.apply(this,arguments)}function gx(){return gx=V(B().mark((function e(){var t,n,r,a,i,o,s;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=fx.getSchemes(),n={},r=U(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,fx.getManager(i).listModels();case 9:for(s in o=e.sent)n[i+lx+s]=o[s];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])}))),gx.apply(this,arguments)}function mx(e){return yx.apply(this,arguments)}function yx(){return(yx=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=hx(t),r=fx.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bx(e,t){return xx.apply(this,arguments)}function xx(){return(xx=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",dx(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kx(e,t){return wx.apply(this,arguments)}function wx(){return(wx=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",dx(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ix=function(){function e(){G(this,e),this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}return q(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}},{key:"setTimeoutCustom",value:function(e,t){var n=this;"undefined"!==typeof window&&jp().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((function(){window.postMessage({name:n.messageName,index:n.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(function(e){e.source===window&&e.data.name===n.messageName&&(e.stopPropagation(),(0,n.functionRefs[e.data.index])(),n.handledMessageCount++,n.handledMessageCount===n.functionRefs.length&&(n.functionRefs=[],n.handledMessageCount=0))}),!0))):setTimeout(e,t)}},{key:"isTypedArray",value:function(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}}]),e}();if(jp().get("IS_BROWSER")){jp().setPlatform("browser",new Ix);try{fx.registerManager(sx.URL_SCHEME,new cx)}catch(Wse){}try{fx.registerManager(Xb.URL_SCHEME,new Zb)}catch(Wse){}}var Cx,Ax=function(){return n(613)};var Sx=function(){function e(){G(this,e),this.util=n(4240),this.textEncoder=new this.util.TextEncoder}return q(e,[{key:"fetch",value:function(e,t){return null!=jp().global.fetch?jp().global.fetch(e,t):(null==Cx&&(Cx=Ax()),Cx(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}},{key:"isTypedArray",value:function(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}]),e}();function _x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",Op(e),new My(e,t,n)}jp().get("IS_NODE")&&!jp().get("IS_BROWSER")&&jp().setPlatform("node",new Sx);var Ex=vb({cast_:function(e,t){var n=hb(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},a={dtype:t};return ab.runKernel(fv,r,a)}});var Tx=vb({clone_:function(e){var t={x:hb(e,"x","clone","string_or_numeric")};return ab.runKernel(ng,t)}});nb();var Nx={buffer:_x,cast:Ex,clone:Tx,print:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}};function Ox(){return ab}function Rx(){return ab.memory()}function Px(e,t){return ab.tidy(e,t)}function Dx(e){Qy(e).forEach((function(e){return e.dispose()}))}function Mx(e){return ab.keep(e)}function Fx(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return ab.registerBackend(e,t,n)}Ly=Nx,function(e){e}((function(e){jp().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}));var Lx=vb({add_:function(e,t){var n=hb(e,"a","add"),r=hb(t,"b","add"),a=E(Yy(n,r),2),i={a:n=a[0],b:r=a[1]};return ab.runKernel(Kp,i)}});var jx=vb({floorDiv_:function(e,t){var n=hb(e,"a","floorDiv"),r=hb(t,"b","floorDiv"),a=E(Yy(n,r),2),i={a:n=a[0],b:r=a[1]};return ab.runKernel(Zv,i)}});var zx=vb({div_:function(e,t){var n=hb(e,"a","div"),r=hb(t,"b","div"),a=E(Yy(n,r),2);if(n=a[0],r=a[1],"int32"===n.dtype&&"int32"===r.dtype)return jx(n,r);var i={a:n,b:r};return ab.runKernel(Lv,i,{})}});var Ux=vb({mul_:function(e,t){var n=hb(e,"a","mul"),r=hb(t,"b","mul"),a=E(Yy(n,r),2),i={a:n=a[0],b:r=a[1]};return ab.runKernel(Rg,i)}});var Bx=vb({sqrt_:function(e){var t={x:hb(e,"x","sqrt","float32")};return ab.runKernel(mm,t)}});var Wx=vb({square_:function(e){var t=hb(e,"x","square");return ab.runKernel("Square",{x:t},{})}});var Vx=vb({zerosLike_:function(e){var t={x:hb(e,"x","zerosLike")};return ab.runKernel(Vm,t)}});function Gx(e){return ab.customGrad(e)}function Hx(e,t){if((Iy(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Iy(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return mb(e,[],[],t)}var Kx=function(){function e(){G(this,e)}return q(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),qx=function(){function e(){G(this,e),this.classNameMap={}}return q(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function Xx(e){ap(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),ap("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),ap(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),qx.register(e)}var Yx=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return Dx(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return function(e,t){ap(Ip(e),(function(){return"The f passed in variableGrads(f) must be a function"})),ap(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof Hy})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],ab.registeredVariables)t.push(ab.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;t=t.filter((function(e){return e.trainable})),ap(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(i," variables is ")+"trainable."}));var o=ab.gradients(e,t,null,!0),s=o.value,u=o.grads;ap(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),ap(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=a&&a.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&Dx(this.iterations_)}},{key:"saveIterations",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:Hx(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Kx);Object.defineProperty(Yx,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var Zx=function(e){F(n,e);var t=z(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return G(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=ab.backend.epsilon()),a}return q(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=ab.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:Px((function(){return Vx(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:Px((function(){return Vx(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;Px((function(){var e=Lx(Ux(o,t.rho),Ux(Wx(i),1-t.rho)),n=Ux(zx(Bx(Lx(s,t.epsilon)),Bx(Lx(o,t.epsilon))),i),r=Lx(Ux(s,t.rho),Ux(Wx(n),1-t.rho));o.assign(e),s.assign(r);var u=Lx(Ux(n,-t.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(Dx(this.accumulatedGrads.map((function(e){return e.variable}))),Dx(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(X(this.accumulatedGrads),X(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adadelta"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(Yx);function Qx(e,t,n){Op(e);var r={shape:e,value:t,dtype:n};return ab.runKernel(qv,{},r)}var Jx=function(e){F(n,e);var t=z(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return G(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return q(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=ab.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:Px((function(){return Qx(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;Px((function(){var e=Lx(o,Wx(i));o.assign(e);var n=Lx(Ux(zx(i,Bx(Lx(e,ab.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&Dx(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"className",get:function(){return"Adagrad"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(Yx);var $x=vb({pow_:function(e,t){var n=hb(e,"base","pow"),r=hb(t,"exp","pow"),a=E(Yy(n,r),2),i={a:n=a[0],b:r=a[1]};return ab.runKernel(Wg,i)}});var ek=vb({sub_:function(e,t){var n=hb(e,"a","sub"),r=hb(t,"b","sub"),a=E(Yy(n,r),2),i={a:n=a[0],b:r=a[1]};return ab.runKernel(Pm,i)}}),tk=function(e){F(n,e);var t=z(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return G(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Px((function(){i.accBeta1=Hx(r).variable(),i.accBeta2=Hx(a).variable()})),null==o&&(i.epsilon=ab.backend.epsilon()),i}return q(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Px((function(){var r=ek(1,t.accBeta1),a=ek(1,t.accBeta2);n.forEach((function(n,i){var o=ab.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Px((function(){return Vx(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:Px((function(){return Vx(o).variable(false)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=Lx(Ux(u,t.beta1),Ux(s,1-t.beta1)),f=Lx(Ux(c,t.beta2),Ux(Wx(s),1-t.beta2)),h=zx(l,r),d=zx(f,a);u.assign(l),c.assign(f);var p=Lx(Ux(zx(h,Lx(Bx(d),t.epsilon)),-t.learningRate),o);o.assign(p)}})),t.accBeta1.assign(Ux(t.accBeta1,t.beta1)),t.accBeta2.assign(Ux(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Dx(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&Dx(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(X(this.accumulatedFirstMoment),X(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=V(B().mark((function e(t){var n,r=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,Px((function(){r.accBeta1.assign($x(r.beta1,r.iterations_+1)),r.accBeta2.assign($x(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adam"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(Yx);var nk=vb({abs_:function(e){var t=hb(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return ab.runKernel(vv,n)}var r={x:t};return ab.runKernel(Vp,r)}});function rk(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function ak(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function ik(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(s)}n.unshift(i)}}return n}var ok=vb({maximum_:function(e,t){var n=hb(e,"a","maximum"),r=hb(t,"b","maximum"),a=E(Yy(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Ex(n,"int32"),r=Ex(r,"int32")),ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(xg,i)}}),sk=function(e){F(n,e);var t=z(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return G(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],Px((function(){i.iteration=Hx(0).variable(),i.accBeta1=Hx(r).variable()})),null==o&&(i.epsilon=ab.backend.epsilon()),i}return q(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Px((function(){var r=ek(1,t.accBeta1),a=zx(-t.learningRate,Lx(Ux(t.iteration,t.decay),1));n.forEach((function(n,i){var o=ab.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Vx(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:Vx(o).variable(false)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=Lx(Ux(u,t.beta1),Ux(s,1-t.beta1)),f=Ux(c,t.beta2),h=nk(s),d=ok(f,h);u.assign(l),c.assign(d);var p=Lx(Ux(zx(a,r),zx(l,Lx(d,t.epsilon))),o);o.assign(p)}})),t.iteration.assign(Lx(t.iteration,1)),t.accBeta1.assign(Ux(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Dx(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&Dx(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"className",get:function(){return"Adamax"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(Yx),uk=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return q(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);n.forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=ab.registeredVariables[n];Px((function(){var e=Lx(Ux(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Mx(Hx(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"className",get:function(){return"SGD"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(Yx),ck=function(e){F(n,e);var t=z(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return G(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Hx(a.momentum),a}return q(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=ab.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:Px((function(){return Vx(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Px((function(){var e,n=Lx(Ux(t.m,i),o);e=t.useNesterov?Lx(Ux(t.c,Lx(o,Ux(n,t.m))),a):Lx(Ux(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&Dx(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"className",get:function(){return"Momentum"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(uk),lk=function(e){F(n,e);var t=z(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(G(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=s,null==o&&(r.epsilon=ab.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return q(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=ab.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:Px((function(){return Vx(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:Px((function(){return Vx(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:Px((function(){return Vx(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var s=t.accumulatedMeanSquares[r].variable,u=t.accumulatedMoments[r].variable;Px((function(){var e=Lx(Ux(s,t.decay),Ux(Wx(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=Lx(Ux(n,t.decay),Ux(o,1-t.decay)),c=zx(Ux(o,t.learningRate),Bx(ek(e,Lx(Wx(i),t.epsilon)))),l=Lx(Ux(u,t.momentum),c);s.assign(e),n.assign(i),u.assign(l);var f=ek(a,l);a.assign(f)}else{var h=Lx(Ux(s,t.decay),Ux(Wx(o),1-t.decay)),d=Lx(Ux(u,t.momentum),zx(Ux(o,t.learningRate),Bx(Lx(h,t.epsilon))));s.assign(h),u.assign(d);var p=ek(a,d);a.assign(p)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&Dx(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Dx(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&Dx(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(X(this.accumulatedMeanSquares),X(this.accumulatedMoments)),this.centered&&t.push.apply(t,X(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"className",get:function(){return"RMSProp"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(Yx),fk=[Zx,Jx,tk,sk,ck,lk,uk];var hk="model",dk=".json",pk=".weights.bin";function vk(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var gk=function(){function e(t){if(G(this,e),!jp().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t=hk),this.modelJsonFileName=t+dk,this.weightDataFileName=t+pk}return q(e,[{key:"save",value:function(){var e=V(B().mark((function e(t){var n,r,a,i,o,s;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a=Ob(t,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,o.href=i,e.next=15,vk((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 15:if(null==t.weightData){e.next=21;break}return(s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,e.next=21,vk((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 21:return e.abrupt("return",{modelArtifactsInfo:Mb(t)});case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();gk.URL_SCHEME="downloads://";var mk=function(){function e(t){if(G(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}return q(e,[{key:"load",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(r){var a=JSON.parse(r.target.result),i=a.modelTopology;if(null!=i)if(null!=a.weightsManifest)if(0!==t.weightsFiles.length){var o=Pb(a,(function(e){return t.loadWeights(e)}));e(o)}else e({modelTopology:i});else n(new Error("weightManifest field is missing from file ".concat(t.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(t.jsonFile.name)))},r.onerror=function(e){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(t.jsonFile)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(e){var t,n=this,r=[],a=[],i=U(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push.apply(r,X(o.weights)),a.push.apply(a,X(o.paths))}}catch(Wse){i.e(Wse)}finally{i.f()}var s=this.checkManifestAndWeightFiles(e),u=a.map((function(e){return n.loadWeightsFile(e,s[e])}));return Promise.all(u).then((function(e){return[r,Tb(e)]}))}},{key:"loadWeightsFile",value:function(e,t){return new Promise((function(n,r){var a=new FileReader;a.onload=function(e){var t=e.target.result;n(t)},a.onerror=function(t){return r("Failed to weights data from file of path '".concat(e,"'."))},a.readAsArrayBuffer(t)}))}},{key:"checkManifestAndWeightFiles",value:function(e){var t,n=this,r=[],a=this.weightsFiles.map((function(e){return Nb(e.name)})),i={},o=U(e);try{for(o.s();!(t=o.n()).done;){t.value.paths.forEach((function(e){var t=Nb(e);if(-1!==r.indexOf(t))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(t,"'"));if(r.push(t),-1===a.indexOf(t))throw new Error("Weight file with basename '".concat(t,"' is not provided."));i[e]=n.weightsFiles[a.indexOf(t)]}))}}catch(Wse){o.e(Wse)}finally{o.f()}if(r.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return i}}]),e}();function yk(e){return new mk(e)}function bk(e,t,n,r){!function(e){ap(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){ap(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),ap(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),ap(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function xk(e,t){return kk.apply(this,arguments)}function kk(){return(kk=V(B().mark((function e(t,n){var r,a,i,o,s,u,c,l,f;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?jp().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,bk(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(s=e.t0,u=s.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(u);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,bk(u,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return f=e.t1,e.abrupt("return",f);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wk(e){return Ik.apply(this,arguments)}function Ik(){return Ik=V(B().mark((function e(t){var n,r,a,i,o=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=Ck((function(e){return xk(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)}))),Ik.apply(this,arguments)}function Ck(e){return function(){var t=V(B().mark((function t(n){var r,a,i,o,s,u,c,l,f,h,d,p,v=arguments;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,c=bb[r]*sp(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),s[n]=!0)})):l(),u.push(e.name),n+=c}))})),s.every((function(e){return e}))){t.next=10;break}throw c=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),f=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;f.push(t)}))})),t.next=15,e(f);case 15:return h=t.sent,d={},p=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=h[p+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,c=0;c<t;c++){var l=new Uint8Array(h[p+c]);s.set(l,u),u+=l.byteLength}o[e].forEach((function(e){var t=Ib(i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)d[n]=t[n]})),p+=t})),t.abrupt("return",d);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}jb.registerSaveRouter((function(e){return jp().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(gk.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new gk(e)}(e.slice(gk.URL_SCHEME.length)):null}));var Ak=function(){function e(t,n){if(G(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(ap("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=jp().platform.fetch,ap(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&ap(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return q(e,[{key:"save",value:function(){var e=V(B().mark((function e(t){var n,r,a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a=Ob(t,r),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=10,this.fetch(this.path,n);case 10:if(!(i=e.sent).ok){e.next=15;break}return e.abrupt("return",{modelArtifactsInfo:Mb(t),responses:[i]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,null!=a||null!=i){e.next=20;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 20:return e.abrupt("return",Pb(n,(function(e){return o.loadWeights(e)})));case 21:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=V(B().mark((function e(t){var n,r,a,i,o,s,u,c,l,f,h,d,p,v,g,m;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=Sk(n),a=E(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=Fb(t),c=[],l=[],f=U(t);try{for(f.s();!(h=f.n()).done;){d=h.value,p=U(d.paths);try{for(p.s();!(v=p.n()).done;)g=v.value,null!=this.weightUrlConverter?l.push(this.weightUrlConverter(g)):c.push(s+g+o)}catch(Wse){p.e(Wse)}finally{p.f()}}}catch(Wse){f.e(Wse)}finally{f.f()}if(!this.weightUrlConverter){e.next=17;break}return e.t0=c.push,e.t1=c,e.t2=X,e.next=14,Promise.all(l);case 14:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 17:return e.next=19,xk(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 19:return m=e.sent,e.abrupt("return",[u,Tb(m)]);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Sk(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function _k(e){return null!=e.match(Ak.URL_SCHEME_REGEX)}Ak.URL_SCHEME_REGEX=/^https?:\/\//;var Ek=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return _k(e)})):_k(e))?Tk(e,t):null};function Tk(e,t){return new Ak(e,t)}function Nk(e,t){return Tk(e,t)}jb.registerSaveRouter(Ek),jb.registerLoadRouter(Ek);var Ok=function(){function e(t){G(this,e),this.modelArtifacts=t}return q(e,[{key:"load",value:function(){return this.modelArtifacts}}]),e}(),Rk=function(){function e(t){G(this,e),this.saveHandler=t}return q(e,[{key:"save",value:function(e){return this.saveHandler(e)}}]),e}(),Pk=q((function e(t){G(this,e),t.load&&(this.load=function(){return Promise.resolve(t.load())}),t.save&&(this.save=function(e){return Promise.resolve(t.save(e))})}));function Dk(e,t,n,r){var a=arguments;return new Pk(Mk.apply(void 0,X(a)))}function Mk(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new Ok(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ok({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ok({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function Fk(e){return new Rk(e)}function Lk(e){return new Rk(e)}var jk=-2,zk=-1;function Uk(e,t,n){var r=e.shape.length;ap(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),ap(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){ap(t[a]+n[a]<=e.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")}))},i=0;i<r;++i)a(i)}function Bk(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function Wk(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function Vk(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function Gk(e,t,n){var r,a,i=e.shape.length;return(r="number"===typeof t?[t].concat(X(new Array(i-1).fill(0))):t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice()).forEach((function(e){ap(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"===typeof n?[n].concat(X(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(ap(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}function Hk(e,t,n,r,a,i,o,s,u){var c;if(null==r?(c=new Array(t.length)).fill(1):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");for(var l=!1,f={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u},h=0;h<f.dims;h++)l&&0!==(1<<h&s)&&f.numAddAxisAfterEllipsis++,1<<h&o&&(l=!0);l||(f.ellipsisMask|=1<<f.dims,f.dims++);var d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;var n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(var r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask)for(var a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r;else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(jk),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(zk),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(f,d);for(var p=!0,v=!0,g=!0,m=[],y=[],b=0;b<e.length;++b){if(0===d.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));var x=!!(d.shrinkAxisMask&1<<b),k=e[b];if(-1!==k){var w=[d.beginMask&1<<b,d.endMask&1<<b],I=[d.strides[b]>0?0:-1,d.strides[b]>0?k:k-1];if(x&&d.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===d.strides[b];var C=!!(d.beginMask&1<<b&&d.endMask&1<<b);if(d.beginValid&&d.endValid){if(x){var A=d.begin[b]<0?k+d.begin[b]:d.begin[b];if(d.begin[b]=A,d.end[b]=d.begin[b]+1,A<0||A>=k)throw Error("slice index ".concat(d.begin[b]," of dimension ").concat(b," out of bounds."))}else d.begin[b]=Kk(d.begin[b],0,d.strides[b],k,w,I),d.end[b]=Kk(d.end[b],1,d.strides[b],k,w,I);var S=1===d.strides[b]&&0===d.begin[b]&&d.end[b]===k;p=p&&S,v=v&&(0===b&&1===d.strides[b]||S)}else p=p&&1===d.strides[b]&&C,v=v&&(0===b&&1===d.strides[b]||C);var _=void 0,E=!1;if(d.beginValid&&d.endValid?(_=d.end[b]-d.begin[b],E=!0):x?(_=1,E=!0):C&&k>=0&&(_=d.strides[b]<0?-k:k,E=!0),E){var T=void 0;T=0===_||_<0!==d.strides[b]<0?0:Math.trunc(_/d.strides[b])+(_%d.strides[b]!==0?1:0),m.push(T)}else m.push(-1)}else m.push(x?1:-1)}for(var N=0;N<d.finalShapeGatherIndices.length;++N){var O=d.finalShapeGatherIndices[N];O>=0?y.push(m[O]):O===jk&&y.push(1)}var R=y.filter((function(e,t){return d.finalShapeGatherIndices[t]!==jk}));return{finalShapeSparse:R,finalShape:y,isIdentity:p,sliceDim0:v,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function Kk(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];var o=e<0?r+e:e;return o<i[0]?i[0]:o>i[1]?i[1]:o}var qk=vb({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:hb(e,"x","all","bool")},a={axis:t,keepDims:n};return ab.runKernel(Xp,r,a)}});var Xk=vb({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:hb(e,"x","any","bool")},a={axis:t,keepDims:n};return ab.runKernel(Yp,r,a)}});var Yk=vb({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:hb(e,"x","argMax")},r={axis:t};return ab.runKernel(Zp,n,r)}});function Zk(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0,o=e[3];return $k(e,[].concat(X(t),[o]),n,i,r,null,null,cw(a))}function Qk(e,t,n,r,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=E(nw(t),2),c=u[0],l=u[1];if("channelsLast"===s)o=[c,l,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));o=[c,l,e[1],e[1]]}return $k(e,o,n,r,a,i,!1,s)}function Jk(e,t,n,r,a,i){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",c=E(rw(t),3),l=c[0],f=c[1],h=c[2];if("NDHWC"===u)s="channelsLast",o=[l,f,h,e[4],e[4]];else{if("NCDHW"!==u)throw new Error("Unknown dataFormat ".concat(u));s="channelsFirst",o=[l,f,h,e[1],e[1]]}return ew(e,o,n,r,a,!1,s,i)}function $k(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,c=-1,l=-1,f=-1;if("channelsLast"===s){var h=E(e,4);u=h[0],c=h[1],l=h[2],f=h[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var d=E(e,4);u=d[0],f=d[1],c=d[2],l=d[3]}var p,v=E(t,4),g=v[0],m=v[1],y=v[3],b=E(nw(n),2),x=b[0],k=b[1],w=E(nw(r),2),I=w[0],C=w[1],A=aw(g,I),S=aw(m,C),_=function(e,t,n,r,a,i,o,s,u){var c,l,f;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,a){null==r&&(r=tw(e,t,n));var i=e[0],o=e[1],s=iw((i-t+2*r)/n+1,a),u=iw((o-t+2*r)/n+1,a);return[s,u]}([t,n],i,r,e,s);l=h[0],f=h[1]}else if("same"===e){l=Math.ceil(t/r),f=Math.ceil(n/a);var d=Math.max(0,(l-1)*r+i-t),p=Math.max(0,(f-1)*a+o-n),v=Math.floor(d/2),g=d-v,m=Math.floor(p/2);c={top:v,bottom:g,left:m,right:p-m,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),f=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var y="channelsLast"===u?e[1][0]:e[2][0],b="channelsLast"===u?e[1][1]:e[2][1],x="channelsLast"===u?e[2][0]:e[3][0],k="channelsLast"===u?e[2][1]:e[3][1];c={top:y,bottom:b,left:x,right:k,type:0===y&&0===b&&0===x&&0===k?"VALID":"EXPLICIT"},l=iw((t-i+y+b)/r+1,s),f=iw((n-o+x+k)/a+1,s)}return{padInfo:c,outHeight:l,outWidth:f}}(a,c,l,x,k,A,S,i,s),T=_.padInfo,N=_.outHeight,O=_.outWidth,R=o?y*f:y;return"channelsFirst"===s?p=[u,R,N,O]:"channelsLast"===s&&(p=[u,N,O,R]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:f,outHeight:N,outWidth:O,outChannels:R,padInfo:T,strideHeight:x,strideWidth:k,filterHeight:g,filterWidth:m,effectiveFilterHeight:A,effectiveFilterWidth:S,dilationHeight:I,dilationWidth:C,inShape:e,outShape:p,filterShape:t}}function ew(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,u=-1,c=-1,l=-1,f=-1,h=-1;if("channelsLast"===o){var d=E(e,5);u=d[0],c=d[1],l=d[2],f=d[3],h=d[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));var p=E(e,5);u=p[0],h=p[1],c=p[2],l=p[3],f=p[4]}var v,g=E(t,5),m=g[0],y=g[1],b=g[2],x=g[4],k=E(rw(n),3),w=k[0],I=k[1],C=k[2],A=E(rw(r),3),S=A[0],_=A[1],T=A[2],N=aw(m,S),O=aw(y,_),R=aw(b,T),P=function(e,t,n,r,a,i,o,s,u,c,l){var f,h,d,p;"valid"===e&&(e=0);if("number"===typeof e){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,a,i){null==a&&(a=tw(e,t[0],r[0]));for(var o=[0,0,0,n],s=0;s<3;s++)e[s]+2*a>=t[s]&&(o[s]=iw((e[s]-t[s]+2*a)/r[s]+1,i));return o}([t,n,r,1],[s,u,c],1,[a,i,o],e,l);h=v[0],d=v[1],p=v[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));var g=((h=Math.ceil(t/a))-1)*a+s-t,m=((d=Math.ceil(n/i))-1)*i+u-n,y=((p=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(g/2),x=g-b,k=Math.floor(m/2),w=m-k,I=Math.floor(y/2);f={top:k,bottom:w,left:I,right:y-I,front:b,back:x,type:"SAME"}}return{padInfo:f,outDepth:h,outHeight:d,outWidth:p}}(a,c,l,f,w,I,C,N,O,R,s),D=P.padInfo,M=P.outDepth,F=P.outHeight,L=P.outWidth,j=i?x*h:x;return"channelsFirst"===o?v=[u,j,M,F,L]:"channelsLast"===o&&(v=[u,M,F,L,j]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:f,inChannels:h,outDepth:M,outHeight:F,outWidth:L,outChannels:j,padInfo:D,strideDepth:w,strideHeight:I,strideWidth:C,filterDepth:m,filterHeight:y,filterWidth:b,effectiveFilterDepth:N,effectiveFilterHeight:O,effectiveFilterWidth:R,dilationDepth:S,dilationHeight:_,dilationWidth:T,inShape:e,outShape:v,filterShape:t}}function tw(e,t,n){var r=aw(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function nw(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function rw(e){return"number"===typeof e?[e,e,e]:e}function aw(e,t){return t<=1?e:e+(e-1)*(t-1)}function iw(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function ow(e){var t=E(nw(e),3),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function sw(e,t){return ow(e)||ow(t)}function uw(e){return nw(e).every((function(e){return e>0}))}function cw(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function lw(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)ap(cp(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach((function(t){t.forEach((function(t){ap(cp(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}))}))}))}}}var fw=vb({reshape_:function(e,t){var n={x:hb(e,"x","reshape","string_or_numeric")},r={shape:t};return ab.runKernel(Jg,n,r)}});var hw=vb({avgPool_:function(e,t,n,r,a){var i=hb(e,"x","avgPool","float32");ap(sw(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var o=i,s=!1;3===i.rank&&(s=!0,o=fw(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ap(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),lw("avgPool",r,a);var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=ab.runKernel(rv,u,c);return l=Ex(l,i.dtype),s?fw(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var dw=vb({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=hb(e,"x","avgPool3d","float32"),s=o,u=!1;4===o.rank&&(u=!0,s=fw(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ap(5===s.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),ap("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),ap("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(function(){return"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")})),lw("avgPool3d",r,a);var c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},f=ab.runKernel(iv,c,l);return f=Ex(f,s.dtype),u?fw(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var pw=vb({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=hb(e,"x","batchNorm"),c=hb(t,"mean","batchNorm"),l=hb(n,"variance","batchNorm");null!=a&&(o=hb(a,"scale","batchNorm")),null!=r&&(s=hb(r,"offset","batchNorm")),ap(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),ap(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),ap(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var f=function(e){return 0===e.rank||1===e.rank?fw(e,[1,1,1,e.size]):2===e.rank?fw(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?fw(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(u),h={x:f,scale:o,offset:s,mean:c,variance:l},d={varianceEpsilon:i},p=ab.runKernel(Qv,h,d);return fw(p,u.shape)}});var vw=vb({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=hb(e,"x","batchNorm"),c=hb(t,"mean","batchNorm"),l=hb(n,"variance","batchNorm");return null!=a&&(o=hb(a,"scale","batchNorm")),null!=r&&(s=hb(r,"offset","batchNorm")),ap(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),ap(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),ap(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&ap(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&ap(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),pw(u,c,l,s,o,i)}});var gw=vb({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=hb(e,"x","batchNorm"),c=hb(t,"mean","batchNorm"),l=hb(n,"variance","batchNorm");return null!=a&&(o=hb(a,"scale","batchNorm")),null!=r&&(s=hb(r,"offset","batchNorm")),ap(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),ap(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),ap(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&ap(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&ap(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),pw(u,c,l,s,o,i)}});var mw=vb({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=hb(e,"x","batchNorm"),c=hb(t,"mean","batchNorm"),l=hb(n,"variance","batchNorm");return null!=a&&(o=hb(a,"scale","batchNorm")),null!=r&&(s=hb(r,"offset","batchNorm")),ap(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),ap(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),ap(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&ap(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&ap(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),pw(u,c,l,s,o,i)}});var yw=vb({broadcastTo_:function(e,t){var n=hb(e,"broadcastTo","x"),r=n.shape;if(Op(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=fw(n,a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));var u=o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));if(0===u.length)return Tx(n);var c={x:n},l={reps:o};return ab.runKernel(Fm,c,l)}});var bw=vb({clipByValue_:function(e,t,n){var r=hb(e,"x","clipByValue");if(ap(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")})),t===n)return Qx(r.shape,t,r.dtype);var a={x:r},i={clipValueMin:t,clipValueMax:n};return ab.runKernel(dv,a,i)}});var xw=vb({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ap(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=db(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return Tx(n[0]);var r=n,a={axis:t};return ab.runKernel(gv,r,a)}});var kw=vb({concat1d_:function(e){return xw(e,0)}});var ww=vb({concat2d_:function(e,t){return xw(e,t)}});var Iw=vb({concat3d_:function(e,t){return xw(e,t)}});var Cw=vb({concat4d_:function(e,t){return xw(e,t)}});var Aw=vb({conv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=hb(e,"x","conv2d","float32"),u=hb(t,"filter","conv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=fw(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ap(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),ap(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),lw("conv2d",r,o);var f="NHWC"===a?c.shape[3]:c.shape[1];ap(f===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(f,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),ap(sw(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),ap(uw(i),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),ap(uw(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var h={x:c,filter:u},d={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=ab.runKernel(mv,h,d);return l?fw(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var Sw=vb({conv1d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=hb(e,"x","conv1d"),u=hb(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=fw(s,[1,s.shape[0],s.shape[1]])),ap(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),ap(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),lw("conv1d",r,o),ap(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),ap(sw(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")})),ap(uw(i),(function(){return"Error in conv1D: Dilated rates should be larger than 0."})),ap(uw(n),(function(){return"Error in conv1D: Stride should be larger than 0."})),ap("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var f=fw(u,[1,u.shape[0],u.shape[1],u.shape[2]]),h=fw(c,[c.shape[0],1,c.shape[1],c.shape[2]]),d=Aw(h,f,[1,n],r,"NHWC",[1,i],o);return fw(d,l?[d.shape[2],d.shape[3]]:[d.shape[0],d.shape[2],d.shape[3]])}});var _w=vb({conv2DBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;ap(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=fw(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),ap(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),ap(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),ap(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===i?s[3]:s[1],f="NHWC"===i?u.shape[3]:u.shape[1];ap(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),ap(f===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(f,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),lw("conv2dDerInput",a,o);var h={dy:u,filter:n},d={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},p=ab.runKernel(bv,h,d);return c?fw(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var Ew=vb({conv2dTranspose_:function(e,t,n,r,a,i){var o=hb(e,"x","conv2dTranspose"),s=hb(t,"filter","conv2dTranspose");return _w(n,o,s,r,a,"NHWC",i)}});var Tw=vb({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=hb(e,"x","conv3d"),s=hb(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=fw(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ap(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),ap(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),ap(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),ap(sw(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),ap("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")})),ap(uw(i),(function(){return"Error in conv3D: Dilated rates should be larger than 0."})),ap(uw(n),(function(){return"Error in conv3D: Strides should be larger than 0."}));var l={x:u,filter:s},f={strides:n,pad:r,dataFormat:a,dilations:i},h=ab.runKernel(xv,l,f);return c?fw(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var Nw=vb({conv3DBackpropInput_:function(e,t,n,r,a){ap(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=fw(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=o.shape[4];ap(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")})),ap(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),ap(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),ap(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),ap(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:o,filter:n},f={pad:a,strides:r,inputShape:i},h=ab.runKernel(wv,l,f);return s?fw(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var Ow=vb({conv3dTranspose_:function(e,t,n,r,a){var i=hb(e,"x","conv3dTranspose"),o=hb(t,"filter","conv3dTranspose");return Nw(n,i,o,r,a)}});var Rw=vb({denseBincount_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=hb(e,"x","denseBincount"),i=hb(t,"weights","denseBincount");ap("int32"===a.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)})),ap(a.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")})),ap(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),ap(i.size===a.size||0===i.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,".")}));var o={x:a,weights:i},s={size:n,binaryOutput:r};return ab.runKernel(Ev,o,s)}});var Pw=vb({depthwiseConv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=hb(e,"x","depthwiseConv2d","float32"),u=hb(t,"filter","depthwiseConv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=fw(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ap(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),ap(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")}));var f="NHWC"===a?c.shape[3]:c.shape[1];ap(f===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(f,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),lw("depthwiseConv2d",r,o);var h={x:c,filter:u},d={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=ab.runKernel(Nv,h,d);return l?fw(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var Dw=vb({elu_:function(e){var t={x:hb(e,"x","elu","float32")};return ab.runKernel(zv,t)}});var Mw=vb({equal_:function(e,t){var n=hb(e,"a","equal","string_or_numeric"),r=hb(t,"b","equal","string_or_numeric"),a=E(Yy(n,r),2);n=a[0],r=a[1],ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(Wv,i)}});var Fw=vb({exp_:function(e){var t={x:hb(e,"x","exp")};return ab.runKernel(Vv,t)}});var Lw=vb({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=hb(e,"x","expandDims","string_or_numeric");ap(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},a={dim:t};return ab.runKernel(Gv,r,a)}});var jw=vb({tile_:function(e,t){var n=hb(e,"x","tile","string_or_numeric");ap(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var r={x:n},a={reps:t};return ab.runKernel(Fm,r,a)}});var zw=vb({eye_:function(e,t,n){null==t&&(t=e);for(var r=_x([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),a=e<=t?e:t,i=0;i<a;++i)r.set(1,i,i);var o=fw(r.toTensor(),[e,t]);if(null==n)return o;if(1===n.length)return jw(Lw(o,0),[n[0],1,1]);if(2===n.length)return jw(Lw(Lw(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return jw(Lw(Lw(Lw(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});var Uw=vb({floor_:function(e){var t={x:hb(e,"x","floor","float32")};return ab.runKernel(Yv,t)}});var Bw=vb({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a={x:hb(e,"x","gather"),indices:hb(t,"indices","gather","int32")},i={axis:n,batchDims:r};return ab.runKernel(Jv,a,i)}});var Ww=vb({greater_:function(e,t){var n=hb(e,"a","greater","string_or_numeric"),r=hb(t,"b","greater","string_or_numeric"),a=E(Yy(n,r),2);n=a[0],r=a[1],ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(eg,i)}});var Vw=vb({greaterEqual_:function(e,t){var n=hb(e,"a","greaterEqual","string_or_numeric"),r=hb(t,"b","greaterEqual","string_or_numeric"),a=E(Yy(n,r),2);n=a[0],r=a[1],ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(tg,i)}});var Gw=vb({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n={x:hb(e,"x","leakyRelu")},r={alpha:t};return ab.runKernel(ug,n,r)}});var Hw=vb({log_:function(e){var t={x:hb(e,"x","log","float32")};return ab.runKernel(hg,t)}});var Kw=vb({log1p_:function(e){var t={x:hb(e,"x","log1p")};return ab.runKernel(dg,t)}});var qw=vb({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:hb(e,"x","max")},a={reductionIndices:t,keepDims:n};return ab.runKernel(bg,r,a)}});var Xw=vb({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hb(e,"x","sum");"bool"===r.dtype&&(r=Ex(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return ab.runKernel(ym,a,i)}});var Yw=vb({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=hb(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var r=Gx((function(e,n){var r=qw(e,t,!0),a=ek(e,r),i=ek(Ex(a,"float32"),Hw(Xw(Fw(a),t,!0)));n([i]);return{value:i,gradFunc:function(e,n){var r=E(n,1)[0],a=Fw(r);return ek(e,Ux(Xw(e,t,!0),a))}}}));return r(n)}});var Zw=vb({logicalAnd_:function(e,t){var n=hb(e,"a","logicalAnd","bool"),r=hb(t,"b","logicalAnd","bool");ik(n.shape,r.shape);var a={a:n,b:r};return ab.runKernel(pg,a)}});var Qw=vb({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=hb(e,"a","matMul"),i=hb(t,"b","matMul"),o=E(Yy(a,i),2),s={a:a=o[0],b:i=o[1]},u={transposeA:n,transposeB:r};return ab.runKernel(sv,s,u)}});var Jw=vb({maxPool_:function(e,t,n,r,a){var i=hb(e,"x","maxPool"),o=i,s=!1;3===i.rank&&(s=!0,o=fw(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ap(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),ap(sw(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),lw("maxPool",r,a);var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=ab.runKernel(kg,u,c);return s?fw(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var $w=vb({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=hb(e,"x","maxPool3d"),s=o,u=!1;4===o.rank&&(u=!0,s=fw(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ap(5===s.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),ap("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),lw("maxPool3d",r,a);var c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},f=ab.runKernel(Ig,c,l);return u?fw(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var eI=vb({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:hb(e,"x","mean")},a={axis:t,keepDims:n};return ab.runKernel(Sg,r,a)}});var tI=vb({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:hb(e,"x","min")},a={axis:t,keepDims:n};return ab.runKernel(_g,r,a)}});var nI=vb({minimum_:function(e,t){var n=hb(e,"a","minimum"),r=hb(t,"b","minimum"),a=E(Yy(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Ex(n,"int32"),r=Ex(r,"int32")),ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(Eg,i)}});function rI(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function aI(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var i=t.map((function(t){return e[t]}));return[n,i]}function iI(e,t){return function(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}(e,t.map((function(e){return 1})),t)}function oI(e,t,n){ap(rI(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function sI(e,t){if(rI(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function uI(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function cI(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}var lI=vb({moments_:function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=pp(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=hb(e,"x","moments")).shape),r=eI(e,n,t),a=r.shape;t||(a=iI(r.shape,n));var i=Wx(ek(Ex(e,"float32"),fw(r,a)));return{mean:r,variance:eI(i,n,t)}}});var fI=vb({neg_:function(e){var t={x:hb(e,"x","neg")};return ab.runKernel(Pg,t)}});var hI=vb({notEqual_:function(e,t){var n=hb(e,"a","notEqual","string_or_numeric"),r=hb(t,"b","notEqual","string_or_numeric"),a=E(Yy(n,r),2);n=a[0],r=a[1],ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(Dg,i)}});var dI=vb({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var i={indices:hb(e,"indices","oneHot","int32")},o={dtype:a,depth:t,onValue:n,offValue:r};return ab.runKernel(zg,i,o)}});function pI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(Op(e),"complex64"===t){var n=pI(e,"float32"),r=pI(e,"float32");return gb(n,r)}var a=Tp(sp(e),t);return ab.makeTensor(a,e,t)}function vI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(Op(e),"complex64"===t){var n=vI(e,"float32"),r=pI(e,"float32");return gb(n,r)}var a=Ep(sp(e),t);return ab.makeTensor(a,e,t)}var gI=vb({onesLike_:function(e){var t={x:hb(e,"x","onesLike")};return ab.runKernel(jg,t)}});var mI=vb({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=hb(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n},i={x:r};return ab.runKernel(Bg,i,a)}});var yI=vb({prelu_:function(e,t){var n={x:hb(e,"x","prelu"),alpha:hb(t,"alpha","prelu")};return ab.runKernel(Vg,n)}}),bI=n(3152),xI=function(){function e(t,n,r,a,i){G(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=bI.alea(o.toString())}return q(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),kI=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(G(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=bI.alea(i)}return q(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var wI=vb({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(Op(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new xI(t,n,r,!1,a),o=_x(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var II=vb({randomUniform_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;Op(e);for(var i=_x(e,r),o=new kI(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});function CI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:e,stop:t,step:n,dtype:r};return ab.runKernel(Xg,{},a)}var AI=vb({relu_:function(e){var t={x:hb(e,"x","relu")};return ab.runKernel(Qg,t)}});var SI=vb({reverse_:function(e,t){var n={x:hb(e,"x","reverse")},r={dims:t};return ab.runKernel(am,n,r)}});var _I=vb({selu_:function(e){var t={x:hb(e,"x","selu")};return ab.runKernel(lm,t)}});var EI=vb({separableConv2d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",s=hb(e,"x","separableConv2d"),u=hb(t,"depthwiseFilter","separableConv2d"),c=hb(n,"pointwiseFilter","separableConv2d"),l=s,f=!1;if(3===s.rank&&(f=!0,l=fw(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ap(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),ap(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),ap(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),ap(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),ap(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var h=u.shape[2],d=u.shape[3];ap(c.shape[2]===h*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(h*d,", ")+"but got ".concat(c.shape[2],".")}));var p=Pw(l,u,r,a,o,i),v=Aw(p,c,1,"valid",o);return f?fw(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});var TI=vb({sigmoid_:function(e){var t={x:hb(e,"x","sigmoid","float32")};return ab.runKernel(vm,t)}});var NI=vb({slice_:function(e,t,n){var r=hb(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var a={x:r},i={begin:t,size:n};return ab.runKernel(fm,a,i)}});var OI=vb({slice1d_:function(e,t,n){var r=hb(e,"x","slice1d");return ap(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),NI(r,[t],[n])}});var RI=vb({slice2d_:function(e,t,n){var r=hb(e,"x","slice2d");return ap(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),NI(r,t,n)}});var PI=vb({slice3d_:function(e,t,n){var r=hb(e,"x","slice3d");return ap(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),NI(r,t,n)}});var DI=vb({slice4d_:function(e,t,n){var r=hb(e,"x","slice4d");return ap(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),NI(r,t,n)}});var MI=vb({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=hb(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var r={logits:n},a={dim:t};return ab.runKernel(km,r,a)}});var FI=vb({softplus_:function(e){var t={x:hb(e,"x","softplus")};return ab.runKernel(gm,t)}});var LI=vb({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r={x:hb(e,"x","split")},a={numOrSizeSplits:t,axis:n};return ab.runKernel(xm,r,a)}});var jI=vb({squeeze_:function(e,t){var n=hb(e,"x","squeeze","string_or_numeric");return fw(n,vp(n.shape,t).newShape)}});var zI=vb({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=db(e,"tensors","stack","string_or_numeric");ap(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&ap(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,a={axis:t};return ab.runKernel(Ug,r,a)}});var UI=vb({tanh_:function(e){var t={x:hb(e,"x","tanh","float32")};return ab.runKernel(Mm,t)}});function BI(e,t){op(e);var n=cb(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return mb(e,null,n,t)}var WI=vb({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(Op(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new xI(t,n,r,!0,a),o=_x(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var VI=vb({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=hb(e,"x","unstack","string_or_numeric");ap(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},a={axis:t};return ab.runKernel(Bm,r,a)}});var GI=vb({where_:function(e,t,n){var r=hb(t,"a","where"),a=hb(n,"b","where"),i=hb(e,"condition","where","bool"),o=ik(ik(i.shape,r.shape),a.shape),s={condition:yw(i,o),t:yw(r,o),e:yw(a,o)};return ab.runKernel(cm,s)}});var HI=vb({imag_:function(e){var t={input:hb(e,"input","imag")};return ab.runKernel(ag,t)}});var KI=vb({real_:function(e){var t={input:hb(e,"input","real")};return ab.runKernel(Yg,t)}});var qI=vb({transpose_:function(e,t,n){var r=hb(e,"x","transpose");if(null==t&&(t=r.shape.map((function(e,t){return t})).reverse()),ap(r.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){ap(e>=0&&e<r.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(t)}))})),r.rank<=1)return r.clone();var a={x:r},i={perm:t};return"complex64"===r.dtype?Px((function(){var e=KI(r),t=HI(r);return e=ab.runKernel(zm,{x:e},i),t=ab.runKernel(zm,{x:t},i),n&&(t=fI(t)),gb(e,t)})):ab.runKernel(zm,a,i)}});var XI=vb({dropout_:function(e,t,n,r){var a=hb(e,"x","dropout");if(ap("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),ap(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof jy?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(up(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=zx(Uw(Lx(II(i,0,1,"float32",r),o)),o);return Ux(a,s)}});var YI=vb({fft_:function(e){ap("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return ab.runKernel(Kv,t)}});var ZI=vb({rfft_:function(e,t){ap("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=NI(e,i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=xw([e,pI(s)],e.shape.length-1),r=t}else n=e;var u=Vx(n),c=fw(gb(n,u),[a,r]),l=YI(c),f=Math.floor(r/2)+1,h=KI(l),d=HI(l),p=LI(h,[f,r-f],h.shape.length-1),v=LI(d,[f,r-f],d.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=f,fw(gb(p[0],v[0]),g)}});var QI=vb({ifft_:function(e){ap("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return ab.runKernel(rg,t)}});var JI=vb({irfft_:function(e){var t,n=e.shape[e.shape.length-1],r=e.size/n;if(n<=2){var a=fw(e,[r,n]);t=QI(a)}else{var i=[r,2*(n-1)],o=fw(KI(e),[r,n]),s=fw(HI(e),[r,n]),u=SI(NI(o,[0,1],[r,n-2]),1),c=Ux(SI(NI(s,[0,1],[r,n-2]),1),Hx(-1)),l=xw([o,u],1),f=xw([s,c],1),h=fw(gb(l,f),[i[0],i[1]]);t=QI(h)}if(t=KI(t),3===e.rank&&0!==e.shape[0]){var d=t,p=e.shape[0];t=fw(t,[p,t.shape[0]/p,t.shape[1]]),d.dispose()}return t}});var $I=vb({conv2DBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=fw(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=fw(t,[1,t.shape[0],t.shape[1],t.shape[2]])),ap(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),ap(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),ap(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];ap(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),ap(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),lw("conv2dDerFilter",a,o);var f={x:s,dy:u},h={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return ab.runKernel(yv,f,h)}});var eC=vb({relu6_:function(e){var t={x:hb(e,"x","relu6")};return ab.runKernel(rm,t)}});var tC=vb({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:hb(e,"x","step")},r={alpha:t};return ab.runKernel(Gm,n,r)}});function nC(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Ux(e,tC(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function rC(e,t){var n=t,r=ak(e.shape,t.shape);return r.length>0&&(n=Xw(n,r)),fw(n,e.shape)}function aC(e,t,n,r){if("linear"===t)return e;if("relu"===t)return AI(e);if("elu"===t)return Dw(e);if("relu6"===t)return eC(e);if("prelu"===t)return yI(e,n);if("leakyrelu"===t)return Gw(e,r);if("sigmoid"===t)return TI(e);throw new Error("Unknown fused activation ".concat(t,"."))}var iC=function(e,t){return!(e>0)||"linear"===t};var oC=vb({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,h=void 0===f?"linear":f,d=e.preluActivationWeights,p=e.leakyreluAlpha;if(h=h||"linear",!1===iC(ab.state.gradientDepth,h)){ap("NHWC"===o,(function(){return"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var v=Aw(t,n,r,a,o,u,c);return null!=l&&(v=Lx(v,l)),aC(v,h,d,p)}var g=hb(t,"x","conv2d","float32"),m=hb(n,"filter","conv2d","float32"),y=g,b=!1;3===g.rank&&(b=!0,y=fw(g,[1,g.shape[0],g.shape[1],g.shape[2]])),ap(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),ap(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(m.rank,".")})),lw("fused conv2d",a,c);var x="NHWC"===o?y.shape[3]:y.shape[1];ap(m.shape[2]===x,(function(){return"Error in conv2d: depth of input (".concat(x,") must match ")+"input depth for filter ".concat(m.shape[2],".")})),ap(sw(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(u,"'")}));var k,w,I=$k(y.shape,m.shape,r,u,a,c);if(null!=l){var C=E(Yy(k=hb(l,"bias","fused conv2d"),g),1);k=C[0],"NHWC"===o?ik(I.outShape,k.shape):(ap(k.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(k.shape.length,".")})),ap(0===k.shape.length||k.shape[0]===I.outChannels||1===k.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(k.shape,") is not ")+"compatible with the number of output channels "+"(".concat(I.outChannels,")")})))}if(null!=d){var A=d.shape;if(ap(A.length<=1||3===A.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(A.length,".")})),1===A.length)ap(1===A[0]||A[0]===I.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(A,") is not compatible with the number of output ")+"channels (".concat(I.outChannels,").")}));else if(3===A.length)try{ik(A,I.outShape)}catch(P){var S="Error in fused conv2d: PReLU activation weights (".concat(A,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(I.outShape,").");throw Error(S)}w=hb(d,"prelu weights","fused conv2d")}var _=function(e,t){ap("NHWC"===o,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var n=E(t,4),i=n[0],s=n[1],c=n[2],l=n[3],f=nC(e,c,h);ap(ow(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")}));var d=[_w(s.shape,f,i,r,a),$I(s,f,i.shape,r,a)];if(null!=l){var p=rC(l,f);d.push(p)}return d},T={x:y,filter:m,bias:k,preluActivationWeights:w},N={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:c,activation:h,leakyreluAlpha:p};if(null==l){var O=Gx((function(e,t,n){var r=ab.runKernel(qm,T,N);return n([t,e,r]),b&&(r=fw(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:_}}));return O(y,m)}var R=Gx((function(e,t,n,r){var a=ab.runKernel(qm,T,N);return r([t,e,a,n]),b&&(a=fw(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:_}}));return R(y,m,k)}});var sC=vb({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=fw(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=fw(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={x:s,dy:u},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return ab.runKernel(Ov,c,l)}});var uC=vb({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,u=!1;3===t.rank&&(u=!0,s=fw(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={dy:s,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},f=ab.runKernel(Rv,c,l);return u?fw(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});var cC=vb({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,s=e.bias,u=e.activation,c=void 0===u?"linear":u,l=e.preluActivationWeights,f=e.leakyreluAlpha,h=void 0===f?.2:f;if(!1===iC(ab.state.gradientDepth,c)){var d=Qw(t,n,a,o);return null!=s&&(d=Lx(d,s)),aC(d,c,l,h)}var p=hb(t,"a","fused matMul"),v=hb(n,"b","fused matMul"),g=E(Yy(p,v),2);p=g[0],v=g[1];var m=a?p.shape[p.rank-2]:p.shape[p.rank-1],y=o?v.shape[v.rank-1]:v.shape[v.rank-2],b=a?p.shape[p.rank-1]:p.shape[p.rank-2],x=o?v.shape[v.rank-2]:v.shape[v.rank-1],k=p.shape.slice(0,-2),w=v.shape.slice(0,-2),I=sp(k),C=sp(w);ap(m===y,(function(){return"Error in fused matMul: inner shapes (".concat(m,") and (")+"".concat(y,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(v.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var A,S,_=ik(p.shape.slice(0,-2),v.shape.slice(0,-2)).concat([b,x]),T=fw(p,a?[I,m,b]:[I,b,m]),N=fw(v,o?[C,x,y]:[C,y,x]);null!=s&&(A=E(Yy(A=hb(s,"bias","fused matMul"),p),1)[0],ik(_,A.shape)),null!=l&&(S=hb(l,"prelu weights","fused matMul"));var O=function(e,t){var n,r,i=E(t,4),u=i[0],l=i[1],f=i[2],h=i[3],d=nC(fw(e,f.shape),f,c);return a||o?!a&&o?(n=Qw(d,l,!1,!1),r=Qw(d,u,!0,!1)):a&&!o?(n=Qw(l,d,!1,!0),r=Qw(u,d,!1,!1)):(n=Qw(l,d,!0,!0),r=Qw(d,u,!0,!0)):(n=Qw(d,l,!1,!0),r=Qw(u,d,!0,!1)),null!=s?[n,r,rC(h,d)]:[n,r]},R={a:T,b:N,bias:A,preluActivationWeights:S},P={transposeA:a,transposeB:o,activation:c,leakyreluAlpha:h};if(null==s){var D=Gx((function(e,t,n){var r=ab.runKernel(Km,R,P);return n([e,t,r]),{value:fw(r,_),gradFunc:O}}));return D(T,N)}var M=Gx((function(e,t,n,r){var a=ab.runKernel(Km,R,P);return r([e,t,a,n]),{value:fw(a,_),gradFunc:O}}));return M(T,N,A)}});function lC(e,t,n){if(op(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=cb(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return mb(e,t,r,n)}var fC=vb({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=hb(e,"image","cropAndResize"),s=hb(t,"boxes","cropAndResize","float32"),u=hb(n,"boxInd","cropAndResize","int32"),c=s.shape[0];ap(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),ap(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),ap(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),ap(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),ap(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),ap("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:s,boxInd:u},f={method:a,extrapolationValue:i,cropSize:r};return ab.runKernel(_v,l,f)}});var hC=vb({flipLeftRight_:function(e){var t=hb(e,"image","flipLeftRight","float32");ap(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return ab.runKernel(Xv,n,{})}});var dC=vb({grayscaleToRGB_:function(e){var t=hb(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];ap(t.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")})),ap(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,jw(t,a)}});var pC=vb({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=hb(e,"image","rotateWithOffset","float32");ap(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r};return ab.runKernel(Hm,i,o)}});function vC(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),ap(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),ap(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),ap(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),ap(1===t.rank,(function(){return"scores must be a 1D tensor"})),ap(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),ap(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var gC=vb({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=hb(e,"boxes","nonMaxSuppression","float32"),o=hb(t,"scores","nonMaxSuppression","float32"),s=vC(i,o,n,r,a),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold};return ab.runKernel(Mg,{boxes:i,scores:o},u)}});function mC(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||yC)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function yC(e,t){return e>t?1:e<t?-1:0}function bC(e,t,n,r,a){return wC(e,t,n,r,a,0)}function xC(e,t,n,r,a,i){return wC(e,t,n,r,a,0,!1,i,!0)}function kC(e,t,n,r,a,i){return wC(e,t,n,r,a,i,!0)}function wC(e,t,n,r,a,i){for(var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[],l=0;l<t.length;l++)t[l]>a&&c.push({score:t[l],boxIndex:l,suppressBeginIndex:0});c.sort(AC);for(var f=i>0?-.5/i:0,h=[],d=[];h.length<n&&c.length>0;){var p=c.pop(),v=p.score,g=p.boxIndex,m=p.suppressBeginIndex;if(v<a)break;for(var y=!1,b=h.length-1;b>=m;--b){var x=IC(e,g,h[b]);if(x>=r){y=!0;break}if(p.score=p.score*CC(r,f,x),p.score<=a)break}p.suppressBeginIndex=h.length,y||(p.score===v?(h.push(g),d.push(p.score)):p.score>a&&mC(c,p,AC))}var k=h.length,w=n-k;s&&w>0&&(h.push.apply(h,X(new Array(w).fill(0))),d.push.apply(d,X(new Array(w).fill(0))));var I={selectedIndices:h};return o&&(I.selectedScores=d),u&&(I.validOutputs=k),I}function IC(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),d=(s-i)*(u-o),p=(f-c)*(h-l);if(d<=0||p<=0)return 0;var v=Math.max(i,c),g=Math.max(o,l),m=Math.min(s,f),y=Math.min(u,h),b=Math.max(m-v,0)*Math.max(y-g,0);return b/(d+p-b)}function CC(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function AC(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function SC(){return SC=V(B().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h,d,p=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>3&&void 0!==p[3]?p[3]:.5,i=p.length>4&&void 0!==p[4]?p[4]:Number.NEGATIVE_INFINITY,o=hb(t,"boxes","nonMaxSuppressionAsync"),s=hb(n,"scores","nonMaxSuppressionAsync"),u=vC(o,s,r,a,i),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,e.next=10,Promise.all([o.data(),s.data()]);case 10:return c=e.sent,l=c[0],f=c[1],h=bC(l,f,r,a,i),d=h.selectedIndices,o!==t&&o.dispose(),s!==n&&s.dispose(),e.abrupt("return",BI(d,"int32"));case 17:case"end":return e.stop()}}),e)}))),SC.apply(this,arguments)}var _C=function(e,t,n){return SC.apply(this,arguments)};var EC=vb({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=hb(e,"boxes","nonMaxSuppression"),s=hb(t,"scores","nonMaxSuppression"),u=vC(o,s,n,r,a,i),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},f=ab.runKernel(Lg,c,l);return{selectedIndices:f[0],selectedScores:f[1]}}});function TC(){return TC=V(B().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h,d,p,v,g=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.length>3&&void 0!==g[3]?g[3]:.5,i=g.length>4&&void 0!==g[4]?g[4]:Number.NEGATIVE_INFINITY,o=g.length>5&&void 0!==g[5]?g[5]:0,s=hb(t,"boxes","nonMaxSuppressionAsync"),u=hb(n,"scores","nonMaxSuppressionAsync"),c=vC(s,u,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=12,Promise.all([s.data(),u.data()]);case 12:return l=e.sent,f=l[0],h=l[1],d=kC(f,h,r,a,i,o),p=d.selectedIndices,v=d.selectedScores,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:BI(p,"int32"),selectedScores:BI(v)});case 19:case"end":return e.stop()}}),e)}))),TC.apply(this,arguments)}var NC=function(e,t,n){return TC.apply(this,arguments)};var OC=vb({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=hb(e,"boxes","nonMaxSuppression"),s=hb(t,"scores","nonMaxSuppression"),u=vC(o,s,n,r,a,null),c={boxes:o,scores:s},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:i},f=ab.runKernel(Fg,c,l);return{selectedIndices:f[0],validOutputs:f[1]}}});function RC(){return RC=V(B().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h,d,p,v,g,m,y,b,x=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x.length>3&&void 0!==x[3]?x[3]:.5,i=x.length>4&&void 0!==x[4]?x[4]:Number.NEGATIVE_INFINITY,o=x.length>5&&void 0!==x[5]&&x[5],s=hb(t,"boxes","nonMaxSuppressionAsync"),u=hb(n,"scores","nonMaxSuppressionAsync"),c=vC(s,u,r,a,i,null),l=c.maxOutputSize,f=c.iouThreshold,h=c.scoreThreshold,e.next=11,Promise.all([s.data(),u.data()]);case 11:return d=e.sent,p=E(d,2),v=p[0],g=p[1],m=xC(v,g,l,f,h,o),y=m.selectedIndices,b=m.validOutputs,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:BI(y,"int32"),validOutputs:Hx(b,"int32")});case 19:case"end":return e.stop()}}),e)}))),RC.apply(this,arguments)}var PC=function(e,t,n){return RC.apply(this,arguments)};var DC=vb({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=hb(e,"images","resizeBilinear");ap(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),ap(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),ap(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=fw(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(t,0);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=ab.runKernel(tm,s,u);return o?fw(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var MC=vb({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=hb(e,"images","resizeNearestNeighbor");ap(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),ap(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),ap("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),ap(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=fw(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(t,0);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=ab.runKernel($g,s,u);return o?fw(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var FC=vb({bincount_:function(e,t,n){var r=hb(e,"x","bincount"),a=hb(t,"weights","bincount");ap("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),ap(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),ap(a.size===r.size||0===a.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")}));var i={x:r,weights:a},o={size:n};return ab.runKernel(cv,i,o)}});var LC=vb({lessEqual_:function(e,t){var n=hb(e,"a","lessEqual","string_or_numeric"),r=hb(t,"b","lessEqual","string_or_numeric"),a=E(Yy(n,r),2);n=a[0],r=a[1],ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(lg,i)}});var jC=vb({round_:function(e){var t={x:hb(e,"x","round")};return ab.runKernel(im,t)}});var zC=vb({threshold_:function(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,u=hb(e,"image","threshold"),c=u.shape[0]*u.shape[1],l=Ux(BI([s]),255);if(ap(3===u.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(u.rank,".")})),ap(3===u.shape[2]||1===u.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(u.shape[2],".")})),ap("int32"===u.dtype||"float32"===u.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(u.dtype,".")})),ap("otsu"===i||"binary"===i,(function(){return"Method must be binary or otsu, but was ".concat(i)})),3===u.shape[2]){var f=E(LI(u,[1,1,1],-1),3);t=f[0],n=f[1],r=f[2];var h=Ux(t,.2989),d=Ux(n,.587),p=Ux(r,.114);a=Lx(Lx(h,d),p)}else a=e;"otsu"===i&&(l=function(e,t){for(var n,r,a,i,o,s,u=BI([-1]),c=BI([0]),l=BI([0]),f=0;f<e.size-1;f++){n=NI(e,0,f+1),r=NI(e,f+1),o=zx(Xw(n),t),s=zx(Xw(r),t);var h=Xw(Ux(n,CI(0,n.size)));a=zx(h,Xw(n));var d=Qx(r.shape,n.size),p=Lx(CI(0,r.size),d),v=Ux(r,p);i=zx(Xw(v),Xw(r));var g=ek(a,i),m=ek(a,i),y=Ux(o,s);l=Ux(Ux(y,g),m);var b=Ww(l,c);c=GI(b,l,c),u=GI(b,BI([f]),u)}return u}(FC(Ex(jC(a),"int32"),yb([]),256),c));var v=o?LC(a,l):Ww(a,l);return Ex(Ux(v,255),"int32")}});var UC=vb({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=hb(e,"image","transform","float32"),s=hb(t,"transforms","transform","float32");ap(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),ap(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),ap(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return ab.runKernel(jm,u,c)}});var BC=vb({bandPart_:function(e,t,n){ap(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),ap(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=hb(e,"a","bandPart");ap(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=E(r.shape.slice(-2),2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(o,")."));if(!(n<=s))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(s,")."));t<0&&(t=o),n<0&&(n=s);var u=fw(CI(0,o,1,"int32"),[-1,1]),c=CI(0,s,1,"int32"),l=ek(u,c),f=Zw(LC(l,Hx(+t,"int32")),Vw(l,Hx(-n,"int32"))),h=pI([o,s],r.dtype);return fw(zI(VI(fw(r,[-1,o,s])).map((function(e){return GI(f,e,h)}))),a)}});function WC(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return nk(e);if(1!==e.rank&&null===n)return WC(fw(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Xw(nk(e),n);if(t===1/0)return qw(nk(e),n);if(t===-1/0)return tI(nk(e),n);if("euclidean"===t||2===t)return Bx(Xw($x(nk(e),Hx(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return qw(Xw(nk(e),n[0]),n[1]-1);if(t===1/0)return qw(Xw(nk(e),n[1]),n[0]);if(t===-1/0)return tI(Xw(nk(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return Bx(Xw(Wx(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var VC=vb({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=WC(e=hb(e,"x","norm"),t,n),i=a.shape;if(r){var o=pp(n,e.shape);i=iI(a.shape,o)}return fw(a,i)}});var GC=vb({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,ap(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){ap(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}else t=!0,e=LI(e,e.shape[0],0).map((function(e){return jI(e,[0])}));ap(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var i=[],o=e,s=function(e){i.push(ab.tidy((function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=Ux(Xw(Ux(i[n],t)),i[n]);t=ek(t,r)}return zx(t,VC(t,"euclidean"))})))},u=0;u<e.length;++u)s(u);return t?zI(i,0):i}});function HC(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ab.tidy((function(){ap(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=zw(n),i=Tx(e),o=lC([[1]],[1,1]),s=Tx(o),u=n>=r?r:n,c=function(e){var t=i,u=s,c=a,l=ab.tidy((function(){var t=NI(i,[e,e],[n-e,1]),u=VC(t),c=NI(i,[e,e],[1,1]),l=GI(Ww(c,0),lC([[-1]]),lC([[1]])),f=ek(c,Ux(l,u)),h=zx(t,f);s=1===h.shape[0]?Tx(o):xw([o,NI(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);var d=fI(zx(Qw(l,f),u)),p=NI(i,[e,0],[n-e,r]),v=Ux(d,s),g=qI(s);if(0===e)i=ek(p,Qw(v,Qw(g,p)));else{var m=ek(p,Qw(v,Qw(g,p)));i=xw([NI(i,[0,0],[e,r]),m],0)}var y=qI(v),b=NI(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=ek(b,Qw(Qw(b,s),y));else{var x=ek(b,Qw(Qw(b,s),y));a=xw([NI(a,[0,0],[n,e]),x],1)}return[s,i,a]})),f=E(l,3);s=f[0],i=f[1],a=f[2],Dx([t,u,c])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=NI(a,[0,0],[n,r]),i=NI(i,[0,0],[r,r])),[a,i]}))}var KC,qC=vb({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(ap(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return HC(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=VI(fw(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((function(e){var n=E(HC(e,t),2),r=n[0],o=n[1];a.push(r),i.push(o)})),[fw(zI(a,0),e.shape),fw(zI(i,0),e.shape)]}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(KC||(KC={}));var XC=vb({squaredDifference_:function(e,t){var n=hb(e,"a","squaredDifference"),r=hb(t,"b","squaredDifference"),a=E(Yy(n,r),2);n=a[0],r=a[1],ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(_m,i,{})}});var YC=vb({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hb(e,"x","logSumExp"),a=pp(t,r.shape),i=qw(r,a,!0),o=ek(r,i),s=Fw(o),u=Xw(s,a),c=Hw(u),l=Lx(fw(i,c.shape),c);if(n){var f=iI(l.shape,a);return fw(l,f)}return l}});var ZC=vb({stringNGrams_:function(e,t,n,r,a,i,o,s){var u=hb(e,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: ".concat(u.shape));var c=hb(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");var l={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},f={data:u,dataSplits:c},h=ab.runKernel(Nm,f,l);return{nGrams:h[0],nGramsSplits:h[1]}}});var QC=vb({stringSplit_:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=hb(e,"input","stringSplit","string"),a=hb(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));var i={skipEmpty:n},o={input:r,delimiter:a},s=ab.runKernel(Om,o,i);return{indices:s[0],values:s[1],shape:s[2]}}});var JC,$C=vb({stringToHashBucketFast_:function(e,t){var n=hb(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");var a={input:n};return ab.runKernel(Rm,a,r)}}),eA={flipLeftRight:hC,grayscaleToRGB:dC,resizeNearestNeighbor:MC,resizeBilinear:DC,rotateWithOffset:pC,cropAndResize:fC,nonMaxSuppression:gC,nonMaxSuppressionAsync:_C,nonMaxSuppressionWithScore:EC,nonMaxSuppressionWithScoreAsync:NC,nonMaxSuppressionPadded:OC,nonMaxSuppressionPaddedAsync:PC,threshold:zC,transform:UC},tA={bandPart:BC,gramSchmidt:GC,qr:qC},nA={stringNGrams:ZC,stringSplit:QC,stringToHashBucketFast:$C},rA=function(){function e(){G(this,e)}return q(e,null,[{key:"sgd",value:function(e){return new uk(e)}},{key:"momentum",value:function(e,t){return new ck(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}},{key:"rmsprop",value:function(e){return new lk(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}},{key:"adam",value:function(){return new tk(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}},{key:"adadelta",value:function(){return new Zx(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"adamax",value:function(){return new sk(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}},{key:"adagrad",value:function(e){return new Jx(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}}]),e}(),aA=rA,iA="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(e){return e()};function oA(){return new Promise((function(e){return iA((function(){return e()}))}))}function sA(e,t){var n=e[0].length;e.forEach((function(e,t){ap(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),ap(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)ap(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function uA(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(JC||(JC={}));var cA=30;function lA(e){return e<=cA?e:Cp(e,Math.floor(Math.sqrt(e)))}function fA(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function hA(e,t,n){var r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])(r=r.concat(t.slice(0))).push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);for(var a=t.length,i=0;i<a;++i)r=r.concat([e[i+1]/t[i],t[i]]);r=r.concat(e.slice(a+1))}return r}function dA(e,t){var n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(var r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{for(var a=[],i=[],o=1;o<e;++o)o>=2*t+1||o%2===1?i.push(o):a.push(o);n.push.apply(n,a),n.push(0),n.push.apply(n,i)}return n}function pA(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function vA(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function gA(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function mA(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===sp(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=e.shape,c=a.slice();c.pop();for(var l=1,f=i;f<n;++f)l*=u[f],c.push(u[f]);var h=[].concat(X(Ap(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,h]}function yA(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:sp(t.shape)/u,sliceSize:o,strides:[].concat(X(Ap(n.slice(0,a))),[1]),outputSize:sp(n)}}var bA=1.7580993408473768,xA=1.0507009873554805,kA=.3275911,wA=.254829592,IA=-.284496736,CA=1.421413741,AA=-1.453152027,SA=1.061405429;function _A(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function EA(e,t){return{real:e[2*t],imag:e[2*t+1]}}function TA(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function NA(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var OA="->",RA=/->/g,PA=",",DA="...";function MA(e,t){var n=((e=e.replace(/\s/g,"")).length-e.replace(RA,"").length)/OA.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(OA,'").'));var r=E(e.split(OA),2),a=r[0],i=r[1];ap(-1===a.indexOf(DA),(function(){return'The ellipsis notation ("'.concat(DA,'") is not supported yet.')}));var o=a.split(PA),s=o.length;if(t!==s)throw new Error("Expected ".concat(s," input tensors, received ").concat(t));if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var u=[],c=function(){var e=i[l];if(!o.some((function(t){return-1!==t.indexOf(e)})))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===u.indexOf(e)&&u.push(e)},l=0;l<i.length;++l)c();for(var f=0;f<a.length;++f){var h=a[f];-1===u.indexOf(h)&&h!==PA&&u.push(h)}for(var d=new Array(o.length),p=0;p<s;++p){if(new Set(o[p].split("")).size!==o[p].length)throw new Error("Found duplicate axes in input component ".concat(o[p],". ")+"Support for duplicate axes in input is not implemented yet.");d[p]=[];for(var v=0;v<o[p].length;++v)d[p].push(u.indexOf(o[p][v]))}for(var g=u.length,m=[],y=i.length;y<g;++y)m.push(y);return{allDims:u,summedDims:m,idDims:d}}function FA(e,t){var n=new Array(e);n.fill(-1);for(var r=0;r<t.length;++r)n[t[r]]=r;for(var a=[],i=0;i<e;++i)-1===n[i]&&a.push(i);return n=n.filter((function(e){return-1!==e})),{permutationIndices:n,expandDims:a}}function LA(e,t,n){for(var r=new Array(e),a=function(e){for(var a=n[e].shape,i=function(n){void 0===r[t[e][n]]?r[t[e][n]]=a[n]:ap(r[t[e][n]]===a[n],(function(){return"Expected dimension ".concat(r[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<t[e].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function jA(e,t){var n,r=e,a=[];0===e.length&&r.push(-1),n=e.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],s=0;s<r.length;++s){var u,c=U(UA(t,r[s]));try{for(c.s();!(u=c.n()).done;){var l=u.value;-1===o.indexOf(l)&&(a[s].push(l),o.push(l))}}catch(Wse){c.e(Wse)}finally{c.f()}}return{path:r,steps:a}}function zA(e){return e.every((function(e,t){return e===t}))}function UA(e,t){for(var n=[],r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function BA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)ap(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);ap(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}ap(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function WA(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function VA(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function GA(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function HA(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function KA(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function qA(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],u=[],c=1,l=1,f=1,h=0;h<r;++h)u.push(e.shape[h]),c*=e.shape[h];for(var d=r;d<n;d++)u.push(e.shape[d]),l*=e.shape[d];for(var p=r;p<a;p++)u.push(t.shape[p]);for(var v=n+1;v<i;v++)u.push(e.shape[v]),f*=e.shape[v];return{batchSize:c,sliceSize:f,outerSize:l,dimSize:s,outputShape:u}}function XA(e){try{return e.map((function(e){return wy(e)}))}catch(Wse){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(Wse))}}function YA(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=_x(e,"int32"),i=_x([n.length,e.length],"int32"),o=0;o<n.length;o++){var s=a.indexToLoc(n[o]),u=o*e.length;i.values.set(s,u)}return i.toTensor()}!function(){var e,t=U(fk);try{for(t.s();!(e=t.n()).done;){Xx(e.value)}}catch(Wse){t.e(Wse)}finally{t.f()}}();var ZA={kernelName:Vp,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(e,tC(Ex(n,"float32"),-1))}}}},QA={kernelName:Gp,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){var t=Wx(Ex(n,"float32")),r=Bx(ek(Hx(1),t));return fI(zx(e,r))}}}},JA={kernelName:Hp,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){var t=Bx(ek(Wx(Ex(n,"float32")),1));return zx(e,t)}}}},$A={kernelName:Kp,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=ik(r.shape,a.shape);return{a:function(){var t=e,n=ak(r.shape,i);return n.length>0&&(t=Xw(t,n)),fw(t,r.shape)},b:function(){var t=e,n=ak(a.shape,i);return n.length>0&&(t=Xw(t,n)),fw(t,a.shape)}}}},eS={kernelName:qp,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},tS={kernelName:Zp,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Vx(n)}}}},nS={kernelName:Qp,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Vx(n)}}}},rS={kernelName:Jp,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return zx(e,Bx(ek(Hx(1),Wx(Ex(n,"float32")))))}}}},aS={kernelName:$p,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){var t=Bx(Lx(Hx(1),Wx(Ex(n,"float32"))));return zx(e,t)}}}},iS={kernelName:nv,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=ik(r.shape,a.shape);return{a:function(){var t=Lx(Wx(r),Wx(a)),n=Ux(e,zx(a,t)),o=ak(r.shape,i);return o.length>0&&(n=Xw(n,o)),fw(n,r.shape)},b:function(){var t=Lx(Wx(r),Wx(a)),n=fI(Ux(e,zx(r,t))),o=ak(a.shape,i);return o.length>0&&(n=Xw(n,o)),fw(n,a.shape)}}}},oS={kernelName:ev,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return zx(e,Lx(Wx(Ex(n,"float32")),1))}}}},sS={kernelName:tv,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return zx(e,ek(Hx(1),Wx(Ex(n,"float32"))))}}}};var uS=vb({avgPool3dGrad_:function(e,t,n,r,a,i){var o=hb(e,"dy","avgPool3dGrad"),s=hb(t,"input","avgPool3dGrad"),u=o,c=s,l=!1;4===s.rank&&(l=!0,u=fw(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=fw(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),ap(5===u.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")})),ap(5===c.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")})),lw("avgPool3dGrad",a,i);var f={dy:u,input:c},h={filterSize:n,strides:r,pad:a,dimRoundingMode:i},d=ab.runKernel(ov,f,h);return l?fw(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),cS={kernelName:iv,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad,s=n.dimRoundingMode;return{x:function(){return uS(e,r,a,i,o,s)}}}};var lS=vb({avgPoolGrad_:function(e,t,n,r,a){var i=hb(e,"dy","avgPoolGrad"),o=hb(t,"input","avgPoolGrad");ap(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var s=o,u=i,c=!1;3===o.rank&&(c=!0,s=fw(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=fw(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ap(4===u.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),ap(4===s.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")}));var l={dy:u,input:s},f={filterSize:n,strides:r,pad:a},h=ab.runKernel(av,l,f);return c?fw(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),fS={kernelName:rv,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad;return{x:function(){return lS(e,r,a,i,o)}}}},hS={kernelName:sv,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],i=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return Qw(e,i,!1,!1)},b:function(){return Qw(e,a,!0,!1)}}:o&&!s?{a:function(){return Qw(i,e,!1,!0)},b:function(){return Qw(a,e,!1,!1)}}:{a:function(){return Qw(i,e,!0,!0)},b:function(){return Qw(e,a,!0,!0)}}:{a:function(){return Qw(e,i,!1,!0)},b:function(){return Qw(a,e,!0,!1)}}}};var dS=vb({spaceToBatchND_:function(e,t,n){var r=hb(e,"x","spaceToBatchND");ap(r.rank>=1+t.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)})),ap(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),ap(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var a={x:r},i={blockShape:t,paddings:n};return ab.runKernel(bm,a,i)}}),pS={kernelName:uv,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return dS(e,r,a)}}}},vS={kernelName:"BroadcastTo",gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var u=[],c=0;c<o.length;c++)o[c]>1&&u.push(c);return{x:function(){return Xw(e,u,!0)}}}},gS={kernelName:fv,gradFunc:function(e){return{x:function(){return e.clone()}}}},mS={kernelName:hv,gradFunc:function(e){return{x:function(){return Vx(e)}}}},yS={kernelName:dv,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.clipValueMin,i=n.clipValueMax;return{x:function(){return GI(Zw(Vw(r,a),LC(r,i)),e,Vx(e))}}}},bS={kernelName:vv,inputsToSave:["x"],gradFunc:ZA.gradFunc},xS={kernelName:gv,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=pp(n.axis,t[0].shape)[0],i=r.map((function(e){return e[a]}));return LI(e,i,a).map((function(e){return function(){return e}}))}},kS={kernelName:mv,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],i=r[1],o=n.dilations,s=n.strides,u=n.pad,c=n.dataFormat;return ap(ow(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return _w(a.shape,e,i,s,u,c)},filter:function(){return $I(a,e,i.shape,s,u,c)}}}},wS={kernelName:bv,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],i=r[1],o=n.strides,s=n.pad,u=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return Aw(e,i,o,s,u,1,c)},filter:function(){return $I(e,a,i.shape,o,s,u,c)}}}};var IS=vb({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=fw(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;4===o.rank&&(o=fw(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),ap(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),ap(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),ap(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),ap(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),ap(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var s={x:i,dy:o},u={strides:r,pad:a,filterShape:n};return ab.runKernel(kv,s,u)}}),CS={kernelName:xv,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;ap(ow(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=E(t,2),s=o[0],u=o[1];return{x:function(){return Nw(s.shape,e,u,a,i)},filter:function(){return IS(s,e,u.shape,a,i)}}}};var AS=vb({sin_:function(e){var t={x:hb(e,"x","sin","float32")};return ab.runKernel(hm,t)}}),SS={kernelName:Iv,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(fI(AS(Ex(n,"float32"))),e)}}}};var _S=vb({sinh_:function(e){var t={x:hb(e,"x","sinh")};return ab.runKernel(dm,t)}}),ES={kernelName:Cv,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(_S(Ex(n,"float32")),e)}}}};var TS=vb({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:hb(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return ab.runKernel(Sv,a,i)}}),NS={kernelName:Sv,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.axis,i=n.exclusive,o=n.reverse;return{x:function(){var t=sI([a],r.rank),n=TS(e,a,i,!o);return null!=t&&(n=qI(n,t)),n}}}},OS={kernelName:Nv,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,o=n.dimRoundingMode,s=null==r?[1,1]:r;ap(ow(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var u=E(t,2),c=u[0],l=u[1];return ap(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")})),ap(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,".")})),ap(c.shape[3]===l.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],".")})),ap(sw(a,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")})),lw("depthwiseConv2d",i,o),{x:function(){return uC(c.shape,e,l,a,i,s,o)},filter:function(){return sC(c,e,l.shape,a,i,s,o)}}}},RS={kernelName:Dv,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],i=r[1],o={x:a,filter:i,dy:e},s={x:a,filter:i,dy:e};return{x:function(){return ab.runKernel(Mv,o,n)},filter:function(){return ab.runKernel(Fv,s,n)}}}},PS={kernelName:zv,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:E(t,1)[0]};return{x:function(){return ab.runKernel(Uv,n)}}}},DS={kernelName:Bv,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0],r=Ux(Fw(fI(Wx(n))),2/Math.sqrt(Math.PI));return{x:function(){return Ux(e,r)}}}},MS={kernelName:Vv,outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(e,n)}}}},FS={kernelName:Gv,inputsToSave:["input"],gradFunc:function(e,t){var n=E(t,1)[0];return{input:function(){return fw(e,n.shape)}}}},LS={kernelName:Hv,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(e,Fw(n))}}}},jS={kernelName:Yv,gradFunc:function(e){return{x:function(){return Vx(e)}}}},zS={kernelName:Zv,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=ik(r.shape,a.shape);return{a:function(){var t=zx(e,Ex(a,"float32")),n=ak(r.shape,i);return n.length>0?fw(Xw(t,n),r.shape):t},b:function(){var t=Ux(e,Ex(r,"float32")),n=ak(a.shape,i);n.length>0&&(t=fw(Xw(t,n),a.shape));var o=Wx(a);return fI(zx(t,Ex(o,"float32")))}}}};var US=vb({rsqrt_:function(e){var t={x:hb(e,"x","rsqrt","float32")};return ab.runKernel(om,t)}}),BS={kernelName:Qv,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=E(t,4),i=a[0],o=a[1],s=a[2],u=a[3],c=null==u?Hx(1):u,l=ak(o.shape,i.shape),f=[];if(1===o.rank){for(var h=0;h<i.shape.length-1;++h)f.push(i.shape[h]);f.push(1)}var d=ek(i,o),p=Ux(e,c),v=US(Lx(s,Hx(r))),g=Ux(Ux(Ux(v,v),v),Hx(-.5));return{x:function(){return 1===o.rank?fw(Ux(Ux(e,jw(fw(v,[1,1,1,o.shape[0]]),f)),c),i.shape):fw(Ux(Ux(e,v),c),i.shape)},mean:function(){var e=Ux(Ux(v,Hx(-1)),p);return 1===o.rank&&(e=Xw(e,l)),fw(e,o.shape)},variance:function(){var e=Ux(Ux(g,d),p);return 1===o.rank&&(e=Xw(e,l)),fw(e,o.shape)},scale:function(){var t=Ux(d,v),n=Ux(e,t);return 1===o.rank&&(n=Xw(n,l)),fw(n,o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=Xw(t,l)),fw(t,o.shape)}}}};var WS=vb({unsortedSegmentSum_:function(e,t,n){var r=hb(e,"x","unsortedSegmentSum"),a=hb(t,"segmentIds","unsortedSegmentSum","int32");ap(cp(n),(function(){return"numSegments must be of dtype int"}));var i={x:r,segmentIds:a},o={numSegments:n};return ab.runKernel(Wm,i,o)}}),VS={kernelName:Jv,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],i=r[1],o=n.axis,s=pp(o,a.shape)[0];return{x:function(){var t=a.shape,n=i.size,r=t.slice(0,s),u=r.length,c=t.slice(o,t.length).slice(1),l=c.length,f=GS(0,u),h=GS(u+1,u+1+l),d=HS([r,[n],c]),p=fw(e,d),v=fw(i,[n]),g=HS([[u],f,h]),m=qI(p,g),y=WS(m,v,a.shape[s]),b=uI(g);return y=qI(y,b)},indices:function(){return i}}}};function GS(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function HS(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var KS={kernelName:tg,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1];return{a:function(){return Vx(r)},b:function(){return Vx(a)}}}},qS={kernelName:ng,gradFunc:function(e){return{x:function(){return Ex(e,"float32")}}}},XS={kernelName:ig,gradFunc:function(e){return{x:function(){return Vx(e)}}}},YS={kernelName:og,gradFunc:function(e){return{x:function(){return Vx(e)}}}},ZS={kernelName:sg,gradFunc:function(e){return{x:function(){return Vx(e)}}}},QS={kernelName:ug,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.alpha,i=Ww(r,0);return{x:function(){return GI(i,e,Ux(e,a))}}}},JS={kernelName:dg,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return zx(e,Lx(n,1))}}}},$S={kernelName:hg,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return zx(e,Ex(n,"float32"))}}}},e_={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.axis;return{logits:function(){var t=Fw(r);return ek(e,Ux(Xw(e,a,!0),t))}}}};var t_=vb({localResponseNormalizationBackprop_:function(e,t,n){var r={x:e,y:t,dy:n},a={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return ab.runKernel(yg,r,a)}}),n_={kernelName:mg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],i=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,c=n.beta;return{x:function(){return t_(a,i,e,o,s,u,c)}}}};function r_(e,t,n,r){return t.rank<n.rank&&(t=fw(t,iI(t.shape,r))),e.rank<n.rank&&(e=fw(e,iI(e.shape,r))),{x:function(){return Ux(e,Ex(Mw(n,t),e.dtype))}}}var a_={kernelName:bg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=r_(e,t[1],a,pp(r,a.shape));return{x:function(){return i.x()}}}};var i_=vb({less_:function(e,t){var n=hb(e,"a","less","string_or_numeric"),r=hb(t,"b","less","string_or_numeric"),a=E(Yy(n,r),2);n=a[0],r=a[1],ik(n.shape,r.shape);var i={a:n,b:r};return ab.runKernel(cg,i)}}),o_={kernelName:xg,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1];return{a:function(){return Ux(e,Ex(Vw(r,a),"float32"))},b:function(){return Ux(e,Ex(i_(r,a),"float32"))}}}};var s_=vb({maxPool3dGrad_:function(e,t,n,r,a,i,o){var s=hb(e,"dy","maxPool3dGrad"),u=hb(t,"input","maxPool3dGrad"),c=hb(n,"output","maxPool3dGrad"),l=s,f=u,h=c,d=!1;4===u.rank&&(d=!0,l=fw(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),f=fw(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),h=fw(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),ap(5===l.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")})),ap(5===f.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(f.rank,".")})),ap(5===h.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(h.rank,".")})),lw("maxPool3dGrad",i,o);var p={dy:l,input:f,output:h},v={filterSize:r,strides:a,pad:i,dimRoundingMode:o},g=ab.runKernel(Cg,p,v);return d?fw(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),u_={kernelName:Ig,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad,c=n.dimRoundingMode;return{x:function(){return s_(e,a,i,o,s,u,c)}}}};var c_=vb({maxPoolGrad_:function(e,t,n,r,a,i,o){var s=hb(e,"dy","maxPoolGrad"),u=hb(t,"input","maxPoolGrad"),c=hb(n,"output","maxPoolGrad");ap(u.rank===s.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(s.rank,")")})),ap(4===s.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),ap(4===u.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")})),lw("maxPoolGrad",i,o);var l={dy:s,input:u,output:c},f={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return ab.runKernel(wg,l,f)}}),l_={kernelName:kg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad;return{x:function(){return c_(e,a,i,o,s,u)}}}},f_={kernelName:Sg,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=pp(n.axis,r.shape),i=sp(aI(r.shape,a)[1]);return{x:function(){var t=r.shape.slice();a.forEach((function(e){t[e]=1}));var n=fw(e,t);return zx(Ux(n,vI(r.shape,"float32")),i)}}}},h_={kernelName:_g,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=E(t,2),i=a[0],o=r_(e,a[1],i,pp(r,i.shape));return{x:function(){return o.x()}}}},d_={kernelName:Eg,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1];return{a:function(){return Ux(e,Ex(LC(r,a),"float32"))},b:function(){return Ux(e,Ex(Ww(r,a),"float32"))}}}},p_={kernelName:Tg,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return NI(e,a,r.shape)}}}},v_={kernelName:Ng,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=ik(r.shape,a.shape);return{a:function(){var t=ak(r.shape,i);return t.length>0?fw(Xw(e,t),r.shape):e},b:function(){var t=Ux(e,fI(Uw(zx(r,a)))),n=ak(a.shape,i);return n.length>0?fw(Xw(t,n),a.shape):t}}}},g_={kernelName:Rg,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=ik(r.shape,a.shape);return{a:function(){var t=Ux(e,Ex(a,"float32")),n=ak(r.shape,i);return n.length>0?fw(Xw(t,n),r.shape):t},b:function(){var t=Ux(e,Ex(r,"float32")),n=ak(a.shape,i);return n.length>0?fw(Xw(t,n),a.shape):t}}}},m_={kernelName:Pg,gradFunc:function(e){return{x:function(){return fI(e)}}}},y_={kernelName:zg,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return pI(n.shape,"float32")}}}},b_={kernelName:jg,gradFunc:function(e){return{x:function(){return Vx(e)}}}},x_={kernelName:Ug,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return VI(e,r).map((function(e){return function(){return e}}))}},k_={kernelName:Bg,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return NI(e,a,r.shape)}}}},w_={kernelName:Wg,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,3),r=n[0],a=n[1],i=n[2],o=r,s=a,u=ik(o.shape,s.shape);return{a:function(){var t=Ex(s,"float32"),n=Ux(e,Ux(t,$x(o,ek(t,Hx(1))))),r=ak(o.shape,u);return r.length>0&&(n=Xw(n,r)),fw(n,o.shape)},b:function(){var t=Ww(o,0),n=GI(t,Hw(o),Vx(o)),r=Ux(e,Ux(i,n)),a=ak(s.shape,u);return a.length>0&&(r=Xw(r,a)),fw(r,s.shape)}}}},I_={kernelName:Vg,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=Ww(r,0);return{x:function(){return GI(i,e,Ux(e,a))},alpha:function(){var t=GI(i,Vx(e),Ux(e,r)),n=ak(a.shape,e.shape);return n.length>0&&(t=Xw(t,n)),fw(t,a.shape)}}}};var C_=vb({cumprod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:hb(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return ab.runKernel(Av,a,i)}});function A_(e,t,n){var r=e.shape.length,a=r-n.length,i=sI(n,r),o=e;null!=i&&(o=qI(e,i));var s=o.shape.slice(),u=s.splice(r-n.length,n.length).reduce((function(e,t){return e*t}),1);s.push(u);var c=function(e,t,n){var r=e.shape.slice();r[n]=1;var a=fw(t,r),i=C_(e,n,!0,!1),o=C_(e,n,!0,!0),s=Ux(i,o);return Ux(a,s)}(o.reshape(s),t,a);if(c=c.reshape(o.shape),null!=i){var l=uI(i);c=qI(c,l)}return c}var S_={kernelName:Gg,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.axis,i=[];return i=void 0===a||null===a?r.shape.map((function(e,t){return t})):"number"===typeof a?[a]:a,{x:function(){return A_(r,e,i)}}}},__={kernelName:Lv,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=ik(r.shape,a.shape);return{a:function(){var t=zx(e,Ex(a,"float32")),n=ak(r.shape,i);return n.length>0?fw(Xw(t,n),r.shape):t},b:function(){var t=Ux(e,Ex(r,"float32")),n=ak(a.shape,i);n.length>0&&(t=fw(Xw(t,n),a.shape));var o=Wx(a);return fI(zx(t,Ex(o,"float32")))}}}},E_={kernelName:Zg,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return zx(e,fI(Wx(n)))}}}},T_={kernelName:rm,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0],r=Ux(LC(n,6),tC(n));return{x:function(){return Ux(e,Ex(r,"float32"))}}}},N_={kernelName:Qg,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(e,Ex(tC(n),"float32"))}}}},O_={kernelName:Jg,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return fw(e,n.shape)}}}},R_={kernelName:tm,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:E(t,1)[0]};return{images:function(){return ab.runKernel(nm,r,n)}}}},P_={kernelName:$g,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:E(t,1)[0]};return{images:function(){return ab.runKernel(em,r,n)}}}},D_={kernelName:am,gradFunc:function(e,t,n){var r=pp(n.dims,e.shape);return{x:function(){return SI(e,r)}}}},M_={kernelName:im,gradFunc:function(e){return{x:function(){return Vx(e)}}}},F_={kernelName:om,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return fI(zx(e,Ux($x(n,1.5),2)))}}}};var L_=vb({logicalNot_:function(e){var t={x:hb(e,"x","logicalNot","bool")};return ab.runKernel(vg,t)}}),j_={kernelName:cm,inputsToSave:["condition"],gradFunc:function(e,t){var n=E(t,1)[0];return{condition:function(){return Ex(Vx(n),"float32")},t:function(){return Ux(e,Ex(n,e.dtype))},e:function(){return Ux(e,Ex(L_(n),e.dtype))}}}},z_={kernelName:lm,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){var t=Ww(n,Hx(0)),r=Hx(bA),a=Hx(xA),i=Ux(e,a),o=Ux(Ux(e,r),Fw(Ex(n,"float32")));return GI(t,i,o)}}}},U_={kernelName:vm,outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(e,Ux(n,ek(Hx(1),n)))}}}},B_={kernelName:pm,gradFunc:function(e){return{x:function(){return Vx(e)}}}};var W_=vb({cos_:function(e){var t={x:hb(e,"x","cos","float32")};return ab.runKernel(Iv,t)}}),V_={kernelName:hm,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(W_(Ex(n,"float32")),e)}}}};var G_=vb({cosh_:function(e){var t={x:hb(e,"x","cosh","float32")};return ab.runKernel(Cv,t)}}),H_={kernelName:dm,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(G_(Ex(n,"float32")),e)}}}},K_={kernelName:fm,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=E(t,1)[0],a=n.begin,i=n.size,o=r.shape,s=E(Gk(r,a,i),2),u=s[0],c=s[1],l=[],f=0;f<e.rank;f++)l.push([u[f],o[f]-u[f]-c[f]]);return{x:function(){return mI(e,l)}}}},q_={kernelName:km,outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.dim,i=Ux(e,r);return{logits:function(){return ek(i,Ux(Xw(i,[a],true),r))}}}},X_={kernelName:gm,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(e,TI(n))}}}};var Y_=vb({batchToSpaceND_:function(e,t,n){var r=hb(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));ap(r.rank>=1+t.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)})),ap(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),ap(r.shape[0]%a===0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)}));var i={x:r},o={blockShape:t,crops:n};return ab.runKernel(uv,i,o)}}),Z_={kernelName:bm,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return Y_(e,r,a)}}}},Q_={kernelName:xm,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return xw(e,r)}}}},J_={kernelName:_m,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=Hx(2);return{a:function(){return Ux(e,Ux(i,ek(r,a)))},b:function(){return Ux(e,Ux(i,ek(a,r)))}}}},$_={kernelName:Pm,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],i=ik(r.shape,a.shape);return{a:function(){var t=e,n=ak(r.shape,i);return n.length>0&&(t=Xw(t,n)),fw(t,r.shape)},b:function(){var t=e,n=ak(a.shape,i);return n.length>0&&(t=Xw(t,n)),fw(fI(t),a.shape)}}}},eE={kernelName:ym,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=r.shape.slice();pp(n.axis,r.shape).forEach((function(e){a[e]=1}));var i=fw(e,a),o=Ux(i,vI(r.shape,"float32"));return{x:function(){return o}}}},tE={kernelName:Mm,outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(ek(Hx(1),Wx(n)),e)}}}},nE={kernelName:Fm,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.reps;return{x:function(){var t=Vx(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=Lx(t,NI(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=Lx(t,NI(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<a[0];++s)for(var u=0;u<a[1];++u)for(var c=0;c<a[2];++c)t=Lx(t,NI(e,[s*r.shape[0],u*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var f=0;f<a[1];++f)for(var h=0;h<a[2];++h)for(var d=0;d<a[3];++d)t=Lx(t,NI(e,[l*r.shape[0],f*r.shape[1],h*r.shape[2],d*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},rE={kernelName:Wm,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return function(e,t){for(var n=ok(t,Vx(t)),r=Bw(e,n),a=Vw(t,Hx(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=Lw(a,o+1);a=Zw(a,vI(r.shape,"bool"));var s=Vx(r);return GI(a,r,s)}(e,n)}}}};for(var aE=0,iE=[ZA,QA,JA,$A,eS,tS,nS,rS,aS,iS,oS,sS,cS,fS,hS,pS,vS,gS,mS,yS,bS,xS,wS,kS,CS,SS,ES,NS,OS,RS,__,PS,DS,MS,FS,LS,zS,jS,BS,VS,KS,qS,XS,YS,ZS,QS,JS,$S,e_,n_,a_,a_,o_,u_,l_,f_,h_,d_,p_,v_,g_,m_,y_,b_,x_,k_,k_,w_,I_,S_,E_,T_,N_,O_,R_,P_,D_,M_,F_,j_,z_,U_,B_,V_,H_,K_,q_,X_,Z_,Z_,Q_,Q_,{kernelName:mm,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return zx(e,Ux(Bx(Ex(n,"float32")),2))}}}},J_,{kernelName:Em,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Ux(e,Ux(Ex(n,"float32"),2))}}}},{kernelName:Gm,gradFunc:function(e){return{x:function(){return Vx(e)}}}},$_,eE,{kernelName:Dm,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return zx(e,Wx(W_(n)))}}}},tE,nE,{kernelName:zm,gradFunc:function(e,t,n){var r=uI(n.perm);return{x:function(){return qI(e,r)}}}},{kernelName:Bm,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return zI(e,r)}}}},rE,{kernelName:Vm,gradFunc:function(e){return{x:function(){return Vx(e)}}}}];aE<iE.length;aE++){ny(iE[aE])}zy().prototype.abs=function(){return this.throwIfDisposed(),nk(this)};var oE=vb({acos_:function(e){var t={x:hb(e,"x","acos")};return ab.runKernel(Gp,t)}});zy().prototype.acos=function(){return this.throwIfDisposed(),oE(this)};var sE=vb({acosh_:function(e){var t={x:hb(e,"x","acosh")};return ab.runKernel(Hp,t)}});zy().prototype.acosh=function(){return this.throwIfDisposed(),sE(this)},zy().prototype.add=function(e){return this.throwIfDisposed(),Lx(this,e)},zy().prototype.all=function(e,t){return this.throwIfDisposed(),qk(this,e,t)},zy().prototype.any=function(e,t){return this.throwIfDisposed(),Xk(this,e,t)},zy().prototype.argMax=function(e){return this.throwIfDisposed(),Yk(this,e)};var uE=vb({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:hb(e,"x","argMin")},r={axis:t};return ab.runKernel(Qp,n,r)}});zy().prototype.argMin=function(e){return this.throwIfDisposed(),uE(this,e)},zy().prototype.asScalar=function(){return this.throwIfDisposed(),ap(1===this.size,(function(){return"The array must have only 1 element."})),fw(this,[])},zy().prototype.asType=function(e){return this.throwIfDisposed(),Ex(this,e)},zy().prototype.as1D=function(){return this.throwIfDisposed(),fw(this,[this.size])},zy().prototype.as2D=function(e,t){return this.throwIfDisposed(),fw(this,[e,t])},zy().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),fw(this,[e,t,n])},zy().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),fw(this,[e,t,n,r])},zy().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),fw(this,[e,t,n,r,a])};var cE=vb({asin_:function(e){var t={x:hb(e,"x","asin")};return ab.runKernel(Jp,t)}});zy().prototype.asin=function(){return this.throwIfDisposed(),cE(this)};var lE=vb({asinh_:function(e){var t={x:hb(e,"x","asinh")};return ab.runKernel($p,t)}});zy().prototype.asinh=function(){return this.throwIfDisposed(),lE(this)};var fE=vb({atan_:function(e){var t={x:hb(e,"x","atan")};return ab.runKernel(ev,t)}});zy().prototype.atan=function(){return this.throwIfDisposed(),fE(this)};var hE=vb({atan2_:function(e,t){var n=hb(e,"a","atan2"),r=hb(t,"b","atan2"),a=E(Yy(n,r),2),i={a:n=a[0],b:r=a[1]};return ab.runKernel(nv,i)}});zy().prototype.atan2=function(e){return this.throwIfDisposed(),hE(this,e)};var dE=vb({atanh_:function(e){var t={x:hb(e,"x","atanh")};return ab.runKernel(tv,t)}});zy().prototype.atanh=function(){return this.throwIfDisposed(),dE(this)},zy().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),hw(this,e,t,n,r)},zy().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Y_(this,e,t)},zy().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),pw(this,e,t,n,r,a)},zy().prototype.broadcastTo=function(e){return this.throwIfDisposed(),yw(this,e)},zy().prototype.cast=function(e){return this.throwIfDisposed(),Ex(this,e)};var pE=vb({ceil_:function(e){var t={x:hb(e,"x","ceil","float32")};return ab.runKernel(hv,t)}});zy().prototype.ceil=function(){return this.throwIfDisposed(),pE(this)},zy().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),bw(this,e,t)},zy().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof jy&&(e=[e]),xw([this].concat(X(e)),t)},zy().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Sw(this,e,t,n,r,a,i)},zy().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),Ew(this,e,t,n,r,a)},zy().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Aw(this,e,t,n,r,a,i)},zy().prototype.cos=function(){return this.throwIfDisposed(),W_(this)},zy().prototype.cosh=function(){return this.throwIfDisposed(),G_(this)},zy().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),C_(this,e,t,n)},zy().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),TS(this,e,t,n)};var vE=vb({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=hb(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];ap(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)})),ap(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)})),ap(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)})),ap(o%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)}));var s={x:r},u={blockSize:t,dataFormat:n};return ab.runKernel(Tv,s,u)}});zy().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),vE(this,e,t)},zy().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Pw(this,e,t,n,r,a,i)};var gE=vb({dilation2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=hb(e,"x","dilation2d"),s=hb(t,"filter","dilation2d");ap(3===o.rank||4===o.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")})),ap(3===s.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),ap("NHWC"===i,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i)}));var u=o,c=!1;3===o.rank&&(u=fw(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),ap(u.shape[3]===s.shape[2],(function(){return"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(s.shape[2])}));var l={x:u,filter:s},f={strides:n,pad:r,dilations:a},h=ab.runKernel(Dv,l,f);return c?fw(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});zy().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),gE(this,e,t,n,r,a)};var mE=vb({divNoNan_:function(e,t){var n=hb(e,"a","div"),r=hb(t,"b","div"),a=E(Yy(n,r),2);n=a[0],r=a[1];var i=zx(n,r),o=Vx(i),s=Mw(r,o);return GI(s,o,i)}});zy().prototype.divNoNan=function(e){return this.throwIfDisposed(),mE(this,e)},zy().prototype.div=function(e){return this.throwIfDisposed(),zx(this,e)};var yE=vb({dot_:function(e,t){var n=hb(e,"t1","dot"),r=hb(t,"t2","dot");ap((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(ap(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")})),1===n.rank&&1===r.rank){var o=fw(n,[1,-1]),s=fw(r,[-1,1]),u=Qw(o,s);return fw(u,[])}if(1===n.rank&&2===r.rank){var c=fw(n,[1,-1]),l=fw(r,[r.shape[0],r.shape[1]]),f=Qw(c,l);return fw(f,[f.size])}if(2===n.rank&&1===r.rank){var h=fw(r,[-1,1]),d=Qw(n,h);return fw(d,[d.size])}var p=fw(r,[r.shape[0],r.shape[1]]);return Qw(n,p)}});zy().prototype.dot=function(e){return this.throwIfDisposed(),yE(this,e)},zy().prototype.elu=function(){return this.throwIfDisposed(),Dw(this)},zy().prototype.equal=function(e){return this.throwIfDisposed(),Mw(this,e)};var bE=vb({erf_:function(e){var t=hb(e,"x","erf");ap("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Ex(t,"float32"));var n={x:t};return ab.runKernel(Bv,n)}});zy().prototype.erf=function(){return this.throwIfDisposed(),bE(this)};var xE=vb({euclideanNorm_:function(e){return VC(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});zy().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),xE(this,e,t)},zy().prototype.exp=function(){return this.throwIfDisposed(),Fw(this)},zy().prototype.expandDims=function(e){return this.throwIfDisposed(),Lw(this,e)};var kE=vb({expm1_:function(e){var t={x:hb(e,"x","expm1")};return ab.runKernel(Hv,t)}});zy().prototype.expm1=function(){return this.throwIfDisposed(),kE(this)},zy().prototype.fft=function(){return this.throwIfDisposed(),YI(this)},zy().prototype.flatten=function(){return this.throwIfDisposed(),fw(this,[this.size])},zy().prototype.floor=function(){return this.throwIfDisposed(),Uw(this)},zy().prototype.floorDiv=function(e){return this.throwIfDisposed(),jx(this,e)},zy().prototype.gather=function(e,t){return this.throwIfDisposed(),Bw(this,e,t)},zy().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Vw(this,e)},zy().prototype.greater=function(e){return this.throwIfDisposed(),Ww(this,e)},zy().prototype.ifft=function(){return this.throwIfDisposed(),QI(this)},zy().prototype.irfft=function(){return this.throwIfDisposed(),JI(this)};var wE=vb({isFinite_:function(e){var t={x:hb(e,"x","isFinite")};return ab.runKernel(ig,t)}});zy().prototype.isFinite=function(){return this.throwIfDisposed(),wE(this)};var IE=vb({isInf_:function(e){var t={x:hb(e,"x","isInf")};return ab.runKernel(og,t)}});zy().prototype.isInf=function(){return this.throwIfDisposed(),IE(this)};var CE=vb({isNaN_:function(e){var t={x:hb(e,"x","isNaN")};return ab.runKernel(sg,t)}});zy().prototype.isNaN=function(){return this.throwIfDisposed(),CE(this)},zy().prototype.leakyRelu=function(e){return this.throwIfDisposed(),Gw(this,e)},zy().prototype.lessEqual=function(e){return this.throwIfDisposed(),LC(this,e)},zy().prototype.less=function(e){return this.throwIfDisposed(),i_(this,e)};var AE=vb({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=hb(e,"x","localResponseNormalization");ap(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")})),ap(cp(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var o=i,s=!1;3===i.rank&&(s=!0,o=fw(i,[1,i.shape[0],i.shape[1],i.shape[2]]));var u={x:o},c={depthRadius:t,bias:n,alpha:r,beta:a},l=ab.runKernel(mg,u,c);return s?fw(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});zy().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),AE(this,e,t,n,r)};var SE=vb({logSigmoid_:function(e){var t=hb(e,"x","logSigmoid"),n=Gx((function(e){return{value:fI(FI(fI(e))),gradFunc:function(t){return Ux(t,TI(fI(e)))}}}));return n(t)}});zy().prototype.logSigmoid=function(){return this.throwIfDisposed(),SE(this)},zy().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Yw(this,e)},zy().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),YC(this,e,t)},zy().prototype.log=function(){return this.throwIfDisposed(),Hw(this)},zy().prototype.log1p=function(){return this.throwIfDisposed(),Kw(this)},zy().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Zw(this,e)},zy().prototype.logicalNot=function(){return this.throwIfDisposed(),L_(this)};var _E=vb({logicalOr_:function(e,t){var n=hb(e,"a","logicalOr","bool"),r=hb(t,"b","logicalOr","bool");ik(n.shape,r.shape);var a={a:n,b:r};return ab.runKernel(gg,a)}});zy().prototype.logicalOr=function(e){return this.throwIfDisposed(),_E(this,e)};var EE=vb({logicalXor_:function(e,t){var n=hb(e,"a","logicalXor","bool"),r=hb(t,"b","logicalXor","bool");return ik(n.shape,r.shape),Zw(_E(e,t),L_(Zw(e,t)))}});zy().prototype.logicalXor=function(e){return this.throwIfDisposed(),EE(this,e)},zy().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Qw(this,e,t,n)},zy().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Jw(this,e,t,n,r)},zy().prototype.max=function(e,t){return this.throwIfDisposed(),qw(this,e,t)},zy().prototype.maximum=function(e){return this.throwIfDisposed(),ok(this,e)},zy().prototype.mean=function(e,t){return this.throwIfDisposed(),eI(this,e,t)},zy().prototype.min=function(e,t){return this.throwIfDisposed(),tI(this,e,t)},zy().prototype.minimum=function(e){return this.throwIfDisposed(),nI(this,e)};var TE=vb({mirrorPad_:function(e,t,n){ap("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=hb(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ap(t.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,".")}));for(var a="reflect"===n?1:0,i=function(e){ap(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),ap(t[e][0]>=0&&t[e][0]<=r.shape[e]-a&&t[e][1]>=0&&t[e][1]<=r.shape[e]-a,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(r.shape[e]-a," or less than 0 for input of ")+"shape ".concat(r.shape)}))},o=0;o<r.rank;o++)i(o);var s={paddings:t,mode:n},u={x:r};return ab.runKernel(Tg,u,s)}});zy().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),TE(this,e,t)};var NE=vb({mod_:function(e,t){var n=hb(e,"a","mod"),r=hb(t,"b","mod"),a=E(Yy(n,r),2),i={a:n=a[0],b:r=a[1]};return ab.runKernel(Ng,i)}});zy().prototype.mod=function(e){return this.throwIfDisposed(),NE(this,e)},zy().prototype.mul=function(e){return this.throwIfDisposed(),Ux(this,e)},zy().prototype.neg=function(){return this.throwIfDisposed(),fI(this)},zy().prototype.norm=function(e,t,n){return this.throwIfDisposed(),VC(this,e,t,n)},zy().prototype.notEqual=function(e){return this.throwIfDisposed(),hI(this,e)},zy().prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),dI(this,e,t,n)},zy().prototype.onesLike=function(){return this.throwIfDisposed(),gI(this)},zy().prototype.pad=function(e,t){return this.throwIfDisposed(),mI(this,e,t)};var OE=vb({pool_:function(e,t,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var s=hb(e,"x","maxPool"),u=s,c=!1;3===s.rank&&(c=!0,u=fw(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ap(sw(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")}));var l,f=Qk(u.shape,t,i,a,r),h=[f.dilationHeight,f.dilationWidth];l="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})),r=n.map((function(e){return e-1})),a=r.map((function(e){return Math.floor(e/2)})),i=r.map((function(e,t){return e-a[t]}));return r.map((function(e,t){return[a[t],i[t]]}))}([f.filterHeight,f.filterWidth],h):[[0,0],[0,0]];var d=1===h[0]&&1===h[1],p=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[u,c]}([f.inHeight,f.inWidth],h,l),v=E(p,2),g=v[0],m=v[1],y=d?r:"valid",b=d?u:dS(u,h,g),x=("avg"===n?function(){return hw(b,t,i,y,o)}:function(){return Jw(b,t,i,y,o)})(),k=d?x:Y_(x,h,m);return c?fw(k,[k.shape[1],k.shape[2],k.shape[3]]):k}});zy().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),OE(this,e,t,n,r,a,i)},zy().prototype.pow=function(e){return this.throwIfDisposed(),$x(this,e)},zy().prototype.prelu=function(e){return this.throwIfDisposed(),yI(this,e)};var RE=vb({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hb(e,"x","prod");"bool"===r.dtype&&(r=Ex(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return ab.runKernel(Gg,a,i)}});zy().prototype.prod=function(e,t){return this.throwIfDisposed(),RE(this,e,t)};var PE=vb({reciprocal_:function(e){var t={x:hb(e,"x","reciprocal")};return ab.runKernel(Zg,t)}});zy().prototype.reciprocal=function(){return this.throwIfDisposed(),PE(this)},zy().prototype.relu=function(){return this.throwIfDisposed(),AI(this)},zy().prototype.relu6=function(){return this.throwIfDisposed(),eC(this)},zy().prototype.reshapeAs=function(e){return this.throwIfDisposed(),fw(this,e.shape)},zy().prototype.reshape=function(e){return this.throwIfDisposed(),fw(this,e)},zy().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),DC(this,e,t,n)},zy().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),MC(this,e,t,n)},zy().prototype.reverse=function(e){return this.throwIfDisposed(),SI(this,e)},zy().prototype.rfft=function(){return this.throwIfDisposed(),ZI(this)},zy().prototype.round=function(){return this.throwIfDisposed(),jC(this)},zy().prototype.rsqrt=function(){return this.throwIfDisposed(),US(this)},zy().prototype.selu=function(){return this.throwIfDisposed(),_I(this)},zy().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),EI(this,e,t,n,r,a,i)},zy().prototype.sigmoid=function(){return this.throwIfDisposed(),TI(this)};var DE=vb({sign_:function(e){var t={x:hb(e,"x","sign")};return ab.runKernel(pm,t)}});zy().prototype.sign=function(){return this.throwIfDisposed(),DE(this)},zy().prototype.sin=function(){return this.throwIfDisposed(),AS(this)},zy().prototype.sinh=function(){return this.throwIfDisposed(),_S(this)},zy().prototype.slice=function(e,t){return this.throwIfDisposed(),NI(this,e,t)},zy().prototype.softmax=function(e){return this.throwIfDisposed(),MI(this,e)},zy().prototype.softplus=function(){return this.throwIfDisposed(),FI(this)},zy().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),dS(this,e,t)},zy().prototype.split=function(e,t){return this.throwIfDisposed(),LI(this,e,t)},zy().prototype.sqrt=function(){return this.throwIfDisposed(),Bx(this)},zy().prototype.square=function(){return this.throwIfDisposed(),Wx(this)},zy().prototype.squaredDifference=function(e){return this.throwIfDisposed(),XC(this,e)},zy().prototype.squeeze=function(e){return this.throwIfDisposed(),jI(this,e)},zy().prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof jy?[this,e]:[this].concat(X(e));return zI(n,t)},zy().prototype.step=function(e){return this.throwIfDisposed(),tC(this,e)};var ME=vb({stridedSlice_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c={x:hb(e,"x","stridedSlice","string_or_numeric")},l={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return ab.runKernel(Tm,c,l)}});zy().prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),ME(this,e,t,n,r,a,i,o,s)},zy().prototype.sub=function(e){return this.throwIfDisposed(),ek(this,e)},zy().prototype.sum=function(e,t){return this.throwIfDisposed(),Xw(this,e,t)};var FE=vb({tan_:function(e){var t={x:hb(e,"x","tan","float32")};return ab.runKernel(Dm,t)}});zy().prototype.tan=function(){return this.throwIfDisposed(),FE(this)},zy().prototype.tanh=function(){return this.throwIfDisposed(),UI(this)},zy().prototype.tile=function(e){return this.throwIfDisposed(),jw(this,e)},zy().prototype.toBool=function(){return this.throwIfDisposed(),Ex(this,"bool")},zy().prototype.toFloat=function(){return this.throwIfDisposed(),Ex(this,"float32")},zy().prototype.toInt=function(){return this.throwIfDisposed(),Ex(this,"int32")};var LE=vb({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=hb(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));var i={x:r},o={k:t,sorted:n},s=E(ab.runKernel(Lm,i,o),2);return{values:s[0],indices:s[1]}}});zy().prototype.topk=function(e,t){return this.throwIfDisposed(),LE(this,e,t)},zy().prototype.transpose=function(e){return this.throwIfDisposed(),qI(this,e)};var jE=vb({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=hb(e,"x","unique","string_or_numeric");ap(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},a={axis:t},i=E(ab.runKernel(Um,r,a),2);return{values:i[0],indices:i[1]}}});zy().prototype.unique=function(e){return this.throwIfDisposed(),jE(this,e)},zy().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),WS(this,e,t)},zy().prototype.unstack=function(e){return this.throwIfDisposed(),VI(this,e)},zy().prototype.where=function(e,t){return this.throwIfDisposed(),GI(e,this,t)},zy().prototype.zerosLike=function(){return this.throwIfDisposed(),Vx(this)};var zE=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,e),Object.setPrototypeOf(D(r),n.prototype),r}return q(n)}(Q(Error)),UE=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,e),Object.setPrototypeOf(D(r),n.prototype),r}return q(n)}(Q(Error)),BE=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,e),Object.setPrototypeOf(D(r),n.prototype),r}return q(n)}(Q(Error)),WE=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,e),Object.setPrototypeOf(D(r),n.prototype),r}return q(n)}(Q(Error)),VE=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,e),Object.setPrototypeOf(D(r),n.prototype),r}return q(n)}(Q(Error)),GE=(Error,function(){function e(t){G(this,e),this.maxEntries=t||100,this.cache=new Map}return q(e,[{key:"get",value:function(e){var t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}},{key:"put",value:function(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}},{key:"getMaxEntries",value:function(){return this.maxEntries}},{key:"setMaxEntries",value:function(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(var t=0;t<this.maxEntries-e;t++){var n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}]),e}());function HE(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function KE(e,t){if(!e)throw new VE(t)}function qE(e,t){var n,r=0,a=U(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(Wse){a.e(Wse)}finally{a.f()}return r}function XE(e){return 1===e.length?e[0]:e}function YE(e){return Array.isArray(e)?e:[e]}function ZE(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function QE(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var JE={};function $E(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function eT(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return eT(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?eT(a):e[r]=a.value)}}function tT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var i,o=e;if(o in n)i=n[o];else if(o in JE)i=JE[o];else if(null==(i=t[o]))throw new BE("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var s=e;if(null==s.className||null==s.config)throw new BE("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(s),".\n")+"'className' and 'config' must set.");var u,c,l=s.className;if(l in n){var f=E(n[l],2);u=f[0],c=f[1]}else if(l in JE){var h=E(JE.className,2);u=h[0],c=h[1]}else if(l in t){var d=E(t[l],2);u=d[0],c=d[1]}if(null==u)throw new BE("Unknown ".concat(r,": ").concat(l,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){for(var p={},v=0,g=Object.keys(JE);v<g.length;v++){var m=g[v];p[m]=JE[m]}for(var y=0,b=Object.keys(n);y<b.length;y++){var x=b[y];p[x]=n[x]}s.config.customObjects=p;for(var k=Object.assign({},JE),w=0,I=Object.keys(n);w<I.length;w++){var C=I[w];JE[C]=n[C]}eT(s.config);var A=c(u,s.config,n,a);return JE=Object.assign({},k),A}for(var S=Object.assign({},JE),_=0,T=Object.keys(n);_<T.length;_++){var N=T[_];JE[N]=n[N]}var O=new u(s.config);return JE=Object.assign({},S),O}function nT(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function rT(e){if(null==e)return e;var t,n=[],r=U(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(Wse){r.e(Wse)}finally{r.f()}return n}function aT(e){if(null==e)throw new BE("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function iT(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new BE("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function oT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return KE(n>=0),KE(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function sT(e,t){Array.isArray(e)?(ap(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return sT(e,"element ".concat(n+1," of ").concat(t))}))):ap(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(uT(e),".")}))}function uT(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return uT(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function cT(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var lT=0;function fT(){return lT++}var hT={};function dT(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in hT||(hT[e]=0),hT[e]+=1,e+hT[e].toString()}var pT=["channelsFirst","channelsLast"],vT=["nearest","bilinear"],gT=["valid","same","causal"],mT=["max","avg"],yT=["sum","mul","concat","ave"],bT=new Map;function xT(e){iT(pT,"DataFormat",e)}function kT(e){iT(gT,"PaddingMode",e)}function wT(e){iT(mT,"PoolMode",e)}var IT=[],CT="/";function AT(e,t){IT.push(e);try{var n=t();return IT.pop(),n}catch(r){throw IT.pop(),r}}function ST(e){if(!NT(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===IT.length?"":IT.join(CT)+CT)+e}function _T(e){if(!NT(e))throw new Error("Not a valid tensor name: '"+e+"'");bT.has(e)||bT.set(e,0);var t=bT.get(e);if(bT.set(e,bT.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return bT.set(n,1),n}return e}var ET,TT=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function NT(e){return!!e.match(TT)}function OT(e){return e===parseInt(e.toString(),10)}function RT(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function PT(e){if(0===e.length)return Number.NaN;for(var t=Number.POSITIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r<t&&(t=r)}return t}function DT(e){if(0===e.length)return Number.NaN;for(var t=Number.NEGATIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r>t&&(t=r)}return t}function MT(e,t){if(t<e)throw new BE("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function FT(){return null==ET&&(ET=ab.backend.epsilon()),ET}function LT(e,t){return Ex(e,t)}function jT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),fw(e,n)}function zT(e,t,n){return Px((function(){switch(e.rank){case 1:return OI(e,t,n);case 2:return RI(e,[t,0],[n,e.shape[1]]);case 3:return PI(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return DI(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return NI(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return NI(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new BE("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function UT(e,t,n){return Px((function(){switch(e.rank){case 1:return OI(e,t,n);case 2:return RI(e,[0,t],[e.shape[0],n]);case 3:return PI(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return DI(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new BE("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function BT(e,t,n,r){return Px((function(){switch(e.rank){case 1:return OI(e,t,n);case 2:switch(r){case 1:return zT(e,t,n);case 2:return UT(e,t,n);default:throw new BE("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return zT(e,t,n);case 2:return PI(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return UT(e,t,n);default:throw new BE("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return zT(e,t,n);case 2:return DI(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return DI(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return UT(e,t,n);default:throw new BE("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new BE("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function WT(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),xw(e,n)}function VT(e,t){switch(e.rank){case 1:return kw([e,t]);case 2:return ww([e,t],0);case 3:return Iw([e,t],0);case 4:return Cw([e,t],0);default:throw new BE("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function GT(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new BE("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return jw(e,t)}function HT(e){return wI(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function KT(e,t,n,r){if(e.rank<2||t.rank<2)throw new WE("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new WE("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return cC({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?YT(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),i=a.pop();e=fw(e,[-1,i]);var o=t.shape.slice(),s=o.pop(),u=o.pop(),c=[].concat(X(o),[s]),l=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=fw(qI(t,l),[u,-1]);var f=[].concat(X(a),X(c));return fw(cC({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?YT(e.rank,r,"channelsLast"):null,activation:n}),f)}function qT(e,t,n){return Px((function(){return t=Array.isArray(t)?BI(t,"int32"):Ex(t,"int32"),Bw(e,t,n)}))}function XT(e){return Ux(e,e)}function YT(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new BE("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?fw(t,[1,r[0],1,1,1]):fw(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?fw(t,[1,1,1,1,r[0]]):fw(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?fw(t,[1,r[0],1,1]):fw(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?fw(t,[1,1,1,r[0]]):fw(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?fw(t,[1,r[0],1]):fw(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?fw(t,[1,1,r[0]]):fw(t,[1].concat(r))}else if(e<3)return t;throw new BE("Unsupported input rank by biasAdd: ".concat(t.rank))}function ZT(e,t,n){return Px((function(){return null==n&&(n="channelsLast"),xT(n),Lx(e,YT(e.rank,t,n))}))}function QT(e,t,n,r){return Px((function(){return XI(e,t,n,r)}))}function JT(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}var $T=["fanIn","fanOut","fanAvg"],eN=["normal","uniform","truncatedNormal"];var tN=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(Kx),nN=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e,t){return pI(e,t)}}]),n}(tN);nN.className="Zeros",Xx(nN);var rN=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e,t){return vI(e,t)}}]),n}(tN);rN.className="Ones",Xx(rN);var aN=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),r=t.call(this),"object"!==typeof e)throw new BE("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new BE("config must have value set but got ".concat(e));return r.value=e.value,r}return q(n,[{key:"apply",value:function(e,t){var n=this;return Px((function(){return Ux(Hx(n.value),vI(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(tN);aN.className="Constant",Xx(aN);var iN=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return q(n,[{key:"apply",value:function(e,t){return II(e,this.minval,this.maxval,t,this.seed)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(tN);iN.className="RandomUniform",Xx(iN);var oN=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return q(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new WE("randomNormal does not support dType ".concat(t,"."));return HT(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(tN);oN.className="RandomNormal",Xx(oN);var sN=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return q(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new WE("truncatedNormal does not support dType ".concat(t,"."));return WI(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(tN);sN.className="TruncatedNormal",Xx(sN);var uN=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return q(n,[{key:"apply",value:function(e,t){var n=this;return Px((function(){if(2!==e.length||e[0]!==e[1])throw new BE("Identity matrix initializer can only be used for 2D square matrices.");return Ux(n.gain,zw(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(tN);uN.className="Identity",Xx(uN);var cN=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),r=t.call(this),e.scale<0)throw new BE("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,function(e){iT($T,"FanMode",e)}(r.mode),r.distribution=null==e.distribution?"normal":e.distribution,function(e){iT(eN,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return q(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(xT(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=RT(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=RT(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=RT(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new WE("".concat(this.getClassName()," does not support dType ").concat(t,"."));return WI(e,0,o,t,this.seed)}var s=Math.sqrt(3*i);return II(e,-s,s,t,this.seed)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(tN);cN.className="VarianceScaling",Xx(cN);var lN=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return q(n,[{key:"getClassName",value:function(){return cN.className}}]),n}(cN);lN.className="GlorotUniform",Xx(lN);var fN=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return q(n,[{key:"getClassName",value:function(){return cN.className}}]),n}(cN);fN.className="GlorotNormal",Xx(fN);var hN=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return q(n,[{key:"getClassName",value:function(){return cN.className}}]),n}(cN);hN.className="HeNormal",Xx(hN);var dN=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return q(n,[{key:"getClassName",value:function(){return cN.className}}]),n}(cN);dN.className="HeUniform",Xx(dN);var pN=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return q(n,[{key:"getClassName",value:function(){return cN.className}}]),n}(cN);pN.className="LeCunNormal",Xx(pN);var vN=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return q(n,[{key:"getClassName",value:function(){return cN.className}}]),n}(cN);vN.className="LeCunUniform",Xx(vN);var gN=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new WE("Random seed is not implemented for Orthogonal Initializer yet.");return r}return q(n,[{key:"apply",value:function(e,t){var n=this;return Px((function(){if(e.length<2)throw new WE("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=HT(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=tA.gramSchmidt(t);return e[0]>e[1]&&(r=qI(r)),Ux(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(tN);gN.className="Orthogonal",Xx(gN);var mN={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function yN(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tT(e,qx.getMap().classNameMap,t,"initializer")}function bN(e){return $E(e)}function xN(e){if("string"===typeof e){var t=e in mN?mN[e]:e;if("GlorotNormal"===t)return new fN;if("GlorotUniform"===t)return new lN;if("HeNormal"===t)return new hN;if("HeUniform"===t)return new dN;if("LeCunNormal"===t)return new pN;if("LeCunUniform"===t)return new vN;var n={};return n.className=t,n.config={},yN(n)}return e instanceof tN?e:yN(e)}function kN(e){return Array.isArray(e)&&Array.isArray(e[0])}function wN(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function IN(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new BE("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function CN(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new BE("Expected exactly 1 Shape; got ".concat(e.length))}return e}function AN(e){var t,n=0,r=U(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch(Wse){r.e(Wse)}finally{r.f()}return n}var SN="Variable",_N=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:SN,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;G(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=fT(),r=null==r?SN:r,this.originalName=ST(r),this.name=_T(this.originalName),this.trainable_=a,this.constraint=i,this.val=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return ab.makeVariable(e,t,n,r)}(t,this.trainable_,this.name,this.dtype)}return q(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function EN(e){return e.map((function(e){return e.read()}))}function TN(e){e.forEach((function(e){e[0].write(e[1])}))}var NN=q((function e(t){G(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}})),ON=q((function e(t,n,r,a,i,o,s){G(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=s,this.id=fT(),null!=o&&(this.originalName=ST(o),this.name=_T(this.originalName)),this.rank=n.length})),RN=0,PN=function(){function e(t,n){G(this,e),this.callArgs=n,this.id=RN++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=U(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(Wse){a.e(Wse)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return q(e,[{key:"getConfig",value:function(){var e,t=[],n=U(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch(Wse){n.e(Wse)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),DN=0,MN=function(e){F(n,e);var t=z(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};G(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=DN++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=ZE(i)+"_"+dT(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}e.batchInputShape=o;var u=r.dtype;null==u&&(u=r.inputDType),null==u&&(u="float32"),e.dtype=u}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return q(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new UE("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new BE("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return XE(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return XE(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new zE("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new zE("Layer ".concat(this.name)+" is not connected, no input to return.");return XE(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new zE("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new zE("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return XE(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=YE(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=YE(this.inputSpec);if(e.length!==t.length)throw new BE("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new BE("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new BE("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new BE("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new BE("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),c=a.axes[s],l=u>=0?o[u]:o[o.length+u];if(null!=c&&-1===[c,null].indexOf(l))throw new BE("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(u," of input shape to ")+"have value ".concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var f=0;f<a.shape.length;++f){var h=a.shape[f],d=r.shape[f];if(null!=h&&null!=d&&h!==d)throw new BE("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=YE(e),i=!0,o=U(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof ON)){i=!1;break}}}catch(Wse){o.e(Wse)}finally{o.f()}var s,u=!0,c=U(a);try{for(c.s();!(s=c.n()).done;){if(s.value instanceof ON){u=!1;break}}}catch(Wse){c.e(Wse)}finally{c.f()}if(i===u)throw new BE("Arguments to apply() must be all SymbolicTensors or all Tensors");return AT(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=U(YE(e));try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(s.shape)}}catch(Wse){o.e(Wse)}finally{o.f()}n.build(XE(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(e),u){var c,l=n.call(e,t),f=[],h=U(YE(l));try{for(h.s();!(c=h.n()).done;){var d=c.value;-1!==a.indexOf(d)&&(d=d.clone()),f.push(d)}}catch(Wse){h.e(Wse)}finally{h.f()}if(l=XE(f),null!=n.activityRegularizer)throw new WE("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}var p,v=function(e){e=YE(e);var t,n=[],r=U(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(Wse){r.e(Wse)}finally{r.f()}return XE(n)}(e),g=n.computeOutputShape(v),m="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?v[0]:v),p=null!=g&&g.length>0&&Array.isArray(g[0])?g.map((function(r,a){return new ON(m,r,n,YE(e),t,n.name,a)})):new ON(m,g,n,YE(e),t,n.name),n.addInboundNode(e,p,null,null,v,g,t),n._refCount++,null!=n.activityRegularizer)throw new WE("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new zE("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=U(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(Wse){n.e(Wse)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new zE("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new UE("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return AN(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){return EN(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;Px((function(){var n=t.weights;if(n.length!==e.length)throw new BE('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=EN(n),i=0;i<a.length;++i){var o=a[i],s=n[i],u=e[i];if(!up(o.shape,u.shape))throw new BE("Layer weight shape ".concat(o.shape," ")+"not compatible with provided weight shape ".concat(u.shape));r.push([s,u])}TN(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o,s){if(-1!==this._addedWeightNames.indexOf(e))throw new BE("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():xN("zeros"));var u=r.apply(t,n),c=new _N(u,n,e,i,o);return u.dispose(),null!=a&&this.addLoss((function(){return a.apply(c.read())})),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=YE(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,X(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=YE(e);t=YE(t),n=YE(n),r=YE(r),a=wN(a),i=wN(i);var u,c=[],l=[],f=[],h=U(s);try{for(h.s();!(u=h.n()).done;){var d=u.value;c.push(d.sourceLayer),l.push(d.nodeIndex),f.push(d.tensorIndex)}}catch(Wse){h.e(Wse)}finally{h.f()}new PN({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:f,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(Kx);function FN(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,s=U(FN(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]));try{for(s.s();!(o=s.n()).done;){var u=o.value;-1===a.indexOf(u)&&a.push(u)}}catch(Wse){s.e(Wse)}finally{s.f()}}return a}var LN=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:dT("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new BE("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new BE("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new BE("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new ON(r.dtype,r.batchInputShape,D(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new PN({outboundLayer:D(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return q(n,[{key:"apply",value:function(e,t){throw new BE("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(MN);LN.className="InputLayer",Xx(LN);var jN=function(){function e(t){if(G(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=U(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(Wse){a.e(Wse)}finally{a.f()}}}return q(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new BE("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Ex(t,e.dtype)}catch(Wse){throw new BE("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof ON){if(null==this.id2Value[e.id])throw new BE("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new BE("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof ON){if(null==this.id2Value[e.id])throw new BE("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new BE("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&Dx(this.id2Mask)}}]),e}(),zN=new GE,UN=new GE;function BN(e,t,n,r){var a,i=null!=n&&n.training,o=Array.isArray(e),s=o?e:[e],u=s.map((function(e){return e.name})),c=[],l=t.names(),f=U(u);try{for(f.s();!(a=f.n()).done;){var h=a.value;-1!==l.indexOf(h)?c.push(t.getValue(h)):c.push(null)}}catch(Wse){f.e(Wse)}finally{f.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var d,p=u.join(",")+"|"+t.names().sort().join(","),v=zN.get(p);if(null==v){var g=function(e,t){ap(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=VN(e[0],t);n=a.sorted,r=a.recipientMap}else{var i,o=new Set,s=U(e);try{for(s.s();!(i=s.n()).done;){var u,c=VN(i.value,t),l=c.sorted,f=c.recipientMap,h=U(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;o.has(d.name)||(n.push(d),o.add(d.name))}}catch(Wse){h.e(Wse)}finally{h.f()}var p=function(e){null==r[e]&&(r[e]=new Set),f[e].forEach((function(t){return r[e].add(t)}))};for(var v in f)p(v)}}catch(Wse){s.e(Wse)}finally{s.f()}}return{sorted:n,recipientCounts:WN(r)}}(s,t);v=g.sorted,d=g.recipientCounts,zN.put(p,v),UN.put(p,d)}d={},i||Object.assign(d,UN.get(p));for(var m=new jN(t),y=0;y<v.length;++y){if(null!=r){var b=Rx().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=v[y],k=x.sourceLayer;if(!(k instanceof LN)){var w,I=[],C=[],A=[],S=!1,_=U(x.inputs);try{for(_.s();!(w=_.n()).done;){var E=w.value,T=m.getValue(E),N=m.getMask(E);I.push(T),C.push(N),null!=N&&(S=!0),i||(d[E.name]--,0!==d[E.name]||t.hasKey(E)||-1!==u.indexOf(E.name)||T.isDisposed||!0===E.sourceLayer.stateful||A.push(T))}}catch(Wse){_.e(Wse)}finally{_.f()}S&&((n=n||{}).mask=C[0]);var O=YE(k.apply(I,n)),R=null;k.supportsMasking&&(R=k.computeMask(I,C));for(var P=GN(x),D=Array.isArray(P)?P:[P],M=0;M<D.length;++M){m.hasKey(D[M])||m.add(D[M],O[M],Array.isArray(R)?R[0]:R);var F=u.indexOf(D[M].name);-1!==F&&(c[F]=O[M])}i||Dx(A)}}return m.disposeMasks(),o?c:c[0]}function WN(e){var t={};for(var n in e)t[n]=e[n].size;return t}function VN(e,t){var n,r=new Set,a=[],i={},o=U(t.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch(Wse){o.e(Wse)}finally{o.f()}var u=[],c=[];for(u.push(e);u.length>0;){var l=u[u.length-1];if(r.has(l.name))u.pop();else{var f=c[c.length-1]===u.length-1;if(0===l.inputs.length||f)u.pop(),a.push(l),r.add(l.name),f&&c.pop();else{c.push(u.length-1);var h,d=U(l.inputs);try{for(d.s();!(h=d.n()).done;){var p=h.value;null==i[p.name]&&(i[p.name]=new Set),i[p.name].add(l.name),r.has(p.name)||u.push(p)}}catch(Wse){d.e(Wse)}finally{d.f()}}}}return{sorted:a,recipientMap:i}}function GN(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=U(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(Wse){i.e(Wse)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function HN(e,t){return Px((function(){return Bx(Xw(Ux(e,e),t,!0))}))}jp().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(function(){return 100}),(function(e){null!=zN&&zN.setMaxEntries(e),null!=UN&&UN.setMaxEntries(e)}));var KN=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"getConfig",value:function(){return{}}}]),n}(Kx),qN=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return q(n,[{key:"apply",value:function(e){var t=this;return Px((function(){var n=HN(e,t.axis),r=bw(n,0,t.maxValue);return Ux(e,zx(r,Lx(FT(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(KN);qN.className="MaxNorm",Xx(qN);var XN=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return q(n,[{key:"apply",value:function(e){var t=this;return Px((function(){return zx(e,Lx(FT(),HN(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(KN);XN.className="UnitNorm",Xx(XN);var YN=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return AI(e)}}]),n}(KN);YN.className="NonNeg",Xx(YN);var ZN=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return q(n,[{key:"apply",value:function(e){var t=this;return Px((function(){var n=HN(e,t.axis),r=Lx(Ux(t.rate,bw(n,t.minValue,t.maxValue)),Ux(1-t.rate,n));return Ux(e,zx(r,Lx(FT(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(KN);ZN.className="MinMaxNorm",Xx(ZN);var QN,JN={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function $N(e){return $E(e)}function eO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tT(e,qx.getMap().classNameMap,t,"constraint")}function tO(e){return null==e?null:"string"===typeof e?eO({className:e in JN?JN[e]:e,config:{}}):e instanceof KN?e:eO(e)}function nO(e){return rO.apply(this,arguments)}function rO(){return rO=V(B().mark((function e(t){var n,r,a,i,o,s,u,c;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!==typeof(o=t[i])&&(s=o,n.push(s.data()),r.push(i),a.push(s));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(u=e.sent,c=0;c<u.length;++c)t[r[c]]=u[c][0];Dx(a);case 12:case"end":return e.stop()}}),e)}))),rO.apply(this,arguments)}function aO(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(QN||(QN={}));var iO=125,oO=function(){function e(){G(this,e),this.validationData=null}return q(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),sO=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;G(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return q(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=U(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(Wse){n.e(Wse)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=U(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(Wse){n.e(Wse)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=V(B().mark((function e(t,n){var r,a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=U(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=V(B().mark((function e(t,n){var r,a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=U(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=V(B().mark((function e(t,n){var r,a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=U(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=V(B().mark((function e(t,n){var r,a,i;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=U(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=V(B().mark((function e(t){var n,r,a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=U(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=V(B().mark((function e(t){var n,r,a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=U(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),uO=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.call(this)}return q(n,[{key:"onEpochBegin",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=V(B().mark((function e(t,n){var r,a,i,o=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=B().mark((function e(t){var a,i,s;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"number"===typeof(a=n[t])?(o.totals.hasOwnProperty(t)||(o.totals[t]=0),o.totals[t]=o.totals[t]+a*r):(t in o.totals?i=o.totals[t]:o.totals[t]=0,s=Px((function(){return Lx(o.totals[t],Ux(a,r))})),o.totals[t]=s,null!=i&&i.dispose());case 2:case"end":return e.stop()}}),e)})),e.t0=B().keys(n);case 5:if((e.t1=e.t0()).done){e.next=10;break}return i=e.t1.value,e.delegateYield(a(i),"t2",8);case 8:e.next=5;break;case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=V(B().mark((function e(t,n){var r,a,i,o=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=20;break}r=U(this.params.metrics),e.prev=2,i=B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.value,null!=o.totals[t]){e.next=3;break}return e.abrupt("return","continue");case 3:"number"===typeof o.totals[t]?n[t]=o.totals[t]/o.seen:Px((function(){var e=Ux(zx(1,o.seen),o.totals[t]);n[t]=e,o.totals[t].dispose(),Mx(n[t])}));case 4:case"end":return e.stop()}}),e)})),r.s();case 5:if((a=r.n()).done){e.next=12;break}return e.delegateYield(i(),"t0",7);case 7:if("continue"!==e.t0){e.next=10;break}return e.abrupt("continue",10);case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(2),r.e(e.t1);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[2,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(oO),cO=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"onTrainBegin",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=V(B().mark((function e(t,n){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o,s,u,c;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(s=i[o],t.push(s.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(u=e.sent,c=0;c<u.length;++c)this.history[n[c]][r[c]].dispose(),this.history[n[c]][r[c]]=u[c][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(oO),lO=function(e){F(n,e);var t=z(n);function n(e,r){var a;if(G(this,n),(a=t.call(this)).currentEpoch=0,a.nowFunc=e.nowFunc,a.nextFrameFunc=e.nextFrameFunc||oA,a.yieldEvery=r||"auto","auto"===a.yieldEvery&&(a.yieldEvery=iO),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return kp(a.yieldEvery)&&(a.maybeWait=function(e,t,n){var r,a=null!=n?n():xy();return function(){var i=null!=n?n():xy();return i-a<t?r:(a=i,r=e.apply(void 0,arguments))}}(a.maybeWait.bind(D(a)),a.yieldEvery,a.nowFunc)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return q(n,[{key:"maybeWait",value:function(){var e=V(B().mark((function e(t,n,r){var a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],null==this.yield){e.next=5;break}return e.next=4,nO(r);case 4:a.push(this.yield(t,n,r));case 5:return a.push(this.nextFrameFunc()),e.next=8,Promise.all(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,nO(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=V(B().mark((function e(t,n){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,nO(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(this.nextFrameFunc()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,nO(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=V(B().mark((function e(t,n){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,nO(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(this.nextFrameFunc()):kp(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,nO(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,nO(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(oO);function fO(e,t){return null==e&&(e={}),e instanceof oO?[e]:Array.isArray(e)&&e[0]instanceof oO?e:YE(e).map((function(e){return new lO(e,t)}))}var hO=function(){function e(){G(this,e)}return q(e,null,[{key:"registerCallbackConstructor",value:function(t,n){ap(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new BE("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,X(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function dO(e,t,n,r,a,i,o,s,u){var c=new cO,l=[new uO].concat(X(hO.createCallbacks(t)));null!=e&&l.push.apply(l,X(e)),l.push(c);var f=new sO(l);return f.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:f,history:c}}function pO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tT(e,qx.getMap().classNameMap,t,"layer",n)}function vO(e,t){return Px((function(){"float32"!==e.dtype&&(e=Ex(e,"float32"));var n=Xw(XT(e),t,!0),r=Qx(n.shape,FT()),a=Bx(ok(n,r));return zx(e,a)}))}function gO(e,t){return Px((function(){return eI(XT(ek(t,e)),-1)}))}function mO(e,t){return Px((function(){return eI(nk(ek(t,e)),-1)}))}function yO(e,t){return Px((function(){var n=ek(e,t),r=bw(nk(e),FT(),Number.MAX_VALUE),a=nk(zx(n,r));return Ux(100,eI(a,-1))}))}function bO(e,t){return Px((function(){var n=bw(t,FT(),Number.MAX_VALUE),r=Hw(Lx(1,n)),a=bw(e,FT(),Number.MAX_VALUE),i=Hw(Lx(1,a));return eI(XT(ek(r,i)),-1)}))}function xO(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Px((function(){if(n)t=MI(t);else{var r=Xw(t,t.shape.length-1,!0);t=zx(t,r)}return t=bw(t,FT(),1-FT()),fI(Xw(Ux(Ex(e,"float32"),Hw(t)),t.shape.length-1))}))}function kO(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Px((function(){var r=Ex(Uw(function(e){var t=[RT(e.shape)];return fw(e,t)}(e)),"int32"),a=(t=bw(t,FT(),1-FT())).shape;return xO(fw(dI(r,a[a.length-1]),a),t,n)}))}function wO(e,t){return Px((function(){var n;return n=bw(t,FT(),1-FT()),n=Hw(zx(n,ek(1,n))),eI(function(e,t){if(!up(e.shape,t.shape))throw new BE("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return Px((function(){var n=AI(t),r=fI(nk(t));return Lx(ek(n,Ux(t,e)),Kw(Fw(r)))}))}(e,n),-1)}))}function IO(e,t){return Px((function(){var n=bw(e,FT(),1),r=bw(t,FT(),1);return Xw(Ux(e,Hw(zx(n,r))),-1)}))}function CO(e,t){return Px((function(){var n=vO(e,-1),r=vO(t,-1),a=Ux(n,r);return fI(Xw(a,-1))}))}hO.constructors={};var AO={meanSquaredError:gO,meanAbsoluteError:mO,meanAbsolutePercentageError:yO,meanSquaredLogarithmicError:bO,squaredHinge:function(e,t){return Px((function(){var n=ok(0,ek(1,Ux(e,t)));return eI(XT(n),-1)}))},hinge:function(e,t){return Px((function(){var n=ok(0,ek(1,Ux(e,t)));return eI(n,-1)}))},categoricalHinge:function(e,t){return Px((function(){var n=Xw(Ux(e,t),-1),r=qw(Ux(ek(1,e),t),-1);return ok(0,Lx(1,ek(r,n)))}))},logcosh:function(e,t){return Px((function(){var n=Math.log(2),r=ek(t,e),a=ek(Lx(r,FI(Ux(-2,r))),n);return eI(a,-1)}))},categoricalCrossentropy:xO,sparseCategoricalCrossentropy:kO,binaryCrossentropy:wO,kullbackLeiblerDivergence:IO,poisson:function(e,t){return Px((function(){var n=Hw(Lx(FT(),t));return eI(ek(t,Ux(e,n)),-1)}))},cosineProximity:CO};function SO(e){if("string"===typeof e){if(e in AO)return AO[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new BE(t)}return e}function _O(e,t){return Px((function(){var n=Ux(.5,gI(t)),r=LT(Ww(t,n),e.dtype);return eI(Mw(e,r),-1)}))}function EO(e,t){return Px((function(){return LT(Mw(Yk(e,-1),Yk(t,-1)),"float32")}))}function TO(e,t){return Px((function(){return Ex(Xw(Zw(Mw(e,1),Mw(t,1))),"float32")}))}function NO(e,t){return wO(e,t)}function OO(e,t){return e.rank===t.rank&&(e=jI(e,[e.rank-1])),(t=Yk(t,-1)).dtype!==e.dtype&&(t=Ex(t,e.dtype)),Ex(Mw(e,t),"float32")}var RO=xO,PO=kO,DO={binaryAccuracy:_O,categoricalAccuracy:EO,precision:function(e,t){return Px((function(){var n=TO(e,t),r=function(e,t){return Px((function(){return Ex(Xw(Zw(Mw(e,0),Mw(t,1))),"float32")}))}(e,t),a=Lx(n,r);return Ex(GI(Ww(a,0),zx(n,a),0),"float32")}))},categoricalCrossentropy:RO,sparseCategoricalCrossentropy:PO,mse:gO,MSE:gO,mae:mO,MAE:mO,mape:yO,MAPE:yO,cosine:CO};function MO(e){if(KE(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(AO);n<r.length;n++){var a=r[n];if(AO[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(DO);i<o.length;i++){var s=o[i];if(DO[s]===e){t=s;break}}return void 0!==t?t:e.name}var FO=1048576;function LO(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!jO(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>FO&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(FO,"."))}}function jO(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!jO(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=U(e);try{for(i.s();!(a=i.n()).done;){if(!jO(a.value))return!1}}catch(Wse){i.e(Wse)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function zO(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=function(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,X(s))}if(t){var u,c=U(e.layers);try{for(c.s();!(u=c.n()).done;){var l,f=u.value,h=!1,d=U(f.inboundNodes);try{for(d.s();!(l=d.n()).done;){var p=l.value;if(-1!==r.indexOf(p)){if(h){t=!1;break}h=!0}}}catch(Wse){d.e(Wse)}finally{d.f()}if(!t)break}}catch(Wse){c.e(Wse)}finally{c.f()}}return t}(e),o=["Layer (type)","Input Shape","Output shape","Param #"];if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in o.push("Receives inputs"),r=[],e.nodesByDepth){var u;(u=r).push.apply(u,X(e.nodesByDepth[s]))}a("_".repeat(t)),UO(o,n,a),a("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)i?BO(c[l],n,a):WO(c[l],n,r,a),a((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var f=function(e){var t;t=null!=e.collectedTrainableWeights?AN(e.collectedTrainableWeights):AN(e.trainableWeights);return t}(e),h=AN(e.nonTrainableWeights);a("Total params: ".concat(f+h)),a("Trainable params: ".concat(f)),a("Non-trainable params: ".concat(h)),a("_".repeat(t))}function UO(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function BO(e,t,n){var r,a;try{a=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(Wse){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(Wse){r="multiple"}var i=e.name,o=e.getClassName();UO(["".concat(i," (").concat(o,")"),a,r,e.countParams().toString()],t,n)}function WO(e,t,n,r){var a,i;try{i=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(Wse){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(Wse){a="multiple"}var o,s=[],u=U(e.inboundNodes);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(var l=0;l<c.inboundLayers.length;++l){var f=c.inboundLayers[l].name,h=c.nodeIndices[l],d=c.tensorIndices[l];s.push("".concat(f,"[").concat(h,"][").concat(d,"]"))}}}catch(Wse){u.e(Wse)}finally{u.f()}var p=e.name,v=e.getClassName(),g=0===s.length?"":s[0];UO(["".concat(p," (").concat(v,")"),i,a,e.countParams().toString(),g],t,r);for(var m=1;m<s.length;++m)UO(["","","","",s[m]],t,r)}function VO(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function GO(e,t){if(null===e)return null;if("string"===typeof e)return QE(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];VO(t,a,i)?n.push(i):n.push(GO(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c];if("name"===c&&"string"===typeof l)o[c]=l;else{var f=QE(c);o[f]=GO(l,f)}}return o}function HO(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return ZE(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];VO(t,a,i)?n.push(i):n.push(HO(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c],f=ZE(c);o[f]="name"!==c&&"className"!==c||"string"!==typeof l?HO(l,c):l}return o}var KO="4.2.0",qO=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=dT(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],rT(r.inputs).length!==r.inputs.length)throw new BE("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));rT(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=U(r.outputs);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=s.sourceLayer,c=s.nodeIndex,l=s.tensorIndex;r.outputLayers.push(u),r.outputLayersNodeIndices.push(c),r.outputLayersTensorIndices.push(l)}}catch(Wse){o.e(Wse)}finally{o.f()}var f,h=U(r.inputs);try{for(h.s();!(f=h.n()).done;){var d=f.value,p=d.sourceLayer,v=d.nodeIndex,g=d.tensorIndex;KE(0===v,"input layer has >1 nodes"),KE(0===g,"input layer has >1 tensors"),r.inputLayers.push(p),r.inputLayersNodeIndices.push(v),r.inputLayersTensorIndices.push(g)}}catch(Wse){h.e(Wse)}finally{h.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var m=0;m<r.inputLayers.length;m++){var y=r.inputLayers[m];if(!(y instanceof LN))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(m," (0-based) originates ")+"from layer type ".concat(y.getClassName(),"."));r.inputNames.push(y.name),r.feedInputShapes.push(y.batchInputShape),r.feedInputNames.push(y.name)}var b,x=U(r.outputLayers);try{for(x.s();!(b=x.n()).done;){var k=b.value;r.outputNames.push(k.name)}}catch(Wse){x.e(Wse)}finally{x.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var w,I={},C={},A={},S={},_={},E=[],T=function e(t,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=t.sourceLayer,s=t.nodeIndex,u=t.tensorIndex);var c=o.inboundNodes[s];if(-1!==i.indexOf(c))throw new UE("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,s)),o.id in _||(_[o.id]=Object.keys(_).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,f=0;f<l;f++){e(c.inputTensors[f],a,i,c.inboundLayers[f],c.nodeIndices[f],c.tensorIndices[f])}for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);E.push(c)}},N=[],O=[],R=U(r.outputs);try{for(R.s();!(w=R.n()).done;){T(w.value,N,O)}}catch(Wse){R.e(Wse)}finally{R.f()}var P,M=U(E.slice().reverse());try{for(M.s();!(P=M.n()).done;){var F=P.value;C[F.id]=F,F.id in I||(I[F.id]=0);var L=I[F.id],j=null==A[F.outboundLayer.id]?0:A[F.outboundLayer.id];L=Math.max(L,j),A[F.outboundLayer.id]=L,S[F.outboundLayer.id]=F.outboundLayer,I[F.id]=L;for(var z=0;z<F.inboundLayers.length;z++){var B=F.inboundLayers[z],W=F.nodeIndices[z],V=B.inboundNodes[W],H=null==I[V.id]?0:I[V.id];I[V.id]=Math.max(L+1,H),C[V.id]=V}}}catch(Wse){M.e(Wse)}finally{M.f()}var K={};for(var q in I){var X=I[q];X in K||(K[X]=[]),K[X].push(C[q])}var Y={};for(var Z in A){var Q=A[Z];Q in Y||(Y[Q]=[]),Y[Q].push(S[Z])}var J=Object.keys(Y).map((function(e){return parseInt(e,10)})).sort(nT);r.layers=[];var $,ee=U(J);try{for(ee.s();!($=ee.n()).done;){var te=Y[$.value];te.sort((function(e,t){var n=_[e.id],r=_[t.id];return n<r?-1:n>r?1:0}));var ne,re=U(te);try{for(re.s();!(ne=re.n()).done;){var ae=ne.value;ae instanceof n&&r.internalContainerRefs.push(ae),r.layers.push(ae)}}catch(Wse){re.e(Wse)}finally{re.f()}}}catch(Wse){ee.e(Wse)}finally{ee.f()}r.layersByDepth=Y,J=Object.keys(K).map((function(e){return parseInt(e,10)})).sort(nT);var ie,oe=r.inputs.slice(),se=[],ue=U(J);try{for(ue.s();!(ie=ue.n()).done;){var ce,le=U(K[ie.value]);try{for(le.s();!(ce=le.n()).done;){var fe=ce.value,he=fe.outboundLayer;if(null!=he){var de,pe=U(fe.inputTensors);try{for(pe.s();!(de=pe.n()).done;){var ve=de.value;if(-1===oe.indexOf(ve))throw new UE("Graph disconnected: cannot obtain value for tensor ".concat(ve)+' at layer "'.concat(he.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(se))}}catch(Wse){pe.e(Wse)}finally{pe.f()}var ge,me=U(fe.outputTensors);try{for(me.s();!(ge=me.n()).done;){var ye=ge.value;oe.push(ye)}}catch(Wse){me.e(Wse)}finally{me.f()}se.push(he.name)}}}catch(Wse){le.e(Wse)}finally{le.f()}}}catch(Wse){ue.e(Wse)}finally{ue.f()}r.nodesByDepth=K;var be,xe=r.layers.map((function(e){return e.name})),ke=U(xe);try{var we=function(){var e=be.value,t=xe.filter((function(t){return t===e})).length;if(1!==t)throw new UE('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(xe))};for(ke.s();!(be=ke.n()).done;)we()}catch(Wse){ke.e(Wse)}finally{ke.f()}return r.outboundNodes=[],r.inboundNodes=[],new PN({outboundLayer:D(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return q(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=U(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(Wse){n.e(Wse)}finally{n.f()}var a,i=U(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(Wse){i.e(Wse)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new BE("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=U(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(Wse){n.e(Wse)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=U(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,X(r.nonTrainableWeights))}}catch(Wse){n.e(Wse)}finally{n.f()}if(!this.trainable){var a,i=[],o=U(this.layers);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,X(s.trainableWeights))}}catch(Wse){o.e(Wse)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=U(this.layers);try{for(i.s();!(t=i.n()).done;){var o,s=U(t.value.weights);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(null!=r[u.originalName])throw new BE("Duplicate weight name: ".concat(u.originalName));r[u.originalName]=u,a++}}catch(Wse){s.e(Wse)}finally{s.f()}}}catch(Wse){i.e(Wse)}finally{i.f()}var c=[];for(var l in e){var f=l;if(null==r[l]){var h=l.split("/");f=h.slice(0,-2).concat([h[h.length-1]]).join("/")}if(null!=r[f])c.push([r[f],e[l]]);else if(n)throw new BE("Provided weight data has no target variable: ".concat(l));delete r[f]}if(n){var d=[];for(var p in r)d.push(p);if(d.length>0)throw new BE("".concat(d.length," of ").concat(a," weights are not set: ")+"".concat(d))}TN(c)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(KO),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=HO(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return Px((function(){e=YE(e);for(var r=new jN,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return BN(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return Px((function(){var r;return e=YE(e),r=null==t?HE(null,e.length):YE(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=wN(e);if(t.length!==this.inputLayers.length)throw new BE("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(nT);if(o.length>1){var s,u=U(o);try{for(u.s();!(s=u.n()).done;){var c,l=s.value,f=U(this.nodesByDepth[l]);try{for(f.s();!(c=f.n()).done;){var h=c.value,d=h.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(d.id)){for(var p=[],v=0;v<h.inboundLayers.length;v++){var g=h.inboundLayers[v],m=h.nodeIndices[v],y=h.tensorIndices[v],b=n["".concat(g.name,"_").concat(m,"_").concat(y)];p.push(b)}for(var x=wN(d.computeOutputShape(XE(p))),k=d.inboundNodes.indexOf(h),w=0;w<x.length;w++){n["".concat(d.name,"_").concat(k,"_").concat(w)]=x[w]}}}}catch(Wse){f.e(Wse)}finally{f.f()}}}catch(Wse){u.e(Wse)}finally{u.f()}}for(var I=[],C=[],A=0;A<this.outputLayers.length;A++){var S=this.outputLayers[A],_=this.outputLayersNodeIndices[A],E=this.outputLayersTensorIndices[A],T="".concat(S.name,"_").concat(_,"_").concat(E);C.push(T)}for(var N=0;N<C.length;N++){var O=C[N];KE(O in n),I.push(n[O])}return XE(I)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=HE(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=e[r],o=t[r];n[a.id]=[i,o]}var s,u=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(nT),c=U(u);try{for(c.s();!(s=c.n()).done;){var l,f=s.value,h=U(this.nodesByDepth[f]);try{for(h.s();!(l=h.n()).done;){var d,p=l.value,v=p.outboundLayer,g=p.inputTensors,m=p.outputTensors,y=new Array,b=U(g);try{for(b.s();!(d=b.n()).done;){var x=d.value;x.id in n&&y.push(n[x.id])}}catch(Wse){b.e(Wse)}finally{b.f()}if(y.length===g.length){var k={},w=void 0,I=void 0,C=void 0,A=void 0;if(null!=p.callArgs&&(k=p.callArgs),1===y.length){var S=E(y[0],2),_=S[0],T=S[1];null==k.mask&&(k.mask=T),C=YE(v.call(_,k)),A=YE(v.computeMask(_,T)),w=[_],I=[T]}else w=y.map((function(e){return e[0]})),I=y.map((function(e){return e[1]})),null==k.mask&&(k.mask=I),C=YE(v.call(w,k)),A=YE(v.computeMask(w,I));if(v.activityRegularizer)throw new WE("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var N=0;N<m.length;++N){var O=m[N],R=C[N],P=A[N];n[O.id]=[R,P]}}}}catch(Wse){h.e(Wse)}finally{h.f()}}}catch(Wse){c.e(Wse)}finally{c.f()}var D,M=[],F=[],L=[],j=U(this.outputs);try{for(j.s();!(D=j.n()).done;){var z=D.value;KE(z.id in n,"Could not compute output ".concat(z.name," : ").concat(z.id));var B=E(n[z.id],2),W=B[0],V=B[1];L.push(W.shape),M.push(W),F.push(V)}}catch(Wse){j.e(Wse)}finally{j.f()}return[M,F,L]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=U(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(a[u]=t,t+=1)}}}catch(Wse){i.e(Wse)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new BE("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new BE("Provide either a layer name or layer index");var n,r=U(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(Wse){r.e(Wse)}finally{r.f()}throw new BE("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return Px((function(){var t,r=[],a=U(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var s=n.nodeKey(i,o);e.containerNodes.has(s)&&r.push.apply(r,X(i.calculateLosses()))}}catch(Wse){a.e(Wse)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=U(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,s=o.getClassName(),u=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var f=o.inboundNodes[l],h=n.nodeKey(o,l),d={};if(this.containerNodes.has(h)){if(f.callArgs)try{JSON.stringify(f.callArgs),d=f.callArgs}catch(Wse){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(f.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),d={}}if(f.inboundLayers.length>0){for(var p=[],v=0;v<f.inboundLayers.length;v++){var g=f.inboundLayers[v],m=f.nodeIndices[v],y=f.tensorIndices[v],b=r[n.nodeKey(g,m)];null==b&&(b=0),p.push([g.name,b,y,d])}c.push(p)}}}var x={};x.name=o.name,x.className=s,x.config=u,x.inboundNodes=c,a.push(x)}}catch(Wse){i.e(Wse)}finally{i.f()}t.layers=a;for(var k=[],w=0;w<this.inputLayers.length;w++){var I=this.inputLayers[w],C=this.inputLayersNodeIndices[w],A=n.nodeKey(I,C);if(this.containerNodes.has(A)){var S=r[A];null!==S&&void 0!==S||(S=0);var _=this.inputLayersTensorIndices[w];k.push([I.name,S,_])}}t.inputLayers=k;for(var E=[],T=0;T<this.outputLayers.length;T++){var N=this.outputLayers[T],O=this.outputLayersNodeIndices[T],R=n.nodeKey(N,O);if(this.containerNodes.has(R)){var P=r[R];null!==P&&void 0!==P||(P=0);var D=this.outputLayersTensorIndices[T];E.push([N.name,P,D])}}return t.outputLayers=E,t}},{key:"stateful",get:function(){if(this._stateful)throw new BE("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=U(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(Wse){t.e(Wse)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;Px((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],s=U(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u[0],l=u[1],f=u[2];if(n=null==u[3]?{}:u[3],!(c in r))return void i(e,t);var h=r[c];if(h.inboundNodes.length<=l)return void i(e,t);var d=h.inboundNodes[l];o.push(d.outputTensors[f])}}catch(Wse){s.e(Wse)}finally{s.f()}o.length>0&&e.apply(XE(o),n)}function s(e){var a=e.name,o=pO(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new BE("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var u,c=t.name,l=t.layers,f=U(l);try{for(f.s();!(u=f.n()).done;){s(u.value)}}catch(Wse){f.e(Wse)}finally{f.f()}for(;!aT(a);){var h,d=U(l);try{for(d.s();!(h=d.n()).done;){var p=h.value,v=r[p.name];if(v.name in a){var g=a[v.name];delete a[v.name];var m,y=U(g);try{for(y.s();!(m=y.n()).done;){o(v,m.value)}}catch(Wse){y.e(Wse)}finally{y.f()}}}}catch(Wse){d.e(Wse)}finally{d.f()}}var b,x=[],k=[],w=U(t.inputLayers);try{for(w.s();!(b=w.n()).done;){var I=b.value,C=I[0],A=I[1],S=I[2];KE(C in r);var _=r[C].inboundNodes[A].outputTensors;x.push(_[S])}}catch(Wse){w.e(Wse)}finally{w.f()}var E,T=U(t.outputLayers);try{for(T.s();!(E=T.n()).done;){var N=E.value,O=N[0],R=N[1],P=N[2];KE(O in r);var D=r[O].inboundNodes[R].outputTensors;k.push(D[P])}}catch(Wse){T.e(Wse)}finally{T.f()}return new e({inputs:x,outputs:k,name:c})}}]),n}(MN);function XO(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function YO(e,t){return XO(e,t,"classWeight")}function ZO(e,t,n,r){return QO.apply(this,arguments)}function QO(){return QO=V(B().mark((function e(t,n,r,a){var i,o,s;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return i=Px((function(){if(1===t.shape.length)return Tx(t);if(2===t.shape.length){if(t.shape[1]>1){return Yk(t,1)}if(1===t.shape[1])return fw(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),Dx(i),s=[],o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");s.push(r[e])})),e.abrupt("return",BI(s,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)}))),QO.apply(this,arguments)}function JO(e,t){return Ux(e,t)}var $O=32;function eR(e,t){var n,r,a=t;n=a.xs,r=a.ys,ap(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var i=tR("input",e.inputNames,n),o=tR("output",e.outputNames,r),s=i[0].shape[0];ap(i.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),ap(o.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var u=function(t){ap(i[t].shape[0]===s,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},c=0;c<i.length;c++)u(c);for(var l=function(t){ap(o[t].shape[0]===s,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},f=0;f<o.length;f++)l(f);return{xs:i,ys:o}}function tR(e,t,n){if(n instanceof jy)return[n];if(Array.isArray(n))return ap(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],i=U(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(null==n[o])throw new BE("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(o,"'."));a.push(n[o])}}catch(Wse){i.e(Wse)}finally{i.f()}return a}function nR(e){if(3===e.length)throw new WE("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function rR(e,t,n){return aR.apply(this,arguments)}function aR(){return aR=V(B().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h,d,p,v,g,m,y,b,x,k,w,I,C,A,S,_,E,T,N,O,R,P,D,M,F;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,ap(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),ap(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),ap(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),ap(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),ap(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(i=null!=r.validationData)&&(oR(r.validationData)?ap(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(u=nR(r.validationData),o=u.xs,s=u.ys)),c=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),f=i?l.slice().concat(l.map((function(e){return"val_"+e}))):l.slice(),h=fO(r.callbacks,r.yieldEvery),d=null==r.verbose?1:r.verbose,p=dO(h,d,r.epochs,null,null,iR(n,r),null,i,f),v=p.callbackList,g=p.history,v.setModel(t),t.history=g,e.next=22,v.onTrainBegin();case 22:return t.stopTraining_=!1,m=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:y=e.sent;case 27:if(!(m<r.epochs)){e.next=98;break}return b={},e.next=31,v.onEpochBegin(m);case 31:if(x=0,k=0,a){e.next=37;break}return e.next=36,n.iterator();case 36:y=e.sent;case 37:if(a&&!(x<r.batchesPerEpoch)){e.next=91;break}return e.next=40,y.next();case 40:if(w=e.sent,!a||!w.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(x," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==w.value){e.next=73;break}return I=eR(t,w.value),C=I.xs,A=I.ys,(S={}).batch=k,S.size=C[0].shape[0],e.next=51,v.onBatchBegin(k,S);case 51:if(_=[],null==r.classWeight){e.next=64;break}E=YO(r.classWeight,t.outputNames),T=0;case 55:if(!(T<E.length)){e.next=64;break}return e.t0=_,e.next=59,ZO(A[T],null,E[T]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++T,e.next=55;break;case 64:for(N=C.concat(A).concat(_),O=c(N),Dx(N),R=0;R<l.length;++R)P=l[R],D=O[R],S[P]=D,Mx(D);return e.next=70,v.onBatchEnd(k,S);case 70:aO(S),k++,x++;case 73:if(!(a?x>=r.batchesPerEpoch:w.done)){e.next=87;break}if(!i){e.next=86;break}if(M=void 0,!oR(r.validationData)){e.next=84;break}return e.t2=YE,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,M=(0,e.t2)(e.t3),e.next=85;break;case 84:M=YE(t.evaluate(o,s,{batchSize:null==r.validationBatchSize?$O:r.validationBatchSize,verbose:0}));case 85:for(F=0;F<t.metricsNames.length;++F)b["val_".concat(t.metricsNames[F])]=M[F];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,v.onEpochEnd(m,b);case 93:if(m++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,v.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])}))),aR.apply(this,arguments)}function iR(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function oR(e){return"function"===typeof e.iterator}function sR(e,t,n){return uR.apply(this,arguments)}function uR(){return uR=V(B().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,i=t.testFunction,o=[],!(r.verbose>0)){e.next=6;break}throw new WE("Verbose mode is not implemented yet.");case 6:if(ap(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),"function"!==typeof n.next){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:s=e.t0,u=0,c=0,l=B().mark((function e(){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.next();case 2:if(n=e.sent,o=Px((function(){if(n.value){var e=eR(t,n.value),r=e.xs,a=e.ys,s=r.concat(a),l=Px((function(){return i(s)}));if(Dx(s),0===c)for(var f=0;f<l.length;++f)o.push(Hx(0));for(var h=s[0].shape[0],d=function(e){var t=l[e],n=o[e];o[e]=Px((function(){return Lx(o[e],Ux(h,t))})),c>0&&Dx(n)},p=0;p<l.length;++p)d(p);Dx(l),u+=h,++c}return o})),!n.done){e.next=7;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(a&&!(c<r.batches)){e.next=25;break}return e.delegateYield(l(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(f=0;f<o.length;++f)h=o[f],o[f]=zx(o[f],u),Dx(h);return e.abrupt("return",XE(o));case 27:case"end":return e.stop()}}),e)}))),uR.apply(this,arguments)}function cR(e){ap(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function lR(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return zT(e,t,n-t)})):zT(e,t,n-t)}function fR(e,t){return Px((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return fR(e,t)})):qT(e,"int32"===t.dtype?t:Ex(t,"int32"))}))}function hR(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function dR(e){var t=[];e instanceof jy&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(jT(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function pR(e,t){if(null!=e){var n=[];if(t instanceof jy)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var i=[];if(e instanceof jy)-1===n.indexOf(e.id)&&i.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&i.push(e)}));else if(null!=e)for(var o in e){var s=e[o];-1===n.indexOf(s.id)&&i.push(s)}i.forEach((function(e){e.isDisposed||e.dispose()}))}}function vR(e){return Array.isArray(e)}function gR(e){return!function(e){return e instanceof jy}(e)&&!vR(e)}function mR(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(vR(e)&&e.length>0)o=!0;else if(gR(e)){for(var s in e)if(e.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new BE("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(gR(e)){r=[];var u,c=U(t);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(null==e[l])throw new BE('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(Wse){c.e(Wse)}finally{c.f()}}else if(vR(e)){if(e.length!==t.length)throw new BE("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new BE("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=dR(r),null!=n)for(var f=0;f<t.length;++f)if(null!=n[f]){var h=r[f];if(h.shape.length!==n[f].length)throw new BE("Error when checking ".concat(i,": expected ").concat(t[f]," ")+"to have ".concat(n[f].length," dimension(s). but got array with ")+"shape ".concat(h.shape));for(var d=0;d<n[f].length;++d)if(0!==d||a){var p=h.shape[d],v=n[f][d];if(null!=v&&v>=0&&p!==v)throw new BE("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[f].slice(1,n[f].length),"] ")+"(i.e.,tensor shape [*,".concat(n[f].slice(1,n[f].length),"])")+" but the ".concat(i," received an input with ").concat(h.shape[0])+" examples, each with shape [".concat(h.shape.slice(1,h.shape.length),"]")+" (tensor shape [".concat(h.shape,"])"))}}return r}function yR(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new BE("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new BE("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new BE("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||a){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new BE("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var bR=function(t){F(r,t);var n=z(r);function r(e){var t;return G(this,r),(t=n.call(this,e)).isTraining=!1,t}return q(r,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new BE("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");zO(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return aA.adagrad(.01)},Adadelta:function(){return aA.adadelta(1,.95,FT())},Adam:function(){return aA.adam(.001,.9,.999,FT())},Adamax:function(){return aA.adamax(.002,.9,.999,FT(),0)},RMSProp:function(){return aA.rmsprop(.001,.9,0,FT())},SGD:function(){return aA.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new BE("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Yx))throw new BE("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new BE("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return SO(e)}))}else{var a=SO(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var i in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(i))throw new BE('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var o,s=U(this.outputNames);try{for(s.s();!(o=s.n()).done;){var u=o.value;null==e.loss[u]&&console.warn('Output "'.concat(u,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(u," during training")),n.push(SO(e.loss[u]))}}catch(Wse){s.e(Wse)}finally{s.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var c=0;c<this.outputs.length;++c){var l=this.internalOutputShapes[c],f=this.outputNames[c];this.feedOutputNames.push(f),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[c])}var h=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],AT("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===h.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var d=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=U(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),a.push(s)}}catch(Wse){i.e(Wse)}finally{i.f()}return a}(e.metrics,this.outputNames);AT("metric",(function(){for(var e=function(e){if(-1!==h.indexOf(e))return"continue";!function(n){var r,a,i,o,s=U(n);try{var u=function(){var n,s=o.value;if("string"===typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){var u,c=t.internalOutputShapes[e];1===c[c.length-1]||t.lossFunctions[e]===wO?-1!==["accuracy","acc"].indexOf(s)?a=_O:-1!==["crossentropy","ce"].indexOf(s)&&(a=NO):t.lossFunctions[e]===kO?-1!==["accuracy","acc"].indexOf(s)?a=OO:-1!==["crossentropy","ce"].indexOf(s)&&(a=PO):-1!==["accuracy","acc"].indexOf(s)?a=EO:-1!==["crossentropy","ce"].indexOf(s)&&(a=RO),-1!==["accuracy","acc"].indexOf(s)?u="acc":-1!==["crossentropy","ce"].indexOf(s)&&(u="ce"),i=a,r=""+u}else{var l=function(e){if("string"===typeof e&&e in DO)return DO[e];if("string"!==typeof e&&null!=e)return e;throw new BE("Unknown metric ".concat(e))}(s);i=l,r=""+MO(s)}AT(r,(function(){n=i})),function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])}(e,r,n)};for(s.s();!(o=s.n()).done;)u()}catch(Wse){s.e(Wse)}finally{s.f()}}(d[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;cR(r);var a=this.standardizeUserDataXY(e,t,!0,r);try{var i=a[0].concat(a[1]);this.makeTestFunction();var o=this.testFunction;return XE(this.testLoop(o,i,r,n.verbose,n.steps))}finally{pR(a[0],e),pR(a[1],t)}}},{key:"evaluateDataset",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",sR(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new BE("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new BE("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new BE("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new jN;if(e instanceof jy&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new BE("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else{var s,u=U(this.inputs);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=e[c.name];if(null==l)throw new BE("No value is provided for the model's input ".concat(c.name));i.add(c,l)}}catch(Wse){u.e(Wse)}finally{u.f()}}var f=BN(a,i);return n?f:f[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=HE(null,e.length),r=e.length,a=U(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(e){return e.name})),u=0;u<e.length;++u){var c=s.indexOf(e[u]);if(-1!==c&&(n[u]=o[c],r--),0===r)break}if(0===r)break}}catch(Wse){a.e(Wse)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new BE("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Px((function(){var a=t.checkNumSamples(e);if(r)throw new WE("Verbose predictLoop() is not implemented yet.");for(var i=hR(a,n),o=t.outputs.map((function(e){return[]})),s=function(n){var r=Px((function(){var r=i[n][0],a=i[n][1],o=lR(e,r,a),s=[];if(Array.isArray(o))for(var u=0;u<o.length;++u)s.push({key:t.inputs[u],value:o[u]});else s.push({key:t.inputs[0],value:o});var c=new jN(s);return BN(t.outputs,c)}));r.forEach((function(e,t){return o[t].push(e)}))},u=0;u<i.length;++u)s(u);return XE(o.map((function(e){return xw(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=dR(e);yR(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return cR(r),this.predictLoop(n,r)}finally{pR(n,e)}}},{key:"predictOnBatch",value:function(e){yR(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new UE("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a];this.feedLossFns[a]===kO?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(function(e,t,n){var r=rT(e.map((function(e){return e.shape[0]})));r.sort();var a=rT(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new BE("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new BE("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!up(r,a))throw new BE("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}(e=mR(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=mR(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){for(var r=[gO,wO,xO],a=0;a<e.length;++a){var i=e[a],o=t[a],s=n[a];if(null!=o){if(o===xO&&1===i.shape[i.shape.length-1])throw new BE("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var f=u[l],h=c[l];if(null!=h&&f!==h)throw new BE("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new BE("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=V(B().mark((function e(t,n,r,a){var i,o,s,u,c,l,f,h,d,p=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(p.length>4&&void 0!==p[4])||p[4],o=p.length>5?p[5]:void 0,s=this.standardizeUserDataXY(t,n,i,o),u=E(s,2),c=u[0],l=u[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(f=null,null==a){e.next=19;break}h=YO(a,this.outputNames),f=[],d=0;case 10:if(!(d<h.length)){e.next=19;break}return e.t0=f,e.next=14,ZO(l[d],null,h[d]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++d,e.next=10;break;case 19:return e.abrupt("return",[c,l,f]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return Px((function(){var o=r.checkNumSamples(t,n,i,"steps"),s=[];if(a>0)throw new WE("Verbose mode is not implemented yet.");if(null!=i)throw new WE("steps mode in testLoop() is not implemented yet");for(var u=hR(o,n),c=BI(MT(0,o)),l=0;l<u.length;++l){var f=u[l][0],h=u[l][1],d=zT(c,f,h-f),p=fR(t,d),v=e(p);if(0===l)for(var g=0;g<v.length;++g)s.push(Hx(0));for(var m=0;m<v.length;++m){var y=v[m];s[m]=Lx(s[m],Ux(h-f,y))}}for(var b=0;b<s.length;++b)s[b]=zx(s[b],o);return s}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(qE(e,r)>1){var i=qE(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],s=e.collectedTrainableWeights.map((function(e){return e.read()})),u=e.optimizer_.minimize((function(){for(var t=[],s=0;s<e.inputs.length;++s)t.push({key:e.inputs[s],value:r[s]});for(var u,c=new jN(t),l=BN(e.outputs,c,{training:!0}),f=0;f<e.lossFunctions.length;++f){var h=(0,e.lossFunctions[f])(a[f],l[f]);null!=i[f]&&(h=JO(h,i[f]));var d=eI(h);n.push(d),u=0===f?h:Lx(u,h)}for(var p=0;p<e.metricsTensors.length;++p){var v=void 0;if(e.outputs.length>1&&p<e.outputs.length)v=n[p];else{var g=e.metricsTensors[p][0],m=e.metricsTensors[p][1];v=eI(g(a[m],l[m]))}Mx(v),o.push(v)}return u=eI(u),e.calculateLosses().forEach((function(e){u=Lx(u,e)})),u}),!0,s);return[u].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return Px((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],s=0;s<e.inputs.length;++s)o.push({key:e.inputs[s],value:a[s]});for(var u=new jN(o),c=BN(e.outputs,u),l=0;l<e.lossFunctions.length;++l){var f=e.lossFunctions[l],h=eI(f(i[l],c[l]));n=0===l?h:Lx(n,h),r.push(n)}for(var d=0;d<e.metricsTensors.length;++d){var p=e.metricsTensors[d][0],v=e.metricsTensors[d][1],g=eI(p(i[v],c[v]));r.push(g)}return r}))}}},{key:"fit",value:function(){var e=V(B().mark((function e(t,n){var r,a,i,o,s,u,c,l,f,h,d,p,v,g,m,y,b,x,k,w,I,C,A,S,_=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_.length>2&&void 0!==_[2]?_[2]:{},!this.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return this.isTraining=!0,e.prev=4,cR(d=null==r.batchSize?32:r.batchSize),!1,e.next=10,this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,false,d);case 10:if(p=e.sent,a=p[0],i=p[1],h=p[2],v=!1,!(null!=r.validationData&&r.validationData.length>0)){e.next=36;break}if(v=!0,2!==r.validationData.length){e.next=22;break}u=r.validationData[0],c=r.validationData[1],e.next=27;break;case 22:if(3!==r.validationData.length){e.next=26;break}throw new WE("validationData including sample weights is not supported yet.");case 26:throw new BE("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(r.validationData," is invalid."));case 27:return!0,e.next=30,this.standardizeUserData(u,c,null,null,true,d);case 30:m=e.sent,l=m[0],f=m[1],g=l.concat(f),e.next=37;break;case 36:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(v=!0,y=Math.floor(a[0].shape[0]*(1-r.validationSplit)),b=a[0].shape[0],l=lR(a,y,b),o=a,a=lR(a,0,y),f=lR(i,y,b),s=i,i=lR(i,0,y),g=l.concat(f)):null!=r.validationSteps&&(v=!0);case 37:return x=a.concat(i).concat(h),this.checkTrainableWeightsConsistency(),k=this.makeTrainFunction(),w=this.getDedupedMetricsNames(),v?(this.makeTestFunction(),I=this.testFunction,C=w.slice().concat(w.map((function(e){return"val_"+e})))):(I=null,g=[],C=w.slice()),A=fO(r.callbacks,r.yieldEvery),e.next=45,this.fitLoop(k,x,w,d,r.epochs,r.verbose,A,I,g,r.shuffle,C,r.initialEpoch,null,null);case 45:return S=e.sent,e.abrupt("return",S);case 47:return e.prev=47,this.isTraining=!1,pR(a,t),pR(i,n),pR(o,t),pR(s,n),pR(l,u),pR(f,c),null!=h&&Dx(h),e.finish(47);case 57:case"end":return e.stop()}}),e,this,[[4,,47,57]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitLoop",value:function(){var e=V(B().mark((function e(t,n,r,a,i,o,s,u,c,l,f,h,d,p){var v,g,m,y,b,x,k,w,I=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a&&(a=32),null==i&&(i=1),null==l&&(l=!0),null==h&&(h=0),v=!1,null!=u&&null!=c&&(v=!0),null==p){e.next=10;break}if(v=!0,null!=d){e.next=10;break}throw new BE("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(g=this.checkNumSamples(n,a,d,"steps_per_epoch"))&&(m=MT(0,g)),null==o&&(o=1),y=dO(s,o,i,h,g,d,a,v,f),b=y.callbackList,x=y.history,b.setModel(this),this.history=x,e.next=18,b.onTrainBegin();case 18:this.stopTraining_=!1,k=B().mark((function e(){var i,o,s,f,h;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.onEpochBegin(w);case 2:if(i={},null==d){e.next=7;break}throw new WE("stepsPerEpoch mode is not implemented yet.");case 7:if("batch"!==l){e.next=11;break}throw new WE("batch shuffling is not implemneted yet");case 11:l&&$d(m);case 12:o=BI(m),s=hR(g,a),f=B().mark((function e(l){var f;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f={},e.next=3,b.onBatchBegin(l,f);case 3:return Px((function(){var e=s[l][0],h=s[l][1],d=zT(o,e,h-e);f.batch=l,f.size=h-e;for(var p=fR(n,d),g=t(p),m=0;m<r.length;++m){var y=r[m],b=g[m];f[y]=b,Mx(b)}if(l===s.length-1&&v)for(var x=I.testLoop(u,c,a),k=0;k<r.length;++k){var w=r[k],C=x[k];Mx(C),i["val_"+w]=C}})),e.next=6,b.onBatchEnd(l,f);case 6:if(aO(f),!I.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),h=0;case 16:if(!(h<s.length)){e.next=24;break}return e.delegateYield(f(h),"t0",18);case 18:if("break"!==e.t0){e.next=21;break}return e.abrupt("break",24);case 21:++h,e.next=16;break;case 24:o.dispose();case 25:return e.next=27,b.onEpochEnd(w,i);case 27:if(!I.stopTraining_){e.next=29;break}return e.abrupt("return","break");case 29:case"end":return e.stop()}}),e)})),w=h;case 21:if(!(w<i)){e.next=29;break}return e.delegateYield(k(),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++w,e.next=21;break;case 29:return e.next=31,b.onTrainEnd();case 31:return e.next=33,this.history.syncData();case 33:return e.abrupt("return",this.history);case 34:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,o,s,u,c,l,f,h,d,p){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rR(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=V(B().mark((function e(t,n){var r,a,i,o,s,u,c,l,f,h;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction(),s=o(a.concat(i)),u=[],c=U(s),e.prev=9,c.s();case 11:if((l=c.n()).done){e.next=19;break}return f=l.value,e.next=15,f.data();case 15:h=e.sent,u.push(h[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:return Dx(s),pR(r[0],t),pR(r[1],n),e.abrupt("return",XE(u));case 31:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=P(R(r.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=Rx().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Rx().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=ZE(this.loss);else if(Array.isArray(this.loss)){var t,n=U(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(Wse){n.e(Wse)}finally{n.f()}e=this.loss.map((function(e){return ZE(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!==typeof a[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=ZE(a[s])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[ZE(MO(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return ZE(MO(e))}));var e={};for(var t in this.metrics)e[t]=ZE(MO(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=pO(GO(e.optimizer_config));if("string"===typeof e.loss)t=QE(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return QE(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=QE(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return QE(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=QE(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var t=V(B().mark((function t(n,r){var a,i,o,s,u,c,l,f,h;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof n){t.next=9;break}if(0!==(a=Bb(n)).length){t.next=6;break}throw new BE("Cannot find any save handlers for URL '".concat(n,"'"));case 6:if(!(a.length>1)){t.next=8;break}throw new BE("Found more than one (".concat(a.length,") save handlers for ")+"URL '".concat(n,"'"));case 8:n=a[0];case 9:if(null!=n.save){t.next=11;break}throw new BE("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return t.next=13,kb(this.getNamedWeights(r));case 13:if(i=t.sent,!1,null,o=this.toJSON(null,false),s={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(KO),convertedBy:null},!(null!=r&&r.includeOptimizer)||null==this.optimizer){t.next=34;break}return s.trainingConfig=this.getTrainingConfig(),c="optimizer",t.t0=e,t.next=25,this.optimizer.getWeights();case 25:return t.t1=t.sent,t.t2=c,t.next=29,t.t0.encodeWeights.call(t.t0,t.t1,t.t2);case 29:l=t.sent,f=l.data,h=l.specs,(u=i.specs).push.apply(u,X(h)),i.data=Tb([i.data,f]);case 34:return null!=this.userDefinedMetadata&&(!0,LO(this.userDefinedMetadata,this.name,true),s.userDefinedMetadata=this.userDefinedMetadata),s.weightData=i.data,s.weightSpecs=i.specs,t.abrupt("return",n.save(s));case 38:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){LO(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),r}(qO);bR.className="Model",Xx(bR);var xR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n)}(bR);xR.className="Functional",Xx(xR);var kR=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:dT("sequential_"),null!=e.layers){var a,i=U(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch(Wse){i.e(Wse)}finally{i.f()}}return r}return q(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new BE("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof bR;if(r){if(1!==(t=e).outputs.length)throw new BE("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new BE("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new BE("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new BE("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new LN({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new BE("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new BE("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=FN(this.outputs[0])}this.inboundNodes=[],new PN({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:HE(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(CN(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new bR({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),P(R(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),P(R(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new UE("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new UE("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=V(B().mark((function e(t,n){var r,a=arguments;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new UE("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new UE("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=V(B().mark((function e(t,n){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new BE("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new BE("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=U(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(Wse){n.e(Wse)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new BE("Legacy serialization format not supported yet.");r=t}else ap(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof n))throw new WE("Sequential.fromConfig called on non-Sequential input: ".concat(o));var s,u=U(r);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=pO(c,undefined,a);a&&l.setFastWeightInitDuringBuild(!0),o.add(l)}}catch(Wse){u.e(Wse)}finally{u.f()}return o}}]),n}(bR);kR.className="Sequential",Xx(kR);var wR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"getConfig",value:function(){return{}}}]),n}(Kx),IR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new WE("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return Dw(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}]),n}(wR);IR.className="elu",Xx(IR);var CR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return _I(e)}}]),n}(wR);CR.className="selu",Xx(CR);var AR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return AI(e)}}]),n}(wR);AR.className="relu",Xx(AR);var SR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return Px((function(){return nI(6,AI(e))}))}}]),n}(wR);SR.className="relu6",Xx(SR);var _R=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return e}}]),n}(wR);_R.className="linear",Xx(_R);var ER=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return TI(e)}}]),n}(wR);ER.className="sigmoid",Xx(ER);var TR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return function(e){return Px((function(){var t=Lx(.5,Ux(.2,e));return bw(t,0,1)}))}(e)}}]),n}(wR);TR.className="hardSigmoid",Xx(TR);var NR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return FI(e)}}]),n}(wR);NR.className="softplus",Xx(NR);var OR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return function(e){return Px((function(){return zx(e,Lx(nk(e),1))}))}(e)}}]),n}(wR);OR.className="softsign",Xx(OR);var RR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return UI(e)}}]),n}(wR);RR.className="tanh",Xx(RR);var PR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return MI(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}]),n}(wR);PR.className="softmax",Xx(PR);var DR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return Yw(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}]),n}(wR);DR.className="logSoftmax",Xx(DR);var MR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Px((function(){return Ux(TI(Ux(e,t)),e)}))}}]),n}(wR);MR.className="swish",Xx(MR);var FR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e){return Px((function(){return Ux(e,UI(FI(e)))}))}}]),n}(wR);function LR(e){return e.getClassName()}function jR(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tT(e,qx.getMap().classNameMap,t,"activation")}function zR(e){if(null==e){var t={className:"linear",config:{}};return jR(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},jR(n)}return e instanceof wR?e:jR(e)}function UR(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}FR.className="mish",Xx(FR);var BR=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n)}(Kx),WR=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this),UR(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return q(n,[{key:"apply",value:function(e){var t=this;return Px((function(){var n=pI([1]);return t.hasL1&&(n=Lx(n,Xw(Ux(t.l1,nk(e))))),t.hasL2&&(n=Lx(n,Xw(Ux(t.l2,XT(e))))),fw(n,[])}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(BR);WR.className="L1L2",Xx(WR);var VR={l1l2:"L1L2"};function GR(e){return $E(e)}function HR(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tT(e,qx.getMap().classNameMap,t,"regularizer")}function KR(e){return null==e?null:"string"===typeof e?HR({className:e in VR?VR[e]:e,config:{}}):e instanceof BR?e:HR(e)}var qR=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return q(n,[{key:"call",value:function(e,t){e=IN(e);var n=AI(e);return null!=this.maxValue&&(n=bw(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);qR.className="ReLU",Xx(qR);var XR=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return q(n,[{key:"call",value:function(e,t){var n=IN(e);return Gw(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);XR.className="LeakyReLU",Xx(XR);var YR=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=xN(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=KR(e.alphaRegularizer),r.alphaConstraint=tO(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new BE("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return q(n,[{key:"build",value:function(e){var t=(e=CN(e)).slice(1);if(null!=this.sharedAxes){var n,r=U(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(Wse){r.e(Wse)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new NN({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=IN(e),yI(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:bN(this.alphaInitializer),alphaRegularizer:GR(this.alphaRegularizer),alphaConstraint:$N(this.alphaConstraint),sharedAxes:this.sharedAxes},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);YR.className="PReLU",Xx(YR);var ZR=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new WE("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return q(n,[{key:"call",value:function(e,t){var n=IN(e);return Dw(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);ZR.className="ELU",Xx(ZR);var QR=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return q(n,[{key:"call",value:function(e,t){var n=IN(e);return Ux(n,Ex(Ww(n,this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);QR.className="ThresholdedReLU",Xx(QR);var JR=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new PR).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return q(n,[{key:"call",value:function(e,t){var n=IN(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);function $R(e,t,n){if("number"===typeof e)return HE(e,t);if(e.length!==t)throw new BE("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if(!OT(a))throw new BE("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e}function eP(e,t,n,r){var a;return null==e?e:(a="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((a+r-1)/r))}function tP(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+DT([n-t,0]);else{if("same"!==r)throw new BE("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function nP(e,t){return Px((function(){return xT(t),"channelsFirst"===t?qI(e,[0,2,3,1]):e}))}function rP(e,t){return Px((function(){return xT(t),"channelsFirst"===t?qI(e,[0,2,3,4,1]):e}))}function aP(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Px((function(){if(null==i&&(i="channelsLast"),xT(i),3!==e.shape.length)throw new BE("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new BE("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new BE("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=qI(e,[0,2,1])),"causal"===a)throw new WE("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=Sw(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=ZT(s,n)),s}))}function iP(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return Px((function(){if(null==i&&(i="channelsLast"),xT(i),3!==e.rank&&4!==e.rank)throw new BE("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new BE("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var u=nP(e,i);if("causal"===a)throw new WE("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=oC({x:u,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=qI(u,[0,3,1,2])),u}))}function oP(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return Px((function(){if(null==i&&(i="channelsLast"),xT(i),4!==e.rank&&5!==e.rank)throw new BE("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new BE("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var s=rP(e,i);if("causal"===a)throw new WE("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=Tw(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=ZT(s,n)),"channelsFirst"===i&&(s=qI(s,[0,4,1,2,3])),s}))}JR.className="Softmax",Xx(JR);var sP=function(e){F(n,e);var t=z(n);function n(e,r){var a;if(G(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,sT(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new WE("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=$R(r.kernelSize,e,"kernelSize"),a.strides=$R(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,kT(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,xT(a.dataFormat),a.activation=zR(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=xN(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=tO(r.biasConstraint),a.biasRegularizer=KR(r.biasRegularizer),a.activityRegularizer=KR(r.activityRegularizer),a.dilationRate=$R(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new BE("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new BE("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new BE("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return q(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:LR(this.activation),useBias:this.useBias,biasInitializer:bN(this.biasInitializer),biasRegularizer:GR(this.biasRegularizer),activityRegularizer:GR(this.activityRegularizer),biasConstraint:$N(this.biasConstraint)},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(KE("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!oT(e.kernelSize,"number",1,3))throw new BE("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(MN),uP=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,sT(a.filters,"filters"),a.kernelInitializer=xN(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=tO(r.kernelConstraint),a.kernelRegularizer=KR(r.kernelRegularizer),a}return q(n,[{key:"build",value:function(e){e=CN(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new BE("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:Y({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){var t;e=IN(e);var r=null==n.bias?null:n.bias.read(),a=cT(n.activation.getClassName());if(null!=a&&2===n.rank)t=iP(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=aP(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=iP(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new WE("convolutions greater than 3D are not implemented yet.");t=oP(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=CN(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=eP(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:bN(this.kernelInitializer),kernelRegularizer:GR(this.kernelRegularizer),kernelConstraint:$N(this.kernelConstraint)},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new BE("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(sP),cP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return q(n,[{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!oT(e.kernelSize,"number",1,2))throw new BE("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(uP);cP.className="Conv2D",Xx(cP);var lP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return q(n,[{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new BE("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(uP);lP.className="Conv3D",Xx(lP);var fP=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,e)).inputSpec=[new NN({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new BE("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return q(n,[{key:"build",value:function(e){if(4!==(e=CN(e)).length)throw new BE("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new BE("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new NN({ndim:4,axes:Y({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){var t=IN(e);if(4!==t.shape.length)throw new BE("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var s=i[r],u=i[a],c=n.kernelSize[0],l=n.kernelSize[1],f=n.strides[0],h=n.strides[1],d=[o,tP(s,f,c,n.padding),tP(u,h,l,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=qI(t,[0,2,3,1]));var p=Ew(t,n.kernel.read(),d,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(p=qI(p,[0,3,1,2])),null!=n.bias&&(p=ZT(p,n.bias.read(),n.dataFormat)),null!=n.activation&&(p=n.activation.apply(p)),p}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=CN(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[t]=this.filters,a[n]=tP(a[n],s,i,this.padding),a[r]=tP(a[r],u,o,this.padding),a}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(cP);fP.className="Conv2DTranspose",Xx(fP);var hP=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,e)).inputSpec=[new NN({ndim:5})],"same"!==r.padding&&"valid"!==r.padding)throw new BE("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return q(n,[{key:"build",value:function(e){if(5!==(e=CN(e)).length)throw new BE("Input should have rank 5; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new BE("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new NN({ndim:5,axes:Y({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){var t=IN(e);if(5!==t.shape.length)throw new BE("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i,o=t.shape,s=o[0];"channelsFirst"===n.dataFormat?(i=2,r=3,a=4):(i=1,r=2,a=3);var u=o[i],c=o[r],l=o[a],f=n.kernelSize[0],h=n.kernelSize[1],d=n.kernelSize[2],p=n.strides[0],v=n.strides[1],g=n.strides[2],m=[s,tP(u,p,f,n.padding),tP(c,v,h,n.padding),tP(l,g,d,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=qI(t,[0,2,3,4,1]));var y=Ow(t,n.kernel.read(),m,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(y=qI(y,[0,4,1,2,3])),null!==n.bias&&(y=ZT(y,n.bias.read(),n.dataFormat)),null!==n.activation&&(y=n.activation.apply(y)),y}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a,i=(e=CN(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3,a=4):(t=4,n=1,r=2,a=3);var o=this.kernelSize[0],s=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],l=this.strides[1],f=this.strides[2];return i[t]=this.filters,i[n]=tP(i[n],c,o,this.padding),i[r]=tP(i[r],l,s,this.padding),i[a]=tP(i[a],f,u,this.padding),i}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(lP);hP.className="Conv3DTranspose",Xx(hP);var dP=function(e){F(n,e);var t=z(n);function n(e,r){var a;if(G(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new BE("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new BE("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new BE("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=xN(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=KR(r.depthwiseRegularizer),a.depthwiseConstraint=tO(r.depthwiseConstraint),a.pointwiseInitializer=xN(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=KR(r.pointwiseRegularizer),a.pointwiseConstraint=tO(r.pointwiseConstraint),a}return q(n,[{key:"build",value:function(e){if((e=CN(e)).length<this.rank+2)throw new BE("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new BE("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new NN({ndim:this.rank+2,axes:Y({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){var t;if(e=IN(e),1===n.rank)throw new WE("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=qI(e,[0,2,3,1])),t=EI(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=ZT(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=qI(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=bN(this.depthwiseInitializer),e.pointwiseInitializer=bN(this.pointwiseInitializer),e.depthwiseRegularizer=GR(this.depthwiseRegularizer),e.pointwiseRegularizer=GR(this.pointwiseRegularizer),e.depthwiseConstraint=$N(this.depthwiseConstraint),e.pointwiseConstraint=$N(this.pointwiseConstraint),e}}]),n}(uP);dP.className="SeparableConv";var pP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,2,e)}return q(n)}(dP);pP.className="SeparableConv2D",Xx(pP);var vP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return q(n,[{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!oT(e.kernelSize,"number",1,1))throw new BE("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(uP);vP.className="Conv1D",Xx(vP);var gP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return q(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return Px((function(){if(e=IN(e),"channelsLast"===n.dataFormat){var t=BT(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return BT(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=BT(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return BT(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);gP.className="Cropping2D",Xx(gP);var mP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xT(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,function(e){iT(vT,"InterpolationFormat",e)}(r.interpolation),r}return q(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return Px((function(){var t=IN(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=qI(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o="nearest"===n.interpolation?eA.resizeNearestNeighbor(t,[a,i]):eA.resizeBilinear(t,[a,i]);return qI(o,[0,3,1,2])}var s=n.size[0]*r[1],u=n.size[1]*r[2];return"nearest"===n.interpolation?eA.resizeNearestNeighbor(t,[s,u]):eA.resizeBilinear(t,[s,u])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);mP.className="UpSampling2D",Xx(mP);var yP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=xN(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=tO(e.depthwiseConstraint),r.depthwiseRegularizer=KR(e.depthwiseRegularizer),r}return q(n,[{key:"build",value:function(e){if((e=CN(e)).length<4)throw new BE("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new BE("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return Px((function(){null==a&&(a="channelsLast"),xT(a);var o=nP(e,a);if(4!==e.rank)throw new BE("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new BE("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=Pw(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=qI(o,[0,3,1,2])),o}))}(e=IN(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=ZT(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=CN(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=eP(t,this.kernelSize[0],this.padding,this.strides[0]),i=eP(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=bN(this.depthwiseInitializer),e.depthwiseRegularizer=GR(this.depthwiseRegularizer),e.depthwiseConstraint=$N(this.depthwiseRegularizer),e}}]),n}(sP);function bP(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new BE("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function xP(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return Px((function(){var u=t.shape.length;if(u<3)throw new BE("Input should be at least 3D, but is ".concat(u,"D."));var c=[1,0].concat(MT(2,u));if(t=qI(t,c),null!=i)throw new WE("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=Ex(Ex(a,"bool"),"float32")).rank===u-1&&(a=Lw(a,-1)),a=qI(a,c)),r&&(t=SI(t,0),null!=a&&(a=SI(a,0)));var l,f,h=[],d=n,p=t.shape[0],v=VI(t);null!=a&&(f=VI(a));for(var g,m=function(t){var n=v[t],r=Px((function(){return e(n,d)}));if(null==a)l=r[0],d=r[1];else{var i=Px((function(){var e=f[t],n=ek(gI(e),e),a=Lx(Ux(r[0],e),Ux(d[0],n)),i=d.map((function(t,a){return Lx(Ux(r[1][a],e),Ux(t,n))}));return{output:a,newStates:i}}));l=i.output,d=i.newStates}s&&h.push(l)},y=0;y<p;++y)m(y);if(s){g=zI(h,1)}return[l,g,d]}))}yP.className="DepthwiseConv2D",Xx(yP);var kP=function(e){F(n,e);var t=z(n);function n(e){var r,a;if(G(this,n),r=t.call(this,e),null==e.cell)throw new BE("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new TP({cells:e.cell}):e.cell).stateSize)throw new BE("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new NN({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return q(n,[{key:"getStates",value:function(){return null==this.states_?MT(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){kN(e)&&(e=e[0]);var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=U(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push([e[0],s])}}catch(Wse){o.e(Wse)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return Px((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new WE("Constants support is not implemented in RNN yet.");kN(e)&&(e=e[0]);var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new NN({shape:[t,null].concat(X(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!up(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new BE("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new NN({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Px((function(){if(!t.stateful)throw new zE("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new BE("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return pI([r,e])})):t.states_=[pI([r,t.cell.stateSize])];else if(null==e)Dx(t.states_),null!=t.keptStates&&(Dx(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return pI([r,e])})):t.states_[0]=pI([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new BE("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):Dx(t.states_);for(var a=0;a<t.states_.length;++a){var i=e[a],o=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,s=[r,o];if(!up(i.shape,s))throw new BE("State ".concat(a," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(s,", received shape=").concat(i.shape));t.states_[a]=i}}t.states_=t.states_.map((function(e){return Mx(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=bP(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var u,c=U(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.stateSpec.push(new NN({shape:l.shape}))}}catch(Wse){c.e(Wse)}finally{c.f()}s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof ON){var f=[e].concat(o),h=this.inputSpec.concat(s),d=this.inputSpec;this.inputSpec=h;var p=P(R(n.prototype),"apply",this).call(this,f,t);return this.inputSpec=d,p}return P(R(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Px((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=IN(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new BE("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=xP((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],f=u[2];n.stateful&&n.resetStates(f,a);var h=n.returnSequences?l:c;return n.returnState?[h].concat(f):h}))}},{key:"getInitialState",value:function(e){var t=this;return Px((function(){var n=pI(e.shape);return n=jT(n=Xw(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?GT(n,[1,e]):n})):t.cell.stateSize>1?[GT(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){P(R(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=pO(t.cell,n);return new e(Object.assign(t,{cell:r}))}}]),n}(MN);kP.className="RNN",Xx(kP);var wP=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n)}(MN),IP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,sT(r.units,"units"),r.activation=zR(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=xN(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=xN(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=xN(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=KR(e.kernelRegularizer),r.recurrentRegularizer=KR(e.recurrentRegularizer),r.biasRegularizer=KR(e.biasRegularizer),r.kernelConstraint=tO(e.kernelConstraint),r.recurrentConstraint=tO(e.recurrentConstraint),r.biasConstraint=tO(e.biasConstraint),r.dropout=PT([1,DT([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=PT([1,DT([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return q(n,[{key:"build",value:function(e){e=CN(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){if(2!==e.length)throw new BE("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=NP({ones:function(){return gI(e)},rate:n.dropout,training:i,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=NP({ones:function(){return gI(r)},rate:n.recurrentDropout,training:i,dropoutFunc:n.dropoutFunc}));var o=n.dropoutMask,s=n.recurrentDropoutMask;a=KT(null!=o?Ux(e,o):e,n.kernel.read()),null!=n.bias&&(a=ZT(a,n.bias.read())),null!=s&&(r=Ux(r,s));var u=Lx(a,KT(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:LR(this.activation),useBias:this.useBias,kernelInitializer:bN(this.kernelInitializer),recurrentInitializer:bN(this.recurrentInitializer),biasInitializer:bN(this.biasInitializer),kernelRegularizer:GR(this.kernelRegularizer),recurrentRegularizer:GR(this.recurrentRegularizer),biasRegularizer:GR(this.biasRegularizer),activityRegularizer:GR(this.activityRegularizer),kernelConstraint:$N(this.kernelConstraint),recurrentConstraint:$N(this.recurrentConstraint),biasConstraint:$N(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}]),n}(wP);IP.className="SimpleRNNCell",Xx(IP);var CP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),e.cell=new IP(e),t.call(this,e)}return q(n,[{key:"call",value:function(e,t){var r=this;return Px((function(){null!=r.cell.dropoutMask&&(Dx(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Dx(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return P(R(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(kP);CP.className="SimpleRNN",Xx(CP);var AP=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new BE("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,sT(r.units,"units"),r.activation=zR(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=zR(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=xN(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=xN(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=xN(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=KR(e.kernelRegularizer),r.recurrentRegularizer=KR(e.recurrentRegularizer),r.biasRegularizer=KR(e.biasRegularizer),r.kernelConstraint=tO(e.kernelConstraint),r.recurrentConstraint=tO(e.recurrentConstraint),r.biasConstraint=tO(e.biasConstraint),r.dropout=PT([1,DT([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=PT([1,DT([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return q(n,[{key:"build",value:function(e){var t=(e=CN(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){if(2!==e.length)throw new BE("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=NP({ones:function(){return gI(e)},rate:n.dropout,training:r,count:3,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=NP({ones:function(){return gI(a)},rate:n.recurrentDropout,training:r,count:3,dropoutFunc:n.dropoutFunc}));var i,o,s,u=n.dropoutMask,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Ux(e,u[0]));var l=KT(e,n.kernel.read());n.useBias&&(l=ZT(l,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Ux(a,c[0]));var f=n.recurrentKernel.read(),h=E(LI(f,[2*n.units,n.units],f.rank-1),2),d=h[0],p=h[1],v=KT(a,d),g=E(LI(l,3,l.rank-1),3),m=g[0],y=g[1],b=g[2],x=E(LI(v,2,v.rank-1),2),k=x[0],w=x[1];i=n.recurrentActivation.apply(Lx(m,k)),o=n.recurrentActivation.apply(Lx(y,w));var I=KT(Ux(o,a),p);s=n.activation.apply(Lx(b,I));var C=Lx(Ux(i,a),Ux(Lx(1,fI(i)),s));return[C,C]}))}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:LR(this.activation),recurrentActivation:LR(this.recurrentActivation),useBias:this.useBias,kernelInitializer:bN(this.kernelInitializer),recurrentInitializer:bN(this.recurrentInitializer),biasInitializer:bN(this.biasInitializer),kernelRegularizer:GR(this.kernelRegularizer),recurrentRegularizer:GR(this.recurrentRegularizer),biasRegularizer:GR(this.biasRegularizer),activityRegularizer:GR(this.activityRegularizer),kernelConstraint:$N(this.kernelConstraint),recurrentConstraint:$N(this.recurrentConstraint),biasConstraint:$N(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}]),n}(wP);AP.className="GRUCell",Xx(AP);var SP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new AP(e),t.call(this,e)}return q(n,[{key:"call",value:function(e,t){var r=this;return Px((function(){null!=r.cell.dropoutMask&&(Dx(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Dx(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return P(R(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(kP);SP.className="GRU",Xx(SP);var _P=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,sT(r.units,"units"),r.activation=zR(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=zR(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=xN(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=xN(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=xN(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=KR(e.kernelRegularizer),r.recurrentRegularizer=KR(e.recurrentRegularizer),r.biasRegularizer=KR(e.biasRegularizer),r.kernelConstraint=tO(e.kernelConstraint),r.recurrentConstraint=tO(e.recurrentConstraint),r.biasConstraint=tO(e.biasConstraint),r.dropout=PT([1,DT([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=PT([1,DT([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return q(n,[{key:"build",value:function(e){var t,n,r=(e=CN(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new(t=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new rN).apply([i]),o=a.apply([2*i]);return VT(VT(n,r),o)}}]),n}(tN),t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){var r=null!=t.training&&t.training;if(3!==e.length)throw new BE("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=NP({ones:function(){return gI(e)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=NP({ones:function(){return gI(a)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var o,s,u,c,l=n.dropoutMask,f=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Ux(e,l[0]));var h=KT(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Ux(a,f[0])),h=Lx(h,KT(a,n.recurrentKernel.read())),n.useBias&&(h=ZT(h,n.bias.read()));var d=E(LI(h,4,h.rank-1),4),p=d[0],v=d[1],g=d[2],m=d[3];o=n.recurrentActivation.apply(p),s=n.recurrentActivation.apply(v),u=Lx(Ux(s,i),Ux(o,n.activation.apply(g))),c=n.recurrentActivation.apply(m);var y=Ux(c,n.activation.apply(u));return[y,y,u]}))}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:LR(this.activation),recurrentActivation:LR(this.recurrentActivation),useBias:this.useBias,kernelInitializer:bN(this.kernelInitializer),recurrentInitializer:bN(this.recurrentInitializer),biasInitializer:bN(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:GR(this.kernelRegularizer),recurrentRegularizer:GR(this.recurrentRegularizer),biasRegularizer:GR(this.biasRegularizer),activityRegularizer:GR(this.activityRegularizer),kernelConstraint:$N(this.kernelConstraint),recurrentConstraint:$N(this.recurrentConstraint),biasConstraint:$N(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}]),n}(wP);_P.className="LSTMCell",Xx(_P);var EP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new _P(e),t.call(this,e)}return q(n,[{key:"call",value:function(e,t){var r=this;return Px((function(){null!=r.cell.dropoutMask&&(Dx(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Dx(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return P(R(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(kP);EP.className="LSTM",Xx(EP);var TP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).cells=e.cells,r}return q(n,[{key:"stateSize",get:function(){var e,t=[],n=U(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,X(r.stateSize)):t.push(r.stateSize)}}catch(Wse){n.e(Wse)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return Px((function(){var r,a=e.slice(1),i=[],o=U(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch(Wse){o.e(Wse)}finally{o.f()}i.reverse();for(var u,c=[],l=0;l<n.cells.length;++l){var f=n.cells[l];a=i[l],u=0===l?[e[0]].concat(a):[u[0]].concat(a),u=f.call(u,t),c.push(u.slice(1))}a=[];var h,d=U(c.slice().reverse());try{for(d.s();!(h=d.n()).done;){var p,v=h.value;(p=a).push.apply(p,X(v))}}catch(Wse){d.e(Wse)}finally{d.f()}return[u[0]].concat(a)}))}},{key:"build",value:function(e){var t;kN(e)&&(e=e[0]),this.cells.forEach((function(n,r){AT("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign(Object.assign({},e),t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=U(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,X(r.trainableWeights))}}catch(Wse){n.e(Wse)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=U(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,X(r.nonTrainableWeights))}}catch(Wse){n.e(Wse)}finally{n.f()}if(!this.trainable){var a,i=[],o=U(this.cells);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,X(s.trainableWeights))}}catch(Wse){o.e(Wse)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=U(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,X(r.weights))}}catch(Wse){n.e(Wse)}finally{n.f()}return EN(t)}},{key:"setWeights",value:function(e){var t,n=[],r=U(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),s=0;s<a.weights.length;++s)n.push([a.weights[s],o[s]])}catch(Wse){r.e(Wse)}finally{r.f()}TN(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=U(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(pO(o,r))}}catch(Wse){i.e(Wse)}finally{i.f()}return new e({cells:a})}}]),n}(wP);function NP(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,s=e.dropoutFunc,u=function(){return null!=s?s(t(),n):QT(t(),n)},c=function(){return JT(u,t,a)};return!o||o<=1?Mx(c().clone()):Array(o).fill(void 0).map(c).map((function(e){return Mx(e.clone())}))}TP.className="StackedRNNCells",Xx(TP);var OP=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},RP=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),e.unroll)throw new WE("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new WE("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new NN({ndim:5})],r}return q(n,[{key:"call",value:function(e,t){var r=this;return Px((function(){if(null!=r.cell.dropoutMask&&(Dx(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Dx(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new BE("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return P(R(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(X(t.slice(2)))),this.returnState&&(t=[t].concat(X(Array(2).fill([e[0]].concat(X(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return Px((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),i=pI([a[0]].concat(X(a.slice(2))));return Array.isArray(n)?Array(n.length).fill(i):[i]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Px((function(){if(!t.stateful)throw new zE("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat(X(a.slice(2)));if(null==r[0])throw new BE("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return pI(i)})):t.states_=[pI(i)];else if(null==e)Dx(t.states_),null!=t.keptStates&&(Dx(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return pI(i)})):t.states_[0]=pI(i);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new BE("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):Dx(t.states_);for(var o=0;o<t.states_.length;++o){var s=e[o],u=i;if(!up(s.shape,u))throw new BE("State ".concat(o," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(s.shape));t.states_[o]=s}}t.states_=t.states_.map((function(e){return Mx(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,s=t.dilationRate,u="channelsFirst"===n,c=e[u?3:2],l=e[u?4:3],f=eP(c,a[0],i,o[0],s[0]),h=eP(l,a[1],i,o[1],s[1]);return[].concat(X(e.slice(0,2)),X(u?[r,f,h]:[f,h,r]))}}]),n}(kP);RP.className="ConvRNN2D";var PP=function(e){F(n,e);var t=z(n);function n(e){var r;G(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,s=e.padding,u=e.dataFormat,c=e.dilationRate;return(r=t.call(this,Object.assign(Object.assign({},e),{units:a}))).filters=a,sT(r.filters,"filters"),r.kernelSize=$R(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return sT(e,"kernelSize")})),r.strides=$R(o||1,2,"strides"),r.strides.forEach((function(e){return sT(e,"strides")})),r.padding=s||"valid",kT(r.padding),r.dataFormat=u||"channelsLast",xT(r.dataFormat),r.dilationRate=$R(c||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return sT(e,"dilationRate")})),r}return q(n,[{key:"build",value:function(e){var t;e=CN(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new BE("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var o;if(this.unitForgetBias){var s=this.biasInitializer,u=this.filters;o=new(t=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"apply",value:function(e,t){return WT([s.apply([u]),vI([u]),s.apply([2*u])])}}]),n}(tN),t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){if(3!==e.length)throw new BE("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],i=e[1],o=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=NP({ones:function(){return gI(a)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var s=n.dropoutMask,u=function(e,t,n){return t&&t[n]?Ux(t[n],e):e},c=u(a,s,0),l=u(a,s,1),f=u(a,s,2),h=u(a,s,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=NP({ones:function(){return gI(i)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var d=n.recurrentDropoutMask,p=u(i,d,0),v=u(i,d,1),g=u(i,d,2),m=u(i,d,3),y=E(LI(n.kernel.read(),4,3),4),b=y[0],x=y[1],k=y[2],w=y[3],I=E(n.useBias?LI(n.bias.read(),4):[null,null,null,null],4),C=I[0],A=I[1],S=I[2],_=I[3];c=n.inputConv(c,b,C,n.padding),l=n.inputConv(l,x,A,n.padding),f=n.inputConv(f,k,S,n.padding),h=n.inputConv(h,w,_,n.padding);var T=E(LI(n.recurrentKernel.read(),4,3),4),N=T[0],O=T[1],R=T[2],P=T[3];p=n.recurrentConv(p,N),v=n.recurrentConv(v,O),g=n.recurrentConv(g,R),m=n.recurrentConv(m,P);var D=n.recurrentActivation.apply(Lx(c,p)),M=n.recurrentActivation.apply(Lx(l,v)),F=Lx(Ux(M,o),Ux(D,n.activation.apply(Lx(f,g)))),L=Ux(n.recurrentActivation.apply(Lx(h,m)),n.activation.apply(F));return[L,L,F]}))}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t=(e.units,OP(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),r)}},{key:"inputConv",value:function(e,t,n,r){var a=Aw(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?ZT(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return Aw(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(_P);PP.className="ConvLSTM2DCell",Xx(PP);var DP=function(e){F(n,e);var t=z(n);function n(e){G(this,n);var r=new PP(e);return t.call(this,Object.assign(Object.assign({},e),{cell:r}))}return q(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(RP);DP.className="ConvLSTM2D",Xx(DP);var MP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return q(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r=IN(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return JT((function(){return QT(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return P(R(n.prototype),"dispose",this).call(this)}}]),n}(MN);MP.className="Dropout",Xx(MP);var FP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return q(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(MP);FP.className="SpatialDropout1D",Xx(FP);var LP=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,sT(r.units,"units"),r.activation=zR(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=xN(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=xN(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=tO(e.kernelConstraint),r.biasConstraint=tO(e.biasConstraint),r.kernelRegularizer=KR(e.kernelRegularizer),r.biasRegularizer=KR(e.biasRegularizer),r.activityRegularizer=KR(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return q(n,[{key:"build",value:function(e){var t=(e=CN(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:Y({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=CN(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r,a=IN(e),i=cT(n.activation.getClassName());return null!=i?r=KT(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=KT(a,n.kernel.read()),null!=n.bias&&(r=ZT(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:LR(this.activation),useBias:this.useBias,kernelInitializer:bN(this.kernelInitializer),biasInitializer:bN(this.biasInitializer),kernelRegularizer:GR(this.kernelRegularizer),biasRegularizer:GR(this.biasRegularizer),activityRegularizer:GR(this.activityRegularizer),kernelConstraint:$N(this.kernelConstraint),biasConstraint:$N(this.biasConstraint)},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);LP.className="Dense",Xx(LP);var jP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return q(n,[{key:"computeOutputShape",value:function(e){var t,n=U((e=CN(e)).slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new BE('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(Wse){n.e(Wse)}finally{n.f()}return[e[0],RT(e,1)]}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r=IN(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=qI(r,a)}return function(e){if(e.rank<=1)throw new BE("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],RT(e.shape,1)];return fw(e,t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);jP.className="Flatten",Xx(jP);var zP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=zR(e.activation),r}return q(n,[{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r=IN(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:LR(this.activation)},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);zP.className="Activation",Xx(zP);var UP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return q(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return Px((function(){return function(e,t){return Px((function(){if(2!==e.shape.length)throw new BE("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return GT(jT(e,1),[1,t,1])}))}(e=IN(e),n.n)}))}},{key:"getConfig",value:function(){var e={n:this.n},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);UP.className="RepeatVector",Xx(UP);var BP=function(e){F(n,e);var t=z(n);function n(e){var r;G(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return q(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new BE("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=RT(e);if(null!==i){if(0===a||u%a!==0)throw new BE(n);r[i]=u/a}else if(u!==a)throw new BE(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r=IN(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return fw(r,i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);BP.className="Reshape",Xx(BP);var WP=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=MT(1,e.dims.length+1);if(!up(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new NN({ndim:r.dims.length+1})],r}return q(n,[{key:"computeOutputShape",value:function(e){var t=(e=CN(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return qI(IN(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);WP.className="Permute",Xx(WP);var VP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return q(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=IN(e);return Xk(hI(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r=IN(e),a=Xk(hI(r,n.maskValue),-1,!0);return Ux(r,Ex(a,r.dtype))}))}}]),n}(MN);VP.className="Masking",Xx(VP);var GP=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(YE(e.inputLength))}return r.inputDim=e.inputDim,sT(r.inputDim,"inputDim"),r.outputDim=e.outputDim,sT(r.outputDim,"outputDim"),r.embeddingsInitializer=xN(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=KR(e.embeddingsRegularizer),r.activityRegularizer=KR(e.activityRegularizer),r.embeddingsConstraint=tO(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return q(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return Px((function(){return n.maskZero?(e=IN(e),hI(e,Vx(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=CN(e),null==this.inputLength)return[].concat(X(e),[this.outputDim]);var t=YE(this.inputLength);if(t.length!==e.length-1)throw new BE('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new BE('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(X(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r=IN(e);"int32"!==r.dtype&&(r=LT(r,"int32"));var a=qT(n.embeddings.read(),fw(r,[r.size]));return fw(a,CN(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:bN(this.embeddingsInitializer),embeddingsRegularizer:GR(this.embeddingsRegularizer),activityRegularizer:GR(this.activityRegularizer),embeddingsConstraint:$N(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);GP.className="Embedding",Xx(GP);var HP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return q(n,[{key:"mergeFunction",value:function(e){throw new WE}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new BE("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[CN(e)]),e.length<2)throw new BE("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=U(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(Wse){r.e(Wse)}finally{r.f()}if((n=rT(n)).length>1)throw new BE("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var s=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var u=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===rT(u).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){if(n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=DT(r),o=U(e);try{for(o.s();!(a=o.n()).done;){for(var s=a.value,u=s.rank,c=0;c<i-u;++c)s=jT(s,1);t.push(s)}}catch(Wse){o.e(Wse)}finally{o.f()}return n.mergeFunction(t)}var l,f=!1,h=U(e);try{for(h.s();!(l=h.n()).done;){var d=l.value,p=d.rank;if(null==p){var v=d.shape,g=v[0],m=v.slice(1).concat([g]),y=fw(d,[g].concat(RT(v.slice(1))));y=qI(y,[1,0]),y=fw(y,m),t.push(y),f=!0}else if(p>1){var b=MT(1,p).concat([0]);t.push(qI(d,b)),f=!0}else t.push(d)}}catch(Wse){h.e(Wse)}finally{h.f()}var x=n.mergeFunction(t),k=x.rank;if(f)if(null==k){var w=x.shape,I=w[w.length-1],C=[I].concat(w.slice(0,w.length-1));x=fw(qI(fw(x,[-1,I]),[1,0]),C)}else if(k>1){var A=[k-1].concat(MT(0,k-1));x=qI(x,A)}return x}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==e[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=U(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&null!==s[0]&&i.push(s[0])}}catch(Wse){o.e(Wse)}finally{o.f()}return t=1===(i=rT(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return Px((function(){if(null==t)return null;if(!Array.isArray(t))throw new BE("`mask` should be an Array");if(!Array.isArray(e))throw new BE("`inputs` should be an Array");if(t.length!==e.length)throw new BE("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;t=t.map((function(e){return null==e?e:Lw(e,0)}));for(var n=t[0],r=1;r<t.length-1;++r)n=Zw(n,t[r]);return n}))}}]),n}(MN),KP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"mergeFunction",value:function(e){return Px((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Lx(t,e[n]);return t}))}}]),n}(HP);KP.className="Add",Xx(KP);var qP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"mergeFunction",value:function(e){return Px((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Ux(t,e[n]);return t}))}}]),n}(HP);qP.className="Multiply",Xx(qP);var XP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"mergeFunction",value:function(e){return Px((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Lx(t,e[n]);return Ux(1/e.length,t)}))}}]),n}(HP);XP.className="Average",Xx(XP);var YP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"mergeFunction",value:function(e){return Px((function(){for(var t=e[0],n=1;n<e.length;++n)t=ok(t,e[n]);return t}))}}]),n}(HP);YP.className="Maximum",Xx(YP);var ZP=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"mergeFunction",value:function(e){return Px((function(){for(var t=e[0],n=1;n<e.length;++n)t=nI(t,e[n]);return t}))}}]),n}(HP);ZP.className="Minimum",Xx(ZP);var QP=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return q(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new BE("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,r=U(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(Wse){r.e(Wse)}finally{r.f()}if(!n){for(var a=[],i=0;i<e.length;++i){var o=e[i].slice();o.splice(this.axis,1);var s,u=!1,c=U(a);try{for(c.s();!(s=c.n()).done;){if(up(s.value,o)){u=!0;break}}}catch(Wse){c.e(Wse)}finally{c.f()}u||a.push(o)}if(a.length>1)throw new BE("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return Px((function(){return WT(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new BE("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=U(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(Wse){i.e(Wse)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new BE("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new BE("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new BE("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return Px((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)null==t[i]?a.push(Ex(gI(e[i]),"bool")):t[i].rank<e[i].rank?a.push(Lw(t[i],-1)):a.push(t[i]);var o=xw(a,n.axis);return qk(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(HP);function JP(e,t){for(;e<0;)e+=t;return e}QP.className="Concatenate",Xx(QP);var $P=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return q(n,[{key:"build",value:function(e){ap(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new WE("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new BE("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new BE("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return JP(t,e[n].shape.length)})):[JP(this.axes,n.shape.length),JP(this.axes,r.shape.length)],this.normalize&&(n=vO(n,t[0]),r=vO(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new WE("batchDot is not implemented for tensors of 4D or higher rank yet");if(ap(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),ap(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new WE("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return Px((function(){var n,o;if(r>a){n=r-a;for(var s=[],u=0;u<n;++u)s.push(1);t=fw(t,t.shape.concat(s))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=fw(e,e.shape.concat(c))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?Xw(Ux(e,t),i[0]):Xw(Ux(qI(e,[1,0]),t),i[1]);else{var f=i[0]!==e.shape.length-1,h=i[1]===t.shape.length-1;o=Qw(e,t,f,h)}if(n>0){for(var d,p=[],v=d=r>a?r+a-3:r-1;v<d+n;++v)p.push(v);o=jI(o,p)}return 1===o.shape.length&&(o=Lw(o,1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[JP(this.axes,e.length),JP(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){ap(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new WE("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(HP);$P.className="Dot",Xx($P);var eD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return q(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r=IN(e);return JT((function(){return Lx(HT(r.shape,0,n.stddev),r)}),(function(){return r}),t.training||!1)}))}}]),n}(MN);eD.className="GaussianNoise",Xx(eD);var tD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return q(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t);var r=IN(e);if(n.rate>0&&n.rate<1){return JT((function(){var e=Math.sqrt(n.rate/(1-n.rate));return Ux(r,HT(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(MN);tD.className="GaussianDropout",Xx(tD);var nD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return q(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||IN(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=P(R(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Px((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return JT((function(){var t=IN(e),a=-1.7580993408473766,i=Vw(II(r),n.rate);i=LT(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),s=-o*a*n.rate,u=Lx(Ux(t,i),Ux(Lx(i,-1),a));return Lx(Ux(u,o),s)}),(function(){return IN(e)}),t.training||!1)}return e}))}}]),n}(MN);function rD(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=vw(e,t,n,r,a,o);else if(3===e.rank)i=gw(e,t,n,r,a,o);else{if(4!==e.rank)throw new WE("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=mw(e,t,n,r,a,o)}return i}function aD(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return up(r.slice().sort(),MT(0,e.rank-1))?function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Px((function(){var i=lI(e,r),o=i.mean,s=i.variance;return[rD(e,o,s,n,t,a),o,s]}))}(e,t,n,r,a):function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Px((function(){var i,o=lI(e,r),s=o.mean,u=o.variance,c=[],l=U(MT(0,e.rank));try{for(l.s();!(i=l.n()).done;){var f=i.value;-1!==r.indexOf(f)?c.push(1):c.push(e.shape[f])}}catch(Wse){l.e(Wse)}finally{l.f()}var h=fw(s,c),d=fw(u,c),p=null==t?null:fw(t,c),v=null==n?null:fw(n,c);return[rD(e,h,d,v,p,a),s,u]}))}(e,t,n,r,a)}nD.className="AlphaDropout",Xx(nD);var iD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=xN(e.betaInitializer||"zeros"),r.gammaInitializer=xN(e.gammaInitializer||"ones"),r.movingMeanInitializer=xN(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=xN(e.movingVarianceInitializer||"ones"),r.betaConstraint=tO(e.betaConstraint),r.gammaConstraint=tO(e.gammaConstraint),r.betaRegularizer=KR(e.betaRegularizer),r.gammaRegularizer=KR(e.gammaRegularizer),r}return q(n,[{key:"build",value:function(e){e=CN(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new BE("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new NN({ndim:e.length,axes:Y({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return Px((function(){var r=null!=t.training&&t.training,a=IN(e),i=a.shape,o=i.length,s=MT(0,o),u=n.axis>=0?n.axis:n.axis+o;s.splice(u,1);var c=HE(1,o);c[u]=i[u];var l=s.slice();l.sort();var f=!up(l,MT(0,o).slice(0,o-1));if(!r)return function(){if(f){var e=fw(n.movingMean.read(),c),t=fw(n.movingVariance.read(),c),r=n.center?fw(n.beta.read(),c):null,i=n.scale?fw(n.gamma.read(),c):null;return rD(a,e,t,r,i,n.epsilon)}return rD(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var h=E(aD(a,n.gamma.read(),n.beta.read(),s,n.epsilon),3),d=h[0],p=h[1],v=h[2],g=function(e,t,n){Px((function(){var r=1-n,a=e.read(),i=Ux(ek(a,t),r);e.write(ek(a,i))}))};return g(n.movingMean,p,n.momentum),g(n.movingVariance,v,n.momentum),d}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:bN(this.betaInitializer),gammaInitializer:bN(this.gammaInitializer),movingMeanInitializer:bN(this.movingMeanInitializer),movingVarianceInitializer:bN(this.movingVarianceInitializer),betaRegularizer:GR(this.betaRegularizer),gammaRegularizer:GR(this.gammaRegularizer),betaConstraint:$N(this.betaConstraint),gammaConstraint:$N(this.gammaConstraint)},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);iD.className="BatchNormalization",Xx(iD);var oD=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=U(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(Wse){i.e(Wse)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=xN(e.betaInitializer||"zeros"),r.gammaInitializer=xN(e.gammaInitializer||"ones"),r.betaRegularizer=KR(e.betaRegularizer),r.gammaRegularizer=KR(e.gammaRegularizer),r.supportsMasking=!0,r}return q(n,[{key:"build",value:function(e){var t=(e=CN(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=U(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(Wse){a.e(Wse)}finally{a.f()}if(this.axis.length!==rT(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=IN(e),a=r.shape,i=a.length;return Px((function(){var e,t=lI(r,n.axis,!0),o=t.mean,s=t.variance,u=HE(1,i),c=U(n.axis);try{for(c.s();!(e=c.n()).done;){var l=e.value;u[l]=a[l]}}catch(Wse){c.e(Wse)}finally{c.f()}for(var f=function(e){return null!=e&&e.shape.length!==i?fw(e,u):e},h=n.scale?f(n.gamma.read()):null,d=n.center?f(n.beta.read()):null,p=[],v=[],g=0;g<i;++g)-1!==n.axis.indexOf(g)?(p.push(a[g]),v.push(1)):(p.push(1),v.push(a[g]));return o=jw(o,p),s=jw(s,p),null!=h&&(h=jw(h,v)),null!=d&&(d=jw(d,v)),rD(r,o,s,d,h,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:bN(this.betaInitializer),gammaInitializer:bN(this.gammaInitializer),betaRegularizer:GR(this.betaRegularizer),gammaRegularizer:GR(this.gammaRegularizer)},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);oD.className="LayerNormalization",Xx(oD);var sD=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new BE("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new BE("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new BE("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new NN({ndim:4})],r}return q(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=CN(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return Px((function(){return function(e,t,n){return Px((function(){if(4!==e.rank)throw new BE("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new BE("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new BE("Unknown data format: ".concat(n,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],mI(e,r)}))}(IN(e),n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN);function uD(e,t,n,r,a,i){return Px((function(){var o;xT(a),wT(i),kT(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=nP(e,a);var s="same"===r?"same":"valid";return o="max"===i?Jw(e,t,n,s):hw(e,t,n,s),"channelsFirst"===a&&(o=qI(o,[0,3,1,2])),o}))}function cD(e,t,n,r,a,i){return Px((function(){var o;xT(a),wT(i),kT(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=rP(e,a);var s="same"===r?"same":"valid";return o="max"===i?$w(e,t,n,s):dw(e,t,n,s),"channelsFirst"===a&&(o=qI(o,[0,4,1,2,3])),o}))}sD.className="ZeroPadding2D",Xx(sD);var lD=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new BE("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(sT(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new BE("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return sT(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,kT(r.padding),r.inputSpec=[new NN({ndim:3})],r}return q(n,[{key:"computeOutputShape",value:function(e){var t=eP((e=CN(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return Px((function(){n.invokeCallHook(e,t),e=jT(IN(e),2);var r=n.poolingFunction(IN(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return jI(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN),fD=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xT(a),kT(r),uD(e,t,n,r,a,"max")}}]),n}(lD);fD.className="MaxPooling1D",Xx(fD);var hD=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xT(a),kT(r),uD(e,t,n,r,a,"avg")}}]),n}(lD);hD.className="AveragePooling1D",Xx(hD);var dD=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new BE("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return sT(r.poolSize,"poolSize"),sT(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xT(r.dataFormat),kT(r.padding),r.inputSpec=[new NN({ndim:4})],r}return q(n,[{key:"computeOutputShape",value:function(e){e=CN(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=eP(t,this.poolSize[0],this.padding,this.strides[0]),n=eP(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return Px((function(){return n.invokeCallHook(e,t),n.poolingFunction(IN(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN),pD=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xT(a),kT(r),uD(e,t,n,r,a,"max")}}]),n}(dD);pD.className="MaxPooling2D",Xx(pD);var vD=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xT(a),kT(r),uD(e,t,n,r,a,"avg")}}]),n}(dD);vD.className="AveragePooling2D",Xx(vD);var gD=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new BE("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return sT(r.poolSize,"poolSize"),sT(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xT(r.dataFormat),kT(r.padding),r.inputSpec=[new NN({ndim:5})],r}return q(n,[{key:"computeOutputShape",value:function(e){e=CN(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=eP(t,this.poolSize[0],this.padding,this.strides[0]),n=eP(n,this.poolSize[1],this.padding,this.strides[1]),r=eP(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return Px((function(){return n.invokeCallHook(e,t),n.poolingFunction(IN(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN),mD=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xT(a),kT(r),cD(e,t,n,r,a,"max")}}]),n}(gD);mD.className="MaxPooling3D",Xx(mD);var yD=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e)}return q(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xT(a),kT(r),cD(e,t,n,r,a,"avg")}}]),n}(gD);yD.className="AveragePooling3D",Xx(yD);var bD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).inputSpec=[new NN({ndim:3})],r}return q(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new WE}}]),n}(MN),xD=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e||{})}return q(n,[{key:"call",value:function(e,t){return Px((function(){var t=IN(e);return eI(t,1)}))}}]),n}(bD);xD.className="GlobalAveragePooling1D",Xx(xD);var kD=function(e){F(n,e);var t=z(n);function n(e){return G(this,n),t.call(this,e||{})}return q(n,[{key:"call",value:function(e,t){return Px((function(){var t=IN(e);return qw(t,1)}))}}]),n}(bD);kD.className="GlobalMaxPooling1D",Xx(kD);var wD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xT(r.dataFormat),r.inputSpec=[new NN({ndim:4})],r}return q(n,[{key:"computeOutputShape",value:function(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new WE}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(MN),ID=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"call",value:function(e,t){var n=this;return Px((function(){var t=IN(e);return"channelsLast"===n.dataFormat?eI(t,[1,2]):eI(t,[2,3])}))}}]),n}(wD);ID.className="GlobalAveragePooling2D",Xx(ID);var CD=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.apply(this,arguments)}return q(n,[{key:"call",value:function(e,t){var n=this;return Px((function(){var t=IN(e);return"channelsLast"===n.dataFormat?qw(t,[1,2]):qw(t,[2,3])}))}}]),n}(wD);CD.className="GlobalMaxPooling2D",Xx(CD);var AD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).layer=e.layer,r}return q(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){P(R(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=pO(t.layer,n);delete t.layer;var a={layer:r};return Object.assign(a,t),new e(a)}}]),n}(MN),SD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return q(n,[{key:"build",value:function(e){if((e=CN(e)).length<3)throw new BE("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),P(R(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=CN(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return Px((function(){return xP((function(e,r){return[IN(n.layer.call(e,t)),[]]}),e=IN(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(AD);SD.className="TimeDistributed",Xx(SD);var _D="concat",ED=function(e){F(n,e);var t=z(n);function n(e){var r;G(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=pO(i),a.goBackwards=!0!==a.goBackwards;var o={};if(o.className=e.layer.getClassName(),o.config=a,r.backwardLayer=pO(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?_D:e.mergeMode,function(e){iT(yT,"BidirectionalMergeMode",e)}(r.mergeMode),e.weights)throw new WE("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return q(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):XE(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=bP(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return P(R(n.prototype),"apply",this).call(this,e,t);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new BE("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,X(r));var c=r.map((function(e){return new NN({shape:e.shape})}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),s.push.apply(s,X(c))}if(null!=a)throw new WE("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof ON,f=0,h=o;f<h.length;f++){if(h[f]instanceof ON!==l)throw new BE("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var d=[e].concat(o),p=this.inputSpec.concat(s),v=this.inputSpec;this.inputSpec=p;var g=P(R(n.prototype),"apply",this).call(this,d,t);return this.inputSpec=v,g}return P(R(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Px((function(){var r,a,i,o,s=t.initialState;if(null==s)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var u=s.slice(0,s.length/2),c=s.slice(s.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:u})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=SI(a,1)),"concat"===n.mergeMode?o=WT([r,a]):"sum"===n.mergeMode?o=Lx(r,a):"ave"===n.mergeMode?o=Ux(.5,Lx(r,a)):"mul"===n.mergeMode?o=Ux(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;AT(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),AT(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){P(R(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=pO(t.layer);if(delete t.layer,null!=t.numConstants)throw new WE("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(AD);ED.className="Bidirectional",Xx(ED);var TD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).scale=e.scale,e.offset?r.offset=e.offset:r.offset=0,r}return q(n,[{key:"getConfig",value:function(){var e={scale:this.scale,offset:this.offset},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return Px((function(){return"float32"!==(e=IN(e)).dtype&&(e=LT(e,"float32")),Lx(Ux(e,n.scale),n.offset)}))}}]),n}(MN);TD.className="Rescaling",Xx(TD);var ND=eA.resizeBilinear,OD=eA.cropAndResize,RD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,r}return q(n,[{key:"centerCrop",value:function(e,t,n,r,a,i,o,s){return Px((function(){var u,c=!1,l=[t/i,n/o,(r+t)/i,(a+n)/o],f=[];3===e.rank?(c=!0,u=zI([e])):u=e;for(var h=0;h<u.shape[0];h++)f.push(l);var d=yb(f,[f.length,4]),p=CI(0,f.length,1,"int32"),v=OD(u,d,p,[r,a],"nearest");return LT(c?IN(VI(v)):v,s)}))}},{key:"upsize",value:function(e,t,n,r){return Px((function(){return LT(ND(e,[t,n]),r)}))}},{key:"call",value:function(e,t){var n=this;return Px((function(){var t=IN(e),r=t.dtype,a=t.shape,i=a[a.length-3],o=a[a.length-2],s=0;i!==n.height&&(s=Math.floor((i-n.height)/2));var u=0;return o!==n.width&&0===(u=Math.floor((o-n.width)/2))&&(u=1),s>=0&&u>=0?n.centerCrop(t,s,u,n.height,n.width,i,o,r):n.upsize(e,n.height,n.width,r)}))}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){var t=(e=CN(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}]),n}(MN);RD.className="CenterCrop",Xx(RD);var PD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this,e)).numTokens=e.numTokens,e.outputMode?r.outputMode=e.outputMode:r.outputMode="multiHot",r}return q(n,[{key:"getConfig",value:function(){var e={numTokens:this.numTokens,outputMode:this.outputMode},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){return null==(e=CN(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}},{key:"call",value:function(e,t){var n=this;return Px((function(){var r;if("int32"!==(e=IN(e)).dtype&&(e=LT(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==n.outputMode)throw new BE("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));r=IN(t.countWeights)}var a=qw(e),i=tI(e),o=Ww(n.numTokens,a).bufferSync().get(0),s=Vw(i,0).bufferSync().get(0);if(!o||!s)throw new BE("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(n.numTokens));return function(e,t,n,r){var a=IN(e);if("int32"!==a.dtype&&(a=LT(a,"int32")),"int"===t)return a;var i=a.shape;if(0===a.rank&&(a=Lw(a,-1)),"oneHot"===t&&1!==a.shape[a.shape.length-1]&&(a=Lw(a,-1)),a.rank>2)throw new BE("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(i)+" which would result in output rank ".concat(a.rank,"."));var o,s=["multiHot","oneHot"].includes(t),u=a;if(o=Rw(u,"undefined"!==typeof r&&"count"===t?r:[],n,s),"tfIdf"!==t)return o;if(r)return Ux(o,r);throw new BE("When outputMode is 'tfIdf', weights must be provided.")}(e,n.outputMode,n.numTokens,r)}))}}]),n}(MN);PD.className="CategoryEncoding",Xx(PD);var DD=new Set(["bilinear","nearest"]),MD=function(e){F(n,e);var t=z(n);function n(e){var r;if(G(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,e.interpolation){if(!DD.has(e.interpolation))throw new BE("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));r.interpolation=e.interpolation}else r.interpolation="bilinear";return r.cropToAspectRatio=Boolean(e.cropToAspectRatio),r}return q(n,[{key:"computeOutputShape",value:function(e){var t=(e=CN(e))[2];return[this.height,this.width,t]}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=P(R(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return Px((function(){var t=[n.height,n.width];if("bilinear"===n.interpolation)return eA.resizeBilinear(e,t,!n.cropToAspectRatio);if("nearest"===n.interpolation)return eA.resizeNearestNeighbor(e,t,!n.cropToAspectRatio);throw new Error("Interpolation is ".concat(n.interpolation," but only ").concat(X(DD)," are supported"))}))}}]),n}(MN);MD.className="Resizing",Xx(MD);var FD,LD;jp().registerFlag("KEEP_INTERMEDIATE_TENSORS",(function(){return!1}),(function(e){e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(FD||(FD={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(LD||(LD={}));function jD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(WD(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=jD(e[o],t,n,r);i[o]=s}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function zD(e){return UD(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:BD)}function UD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(WD(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=e.map((function(e){return e[r]})),o=UD(a,t,n);i[r]=o};for(var s in r)o(s);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function BD(e){return null===e?null:WD(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function WD(e){var t=!1;jp().get("IS_BROWSER")?t=e instanceof TextDecoder:t=e instanceof n(8090).StringDecoder;return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof jy)&&!(e instanceof Promise)&&!t)}function VD(e){return function(e,t){return jD(e,t)}(e,GD)}function GD(e){return e instanceof jy?{value:e.clone(),recurse:!1}:WD(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var HD=function(){function e(t){if(G(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return q(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=U(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(Wse){n.e(Wse)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),KD=function(e){F(n,e);var t=z(n);function n(){return G(this,n),t.call(this,n.INITIAL_CAPACITY)}return q(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){P(R(n.prototype),"isFull",this).call(this)&&this.expand(),P(R(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){P(R(n.prototype),"isFull",this).call(this)&&this.expand(),P(R(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(HD);function qD(e){return new JD(e)}function XD(e,t){return new cM(e,t)}KD.INITIAL_CAPACITY=32;var YD,ZD=function(){function e(){G(this,e)}return q(e,[{key:"toArray",value:function(){var e=V(B().mark((function e(){var t,n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=V(B().mark((function e(){var t,n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new iM(this,e)}},{key:"filter",value:function(e){return new rM(this,e)}},{key:"map",value:function(e){return new aM(this,e)}},{key:"mapAsync",value:function(e){return new oM(this,e)}},{key:"serialMapAsync",value:function(e){return new oM(this,e).serial()}},{key:"flatmap",value:function(e){return new uM(this,e)}},{key:"forEachAsync",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){return new nM(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:BD;return this.rowMajorBatch(e,t).map((function(e){return zD(e,n)}))}},{key:"concatenate",value:function(e,t){return new cM(new QD([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new tM(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new eM(this,e)}},{key:"prefetch",value:function(e){return new lM(this,e)}},{key:"shuffle",value:function(e,t){return new fM(this,e,t)}},{key:"serial",value:function(){return new $D(this)}}]),e}(),QD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).items=e,r.trav=0,r}return q(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:VD(t),done:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),JD=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).nextFn=e,r}return q(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),$D=function(e){F(n,e);var t=z(n);function n(e){var r;return G(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),eM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:Dx(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),tM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),nM=function(e){F(n,e);var t=z(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return G(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=V(B().mark((function e(){var t,n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),rM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=V(B().mark((function e(){var t;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:Dx(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),aM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o,s;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=Qy(t.value),r=this.transform(t.value),a=Qy(r),i=U(n);try{for(i.s();!(o=i.n()).done;)Zy(s=o.value,a)||s.dispose()}catch(Wse){i.e(Wse)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),iM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),oM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o,s;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=Qy(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,a=Qy(r),i=U(n);try{for(i.s();!(o=i.n()).done;)Zy(s=o.value,a)||s.dispose()}catch(Wse){i.e(Wse)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),sM=function(e){F(n,e);var t=z(n);function n(){var e;return G(this,n),(e=t.call(this)).outputQueue=new KD,e.lastRead=Promise.resolve({value:null,done:!1}),e}return q(n,[{key:"next",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ZD),uM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o,s;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=Qy(t.value),r=this.transform(t.value),a=Qy(r),this.outputQueue.pushAll(r),i=U(n);try{for(i.s();!(o=i.n()).done;)Zy(s=o.value,a)||s.dispose()}catch(Wse){i.e(Wse)}finally{i.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(sM),cM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return q(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(ZD);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(YD||(YD={}));var lM=function(e){F(n,e);var t=z(n);function n(e,r){var a;return G(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new HD(r),a}return q(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(ZD),fM=function(e){F(n,e);var t=z(n);function n(e,r,a){var i;return G(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=bI.alea(a||xy().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return q(n,[{key:"next",value:function(){var e=V(B().mark((function e(){var t=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=V(B().mark((function e(){var t,n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(lM),hM=function(){function e(){G(this,e),this.size=null}return q(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return ap(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),dM(V(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,pM));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,dM(V(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,dM(V(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return Px((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return dM(V(B().mark((function n(){return B().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return Px((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return dM(V(B().mark((function n(){return B().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return dM(V(B().mark((function n(){return B().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,dM(V(B().mark((function t(){var r;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=qD(V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",XD(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,dM(V(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=bI.alea(t||xy().toString());return dM(V(B().mark((function t(){var i;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,dM(V(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=V(B().mark((function e(){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function dM(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){F(a,n);var r=z(a);function a(){var e;return G(this,a),(e=r.apply(this,arguments)).size=t,e}return q(a,[{key:"iterator",value:function(){var t=V(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(hM))}function pM(e){if(null===e)return null;var t,n=e[0];return null==(t=n)||function(e){return null===e||"object"!==typeof e&&"function"!==typeof e}(t)||Array.isArray(t)||"object"===typeof t&&t instanceof jy||Iy(t)?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof jy?zI(e):yb(e)}(e),recurse:!1}:{value:null,recurse:!0}}hM.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function vM(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&ap("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var gM=YA,mM=function(e){F(n,e);var t=z(n);function n(){var e;return G(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new Zd(D(e),Ox()),e}return q(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,jp().get("IS_NODE")&&Ym("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));var r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&xp(n[0])){var a=n.map((function(e){return ky(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"refCount",value:function(e){return this.data.has(e)?this.data.get(e).refCount:0}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;return"complex64"===n?_A(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):function(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}(this.data.get(e).values,n)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return wy(e)}));return _x(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return _x(e.shape,e.dtype,t)}},{key:"makeOutput",value:function(e,t,n){return Ox().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;var n=this.data.get(e).complexTensorInfos;null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"time",value:function(){var e=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=xy(),t(),r=xy()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){vM([e],"where");var t=this.readSync(e.dataId);return gM(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return P(R(n.prototype),"epsilon",this).call(this)}}]),n}(Qd);mM.nextDataId=0;function yM(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(vM(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");for(var u=o,c=u.data.get(s.dataId).values,l=sp(s.shape),f=n||s.dtype,h=mp(f,l),d=0;d<l;++d)h[d]=t(c[d],i);return u.makeTensorInfo(s.shape,f,h)}}function bM(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(vM(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var u=o,c=u.data.get(s.dataId).values,l=n||s.dtype,f=t(c,l,i);return u.makeTensorInfo(s.shape,l,f)}}Fx("cpu",(function(){return new mM}),1);var xM=yM(zv,(function(e){return e>=0?e:Math.exp(e)-1})),kM={kernelName:zv,backendName:"cpu",kernelFunc:xM};function wM(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var IM={kernelName:ng,backendName:"cpu",kernelFunc:wM};function CM(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha;vM([a],"leakyRelu");for(var o=sp(a.shape),s=n.data.get(a.dataId).values,u=gp("float32",o),c=0;c<s.length;c++)u[c]=s[c]<0?i*s[c]:s[c];return n.makeTensorInfo(a.shape,"float32",u)}var AM={kernelName:ug,backendName:"cpu",kernelFunc:CM};function SM(e){return function(t,n,r,a,i){var o=ik(t,n),s=o.length,u=Ap(o),c=gp(i,sp(o)),l=t.length,f=n.length,h=Ap(t),d=Ap(n),p=rk(t,o),v=rk(n,o);if(p.length+v.length===0)for(var g=0;g<c.length;++g)c[g]=e(r[g%r.length],a[g%a.length]);else for(var m=function(){var t=Pp(y,s,u),n=t.slice(-l);p.forEach((function(e){return n[e]=0}));var i=Rp(n,l,h),o=t.slice(-f);v.forEach((function(e){return o[e]=0}));var g=Rp(o,f,d);c[y]=e(r[i],a[g])},y=0;y<c.length;++y)m();return[c,o]}}var _M=SM((function(e,t){return e<0?t*e:e}));function EM(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;vM([r,a],"prelu");var i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=E(_M(r.shape,a.shape,i,o,"float32"),2),u=s[0],c=s[1];return n.makeTensorInfo(c,"float32",u)}var TM={kernelName:Vg,backendName:"cpu",kernelFunc:EM},NM=yM(Qg,(function(e){return Math.max(0,e)})),OM={kernelName:Qg,backendName:"cpu",kernelFunc:NM},RM=yM(rm,(function(e){return Math.min(Math.max(0,e),6)})),PM={kernelName:rm,backendName:"cpu",kernelFunc:RM};function DM(e){return function(t,n,r){for(var a=gp(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}var MM=DM((function(e){return 1/(1+Math.exp(-e))})),FM=yM(vm,(function(e){return 1/(1+Math.exp(-e))})),LM={kernelName:vm,backendName:"cpu",kernelFunc:FM};function jM(e,t,n,r,a){if("linear"===n)return wM({inputs:{x:t},backend:e});if("relu"===n)return NM({inputs:{x:t},backend:e});if("elu"===n)return xM({inputs:{x:t},backend:e});if("relu6"===n)return RM({inputs:{x:t},backend:e});if("prelu"===n)return EM({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return CM({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return FM({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function zM(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}var UM={kernelName:pv,backendName:"cpu",kernelFunc:zM};function BM(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n)return zM({inputs:{real:BM(e,t,"float32"),imag:BM(e,t,"float32")},backend:e});var r=Tp(sp(t),n);return e.makeTensorInfo(t,n,r)}function WM(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var VM={kernelName:Yg,backendName:"cpu",kernelFunc:WM};function GM(e,t,n,r){if("int32"===r)return[t,"int32",Int32Array.from(e)];if("bool"===r){var a=by([0],n),i=SM((function(e,t){return e!==t?1:0}))(t,[],e,a,"bool"),o=E(i,2),s=o[0];return[o[1],"bool",s]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function HM(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return wM({inputs:{x:a},backend:n});var o=BM(n,a.shape,a.dtype),s=HM({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),u=zM({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("complex64"===a.dtype){var c=WM({inputs:{input:a},backend:n}),l=HM({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),l}if(!yp(a.dtype,i)){var f=wM({inputs:{x:a},backend:n});return{dataId:f.dataId,shape:f.shape,dtype:i}}var h=E(GM(n.data.get(a.dataId).values,a.shape,a.dtype,i),3),d=h[0],p=h[1],v=h[2];return n.makeTensorInfo(d,p,v)}var KM={kernelName:fv,backendName:"cpu",kernelFunc:HM};function qM(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,s=a.b,u=i;vM([o,s],e);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,f="string"===o.dtype?XA(c):c,h="string"===o.dtype?XA(l):l,d=r||o.dtype,p=E(t(o.shape,s.shape,f,h,d),2),v=p[0],g=p[1];return u.makeTensorInfo(g,d,v)}:function(e){var a=e.inputs,i=e.backend,o=a.a,s=a.b,u=i;if("complex64"===o.dtype||"complex64"===s.dtype){var c=HM({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),l=u.data.get(c.dataId),f=l.complexTensorInfos.real,h=l.complexTensorInfos.imag,d=u.data.get(f.dataId).values,p=u.data.get(h.dataId).values,v=HM({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),g=u.data.get(v.dataId),m=g.complexTensorInfos.real,y=g.complexTensorInfos.imag,b=u.data.get(m.dataId).values,x=u.data.get(y.dataId).values,k=E(n(o.shape,s.shape,d,p,b,x),3),w=k[0],I=k[1],C=k[2],A=u.makeTensorInfo(C,"float32",w),S=u.makeTensorInfo(C,"float32",I),_=zM({inputs:{real:A,imag:S},backend:u});return u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(v),u.disposeIntermediateTensorInfo(A),u.disposeIntermediateTensorInfo(S),_}var T=u.data.get(o.dataId).values,N=u.data.get(s.dataId).values,O=r||o.dtype,R=E(t(o.shape,s.shape,T,N,O),2),P=R[0],D=R[1];return u.makeTensorInfo(D,O,P)}}function XM(e){return function(t,n,r,a,i,o){var s=ik(t,n),u=sp(s),c=s.length,l=Ap(s),f=gp("float32",u),h=gp("float32",u),d=rk(t,s),p=rk(n,s),v=_A(r,a),g=_A(i,o),m=t.length,y=Ap(t),b=n.length,x=Ap(n);if(d.length+p.length===0)for(var k=0;k<f.length;k++){var w=k%v.length,I=k%g.length,C=e(v[2*w],v[2*w+1],g[2*I],g[2*I+1]);f[k]=C.real,h[k]=C.imag}else for(var A=function(){var t=Pp(S,c,l),n=t.slice(-m);d.forEach((function(e){return n[e]=0}));var r=Rp(n,m,y),a=t.slice(-b);p.forEach((function(e){return a[e]=0}));var i=Rp(a,b,x),o=e(v[2*r],v[2*r+1],g[2*i],g[2*i+1]);f[S]=o.real,h[S]=o.imag},S=0;S<f.length;S++)A();return[f,h,s]}}var YM=SM((function(e,t){return e+t})),ZM=XM((function(e,t,n,r){return{real:e+n,imag:t+r}})),QM=qM(Kp,YM,ZM),JM={kernelName:Kp,backendName:"cpu",kernelFunc:QM};function $M(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=sp(a.shape),s=dp(i,o),u=sp(s);ap(o===u,(function(){return"The new shape (".concat(s,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){var l=c.complexTensorInfos.real,f=c.complexTensorInfos.imag;l.shape=s,f.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}var eF={kernelName:Jg,backendName:"cpu",kernelFunc:$M};function tF(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=r.transposeA,s=r.transposeB;vM([a,i],"matMul");var u=a.shape.length,c=i.shape.length,l=o?a.shape[u-2]:a.shape[u-1],f=s?i.shape[c-1]:i.shape[c-2],h=o?a.shape[u-1]:a.shape[u-2],d=s?i.shape[c-2]:i.shape[c-1],p=a.shape.slice(0,-2),v=i.shape.slice(0,-2),g=sp(p),m=sp(v),y=ik(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,d]);ap(l===f,(function(){return"Error in matMul: inner shapes (".concat(l,") and (")+"".concat(f,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match.")}));for(var b=s?[m,d,f]:[m,f,d],x=$M({inputs:{x:a},backend:n,attrs:{shape:o?[g,l,h]:[g,h,l]}}),k=$M({inputs:{x:i},backend:n,attrs:{shape:b}}),w=o?x.shape[1]:x.shape[2],I=o?x.shape[2]:x.shape[1],C=s?k.shape[1]:k.shape[2],A=Math.max(g,m),S=n.data.get(x.dataId).values,_=n.data.get(k.dataId).values,T=Ap(x.shape),N=Ap(k.shape),O=E(o?[T[0],1,T[1]]:[T[0],T[1],1],3),R=O[0],P=O[1],D=O[2],M=E(s?[1,N[1],N[0]]:[N[1],1,N[0]],3),F=M[0],L=M[1],j=M[2],z=I*C,U=_x([A,I,C],x.dtype),B=U.values,W=n.blockSize,V=0;V<A;V++)for(var G=V%g,H=V%m,K=0;K<I;K+=W)for(var q=Math.min(K+W,I),X=0;X<C;X+=W)for(var Y=Math.min(X+W,C),Z=0;Z<w;Z+=W)for(var Q=Math.min(Z+W,w),J=K;J<q;J++)for(var $=X;$<Y;$++){for(var ee=0,te=Z;te<Q;te++){ee+=S[G*R+J*P+te*D]*_[te*F+$*L+H*j]}B[V*z+(J*C+$)]+=ee}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(k),n.makeTensorInfo(y,U.dtype,U.values)}var nF={kernelName:sv,backendName:"cpu",kernelFunc:tF};var rF={kernelName:Km,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,s=a.a,u=a.b,c=a.bias,l=a.preluActivationWeights,f=o.transposeA,h=o.transposeB,d=o.activation,p=o.leakyreluAlpha,v=[];t=tF({inputs:{a:s,b:u},attrs:{transposeA:f,transposeB:h},backend:i}),c&&(n=QM({inputs:{a:t,b:c},backend:i}),v.push(t),t=n),d&&(r=jM(i,t,d,l,p),v.push(t),t=r);for(var g=0,m=v;g<m.length;g++){var y=m[g];i.disposeIntermediateTensorInfo(y)}return t}};function aF(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var iF={kernelName:Vp,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;vM(t,"abs");var r=new Float32Array(sp(t.shape));return r=aF(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},oF=yM(Gp,(function(e){return Math.acos(e)})),sF={kernelName:Gp,backendName:"cpu",kernelFunc:oF},uF=yM(Hp,(function(e){return Math.acosh(e)})),cF={kernelName:Hp,backendName:"cpu",kernelFunc:uF};var lF={kernelName:qp,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;vM(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),i=_x(r[0].shape,r[0].dtype),o=i.values,s=0;s<r.length;s++)for(var u=a[s],c=0;c<o.length;c++)o[c]+=u[c];return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function fF(e,t,n,r,a){for(var i=t.length,o=sp(t),s=Ap(t),u=Ap(a),c=gp(n,sp(a)),l=0;l<o;++l){for(var f=Pp(l,i,s),h=new Array(f.length),d=0;d<h.length;d++)h[d]=f[r[d]];c[Rp(h,i,u)]=e[l]}return c}function hF(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;vM(a,"transpose");for(var o=a.shape.length,s=new Array(o),u=0;u<s.length;u++)s[u]=a.shape[i[u]];var c=fF(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(c,s,a.dtype),shape:s,dtype:a.dtype}}var dF={kernelName:zm,backendName:"cpu",kernelFunc:hF};var pF={kernelName:Xp,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;vM(a,"all");var s=pp(i,a.shape),u=s,c=sI(u,a.shape.length),l=a;null!=c&&(l=hF({inputs:{x:a},backend:n,attrs:{perm:c}}),u=cI(u.length,a.shape.length)),oI("all",u,l.shape.length);for(var f=E(aI(l.shape,u),2),h=f[0],d=sp(f[1]),p=Tp(sp(h),l.dtype),v=n.data.get(l.dataId).values,g=0;g<p.length;++g){for(var m=g*d,y=v[m],b=0;b<d;++b){var x=v[m+b];y=y&&x}p[g]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var k=n.makeTensorInfo(h,l.dtype,p);if(o){var w=$M({inputs:{x:k},backend:n,attrs:{shape:iI(h,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}};var vF={kernelName:Yp,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;vM(a,"any");var s=pp(i,a.shape),u=s,c=sI(u,a.shape.length),l=a;null!=c&&(l=hF({inputs:{x:a},backend:n,attrs:{perm:c}}),u=cI(u.length,a.shape.length)),oI("any",u,l.shape.length);for(var f=E(aI(l.shape,u),2),h=f[0],d=sp(f[1]),p=Tp(sp(h),l.dtype),v=n.data.get(l.dataId).values,g=0;g<p.length;++g){for(var m=g*d,y=v[m],b=0;b<d;++b){var x=v[m+b];y=y||x}p[g]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var k=n.makeTensorInfo(h,l.dtype,p);if(o){var w=$M({inputs:{x:k},backend:n,attrs:{shape:iI(h,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}};var gF={kernelName:Zp,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;vM(a,"argMax");var o=pp(i,a.shape),s=sI(o,a.shape.length),u=a,c=[];null!=s&&(u=hF({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=cI(o.length,u.shape.length)),oI("argMax",o=[o[0]],u.shape.length);for(var l=E(aI(u.shape,o),2),f=l[0],h=l[1],d=Tp(sp(f),"int32"),p=sp(h),v=n.data.get(u.dataId).values,g=0;g<d.length;++g){for(var m=g*p,y=v[m],b=0,x=0;x<p;++x){var k=v[m+x];k>y&&(y=k,b=x)}d[g]=b}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(f,"int32",d)}};var mF={kernelName:Qp,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;vM(a,"argMin");var o=pp(i,a.shape),s=sI(o,a.shape.length),u=a,c=[];null!=s&&(u=hF({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=cI(o.length,u.shape.length)),oI("argMin",o=[o[0]],u.shape.length);for(var l=E(aI(u.shape,o),2),f=l[0],h=l[1],d=Tp(sp(f),"int32"),p=sp(h),v=n.data.get(u.dataId).values,g=0;g<d.length;++g){for(var m=g*p,y=v[m],b=0,x=0;x<p;++x){var k=v[m+x];k<y&&(y=k,b=x)}d[g]=b}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(f,"int32",d)}},yF=yM(Jp,(function(e){return Math.asin(e)})),bF={kernelName:Jp,backendName:"cpu",kernelFunc:yF},xF=yM($p,(function(e){return Math.asinh(e)})),kF={kernelName:$p,backendName:"cpu",kernelFunc:xF},wF=yM(ev,(function(e){return Math.atan(e)})),IF={kernelName:ev,backendName:"cpu",kernelFunc:wF},CF=SM((function(e,t){return Math.atan2(e,t)})),AF=qM(nv,CF),SF={kernelName:nv,backendName:"cpu",kernelFunc:AF},_F=yM(tv,(function(e){return Math.atanh(e)})),EF={kernelName:tv,backendName:"cpu",kernelFunc:_F};function TF(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,f=a.effectiveFilterWidth,h=a.padInfo.top,d=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=_x(a.outShape,n),g=v.values,m=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],x=0;x<a.batchSize;++x)for(var k=x*m,w=x*r[0],I=0;I<a.inChannels;++I)for(var C=0;C<a.outHeight;++C)for(var A=C*o-h,S=Math.max(0,A),_=Math.min(a.inHeight,l+A),E=k+C*y,T=0;T<a.outWidth;++T){for(var N=T*s-d,O=Math.max(0,N),R=Math.min(a.inWidth,f+N),P=p,D=0,M=0,F=S;F<_;F+=u){for(var L=w+F*r[1],j=O;j<R;j+=c){var z=e[L+j*r[2]+I];"max"===i&&z>P?P=z:"avg"===i&&(D+=z,M++)}if(isNaN(P))break}g[E+T*b+I]="avg"===i?D/M:P}return v}function NF(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=_x(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,v=_x(t,n,e),g=0;g<r.batchSize;++g)for(var m=0;m<r.inChannels;++m)for(var y=0;y<r.outHeight;++y){for(var b=y*s-d,x=b;x<0;)x+=c;for(var k=Math.min(r.inHeight,f+b),w=0;w<r.outWidth;++w){for(var I=w*u-p,C=I;C<0;)C+=l;for(var A=Math.min(r.inWidth,h+I),S=Number.NEGATIVE_INFINITY,_=-1,E=x;E<k;E+=c)for(var T=E-b,N=C;N<A;N+=l){var O=N-I,R=v.get(g,E,N,m);R>S&&(S=R,_=a?i?((g*r.inHeight+E)*r.inWidth+N)*r.inChannels+m:(E*r.inWidth+N)*r.inChannels+m:T*h+O)}o.set(_,g,y,w,m)}}return o}function OF(e,t,n,r,a,i){for(var o=a.strideDepth,s=a.strideHeight,u=a.strideWidth,c=a.dilationDepth,l=a.dilationHeight,f=a.dilationWidth,h=a.effectiveFilterDepth,d=a.effectiveFilterHeight,p=a.effectiveFilterWidth,v=a.padInfo.front,g=a.padInfo.top,m=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=_x(a.outShape,n),x=b.values,k=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],w=a.outShape[2]*a.outShape[3]*a.outShape[4],I=a.outShape[3]*a.outShape[4],C=a.outShape[4],A=0;A<a.batchSize;++A)for(var S=A*k,_=A*r[0],E=0;E<a.inChannels;++E)for(var T=0;T<a.outDepth;++T){for(var N=T*o-v,O=N;O<0;)O+=c;for(var R=Math.min(a.inDepth,h+N),P=S+T*w,D=0;D<a.outHeight;++D){for(var M=D*s-g,F=M;F<0;)F+=l;for(var L=Math.min(a.inHeight,d+M),j=P+D*I,z=0;z<a.outWidth;++z){for(var U=z*u-m,B=U;B<0;)B+=f;for(var W=Math.min(a.inWidth,p+U),V=j+z*C,G=y,H=0,K=0,q=O;q<R;q+=c){for(var X=_+q*r[1],Y=F;Y<L;Y+=l){for(var Z=X+Y*r[2],Q=B;Q<W;Q+=f){var J=e[Z+Q*r[3]+E];if("max"===i&&J>G?G=J:"avg"===i&&(H+=J,K++),isNaN(G))break}if(isNaN(G))break}if(isNaN(G))break}x[V+E]="avg"===i?H/Math.max(K,1):G}}}return b}var RF={kernelName:rv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;vM(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;ap(sw(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=Qk(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&up(l.inShape,l.outShape))c=wM({inputs:{x:a},backend:n});else{var f=n.data.get(a.dataId).values,h=Ap(a.shape),d=TF(f,a.shape,a.dtype,h,l,"avg");c=n.makeTensorInfo(l.outShape,a.dtype,d.values)}return c}};var PF={kernelName:iv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat;vM(a,"avgPool3d");var l=Jk(a.shape,i,o,1,s,u,c),f=OF(n.data.get(a.dataId).values,a.shape,a.dtype,Ap(a.shape),l,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}};var DF={kernelName:ov,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;vM([a,i],"avgPool3DGrad");for(var l=Jk(i.shape,o,s,1,u,c),f=l.strideDepth,h=l.strideHeight,d=l.strideWidth,p=l.filterDepth,v=l.filterHeight,g=l.filterWidth,m=l.dilationDepth,y=l.dilationHeight,b=l.dilationWidth,x=l.effectiveFilterDepth,k=l.effectiveFilterHeight,w=l.effectiveFilterWidth,I=x-1-l.padInfo.front,C=w-1-l.padInfo.left,A=k-1-l.padInfo.top,S=_x(i.shape,"float32"),_=1/(p*v*g),E=n.bufferSync(a),T=0;T<l.batchSize;++T)for(var N=0;N<l.inChannels;++N)for(var O=0;O<l.inDepth;++O)for(var R=0;R<l.inHeight;++R)for(var P=0;P<l.inWidth;++P){for(var D=O-I,M=R-A,F=P-C,L=0,j=0;j<x;j+=m){var z=(D+j)/f;if(!(z<0||z>=l.outDepth||Math.floor(z)!==z))for(var U=0;U<k;U+=y){var B=(M+U)/h;if(!(B<0||B>=l.outHeight||Math.floor(B)!==B))for(var W=0;W<w;W+=b){var V=(F+W)/d;if(!(V<0||V>=l.outWidth||Math.floor(V)!==V))L+=E.get(T,z,B,V,N)}}}S.set(L*_,T,O,R,P,N)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};var MF={kernelName:av,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;vM([a,i],"avgPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=Qk(o.shape,s,u,1,c),f=l.strideHeight,h=l.strideWidth,d=l.filterHeight,p=l.filterWidth,v=l.dilationHeight,g=l.dilationWidth,m=l.effectiveFilterHeight,y=l.effectiveFilterWidth,b=y-1-l.padInfo.left,x=m-1-l.padInfo.top,k=_x(o.shape,"float32"),w=1/(d*p),I=n.data.get(a.dataId).values,C=_x(a.shape,"float32",I),A=0;A<l.batchSize;++A)for(var S=0;S<l.inChannels;++S)for(var _=0;_<l.inHeight;++_)for(var E=0;E<l.inWidth;++E){for(var T=_-x,N=E-b,O=0,R=0;R<m;R+=v){var P=(T+R)/f;if(!(P<0||P>=l.outHeight||Math.floor(P)!==P))for(var D=0;D<y;D+=g){var M=(N+D)/h;if(!(M<0||M>=l.outWidth||Math.floor(M)!==M))O+=C.get(A,P,M,S)}}k.set(O*w,A,_,E,S)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var FF={kernelName:Qv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.scale,o=t.offset,s=t.mean,u=t.variance;ap(s.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),ap(null==o||s.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),ap(null==i||s.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),vM([a,s,u,i,o],"batchNorm");var c=r.varianceEpsilon;null==c&&(c=.001);for(var l=n.data.get(a.dataId).values,f=n.data.get(s.dataId).values,h=n.data.get(u.dataId).values,d=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(l.length),g=p.length,m=d.length,y=h.length,b=f.length,x=0,k=0,w=0,I=0,C=0;C<l.length;++C)v[C]=p[x++]+(l[C]-f[k++])*d[w++]/Math.sqrt(h[I++]+c),x>=g&&(x=0),k>=b&&(k=0),w>=m&&(w=0),I>=y&&(I=0);return n.makeTensorInfo(a.shape,a.dtype,v)}};function LF(e,t,n,r,a){var i=Wk(r,t,n),o=sp(n),s=Ap(r);if(i){var u=Vk(t,s);return"string"===a?e.slice(u,u+o):e.subarray(u,u+o)}for(var c=_x(r,a,"string"===a?XA(e):e),l=_x(n,a),f=0;f<l.size;++f){var h=l.indexToLoc(f),d=h.map((function(e,n){return e+t[n]}));l.set.apply(l,[c.get.apply(c,X(d))].concat(X(h)))}return"string"===a?l.values.map((function(e){return ky(e)})):l.values}function jF(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size;vM(a,"slice");var s=E(Gk(a,i,o),2),u=s[0],c=s[1];Uk(a,u,c);var l=LF(n.data.get(a.dataId).values,u,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,l)}var zF={kernelName:fm,backendName:"cpu",kernelFunc:jF};var UF={kernelName:uv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;vM([a],"batchToSpaceND");var s=i.reduce((function(e,t){return e*t})),u=hA(a.shape,i,s),c=dA(u.length,i.length),l=pA(a.shape,i,s),f=vA(o,i.length),h=gA(l,o,i.length),d=$M({inputs:{x:a},backend:n,attrs:{shape:u}}),p=hF({inputs:{x:d},backend:n,attrs:{perm:c}}),v=$M({inputs:{x:p},backend:n,attrs:{shape:l}}),g=jF({inputs:{x:v},backend:n,attrs:{begin:f,size:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),g}};function BF(e,t,n,r,a){for(var i=sp(r),o=Tp(a,n),s=0;s<e.length;s++){var u=e[s];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o[u]+=i>0?t[s]:1)}return o}function WF(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=_x([a,n],t.dtype),s=0;s<a;s++)for(var u=0;u<i;u++){var c=e.get(s,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,s,c):t.size>0?o.set(o.get(s,c)+t.get(s,u),s,c):o.set(o.get(s,c)+1,s,c))}return o}var VF={kernelName:cv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=BF(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}};var GF={kernelName:lv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=ik(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},HF=DM((function(e){return Math.ceil(e)})),KF=bM(hv,HF),qF={kernelName:hv,backendName:"cpu",kernelFunc:KF},XF=yM(dv,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),YF={kernelName:dv,backendName:"cpu",kernelFunc:XF},ZF={kernelName:vv,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(sp(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=0;c<s.length;c++){var l=s[c],f=u[c];r[c]=Math.hypot(l,f)}return n.makeOutput(r,t.shape,"float32")}};function QF(e,t,n,r){var a=mp(n,sp(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=sp(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?XA(e.vals):e.vals,i=0,s=0;s<e.shape[0];++s)for(var u=s*t[1]+o,c=0;c<e.shape[1];++c)a[u+c]=r[i++];o+=e.shape[1]}))}return a}function JF(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var $F={kernelName:ag,backendName:"cpu",kernelFunc:JF};function eL(e){var t=e.inputs,n=e.backend,r=pp(e.attrs.axis,t[0].shape)[0],a=t.map((function(e){return e.shape}));sA(a,r);var i=uA(t.map((function(e){return e.shape})),r);if(0===sp(i))return n.makeTensorInfo(i,t[0].dtype,[]);var o=t.filter((function(e){return sp(e.shape)>0}));if(1===o.length)return wM({inputs:{x:o[0]},backend:n});if("complex64"===o[0].dtype){var s=o.map((function(e){return WM({inputs:{input:e},backend:n})})),u=o.map((function(e){return JF({inputs:{input:e},backend:n})})),c=eL({inputs:s,backend:n,attrs:{axis:r}}),l=eL({inputs:u,backend:n,attrs:{axis:r}}),f=zM({inputs:{real:c,imag:l},backend:n});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),f}var h=o.map((function(e){var t=sp(e.shape.slice(r));return $M({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),d=h.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));i=uA(h.map((function(e){return e.shape})),1);var p=1===h[0].shape[0],v=QF(d,i,t[0].dtype,p),g=uA(o.map((function(e){return e.shape})),r),m=n.makeTensorInfo(g,t[0].dtype,v);return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}var tL={kernelName:gv,backendName:"cpu",kernelFunc:eL};function nL(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dilations,l=r.dimRoundingMode;vM([a,i],"conv2d");for(var f=cw(u),h=$k(a.shape,i.shape,o,c,s,l,!1,f),d=h.filterHeight,p=h.filterWidth,v=h.dilationHeight,g=h.dilationWidth,m=h.padInfo.left,y=h.padInfo.top,b="channelsLast"===h.dataFormat,x=new My(h.outShape,a.dtype),k=Ap(a.shape),w=Ap(i.shape),I=k[0],C=b?k[1]:k[2],A=b?k[2]:1,S=b?1:k[1],_=x.strides[0],E=b?x.strides[1]:x.strides[2],T=b?x.strides[2]:1,N=b?1:x.strides[1],O=n.data.get(a.dataId).values,R=n.data.get(i.dataId).values,P=x.values,D=0;D<h.batchSize;++D)for(var M=D*I,F=D*_,L=0;L<h.outHeight;++L)for(var j=F+L*E,z=L*h.strideHeight-y,U=0;U<d;++U){var B=z+U*v;if(!(B<0||B>=h.inHeight))for(var W=U*w[0],V=M+B*C,G=0;G<h.outWidth;++G)for(var H=j+G*T,K=G*h.strideWidth-m,q=0;q<p;++q){var X=K+q*g;if(!(X<0||X>=h.inWidth))for(var Y=V+X*A,Z=W+q*w[1],Q=0;Q<h.inChannels;++Q){for(var J=O[Y+Q*S],$=0;$<h.outChannels;++$)P[H+$*N]+=J*R[Z+$];Z+=h.outChannels}}}return n.makeTensorInfo(x.shape,x.dtype,P)}var rL={kernelName:mv,backendName:"cpu",kernelFunc:nL};var aL={kernelName:yv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape;vM([a,i],"conv2dBackpropFilter");for(var f=cw(u),h=$k(a.shape,l,o,1,s,c,!1,f),d=h.strideHeight,p=h.strideWidth,v=h.filterHeight,g=h.filterWidth,m="channelsLast"===h.dataFormat,y=new My(h.filterShape,"float32"),b=h.padInfo.left,x=h.padInfo.top,k=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,I=new My(a.shape,a.dtype,k),C=new My(i.shape,i.dtype,w),A=0;A<v;++A)for(var S=Math.max(0,Math.ceil((x-A)/d)),_=Math.min(h.outHeight,(h.inHeight+x-A)/d),E=0;E<g;++E)for(var T=Math.max(0,Math.ceil((b-E)/p)),N=Math.min(h.outWidth,(h.inWidth+b-E)/p),O=0;O<h.inChannels;++O)for(var R=0;R<h.outChannels;++R){for(var P=0,D=0;D<h.batchSize;++D)for(var M=S;M<_;++M)for(var F=A+M*d-x,L=T;L<N;++L){var j=E+L*p-b;P+=m?I.get(D,F,j,O)*C.get(D,M,L,R):I.get(D,O,F,j)*C.get(D,R,M,L)}y.set(P,A,E,O,R)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var iL={kernelName:bv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode;vM([a,i],"conv2dBackpropInput");var f=Ap(i.shape),h=Ap(a.shape),d=cw(c),p=$k(o,i.shape,s,1,u,l,!1,d),v=new My(p.inShape,"float32"),g=v.values,m=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,b=E(f,3),x=b[0],k=b[1],w=b[2],I=p.batchSize,C=p.filterHeight,A=p.filterWidth,S=p.inChannels,_=p.inHeight,T=p.inWidth,N=p.outChannels,O=p.outHeight,R=p.outWidth,P=p.strideHeight,D=p.strideWidth;d=p.dataFormat;for(var M=C-1-p.padInfo.top,F=A-1-p.padInfo.left,L="channelsLast"===d,j=v.strides[0],z=L?v.strides[1]:v.strides[2],U=L?v.strides[2]:1,B=L?1:v.strides[1],W=h[0],V=L?h[1]:h[2],G=L?h[2]:1,H=L?1:h[1],K=0;K<I;++K)for(var q=0;q<S;++q)for(var X=0;X<_;++X)for(var Y=X-M,Z=Math.max(0,Math.ceil(Y/P)),Q=Math.min(O,(C+Y)/P),J=0;J<T;++J){for(var $=J-F,ee=Math.max(0,Math.ceil($/D)),te=Math.min(R,(A+$)/D),ne=0,re=Z;re<Q;++re)for(var ae=re*P-Y,ie=ee;ie<te;++ie)for(var oe=W*K+V*re+G*ie,se=x*(C-1-ae)+k*(A-1-(ie*D-$))+w*q,ue=0;ue<N;++ue){ne+=m[oe+H*ue]*y[se+ue]}g[j*K+z*X+U*J+B*q]=ne}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};var oL={kernelName:xv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations;vM([a,i],"conv3d");for(var c=ew(a.shape,i.shape,o,u,s),l=c.filterDepth,f=c.filterHeight,h=c.filterWidth,d=c.dilationDepth,p=c.dilationHeight,v=c.dilationWidth,g=c.padInfo,m=g.front,y=g.left,b=g.top,x=new My(c.outShape,a.dtype),k=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,I=x.values,C=Ap(a.shape),A=Ap(i.shape),S=0;S<c.batchSize;++S)for(var _=S*C[0],E=S*x.strides[0],T=0;T<c.outDepth;++T)for(var N=E+T*x.strides[1],O=T*c.strideDepth-m,R=0;R<l;++R){var P=O+R*d;if(!(P<0||P>=c.inDepth))for(var D=R*A[0],M=_+P*C[1],F=0;F<c.outHeight;++F)for(var L=N+F*x.strides[2],j=F*c.strideHeight-b,z=0;z<f;++z){var U=j+z*p;if(!(U<0||U>=c.inHeight))for(var B=D+z*A[1],W=M+U*C[2],V=0;V<c.outWidth;++V)for(var G=L+V*c.outChannels,H=V*c.strideWidth-y,K=0;K<h;++K){var q=H+K*v;if(!(q<0||q>=c.inWidth))for(var X=B+K*A[2],Y=W+q*c.inChannels,Z=X,Q=0;Q<c.inChannels;++Q){for(var J=k[Y+Q],$=0;$<c.outChannels;++$)I[G+$]+=J*w[Z+$];Z+=c.outChannels}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var sL={kernelName:kv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape;vM([a,i],"conv3dBackpropFilterV2");for(var c=Ap(a.shape),l=Ap(i.shape),f=ew(a.shape,u,o,1,s),h=f.strideDepth,d=f.strideHeight,p=f.strideWidth,v=f.filterDepth,g=f.filterHeight,m=f.filterWidth,y=new My(f.filterShape,"float32"),b=y.values,x=E(y.strides,4),k=x[0],w=x[1],I=x[2],C=x[3],A=n.data.get(i.dataId).values,S=E(l,4),_=S[0],T=S[1],N=S[2],O=S[3],R=n.data.get(a.dataId).values,P=E(c,4),D=P[0],M=P[1],F=P[2],L=P[3],j=f.padInfo.front,z=f.padInfo.left,U=f.padInfo.top,B=0;B<v;++B)for(var W=Math.max(0,Math.ceil((j-B)/h)),V=Math.min(f.outDepth,(f.inDepth+j-B)/h),G=B*k,H=0;H<g;++H)for(var K=Math.max(0,Math.ceil((U-H)/d)),q=Math.min(f.outHeight,(f.inHeight+U-H)/d),X=H*w+G,Y=0;Y<m;++Y)for(var Z=Math.max(0,Math.ceil((z-Y)/p)),Q=Math.min(f.outWidth,(f.inWidth+z-Y)/p),J=Y*I+X,$=0;$<f.inChannels;++$)for(var ee=$*C+J,te=0;te<f.outChannels;++te){for(var ne=0,re=0;re<f.batchSize;++re)for(var ae=re*D,ie=re*_,oe=W;oe<V;++oe)for(var se=(B+oe*h-j)*M+ae,ue=oe*T+ie,ce=K;ce<q;++ce)for(var le=(H+ce*d-U)*F+se,fe=ce*N+ue,he=Z;he<Q;++he){var de=he*O+fe;ne+=R[(Y+he*p-z)*L+le+$]*A[de+te]}b[ee+te]=ne}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var uL={kernelName:wv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=r.inputShape;vM([a],"conv3dBackpropInputV2");for(var c=Ap(a.shape),l=Ap(i.shape),f=ew(u,i.shape,s,1,o),h=new My(f.inShape,"float32"),d=h.values,p=E(h.strides,4),v=p[0],g=p[1],m=p[2],y=p[3],b=n.data.get(a.dataId).values,x=E(c,4),k=x[0],w=x[1],I=x[2],C=x[3],A=n.data.get(i.dataId).values,S=E(l,4),_=S[0],T=S[1],N=S[2],O=S[3],R=f.batchSize,P=f.filterDepth,D=f.filterHeight,M=f.filterWidth,F=f.inChannels,L=f.inDepth,j=f.inHeight,z=f.inWidth,U=f.outChannels,B=f.outDepth,W=f.outHeight,V=f.outWidth,G=f.strideDepth,H=f.strideHeight,K=f.strideWidth,q=P-1-f.padInfo.front,X=D-1-f.padInfo.top,Y=M-1-f.padInfo.left,Z=0;Z<R;++Z)for(var Q=0;Q<F;++Q)for(var J=0;J<L;++J)for(var $=J-q,ee=Math.max(0,Math.ceil($/G)),te=Math.min(B,(P+$)/G),ne=0;ne<j;++ne)for(var re=ne-X,ae=Math.max(0,Math.ceil(re/H)),ie=Math.min(W,(D+re)/H),oe=0;oe<z;++oe){for(var se=oe-Y,ue=Math.max(0,Math.ceil(se/K)),ce=Math.min(V,(M+se)/K),le=0,fe=ee;fe<te;++fe)for(var he=fe*G-$,de=ae;de<ie;++de)for(var pe=de*H-re,ve=ue;ve<ce;++ve)for(var ge=k*Z+w*fe+I*de+C*ve,me=_*(P-1-he)+T*(D-1-pe)+N*(M-1-(ve*K-se))+O*Q,ye=0;ye<U;++ye){le+=b[ge+ye]*A[me+ye]}d[v*Z+g*J+m*ne+y*oe+Q]=le}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},cL=yM(Iv,(function(e){return Math.cos(e)})),lL={kernelName:Iv,backendName:"cpu",kernelFunc:cL},fL=yM(Cv,(function(e){return Math.cosh(e)})),hL={kernelName:Cv,backendName:"cpu",kernelFunc:fL};var dL={kernelName:_v,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=E(a.shape,4),f=l[0],h=l[1],d=l[2],p=l[3],v=i.shape[0],g=E(s,2),m=g[0],y=g[1],b=_x([v,m,y,p],"float32"),x=n.data.get(i.dataId).values,k=n.data.get(o.dataId).values,w=n.data.get(a.dataId).values,I=Ap(a.shape),C=Ap(b.shape),A=0;A<v;A++){var S=4*A,_=x[S],T=x[S+1],N=x[S+2],O=x[S+3],R=k[A];if(!(R>=f))for(var P=m>1?(N-_)*(h-1)/(m-1):0,D=y>1?(O-T)*(d-1)/(y-1):0,M=0;M<m;M++){var F=m>1?_*(h-1)+M*P:.5*(_+N)*(h-1);if(F<0||F>h-1)for(var L=0;L<y;L++)for(var j=0;j<p;j++){var z=j+L*C[2]+M*C[1]+A*C[0];b.values[z]=c}else if("bilinear"===u)for(var U=Math.floor(F),B=Math.ceil(F),W=F-U,V=0;V<y;V++){var G=y>1?T*(d-1)+V*D:.5*(T+O)*(d-1);if(G<0||G>d-1)for(var H=0;H<p;H++){var K=H+V*C[2]+M*C[1]+A*C[0];b.values[K]=c}else for(var q=Math.floor(G),X=Math.ceil(G),Y=G-q,Z=0;Z<p;Z++){var Q=Z+q*I[2]+U*I[1]+R*I[0],J=w[Q],$=w[Q=Z+X*I[2]+U*I[1]+R*I[0]],ee=w[Q=Z+q*I[2]+B*I[1]+R*I[0]],te=J+($-J)*Y,ne=ee+(w[Q=Z+X*I[2]+B*I[1]+R*I[0]]-ee)*Y;Q=Z+V*C[2]+M*C[1]+A*C[0],b.values[Q]=te+(ne-te)*W}}else for(var re=0;re<y;++re){var ae=y>1?T*(d-1)+re*D:.5*(T+O)*(d-1);if(ae<0||ae>d-1)for(var ie=0;ie<p;ie++){var oe=ie+re*C[2]+M*C[1]+A*C[0];b.values[oe]=c}else for(var se=Math.round(ae),ue=Math.round(F),ce=0;ce<p;ce++){var le=ce+se*I[2]+ue*I[1]+R*I[0],fe=ce+re*C[2]+M*C[1]+A*C[0];b.values[fe]=w[le]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var pL={kernelName:Av,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;vM(a,"cumprod");var u=sI([i],a.shape.length),c=a;null!=u&&(c=hF({inputs:{x:a},backend:n,attrs:{perm:u}}));var l=cI(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var f=qy(c.dtype,"int32"),h=Ep(sp(c.shape),f),d=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],v=s?function(e,t){return e+p-t-1}:function(e,t){return e+t},g=0;g<d.length;g+=p)for(var m=0;m<p;m++){var y=v(g,m);if(0===m)h[y]=o?1:d[y];else{var b=v(g,m-1);h[y]=o?d[b]*h[b]:d[y]*h[b]}}var x=n.makeTensorInfo(c.shape,f,h);if(null!=u){var k=hF({inputs:{x:x},backend:n,attrs:{perm:uI(u)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),k}return x}};var vL={kernelName:Sv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;vM(a,"cumsum");var u=sI([i],a.shape.length),c=a;null!=u&&(c=hF({inputs:{x:a},backend:n,attrs:{perm:u}}));var l=cI(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var f=qy(c.dtype,"int32"),h=Tp(sp(c.shape),f),d=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],v=s?function(e,t){return e+p-t-1}:function(e,t){return e+t},g=0;g<d.length;g+=p)for(var m=0;m<p;m++){var y=v(g,m);if(0===m)h[y]=o?0:d[y];else{var b=v(g,m-1);h[y]=o?d[b]+h[b]:d[y]+h[b]}}var x=n.makeTensorInfo(c.shape,f,h);if(null!=u){var k=hF({inputs:{x:x},backend:n,attrs:{perm:uI(u)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),k}return x}};var gL={kernelName:Ev,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=BF(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}if(2===a.shape.length){var c=WF(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var mL={kernelName:Tv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;ap("NHWC"===o,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o)}));for(var s=a.shape[0],u=a.shape[1],c=a.shape[2],l=a.shape[3],f=u*i,h=c*i,d=l/(i*i),p=n.data.get(a.dataId).values,v=new Float32Array(s*f*h*d),g=0,m=0;m<s;++m)for(var y=0;y<f;++y)for(var b=Math.floor(y/i),x=y%i,k=0;k<h;++k)for(var w=Math.floor(k/i),I=(x*i+k%i)*d,C=0;C<d;++C){var A=C+I+l*(w+c*(b+u*m));v[g++]=p[A]}return n.makeTensorInfo([s,f,h,d],a.dtype,v)}};function yL(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode;vM([a,i],"depthwiseConv2DNative");var l=Ap(a.shape),f=Ap(i.shape),h=u;null==h&&(h=[1,1]),ap(sw(o,h),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(h,"'")}));for(var d=$k(a.shape,i.shape,o,h,s,c,!0),p=d.filterHeight,v=d.filterWidth,g=d.dilationHeight,m=d.dilationWidth,y=d.padInfo,b=y.left,x=y.top,k=d.outChannels/d.inChannels,w=new My(d.outShape,a.dtype),I=n.data.get(a.dataId).values,C=n.data.get(i.dataId).values,A=w.values,S=0;S<d.batchSize;++S)for(var _=S*l[0],E=S*w.strides[0],T=0;T<d.outHeight;++T)for(var N=E+T*w.strides[1],O=T*d.strideHeight-x,R=0;R<p;++R){var P=O+R*g;if(!(P<0||P>=d.inHeight))for(var D=R*f[0],M=_+P*l[1],F=0;F<d.outWidth;++F)for(var L=N+F*w.strides[2],j=F*d.strideWidth-b,z=0;z<v;++z){var U=j+z*m;if(!(U<0||U>=d.inWidth))for(var B=D+z*f[1],W=M+U*d.inChannels,V=L,G=B,H=0;H<d.inChannels;++H){for(var K=I[W+H],q=0;q<k;++q)A[V+q]+=K*C[G+q];V+=k,G+=k}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var bL={kernelName:Nv,backendName:"cpu",kernelFunc:yL};var xL={kernelName:Ov,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape;vM([a,i],"depthwiseConv2dNativeBackpropFilter");for(var f=$k(a.shape,l,o,s,u,c,!0),h=f.strideHeight,d=f.strideWidth,p=f.filterHeight,v=f.filterWidth,g=new My(f.filterShape,"float32"),m=f.padInfo.left,y=f.padInfo.top,b=f.outChannels/f.inChannels,x=n.data.get(a.dataId).values,k=new My(a.shape,a.dtype,x),w=n.data.get(i.dataId).values,I=new My(i.shape,i.dtype,w),C=0;C<p;++C)for(var A=Math.max(0,Math.ceil((y-C)/h)),S=Math.min(f.outHeight,(f.inHeight+y-C)/h),_=0;_<v;++_)for(var E=Math.max(0,Math.ceil((m-_)/d)),T=Math.min(f.outWidth,(f.inWidth+m-_)/d),N=0;N<f.outChannels;++N){for(var O=Math.trunc(N/b),R=N%b,P=0,D=0;D<f.batchSize;++D)for(var M=A;M<S;++M)for(var F=C+M*h-y,L=E;L<T;++L){var j=_+L*d-m;P+=k.get(D,F,j,O)*I.get(D,M,L,N)}g.set(P,C,_,O,R)}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};var kL={kernelName:Rv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.inputShape;vM([a,i],"depthwiseConv2DNativeBackpropInput");for(var f=Ap(a.shape),h=Ap(i.shape),d=$k(l,i.shape,o,s,u,c,!0),p=new My(d.inShape,"float32"),v=p.values,g=E(p.strides,3),m=g[0],y=g[1],b=g[2],x=n.data.get(a.dataId).values,k=E(f,3),w=k[0],I=k[1],C=k[2],A=n.data.get(i.dataId).values,S=E(h,3),_=S[0],T=S[1],N=S[2],O=d.batchSize,R=d.filterHeight,P=d.filterWidth,D=d.inChannels,M=d.inHeight,F=d.inWidth,L=d.outChannels,j=d.outHeight,z=d.outWidth,U=d.strideHeight,B=d.strideWidth,W=R-1-d.padInfo.top,V=P-1-d.padInfo.left,G=L/D,H=0;H<O;++H)for(var K=0;K<D;++K)for(var q=0;q<M;++q)for(var X=q-W,Y=Math.max(0,Math.ceil(X/U)),Z=Math.min(j,(R+X)/U),Q=0;Q<F;++Q){for(var J=Q-V,$=Math.max(0,Math.ceil(J/B)),ee=Math.min(z,(P+J)/B),te=0,ne=Y;ne<Z;++ne)for(var re=ne*U-X,ae=$;ae<ee;++ae)for(var ie=w*H+I*ne+C*ae,oe=_*(R-1-re)+T*(P-1-(ae*B-J))+N*K,se=0;se<G;++se){te+=x[ie+(K*G+se)]*A[oe+se]}v[m*H+y*q+b*Q+K]=te}return n.makeTensorInfo(p.shape,p.dtype,p.values)}};var wL={kernelName:Pv,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=sp(r.shape),i=n.data.get(r.dataId).values,o=_x([a,a],r.dtype),s=o.values,u=0;u<i.length;u++)s[u*a+u]=i[u];var c=[].concat(X(r.shape),X(r.shape));return n.makeTensorInfo(c,o.dtype,o.values)}},IL={kernelName:Dv,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=n,l=c.data.get(a.dataId).values,f=a.shape.length,h=c.data.get(i.dataId).values,d=i.shape.length,p=Zk(a.shape,i.shape,o,s,"NHWC",u),v=p.batchSize,g=p.inHeight,m=p.inWidth,y=p.inChannels,b=p.outHeight,x=p.outWidth,k=p.padInfo,w=p.strideHeight,I=p.strideWidth,C=p.filterHeight,A=p.filterWidth,S=p.dilationHeight,_=p.dilationWidth,E=p.outShape,T=sp(E),N=E.length,O=mp(a.dtype,T),R=0;R<v;++R)for(var P=0;P<b;++P)for(var D=P*w-k.top,M=0;M<x;++M)for(var F=M*I-k.left,L=0;L<y;++L){for(var j=Number.MIN_SAFE_INTEGER,z=0;z<C;++z){var U=D+z*S;if(U>=0&&U<g)for(var B=0;B<A;++B){var W=F+B*_;if(W>=0&&W<m){var V=Rp([R,U,W,L],f,Ap(a.shape)),G=Rp([z,B,L],d,Ap(i.shape)),H=l[V]+h[G];H>j&&(j=H)}}}O[Rp([R,P,M,L],N,Ap(E))]=j}return{dataId:c.write(by(O,a.dtype),E,a.dtype),shape:E,dtype:a.dtype}}},CL={kernelName:Fv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,f=_p(a.shape,l.data.get(a.dataId).values),h=_p(i.shape,l.data.get(i.dataId).values),d=Zk(a.shape,i.shape,s,u,"NHWC",c),p=d.batchSize,v=d.inHeight,g=d.inWidth,m=d.inChannels,y=d.outHeight,b=d.outWidth,x=d.padInfo,k=d.strideHeight,w=d.strideWidth,I=d.filterHeight,C=d.filterWidth,A=d.dilationHeight,S=d.dilationWidth,_=d.outShape;ap(o.rank===_.length,(function(){return"Error in ".concat(Fv,", dy ")+"must have the same rank as output ".concat(_.length,", but got ")+"".concat(o.rank)}));for(var E=_p(_,l.data.get(o.dataId).values),T=Np(i.shape,i.dtype),N=0;N<p;++N)for(var O=0;O<y;++O)for(var R=O*k-x.top,P=0;P<b;++P)for(var D=P*w-x.left,M=0;M<m;++M){for(var F=Number.MIN_SAFE_INTEGER,L=0,j=0,z=0;z<I;++z){var U=R+z*A;if(U>=0&&U<v)for(var B=0;B<C;++B){var W=D+B*S;if(W>=0&&W<g){var V=f[N][U][W][M]+h[z][B][M];V>F&&(F=V,L=z,j=B)}}}T[L][j][M]+=E[N][O][P][M]}return{dataId:l.write(by(T,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},AL={kernelName:Mv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,f=_p(a.shape,l.data.get(a.dataId).values),h=_p(i.shape,l.data.get(i.dataId).values),d=Zk(a.shape,i.shape,s,u,"NHWC",c),p=d.batchSize,v=d.inHeight,g=d.inWidth,m=d.inChannels,y=d.outHeight,b=d.outWidth,x=d.padInfo,k=d.strideHeight,w=d.strideWidth,I=d.filterHeight,C=d.filterWidth,A=d.dilationHeight,S=d.dilationWidth,_=d.outShape;ap(o.rank===_.length,(function(){return"Error in ".concat(Mv,", dy ")+"must have the same rank as output ".concat(_.length,", but got ")+"".concat(o.rank)}));for(var E=_p(_,l.data.get(o.dataId).values),T=Np(a.shape,a.dtype),N=0;N<p;++N)for(var O=0;O<y;++O)for(var R=O*k-x.top,P=0;P<b;++P)for(var D=P*w-x.left,M=0;M<m;++M){for(var F=Number.MIN_SAFE_INTEGER,L=R<0?0:R,j=D<0?0:D,z=0;z<I;++z){var U=R+z*A;if(U>=0&&U<v)for(var B=0;B<C;++B){var W=D+B*S;if(W>=0&&W<g){var V=f[N][U][W][M]+h[z][B][M];V>F&&(F=V,L=U,j=W)}}}T[N][L][j][M]+=E[N][O][P][M]}return{dataId:l.write(by(T,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},SL=SM((function(e,t){return e*t})),_L=XM((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),EL=qM(Rg,SL,_L),TL={kernelName:Rg,backendName:"cpu",kernelFunc:EL};function NL(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims;vM(i,"sum");var u=(t="bool"===i.dtype?HM({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):wM({inputs:{x:i},backend:r})).shape.length,c=pp(o,t.shape),l=sI(c,u),f=c,h=t;null!=l&&(h=hF({inputs:{x:t},backend:r,attrs:{perm:l}}),f=cI(f.length,u)),oI("sum",f,h.shape.length);for(var d=E(aI(h.shape,f),2),p=d[0],v=d[1],g=BM(r,p,qy(h.dtype,"int32")),m=sp(v),y=r.data.get(g.dataId).values,b=r.data.get(h.dataId).values,x=0;x<y.length;++x){for(var k=x*m,w=0,I=0;I<m;++I)w+=b[k+I];y[x]=w}if(s){var C=g;g=$M({inputs:{x:g},backend:r,attrs:{shape:iI(g.shape,c)}}),r.disposeIntermediateTensorInfo(C)}return r.disposeIntermediateTensorInfo(t),null!=l&&r.disposeIntermediateTensorInfo(h),g}var OL={kernelName:ym,backendName:"cpu",kernelFunc:NL};var RL={kernelName:jv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=MA(e.attrs.equation,r.length),i=a.allDims,o=a.summedDims,s=a.idDims;LA(i.length,s,r);for(var u=jA(o,s),c=u.path,l=u.steps,f=l.length,h=null,d=i.length,p=[],v=0;v<f;++v){var g,m=U(l[v]);try{for(m.s();!(g=m.n()).done;){var y=g.value,b=FA(d,s[y]),x=b.permutationIndices,k=b.expandDims,w=void 0;zA(x)?w=r[y]:(w=hF({inputs:{x:r[y]},backend:n,attrs:{perm:x}}),p.push(w));for(var I=w.shape.slice(),C=0;C<k.length;++C)I.splice(k[C],0,1);up(w.shape,I)||(w=$M({inputs:{x:w},backend:n,attrs:{shape:I}}),p.push(w)),null===h?h=w:(h=EL({inputs:{a:w,b:h},backend:n}),p.push(h))}}catch(Wse){m.e(Wse)}finally{m.f()}v<f-1&&(c[v]>=0&&(h=NL({inputs:{x:h},backend:n,attrs:{axis:c[v]-(i.length-d),keepDims:!1}}),p.push(h)),d--)}for(var A=0,S=p;A<S.length;A++){var _=S[A];_!==h&&n.disposeIntermediateTensorInfo(_)}return h}};var PL={kernelName:Uv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;vM([r,a],"eluGrad");for(var i=new Float32Array(sp(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,u=0;u<o.length;++u){var c=o[u];i[u]=c>=1?s[u]:s[u]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}},DL=SM((function(e,t){return e===t?1:0})),ML=qM(Wv,DL,null,"bool"),FL={kernelName:Wv,backendName:"cpu",kernelFunc:ML},LL=yM(Bv,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+.3275911*n);return t*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-n*n))})),jL={kernelName:Bv,backendName:"cpu",kernelFunc:LL},zL=DM((function(e){return Math.exp(e)})),UL=bM(Vv,zL,"float32"),BL={kernelName:Vv,backendName:"cpu",kernelFunc:UL};function WL(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,i=r.dim,o=a.shape.length,s=a.shape.slice(),u=i;return i<0&&(ap(-(o+1)<=i,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+i+1),s.splice(u,0,1),$M({inputs:{x:a},backend:n,attrs:{shape:s}})}var VL={kernelName:Gv,backendName:"cpu",kernelFunc:WL},GL=DM((function(e){return Math.expm1(e)})),HL=bM(Hv,GL),KL={kernelName:Hv,backendName:"cpu",kernelFunc:HL},qL=SM((function(e,t){return e/t})),XL=qM(Lv,qL),YL={kernelName:Lv,backendName:"cpu",kernelFunc:XL},ZL=SM((function(e,t){return e-t})),QL=XM((function(e,t,n,r){return{real:e-n,imag:t-r}})),JL=qM(Pm,ZL,QL),$L={kernelName:Pm,backendName:"cpu",kernelFunc:JL};function ej(e,t,n){for(var r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[a,i],l=sp(c),f=gp("float32",l),h=gp("float32",l),d=0;d<a;d++){for(var p=jF({inputs:{x:s},backend:n,attrs:{begin:[d,0],size:[1,i]}}),v=jF({inputs:{x:u},backend:n,attrs:{begin:[d,0],size:[1,i]}}),g=zM({inputs:{real:p,imag:v},backend:n}),m=tj(g,t,n),y=_A(m.real,m.imag),b=0;b<i;b++){var x=EA(y,b);f[d*i+b]=x.real,h[d*i+b]=x.imag}n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g)}var k=n.makeTensorInfo(c,"float32",f),w=n.makeTensorInfo(c,"float32",h),I=zM({inputs:{real:k,imag:w},backend:n});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(w),I}function tj(e,t,n){var r=sp(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((m=r)&m-1)){var s=nj(i,o,r,t,n),u=[e.shape[0],e.shape[1]];if(t){var c=n.makeTensorInfo(u,"float32",s.real),l=n.makeTensorInfo(u,"float32",s.imag),f=n.makeTensorInfo([],"float32",yy(r,"float32")),h=wM({inputs:{x:f},backend:n}),d=YL.kernelFunc({inputs:{a:c,b:f},backend:n}),p=YL.kernelFunc({inputs:{a:l,b:h},backend:n}),v=n.data.get(d.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),{real:v,imag:g}}return s}var m,y=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=NA(a*s,t,n),c=EA(e,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=t,o/=t),TA(r,i,o,a)}return r}(_A(i,o),r,t);return function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(y)}function nj(e,t,n,r,a){if(1===n)return{real:e,imag:t};var i=_A(e,t),o=n/2,s=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),u=s.real,c=s.imag,l=[u.length],f=a.makeTensorInfo(l,"float32",u),h=a.makeTensorInfo(l,"float32",c),d=zM({inputs:{real:f,imag:h},backend:a}),p=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),v=p.real,g=p.imag,m=[v.length],y=a.makeTensorInfo(m,"float32",v),b=a.makeTensorInfo(m,"float32",g),x=zM({inputs:{real:y,imag:b},backend:a}),k=nj(u,c,o,r,a),w=k.real,I=k.imag,C=[w.length],A=a.makeTensorInfo(C,"float32",w),S=a.makeTensorInfo(C,"float32",I),_=zM({inputs:{real:A,imag:S},backend:a}),E=nj(v,g,o,r,a),T=E.real,N=E.imag,O=[T.length],R=a.makeTensorInfo(O,"float32",T),P=a.makeTensorInfo(O,"float32",N),D=zM({inputs:{real:R,imag:P},backend:a}),M=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(n,r),F=[M.real.length],L=a.makeTensorInfo(F,"float32",M.real),j=a.makeTensorInfo(F,"float32",M.imag),z=zM({inputs:{real:L,imag:j},backend:a}),U=EL({inputs:{a:z,b:D},backend:a}),B=QM({inputs:{a:_,b:U},backend:a}),W=JL({inputs:{a:_,b:U},backend:a}),V=WM({inputs:{input:B},backend:a}),G=WM({inputs:{input:W},backend:a}),H=JF({inputs:{input:B},backend:a}),K=JF({inputs:{input:W},backend:a}),q=eL({inputs:[V,G],backend:a,attrs:{axis:0}}),X=eL({inputs:[H,K],backend:a,attrs:{axis:0}}),Y=a.data.get(q.dataId).values,Z=a.data.get(X.dataId).values;return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(S),a.disposeIntermediateTensorInfo(_),a.disposeIntermediateTensorInfo(R),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(X),{real:Y,imag:Z}}var rj={kernelName:Kv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=sp(r.shape),i=r.shape[r.shape.length-1],o=$M({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=ej(o,!1,n),u=$M({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}};function aj(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype||wp(a),o=mp(i,sp(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,i,o)}var ij={kernelName:qv,backendName:"cpu",kernelFunc:aj};var oj={kernelName:Xv,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,i=gp(r.dtype,sp(r.shape)),o=E(r.shape,4),s=o[0],u=o[1],c=o[2],l=o[3],f=a.data.get(r.dataId).values,h=0;h<s;h++)for(var d=h*c*u*l,p=0;p<u;p++)for(var v=p*(c*l),g=0;g<c;g++)for(var m=g*l,y=0;y<l;y++){var b=Math.round(c-g-1),x=d+v+m+y,k=f[x];if(b>=0&&b<c)k=f[d+v+b*l+y];i[x]=k}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},sj=DM((function(e){return Math.floor(e)})),uj=bM(Yv,sj),cj={kernelName:Yv,backendName:"cpu",kernelFunc:uj},lj=SM((function(e,t){return Math.floor(e/t)})),fj=qM(Zv,lj,null,"int32"),hj={kernelName:Zv,backendName:"cpu",kernelFunc:fj};var dj={kernelName:qm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,f=r.dilations,h=r.dimRoundingMode,d=r.activation,p=r.leakyreluAlpha,v=nL({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:h}});if(o){var g=v;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){var m=$M({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});v=QM({inputs:{a:v,b:m},backend:n}),n.disposeIntermediateTensorInfo(m)}else v=QM({inputs:{a:v,b:o},backend:n});n.disposeIntermediateTensorInfo(g)}if(d){var y=v;if("NCHW"===l&&"prelu"===d&&1===s.shape.length&&1!==s.shape[0]){var b=$M({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});v=jM(n,v,d,b,p),n.disposeIntermediateTensorInfo(b)}else v=jM(n,v,d,s,p);n.disposeIntermediateTensorInfo(y)}return v}};var pj={kernelName:Xm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,f=r.dilations,h=r.dimRoundingMode,d=r.activation,p=r.leakyreluAlpha,v=yL({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:h}});if(o){var g=v;v=QM({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(g)}if(d){var m=v;v=jM(n,v,d,s,p),n.disposeIntermediateTensorInfo(m)}return v}};function vj(e,t,n,r,a,i,o,s,u){for(var c=_x([r,i],n),l=0;l<r;l++){for(var f=[],h=0,d=0;d<a;d++){var p=e[l*a+d];h+=p*o[d],f.push(p)}if(h<0||h>=u/i)throw new Error("Invalid indices: ".concat(f," does not index into ").concat(s));for(var v=0;v<i;v++)c.values[l*i+v]=t.get.apply(t,X(t.indexToLoc(h*i+v)))}return c}var gj={kernelName:$v,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=sp(r.shape),o=a.shape,s=o[o.length-1],u=E(mA(r,a),4),c=u[0],l=u[1],f=u[2],h=u[3];if(0===l)return n.makeTensorInfo(c,r.dtype,[]);var d=vj(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,l,s,f,h,r.shape,i);return n.makeTensorInfo(c,r.dtype,d.values)}};function mj(e,t,n){for(var r=_x(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=i[0],s=i[2],u=t.locToIndex([o,s]);i[2]=t.values[u];var c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var yj={kernelName:Jv,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims;vM([a,i],"gatherV2");for(var u=pp(o,a.shape)[0],c=n.data.get(i.dataId).values,l=a.shape[u],f=function(){var e=c[h];ap(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},h=0;h<c.length;++h)f();var d=s;null==s&&(d=0);var p=sp(i.shape),v=qA(a,i,u,d),g=$M({inputs:{x:a},backend:n,attrs:{shape:[v.batchSize,v.outerSize,v.dimSize,v.sliceSize]}}),m=$M({inputs:{x:i},backend:n,attrs:{shape:[v.batchSize,p/v.batchSize]}}),y=[v.batchSize,v.outerSize,p/v.batchSize,v.sliceSize],b=n.bufferSync(m),x=mj(n.bufferSync(g),b,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(v.outputShape,x.dtype,x.values)}},bj=SM((function(e,t){return e>t?1:0})),xj=qM(eg,bj,null,"bool"),kj={kernelName:eg,backendName:"cpu",kernelFunc:xj},wj=SM((function(e,t){return e>=t?1:0})),Ij=qM(tg,wj,null,"bool"),Cj={kernelName:tg,backendName:"cpu",kernelFunc:Ij};var Aj={kernelName:rg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=sp(r.shape),i=r.shape[r.shape.length-1],o=$M({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=ej(o,!0,n),u=$M({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}},Sj=yM(ig,(function(e){return Number.isFinite(e)?1:0}),"bool"),_j={kernelName:ig,backendName:"cpu",kernelFunc:Sj},Ej=yM(og,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),Tj={kernelName:og,backendName:"cpu",kernelFunc:Ej},Nj=yM(sg,(function(e){return Number.isNaN(e)?1:0}),"bool"),Oj={kernelName:sg,backendName:"cpu",kernelFunc:Nj},Rj=SM((function(e,t){return e<t?1:0})),Pj=qM(cg,Rj,null,"bool"),Dj={kernelName:cg,backendName:"cpu",kernelFunc:Pj},Mj=SM((function(e,t){return e<=t?1:0})),Fj=qM(lg,Mj,null,"bool"),Lj={kernelName:lg,backendName:"cpu",kernelFunc:Fj};function jj(e,t,n){var r=(t-e)/(n-1),a=Tp(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var zj={kernelName:fg,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=jj(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},Uj=DM((function(e){return Math.log(e)})),Bj=bM(hg,Uj),Wj={kernelName:hg,backendName:"cpu",kernelFunc:Bj},Vj=yM(dg,(function(e){return Math.log1p(e)})),Gj={kernelName:dg,backendName:"cpu",kernelFunc:Vj},Hj=SM((function(e,t){return e&&t})),Kj=qM(pg,Hj,null,"bool"),qj={kernelName:pg,backendName:"cpu",kernelFunc:Kj},Xj=yM(vg,(function(e){return e?0:1}),"bool"),Yj={kernelName:vg,backendName:"cpu",kernelFunc:Xj},Zj=SM((function(e,t){return e||t})),Qj=qM(gg,Zj,null,"bool"),Jj={kernelName:gg,backendName:"cpu",kernelFunc:Qj};var $j={kernelName:mg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta;vM(a,"LRN");var c=a.shape[3],l=c-1,f=n.data.get(a.dataId).values,h=sp(a.shape),d=new Float32Array(h);function p(e){for(var t=e%c,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,l),a=0;n<=r;n++){var o=f[n];a+=o*o}return a}for(var v=0;v<h;v++){var g=p(v),m=f[v]*Math.pow(o+s*g,-u);d[v]=m}return n.makeTensorInfo(a.shape,a.dtype,d)}};var ez={kernelName:yg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta;vM(o,"LRNGrad");for(var f=sp(o.shape),h=o.shape[3],d=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,g=new Float32Array(f),m=f,y=0;y<m;y++){for(var b=y%h,x=y-b+Math.max(0,b-s),k=y-b+Math.min(h,b+s+1),w=0,I=x;I<k;I++)w+=Math.pow(p[I],2);w=c*w+u;for(var C=x;C<k;C++){var A=-2*c*l*p[C]*v[y]/w;y===C&&(A+=Math.pow(w,-l)),A*=d[y],g[C]+=A}}return n.makeTensorInfo(o.shape,a.dtype,g)}};function tz(e,t,n,r){for(var a=gp(r,sp(n)),i=0;i<a.length;++i){for(var o=i*t,s=e[o],u=0;u<t;++u){var c=e[o+u];(Number.isNaN(c)||c>s)&&(s=c)}a[i]=s}return a}function nz(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=n,u=a.shape,c=u.length,l=pp(i,u),f=l,h=sI(f,c),d=s.data.get(a.dataId).values;if(null!=h){for(var p=new Array(c),v=0;v<p.length;v++)p[v]=u[h[v]];d=fF(d,u,a.dtype,h,p),f=cI(f.length,c),u=p}vM(a,"max"),oI("max",f,c);var g=E(aI(u,f),2),m=g[0],y=tz(d,sp(g[1]),m,a.dtype),b=s.write(y,m,a.dtype),x=m;o&&(x=iI(m,l));return{dataId:b,shape:x,dtype:a.dtype}}var rz={kernelName:bg,backendName:"cpu",kernelFunc:nz},az=SM((function(e,t){return Math.max(e,t)})),iz=qM(xg,az),oz={kernelName:xg,backendName:"cpu",kernelFunc:iz};var sz={kernelName:kg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;vM(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;ap(sw(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=Qk(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&up(l.inShape,l.outShape))c=wM({inputs:{x:a},backend:n});else{var f=n.data.get(a.dataId).values,h=Ap(a.shape),d=TF(f,a.shape,a.dtype,h,l,"max");c=n.makeTensorInfo(l.outShape,a.dtype,d.values)}return c}};var uz={kernelName:Ig,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat;vM(a,"maxPool3d");var l=Jk(a.shape,i,o,1,s,u,c),f=OF(n.data.get(a.dataId).values,a.shape,a.dtype,Ap(a.shape),l,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}};var cz={kernelName:Cg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;vM([a,i],"maxPool3DGrad");for(var l=Jk(i.shape,o,s,1,u,c),f=function(e,t){for(var n=_x(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left,v=0;v<t.batchSize;++v)for(var g=0;g<t.inChannels;++g)for(var m=0;m<t.outDepth;++m){for(var y=m*r-h,b=y;b<0;)b+=o;for(var x=Math.min(t.inDepth,c+y),k=0;k<t.outHeight;++k){for(var w=k*a-d,I=w;I<0;)I+=s;for(var C=Math.min(t.inHeight,l+w),A=0;A<t.outWidth;++A){for(var S=A*i-p,_=S;_<0;)_+=u;for(var E=Math.min(t.inWidth,f+S),T=Number.NEGATIVE_INFINITY,N=-1,O=b;O<x;O+=o)for(var R=O-y,P=I;P<C;P+=s)for(var D=P-w,M=_;M<E;M+=u){var F=M-S,L=e.get(v,O,P,M,g);L>=T&&(T=L,N=R*l*f+D*l+F)}n.set(N,v,m,k,A,g)}}}return n}(n.bufferSync(i),l),h=l.strideDepth,d=l.strideHeight,p=l.strideWidth,v=l.dilationDepth,g=l.dilationHeight,m=l.dilationWidth,y=l.effectiveFilterDepth,b=l.effectiveFilterHeight,x=l.effectiveFilterWidth,k=y-1-l.padInfo.front,w=x-1-l.padInfo.left,I=b-1-l.padInfo.top,C=_x(i.shape,"float32"),A=n.bufferSync(a),S=0;S<l.batchSize;++S)for(var _=0;_<l.inChannels;++_)for(var E=0;E<l.inDepth;++E)for(var T=0;T<l.inHeight;++T)for(var N=0;N<l.inWidth;++N){for(var O=E-k,R=T-I,P=N-w,D=0,M=0;M<y;M+=v){var F=(O+M)/h;if(!(F<0||F>=l.outDepth||Math.floor(F)!==F))for(var L=0;L<b;L+=g){var j=(R+L)/d;if(!(j<0||j>=l.outHeight||Math.floor(j)!==j))for(var z=0;z<x;z+=m){var U=(P+z)/p;if(!(U<0||U>=l.outWidth||Math.floor(U)!==U)){var B=y*b*x-1-f.get(S,F,j,U,_)===M*b*x+L*x+z?1:0;if(0!==B)D+=A.get(S,F,j,U,_)*B}}}}C.set(D,S,E,T,N,_)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};var lz={kernelName:wg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;vM([i,t.output],"maxPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,f=Qk(o.shape,s,u,1,c,l),h=n.data.get(o.dataId).values,d=_x(f.outShape,o.dtype,NF(h,o.shape,o.dtype,f).values),p=f.strideHeight,v=f.strideWidth,g=f.dilationHeight,m=f.dilationWidth,y=f.effectiveFilterHeight,b=f.effectiveFilterWidth,x=b-1-f.padInfo.left,k=y-1-f.padInfo.top,w=_x(o.shape,"float32"),I=n.data.get(a.dataId).values,C=_x(a.shape,"float32",I),A=0;A<f.batchSize;++A)for(var S=0;S<f.inChannels;++S)for(var _=0;_<f.inHeight;++_)for(var E=0;E<f.inWidth;++E){for(var T=_-k,N=E-x,O=0,R=0;R<y;R+=g){var P=(T+R)/p;if(!(P<0||P>=f.outHeight||Math.floor(P)!==P))for(var D=0;D<b;D+=m){var M=(N+D)/v;if(!(M<0||M>=f.outWidth||Math.floor(M)!==M)){var F=y*b-1-d.get(A,P,M,S)===R*b+D?1:0;if(0!==F)O+=C.get(A,P,M,S)*F}}}w.set(O,A,_,E,S)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var fz={kernelName:Ag,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;vM(a,"MaxPoolWithArgmax");var l=c.data.get(a.dataId).values,f=Qk(a.shape,i,o,[1,1],s),h=function(e,t,n,r,a){var i=TF(e,0,n,Ap(t),a,"max"),o=NF(e,t,n,a,!0,r);return[i.values,o.values]}(l,a.shape,a.dtype,u,f),d=E(h,2),p=d[0],v=d[1],g=c.write(p,f.outShape,a.dtype),m=c.write(v,f.outShape,a.dtype);return[{dataId:g,shape:f.outShape,dtype:a.dtype},{dataId:m,shape:f.outShape,dtype:"int32"}]}};var hz={kernelName:Sg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=pp(i,a.shape),u=sp(aI(a.shape,s)[1]),c=[],l=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(l);var f=HM({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(f);var h=XL({inputs:{a:f,b:l},backend:n});c.push(h);var d=NL({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:o}});return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),d}};var dz={kernelName:_g,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;vM(a,"min");var s=pp(i,a.shape),u=s,c=sI(u,a.shape.length),l=a;null!=c&&(l=hF({inputs:{x:a},backend:n,attrs:{perm:c}}),u=cI(u.length,a.shape.length)),oI("min",u,l.shape.length);for(var f=E(aI(l.shape,u),2),h=f[0],d=sp(f[1]),p=Tp(sp(h),l.dtype),v=n.data.get(l.dataId).values,g=0;g<p.length;++g){for(var m=g*d,y=v[m],b=0;b<d;++b){var x=v[m+b];(Number.isNaN(x)||x<y)&&(y=x)}p[g]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var k=n.makeTensorInfo(h,l.dtype,p);if(o){var w=$M({inputs:{x:k},backend:n,attrs:{shape:iI(h,s)}});return n.disposeIntermediateTensorInfo(k),w}return k}},pz=SM((function(e,t){return Math.min(e,t)})),vz=qM(Eg,pz),gz={kernelName:Eg,backendName:"cpu",kernelFunc:vz};var mz={kernelName:Tg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode;vM(a,"mirrorPad");for(var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=i.map((function(e,t){return e[0]+a.shape[t]})),l="reflect"===o?0:1,f=n.data.get(a.dataId).values,h=a.shape.length,d=Ap(a.shape),p=sp(s),v=s.length,g=Ap(s),m=gp(a.dtype,p),y=0;y<p;y++){for(var b=Pp(y,v,g),x=0;x<v;x++)b[x]<u[x]?b[x]=2*u[x]-b[x]-l:b[x]>=c[x]&&(b[x]=2*(c[x]-1)-b[x]+l);b=b.map((function(e,t){return e-u[t]}));var k=Rp(b,h,d);m[y]=f[k]}return{dataId:n.write(m,s,a.dtype),shape:s,dtype:a.dtype}}},yz=SM((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),bz=qM(Ng,yz),xz={kernelName:Ng,backendName:"cpu",kernelFunc:bz};function kz(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=a.shape.length,s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(s));var u=pp([s],a.shape),c=nz({inputs:{x:a},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=iI(c.shape,u),f=$M({inputs:{x:c},backend:n,attrs:{shape:l}}),h=JL({inputs:{a:a,b:f},backend:n}),d=UL({inputs:{x:h},backend:n}),p=NL({inputs:{x:d},backend:n,attrs:{axis:u,keepDims:!1}}),v=$M({inputs:{x:p},backend:n,attrs:{shape:l}}),g=XL({inputs:{a:d,b:v},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),g}var wz={kernelName:km,backendName:"cpu",kernelFunc:kz};var Iz={kernelName:Og,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized;vM(a,"multinomial");for(var u=s?a:kz({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],f=n.data.get(u.dataId).values,h=[c,i],d=Tp(sp(h),"int32"),p=0;p<c;++p){var v=p*l,g=new Float32Array(l-1);g[0]=f[v];for(var m=1;m<g.length;++m)g[m]=g[m-1]+f[v+m];for(var y=bI.alea(o.toString()),b=p*i,x=0;x<i;++x){var k=y();d[b+x]=g.length;for(var w=0;w<g.length;w++)if(k<g[w]){d[b+x]=w;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(h,"int32",d)}};function Cz(e,t,n){var r=yy(-1,n);return SL([],t,r,e,n)}var Az={kernelName:Pg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;vM(r,"neg");var a=E(Cz(n.data.get(r.dataId).values,r.shape,r.dtype),2),i=a[0],o=a[1];return n.makeTensorInfo(o,r.dtype,i)}},Sz=bC;var _z={kernelName:Mg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold;vM(a,"NonMaxSuppression");var c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,f=Sz(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},Ez=xC;var Tz={kernelName:Fg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize;vM(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,h=Ez(l,f,o,s,u,c),d=h.selectedIndices,p=h.validOutputs;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},Nz=kC;var Oz={kernelName:Lg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma;vM(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,h=Nz(l,f,o,s,u,c),d=h.selectedIndices,p=h.selectedScores;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},Rz=SM((function(e,t){return e!==t?1:0})),Pz=qM(Dg,Rz,null,"bool"),Dz={kernelName:Dg,backendName:"cpu",kernelFunc:Pz};var Mz={kernelName:zg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,s=r.onValue,u=r.offValue;vM(a,"oneHot");var c=sp(a.shape),l=new Float32Array(c*o);l.fill(u);for(var f=n.data.get(a.dataId).values,h=0;h<c;++h)f[h]>=0&&f[h]<o&&(l[h*o+f[h]]=s);return n.makeTensorInfo([].concat(X(a.shape),[o]),i,l)}};function Fz(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=WM({inputs:{input:r},backend:n}),i=Fz({inputs:{x:a},backend:n}),o=JF({inputs:{input:r},backend:n}),s=Fz({inputs:{x:o},backend:n}),u=zM({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return aj({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var Lz={kernelName:Vm,backendName:"cpu",kernelFunc:Fz};var jz={kernelName:jg,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=WM({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=JF({inputs:{input:a},backend:r}),u=Fz({inputs:{x:s},backend:r}),c=zM({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return aj({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function zz(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return WL({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){ip(a,e.shape,"All tensors passed to stack must have matching shapes"),ap(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=t.map((function(e){var t=WL({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),u=eL({inputs:s,backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}var Uz={kernelName:Ug,backendName:"cpu",kernelFunc:zz};var Bz={kernelName:Bg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;vM(a,"pad");var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=n.data.get(a.dataId).values,l=sp(a.shape),f=a.shape.length,h=Ap(a.shape),d=sp(s),p=s.length,v=Ap(s),g=gp(a.dtype,d);0!==o&&g.fill(o);for(var m=0;m<l;m++){var y=Pp(m,f,h).map((function(e,t){return e+u[t]}));g[Rp(y,p,v)]=c[m]}return{dataId:n.write(g,s,a.dtype),shape:s,dtype:a.dtype}}},Wz=SM((function(e,t){return Math.pow(e,t)})),Vz=qM(Wg,Wz),Gz={kernelName:Wg,backendName:"cpu",kernelFunc:Vz};function Hz(e,t,n,r){for(var a=E(aI(e,r),2),i=a[0],o=a[1],s=qy(t,"int32"),u=Tp(sp(i),s),c=sp(o),l=0;l<u.length;++l){for(var f=l*c,h=1,d=0;d<c;++d)h*=n[f+d];u[l]=h}return{outVals:u,outShape:i,outDtype:s}}var Kz={kernelName:Gg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;vM(a,"prod");var s=a.shape.length,u=pp(i,a.shape),c=sI(u,s),l=u,f=a,h=[];null!=c&&(f=hF({inputs:{x:a},backend:n,attrs:{perm:c}}),h.push(f),l=cI(l.length,s));var d=n.data.get(f.dataId).values,p=Hz(f.shape,f.dtype,d,l),v=p.outVals,g=p.outShape,m=p.outDtype,y=g;return o&&(y=iI(g,u)),h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,m,v)}};function qz(e,t,n,r){var a=[],i=0,o=t.length-1+n.length,s=new Array(o).fill(null).map((function(){return[0]}));!function(e,t){for(var n=0;n<e.length;++n){var r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(var i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);for(var u=1,c=0;c<t.length-1;++c){u*=t[c];for(var l=t[c+1],f=1;f<u+1;++f)s[c].push(f*l)}for(var h=0;h<e.length;++h){for(var d=e[h],p=e[h]+1,v=0;v<n.length;++v){var g=n[v],m=v+t.length-1;if(m>=0)for(var y=s[m],b=y[y.length-1]-g[d],x=d;x<p;++x)s[m].push(g[x+1]+b);d=g[d],p=g[p]}p!==d&&(a.push([d,p]),i+=p-d)}return{outSplits:s,valueSlices:a,numValues:i}}function Xz(e,t){for(var n=e.slice(0,t);n.length<t;)n.push(1);for(var r=t;r<e.length;r++)n[t-1]*=e[r];return n}function Yz(e,t,n,r,a){var i=t.slice();i[0]=a;var o=mp(n,sp(i)),s=e.length;return function(e,t,n,r,a,i){var o,s=Xz(t,2)[1],u=Xz(i,2)[1],c=0,l=U(n);try{for(l.s();!(o=l.n()).done;)for(var f=o.value,h=f[0];h<f[1];++h){for(var d=0;d<r;++d)a[c*u+d]=e[h*s+d];++c}}catch(Wse){l.e(Wse)}finally{l.f()}}(e,t,r,0===s?0:s/t[0],o,i),[o,i]}function Zz(e,t,n,r,a,i,o,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((function(e,r){if(e<0||e>=n){var a=Pp(r,t.length,Ap(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}}))}(i,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");var u=qz(i,o,e,r[0]),c=u.outSplits,l=u.valueSlices,f=u.numValues,h=function(e){for(var t=[],n=function(){var n=mp("int32",e[r].length);t.push(n),e[r].forEach((function(e,t){return n[t]=e}))},r=0;r<e.length;++r)n();return t}(c),d=Yz(n,r,a,l,f);return[h,d[0],d[1]]}var Qz={kernelName:Hg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,s=(r.outputRaggedRank,a.map((function(e){return n.data.get(e.dataId).values}))),u=a.map((function(e){return e.shape})),c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,f=E(Zz(s,u,c,i.shape,i.dtype,l,o.shape),3),h=f[0],d=f[1],p=f[2],v=h.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),g=n.makeTensorInfo(p,i.dtype,d);return v.concat([g])}},Jz=2147483647;function $z(e,t,n,r,a,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");var s=0===t.length,u=0===a.length,c=0===o.length,l=[];s||l.push(t[0]),u||l.push(a[0]),c||l.push(o[0]);for(var f=1;f<l.length;++f)if(l[f]!==l[f-1])throw new Error("starts, limits, and deltas must have the same shape");var h=0===l.length?1:l[0],d=mp("int32",h+1);d[0]=0;for(var p=0;p<h;++p){var v=s?e[0]:e[p],g=u?r[0]:r[p],m=c?i[0]:i[p];if(0===m)throw new Error("Requires delta != 0");var y=void 0;if(m>0&&g<v||m<0&&g>v)y=0;else if((y=Math.ceil(Math.abs((g-v)/m)))>Jz)throw new Error("Requires ((limit - start) / delta) <= ".concat(Jz));d[p+1]=d[p]+y}for(var b=mp(n,d[h]),x=0,k=0;k<h;++k)for(var w=d[k+1]-d[k],I=s?e[0]:e[k],C=c?i[0]:i[k],A=0;A<w;++A)b[x++]=I,I+=C;return[d,b]}var eU={kernelName:Kg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=E($z(o,r.shape,r.dtype,s,a.shape,u,i.shape),2),l=c[0],f=c[1];return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([f.length],r.dtype,f)]}},tU=JC,nU=function(){function e(t,n,r,a,i,o,s,u,c,l){var f;G(this,e),this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=function(e){var t,n={FIRST_DIM_SIZE:JC.FIRST_DIM_SIZE,VALUE_ROWIDS:JC.VALUE_ROWIDS,ROW_LENGTHS:JC.ROW_LENGTHS,ROW_SPLITS:JC.ROW_SPLITS,ROW_LIMITS:JC.ROW_LIMITS,ROW_STARTS:JC.ROW_STARTS},r=[],a=U(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!(i in n))break;r.push(n[i])}}catch(Wse){a.e(Wse)}finally{a.f()}return r}(l),this.raggedRank=0===(f=this.rowPartitionTypes).length?0:f[0]===JC.FIRST_DIM_SIZE?f.length-1:f.length}return q(e,[{key:"getRowPartitionTypeByDimension",value:function(e){return this.rowPartitionTypes[0]===tU.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}},{key:"getRowPartitionTensor",value:function(e){return this.rowPartitionTypes[0]===tU.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}},{key:"getMaxWidth",value:function(t){var n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case tU.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case tU.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(tU[this.getRowPartitionTypeByDimension(t-1)]))}}},{key:"tensorShapeFromTensor",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return aU(e,n)}},{key:"calculateOutputSize",value:function(e){var t=this.valuesShape;!function(e,t){if(null!=e&&null!=t){var n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(var a=0;a<Math.min(n,r-1);++a){var i=e[a],o=t[a+1];if(i>=0&&o>=0&&1!==i&&i!==o)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(i," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(o))}}}(this.defaultValueShape,t);var n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=function(e,t,n){var r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(var a=1;a<n.length;++a){var i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(s))}else r[o]=i}return r}(this.raggedRank,n,t),a=r;a[0]<0&&(a[0]=e);for(var i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}},{key:"calculateFirstParentOutputIndex",value:function(e,t,n){for(var r=Math.min(e,n),a=[],i=0,o=0;o<r;++o,i+=t)a.push(i);for(var s=r;s<e;++s)a.push(-1);return ap(a.length===e,(function(){return"Final length of result must be equal to firstDimension."})),a}},{key:"calculateOutputIndexRowSplit",value:function(e,t,n,r){for(var a=e.length,i=[],o=0;o<a-1;++o){var s=e[o+1]-e[o],u=Math.min(r,s),c=t[o];-1===c&&(u=0);for(var l=0;l<u;++l)i.push(c),c+=n;for(var f=0;f<s-u;++f)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}},{key:"calculateOutputIndexValueRowID",value:function(e,t,n,r){var a=e.length,i=[];if(0===a)return[];var o=0,s=e[0];if(s>=t.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(t.length));var u=t[s];i.push(u);for(var c=1;c<a;++c){var l=e[c];if(l===s)u>=0&&(++o<r?u+=n:u=-1);else{if(o=0,s=l,l>=t.length)throw new Error("Got nextValueRowId=".concat(l," which is not less than ").concat(t.length));u=t[l]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}},{key:"calculateOutputIndex",value:function(e,t,n,r){var a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case tU.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case tU.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(tU[i]))}}},{key:"getFirstDimensionSize",value:function(){var e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");var t=this.rowPartitionTypes[0];switch(t){case tU.FIRST_DIM_SIZE:return e[0];case tU.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case tU.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(tU[t]))}}},{key:"compute",value:function(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");var e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(var r=n.length-2;r>=0;--r)n[r]=n[r+1]*t[r+1];var a=aU(t,!1),i=mp(this.valuesDType,sp(a));if(n[0]*t[0]>0){for(var o=this.calculateFirstParentOutputIndex(e,n[0],t[0]),s=1;s<=this.raggedRank;++s){o=this.calculateOutputIndex(s-1,o,n[s],t[s])}this.setOutput(this.raggedRank,o,i,a)}return[a,i]}},{key:"setOutput",value:function(e,t,n,r){if(0!==n.length){var a=this.values,i=n,o=r.slice(),s=sp(o=o.slice(e+1)),u=t.length,c=this.defaultValue;if(c.length!==s&&1!==c.length){var l=this.defaultValueShape;Px((function(){var e=fw(c,l),t=yw(e,o);c=t.dataSync()}))}for(var f=0,h=0,d=0,p=0;p<=u;++p){var v=p<u?t[p]:-1;if(v!==d){if(h<d){var g=a.subarray(f*s);rU(i.subarray(h*s),g,(d-h)*s)}if(p>=u){var m=n.length;v=Math.floor(m/s)}if(v>d)if(1===this.defaultValue.length)i.subarray(d*s,v*s).fill(this.defaultValue[0]),d=v;else for(;v>d;){rU(i.slice(d*s),c,s),++d}v<0?(f=p+1,h=d):(f=p,d=(h=d)+1)}else++d}}}}],[{key:"getMaxWidthRowSplit",value:function(e){var t=e.length;if(0===t||1===t)return 0;for(var n=0,r=0;r<t-1;++r){var a=e[r+1]-e[r];a>n&&(n=a)}return n}},{key:"getMaxWidthValueRowID",value:function(e){var t=e.length;if(0===t)return 0;for(var n=0,r=e[0],a=0,i=1;i<t;++i){var o=e[i];o!==r&&(r=o,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}}]),e}();function rU(e,t,n){for(var r=0;r<n;r++)e[r]=t[r]}function aU(e,t){var n,r=[],a=U(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i<0){if(!t)throw new Error("Dimension ".concat(i," must be >= 0"));if(i<-1)throw new Error("Dimension ".concat(i," must be >= -1"));i=-1}r.push(i)}}catch(Wse){a.e(Wse)}finally{a.f()}return r}function iU(e,t,n,r,a,i,o,s,u,c){return new nU(e,t,n,r,a,i,o,s,u,c).compute()}var oU={kernelName:qg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,s=t.rowPartitionTensors,u=r.rowPartitionTypes,c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,f=n.data.get(o.dataId).values,h=s.map((function(e){return n.data.get(e.dataId).values})),d=s.map((function(e){return e.shape})),p=E(iU(c,a.shape,l,i.shape,i.dtype,f,o.shape,h,d,u),2),v=p[0],g=p[1];return n.makeTensorInfo(v,i.dtype,g)}};function sU(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return Tp(0,r);var a=Tp(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}var uU={kernelName:Xg,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=sU(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},cU=yM(Zg,(function(e){return 1/e})),lU={kernelName:Zg,backendName:"cpu",kernelFunc:cU};var fU={kernelName:tm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;vM(a,"resizeBilinear");for(var u=Ap(a.shape),c=E(s,2),l=c[0],f=c[1],h=E(a.shape,4),d=h[0],p=h[1],v=h[2],g=h[3],m=n.data.get(a.dataId).values,y=new Float32Array(sp([d,l,f,g])),b=[i&&l>1?p-1:p,i&&f>1?v-1:v],x=[i&&l>1?l-1:l,i&&f>1?f-1:f],k=0,w=b[0]/x[0],I=b[1]/x[1],C=0;C<d;C++)for(var A=0;A<l;A++){var S=void 0;S=o?w*(A+.5)-.5:w*A;for(var _=Math.max(0,Math.floor(S)),T=S-_,N=Math.min(p-1,Math.ceil(S)),O=C*u[0]+_*u[1],R=C*u[0]+N*u[1],P=0;P<f;P++){var D=void 0;D=o?I*(P+.5)-.5:I*P;for(var M=Math.max(0,Math.floor(D)),F=D-M,L=Math.min(v-1,Math.ceil(D)),j=O+M*u[2],z=R+M*u[2],U=O+L*u[2],B=R+L*u[2],W=0;W<g;W++){var V=m[j+W],G=m[z+W],H=V+(m[U+W]-V)*F,K=H+(G+(m[B+W]-G)*F-H)*T;y[k++]=K}}}return n.makeTensorInfo([d,l,f,g],"float32",y)}};var hU={kernelName:nm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;vM([i,a],"resizeBilinearGrad");for(var s=Ap(a.shape),u=E(a.shape,4),c=u[0],l=u[1],f=u[2],h=u[3],d=E(i.shape,3),p=d[1],v=d[2],g=new Float32Array(c*l*f*h),m=[o&&p>1?l-1:l,o&&v>1?f-1:f],y=[o&&p>1?p-1:p,o&&v>1?v-1:v],b=m[0]/y[0],x=m[1]/y[1],k=n.data.get(i.dataId).values,w=0,I=0;I<c;I++)for(var C=I*s[0],A=0;A<p;A++)for(var S=A*b,_=Math.floor(S),T=Math.min(Math.ceil(S),l-1),N=C+_*s[1],O=C+T*s[1],R=S-_,P=1-R,D=0;D<v;D++)for(var M=D*x,F=Math.floor(M),L=Math.min(Math.ceil(M),f-1),j=M-F,z=1-j,U=N+F*s[2],B=N+L*s[2],W=O+F*s[2],V=O+L*s[2],G=P*z,H=P*j,K=R*z,q=R*j,X=0;X<h;X++){var Y=k[w++];g[U+X]+=Y*G,g[B+X]+=Y*H,g[W+X]+=Y*K,g[V+X]+=Y*q}return n.makeTensorInfo([c,f,l,h],"float32",g)}};var dU={kernelName:$g,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;vM(a,"resizeNearestNeighbor");for(var u=Ap(a.shape),c=E(s,2),l=c[0],f=c[1],h=E(a.shape,4),d=h[0],p=h[1],v=h[2],g=h[3],m=n.data.get(a.dataId).values,y=new Float32Array(d*l*f*g),b=[i&&l>1?p-1:p,i&&f>1?v-1:v],x=[i&&l>1?l-1:l,i&&f>1?f-1:f],k=b[0]/x[0],w=b[1]/x[1],I=0,C=0;C<d;C++)for(var A=C*u[0],S=0;S<l;S++){var _=o?k*(S+.5):k*S,T=Math.min(p-1,i?Math.round(_):Math.floor(_));o&&(T=Math.max(0,T));for(var N=A+T*u[1],O=0;O<f;O++){var R=o?w*(O+.5):w*O,P=Math.min(v-1,i?Math.round(R):Math.floor(R));o&&(P=Math.max(0,P));for(var D=N+P*u[2],M=0;M<g;M++){var F=m[D+M];y[I++]=F}}}return n.makeTensorInfo([d,l,f,g],a.dtype,y)}};var pU={kernelName:em,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;vM([i,a],"resizeNearestNeighborGrad");for(var s=Ap(a.shape),u=Ap(i.shape),c=E(a.shape,4),l=c[0],f=c[1],h=c[2],d=c[3],p=E(i.shape,3),v=p[1],g=p[2],m=new Float32Array(l*f*h*d),y=n.data.get(i.dataId).values,b=[o&&v>1?f-1:f,o&&g>1?h-1:h],x=[o&&v>1?v-1:v,o&&g>1?g-1:g],k=b[0]/x[0],w=b[1]/x[1],I=1/k,C=1/w,A=2*Math.ceil(I)+2,S=2*Math.ceil(C)+2,_=0;_<l;_++)for(var T=_*s[0],N=0;N<f;N++)for(var O=T+N*s[1],R=Math.floor(N*I),P=Math.floor(R-A/2),D=0;D<h;D++)for(var M=O+D*s[2],F=Math.floor(D*C),L=Math.floor(F-S/2),j=0;j<d;j++){for(var z=0,U=0;U<A;U++){var B=U+P;if(!(B<0||B>=v)){var W=T+B*u[1],V=B*k;if(N===Math.min(f-1,o?Math.round(V):Math.floor(V)))for(var G=0;G<S;G++){var H=G+L;if(!(H<0||H>=g)){var K=W+H*u[2],q=H*w;D===Math.min(h-1,o?Math.round(q):Math.floor(q))&&(z+=y[K+j])}}}}m[M+j]=z}return n.makeTensorInfo(a.shape,a.dtype,m)}};var vU={kernelName:am,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims;vM(a,"reverse");var o=a.shape.length,s=pp(i,a.shape);if(0===o)return wM({inputs:{x:a},backend:n});for(var u=new My(a.shape,a.dtype),c=n.bufferSync(a),l=function(){var e=u.indexToLoc(f),t=e.slice();s.forEach((function(e){return t[e]=a.shape[e]-1-t[e]})),u.set.apply(u,[c.get.apply(c,X(t))].concat(X(e)))},f=0;f<u.size;f++)l();return n.makeTensorInfo(u.shape,u.dtype,u.values)}},gU={kernelName:Hm,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=gp(a.dtype,sp(a.shape)),l=E(a.shape,4),f=l[0],h=l[1],d=l[2],p=l[3],v=E(fA(s,h,d),2),g=v[0],m=v[1],y=Math.sin(i),b=Math.cos(i),x=u.data.get(a.dataId).values,k=0;k<f;k++)for(var w=k*d*h*p,I=0;I<h;I++)for(var C=I*(d*p),A=0;A<d;A++)for(var S=A*p,_=0;_<p;_++){var T=[f,I,A,_],N=T[2],O=T[1],R=(N-g)*b-(O-m)*y,P=(N-g)*y+(O-m)*b;R=Math.round(R+g),P=Math.round(P+m);var D=o;if("number"!==typeof o&&(D=3===_?255:o[_]),R>=0&&R<d&&P>=0&&P<h)D=x[w+P*(d*p)+R*p+_];c[w+C+S+_]=D}return{dataId:u.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},mU=yM(im,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),yU={kernelName:im,backendName:"cpu",kernelFunc:mU},bU=DM((function(e){return 1/Math.sqrt(e)})),xU=bM(om,bU),kU={kernelName:om,backendName:"cpu",kernelFunc:xU};function wU(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],f=e.values,h=t.values;if(0===r)return _x(n,t.dtype);var d=_x(l,t.dtype);"string"===typeof u||"number"===typeof u?d.values.fill(u):"boolean"===typeof u&&d.values.fill(+u);for(var p=0;p<i;p++){for(var v=[],g=0,m=0;m<o;m++){var y=f[p*o+m];v.push(y),g+=y*s[m]}if(g<0||g>=r/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var b=0;b<a;b++)c?d.values[g*a+b]+=h[p*a+b]:d.values[g*a+b]=0===t.rank?h[0]:h[p*a+b]}return d}var IU={kernelName:sm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=yA(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,f=s.strides,h=s.outputSize,d=wU(n.bufferSync(a),n.bufferSync(i),o,h,l,c,u,f,0,!0);return n.makeTensorInfo(o,d.dtype,d.values)}};function CU(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<t?n=a+1:r=a;return r}function AU(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<=t?n=a+1:r=a;return r}var SU={kernelName:um,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,s=function(e,t,n,r,a,i){for(var o=mp("int32",n*a),s=0;s<n;++s)for(var u=e.slice(s*r,(s+1)*r),c=s*a,l=0;l<a;++l)o[c+l]="left"===i?CU(u,t[l+c]):AU(u,t[l+c]);return o}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",s)}};var _U={kernelName:cm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e;vM([r,a,i],"select");for(var o=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=qy(a.dtype,i.dtype),f=Tp(sp(a.shape),l),h=0,d=0===o||o>1||1===a.shape.length?1:sp(a.shape.slice(1)),p=0;p<s.length;p++)for(var v=0;v<d;v++)1===s[p]?f[h++]=u[p]:f[h++]=c[p];return n.makeTensorInfo(a.shape,l,f)}},EU=yM(lm,(function(e){return e>=0?1.0507009873554805*e:1.7580993408473768*(Math.exp(e)-1)})),TU={kernelName:lm,backendName:"cpu",kernelFunc:EU},NU=yM(pm,(function(e){return e<0?-1:e>0?1:0})),OU={kernelName:pm,backendName:"cpu",kernelFunc:NU},RU=yM(hm,(function(e){return Math.sin(e)})),PU={kernelName:hm,backendName:"cpu",kernelFunc:RU},DU=yM(dm,(function(e){return Math.sinh(e)})),MU={kernelName:dm,backendName:"cpu",kernelFunc:DU},FU=Math.log(1.1920928955078125e-7)+2,LU=yM(gm,(function(e){var t=e>-FU,n=e<FU,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),jU={kernelName:gm,backendName:"cpu",kernelFunc:LU};var zU={kernelName:bm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;vM([a],"spaceToBatchND");var s=sp(i),u=[[0,0]];u.push.apply(u,X(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=Bz.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),f=hA(l.shape,i,s,!1),h=dA(f.length,i.length,!1),d=pA(l.shape,i,s,!1),p=$M({inputs:{x:l},backend:n,attrs:{shape:f}}),v=hF({inputs:{x:p},backend:n,attrs:{perm:h}}),g=$M({inputs:{x:v},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),g}};function UU(e,t,n,r,a,i,o){var s=t[0],u=i[0],c=new Array(u),l=new Array(s),f=t[1];if(0===u){if(0!==s)throw new Error("Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(s));return[mp(n,0),[0,f],mp(a,0),c,l]}for(var h=!0,d=0,p=new Array(u).fill(0),v=0;v<s;++v){var g=e[v*f];if(g<0)throw new Error(WA(v,g));if(g>=u)throw new Error(VA(v,g,u));++p[g],h=h&&g>=d,d=g}for(var m=!0,y=0;y<u;++y){var b=0===p[y];c[y]=b,m=m&&!b,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(m&&h){for(var x=e,k=r,w=0;w<s;++w)l[w]=w;return[x,[s,f],k,c,l]}for(var I=p[u-1],C=mp(n,I*f),A=mp(a,I),S=new Array(u).fill(0),_=0;_<s;++_){var E=e[_*f],T=S[E],N=(0===E?0:p[E-1])+T;S[E]++;for(var O=0;O<f;++O)C[N*f+O]=e[_*f+O];A[N]=r[_],l[_]=N}for(var R=0;R<u;++R){if(0===S[R]){var P=0===R?0:p[R-1];C[P*f+0]=R;for(var D=1;D<f;++D)C[P*f+D]=0;A[P]=o}}return[C,[I,f],A,c,l]}var BU={kernelName:wm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],f=E(UU(s,r.shape,r.dtype,u,a.dtype,c,l),5),h=f[0],d=f[1],p=f[2],v=f[3],g=f[4];return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],a.dtype,p),n.makeTensorInfo([v.length],"bool",new Uint8Array(v.map((function(e){return Number(e)})))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};function WU(e,t,n,r,a){for(var i,o=sp(r),s=t[0],u=a.length,c=[],l=1,f=-1,h=0;h<u;++h){var d=a[h];if(-1===d){if(-1!==f)throw new Error((i=h,"only one output dimension may be -1, not both ".concat(f," and ").concat(i)));f=h,c.push(1)}else{if(d<0)throw new Error(GA(h,d));l*=d,c.push(d)}}if(-1!==f){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");var p=Math.trunc(o/l);if(l*p!==o)throw new Error(function(e,t){var n=sp(e),r=sp(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}(r,c));c[f]=p}if(sp(c)!==o)throw new Error(function(e,t){var n=sp(e),r=sp(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}(r,c));var v=r.length,g=[];if(v>0){g[v-1]=1;for(var m=v-2;m>=0;--m)g[m]=g[m+1]*r[m+1]}var y=[];if(u>0){y[u-1]=1;for(var b=u-2;b>=0;--b)y[b]=y[b+1]*c[b+1]}for(var x=mp(n,s*u),k=0;k<s;++k){for(var w=0,I=0;I<v;++I)w+=e[k*v+I]*g[I];for(var C=0;C<u;++C)x[k*u+C]=Math.trunc(w/y[C]),w%=y[C]}return[x,[s,u],c]}var VU={kernelName:Im,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,u=Array.from(n.data.get(i.dataId).values),c=E(WU(s,r.shape,r.dtype,o,u),3),l=c[0],f=c[1],h=c[2];return[n.makeTensorInfo(f,r.dtype,l),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}};function GU(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=r.length,u=[t[0],e.length/t[0]],c=u[1],l=s>0?a[s-1]+1:0;if(l<0)throw new Error("segment ids must be >= 0");var f=t.slice();f[0]=l;var h=f.reduce((function(e,t){return e*t}),1),d=mp(n,h);if(0===s)return l>0&&d.fill(o),[d,f];if(l<=0)throw new Error("segment ids must be >= 0");for(var p=0,v=1,g=0,m=a[p];;){var y=0;if(v<s){if(m===(y=a[v])){++v;continue}if(m>=y)throw new Error("segment ids are not increasing")}if(m<0||m>=l)throw new Error(HA(m,l));m>g&&d.fill(o,g*c,m*c);for(var b=p;b<v;++b){var x=r[b];if(x<0||x>=u[0])throw new Error(KA(b,r[b],u[0]));for(var k=0;k<c;k++)d[m*c+k]+=e[x*c+k]}if(i)for(var w=0;w<c;w++)d[m*c+w]/=v-p;if(p=v,g=m+1,m=y,++v>s)break}return g<l&&d.fill(o,g*c,l*c),[d,f]}var HU={kernelName:Cm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=E(GU(o,r.shape,r.dtype,s,u,!0),2),l=c[0],f=c[1];return n.makeTensorInfo(f,r.dtype,l)}};var KU={kernelName:Am,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=E(GU(o,r.shape,r.dtype,s,u),2),l=c[0],f=c[1];return n.makeTensorInfo(f,r.dtype,l)}};var qU={kernelName:Sm,backendName:"cpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.sparseIndices,o=n.sparseValues,s=n.defaultValue,u=a.outputShape,c=yA(0,i,u),l=c.sliceRank,f=c.numUpdates,h=c.sliceSize,d=c.strides,p=c.outputSize,v=!1,g=r.bufferSync(i);switch(o.dtype){case"bool":t=wU(g,r.bufferSync(o),u,p,h,f,l,d,Boolean(r.data.get(s.dataId).values[0]),v);break;case"float32":t=wU(g,r.bufferSync(o),u,p,h,f,l,d,r.data.get(s.dataId).values[0],v);break;case"int32":t=wU(g,r.bufferSync(o),u,p,h,f,l,d,r.data.get(s.dataId).values[0],v);break;case"string":t=wU(g,r.bufferSync(o),u,p,h,f,l,d,wy(r.data.get(s.dataId).values[0]),v);break;default:throw new Error("Unsupported type ".concat(o.dtype))}return r.makeTensorInfo(u,t.dtype,t.values)}};var XU={kernelName:xm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=pp(r.axis,a.shape)[0],s=BA(a,i,o),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return s.map((function(e){var t=X(c);t[o]=e;var r=jF({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,r}))}},YU=DM((function(e){return Math.sqrt(e)})),ZU=yM(mm,(function(e){return Math.sqrt(e)})),QU={kernelName:mm,backendName:"cpu",kernelFunc:ZU},JU={kernelName:Em,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;vM(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},$U=SM((function(e,t){var n=e-t;return n*n})),eB=qM(_m,$U),tB={kernelName:_m,backendName:"cpu",kernelFunc:eB},nB=yM(Gm,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),rB={kernelName:Gm,backendName:"cpu",kernelFunc:nB};function aB(e,t,n,r){for(var a=_x(e,t.dtype),i=0;i<a.size;i++){for(var o=a.indexToLoc(i),s=new Array(o.length),u=0;u<s.length;u++)s[u]=o[u]*n[u]+r[u];a.set.apply(a,[t.get.apply(t,s)].concat(X(o)))}return a}var iB={kernelName:Tm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.end,s=r.strides,u=r.beginMask,c=r.endMask,l=r.ellipsisMask,f=r.newAxisMask,h=r.shrinkAxisMask;vM(a,"stridedSlice");var d,p=Hk(a.shape,i,o,s,u,c,l,f,h),v=p.finalShapeSparse,g=p.finalShape,m=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,x=p.begin,k=p.end,w=p.strides;if(m)d=$M({inputs:{x:a},backend:n,attrs:{shape:g}});else if(y||b){ap(a.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(a.shape.length)}));var I=Bk(x,k,w),C=jF({inputs:{x:a},backend:n,attrs:{begin:x,size:I}});d=$M({inputs:{x:C},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(C)}else{var A=aB(v,n.bufferSync(a),w,x);d=n.makeTensorInfo(g,A.dtype,A.values)}return d}},oB=function(){function e(t,n,r,a,i,o){G(this,e),this.separator=ky(t),this.nGramWidths=n,this.leftPad=ky(r),this.rightPad=ky(a),this.padWidth=i,this.preserveShort=o}return q(e,[{key:"getPadWidth",value:function(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}},{key:"getNumNGrams",value:function(e,t){var n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}},{key:"createNGrams",value:function(e,t,n,r,a,i){for(var o=this,s=function(){var s=o.getPadWidth(i),c=Math.max(0,s-u),l=Math.max(0,s-(a-(u+1))),f=i-(c+l),h=t+(c>0?0:u-s),d=0;d+=c*o.leftPad.length;for(var p=0;p<f;++p)d+=e[h+p].length;d+=l*o.rightPad.length,d+=(c+l+f-1)*o.separator.length,n[r+u]=new Uint8Array(d);for(var v=n[r+u],g=0,m=function(e){return e.forEach((function(e){return v[g++]=e}))},y=0;y<c;++y)m(o.leftPad),m(o.separator);for(var b=0;b<f-1;++b)m(e[h+b]),m(o.separator);if(f>0){m(e[h+f-1]);for(var x=0;x<l;++x)m(o.separator),m(o.rightPad)}else{for(var k=0;k<l-1;++k)m(o.rightPad),m(o.separator);m(o.rightPad)}},u=0;u<a;++u)s()}},{key:"compute",value:function(e,t){var n=this,r=e.length,a=t.length;if(a>0){var i=t[0];if(0!==i)throw new Error("First split value must be 0, got ".concat(i));for(var o=1;o<a;++o){var s=t[o]>=i;if(!(s=s&&t[o]<=r))throw new Error("Invalid split value ".concat(t[o],", must be in [").concat(i,", ").concat(r,"]"));i=t[o]}if(i!==r)throw new Error("Last split value must be data size. Expected ".concat(r,", got ").concat(i))}var u=a-1,c=mp("int32",a);if(0===r||0===a){for(var l=new Array(r),f=0;f<=u;++f)c[f]=0;return[l,c]}c[0]=0;for(var h=function(){var e=t[d]-t[d-1],r=0;n.nGramWidths.forEach((function(t){r+=n.getNumNGrams(e,t)})),n.preserveShort&&e>0&&0===r&&(r=1),c[d]=c[d-1]+r},d=1;d<=u;++d)h();for(var p=new Array(c[u]),v=function(r){var a=t[r],i=c[r];if(n.nGramWidths.forEach((function(o){var s=t[r+1]-t[r],u=n.getNumNGrams(s,o);n.createNGrams(e,a,p,i,u,o),i+=u})),n.preserveShort&&i===c[r]){var o=t[r+1]-t[r];if(0===o)return"continue";var s=o+2*n.padWidth;n.createNGrams(e,a,p,i,1,s)}},g=0;g<u;++g)v(g);return[p,c]}}]),e}();function sB(e,t,n,r,a,i,o,s){return new oB(n,r,a,i,o,s).compute(e,t)}var uB={kernelName:Nm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,c=r.preserveShortSequences,l=t.data,f=t.dataSplits,h=E(sB(n.data.get(l.dataId).values,n.data.get(f.dataId).values,a,i,o,s,u,c),2),d=h[0],p=h[1];return[n.makeTensorInfo([d.length],"string",d),n.makeTensorInfo(f.shape,"int32",p)]}};function cB(e,t,n,r){if(e.length)if(0!==t.length)if(1!==t.length){for(var a=0,i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){var o=e.subarray(a,i);n&&0===o.length||r.push(o),a=i+1}}else{for(var s=t[0],u=e.indexOf(s);-1!==u;){var c=e.subarray(0,u);n&&0===c.length||r.push(c),u=(e=e.subarray(u+1)).indexOf(s)}n&&0===e.length||r.push(e)}else for(var l=0;l<e.length;++l)r.push(e.subarray(l,l+1))}function lB(e,t,n){for(var r=e.length,a=[],i=0,o=0,s=new Array(r),u=0;u<r;++u){var c=a.length;cB(e[u],t,n,a);var l=a.length-c;s[u]=l,i+=l,o=Math.max(o,l)}for(var f=mp("int32",2*i),h=new Array(i),d=[r,o],p=0,v=0;v<r;++v)for(var g=0;g<s[v];++g)f[2*p]=v,f[2*p+1]=g,h[p]=a[p],++p;return[f,h,d]}var fB={kernelName:Om,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=E(lB(n.data.get(a.dataId).values,n.data.get(i.dataId).values[0],r),3),s=o[0],u=o[1],c=o[2],l=u.length;return[n.makeTensorInfo([l,2],"int32",s),n.makeTensorInfo([l],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(c))]}};function hB(e,t){for(var n=mp("int32",e.length),r=0;r<e.length;++r)n[r]=my(e[r]).modulo(t).getLowBitsUnsigned();return n}var dB={kernelName:Rm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=hB(n.data.get(a.dataId).values,r);return n.makeTensorInfo(a.shape,"int32",i)}},pB=yM(Dm,(function(e){return Math.tan(e)})),vB={kernelName:Dm,backendName:"cpu",kernelFunc:pB},gB=yM(Mm,(function(e){return Math.tanh(e)}));function mB(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=_x(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=o[u]%e.shape[u];var c=e.locToIndex(s);a.values[i]=e.values[c]}return a}var yB={kernelName:Fm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;vM(a,"tile");var o=mB(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},bB=function(e,t){var n=t.value-e.value;return 0===n?e.index-t.index:n};function xB(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;r>n;){if(r-n>600){var a=r-n+1,i=t-n+1,o=Math.log(a),s=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*s*(a-s)/a)*Math.sign(i-a/2);xB(e,t,Math.max(n,Math.floor(t-i*s/a+u)),Math.min(r,Math.floor(t+(a-i)*s/a+u)))}var c=e[t],l=n,f=r;for(np(e,n,t),bB(e[r],c)>0&&np(e,n,r);l<f;){for(np(e,l,f),l++,f--;bB(e[l],c)<0;)l+=1;for(;bB(e[f],c)>0;)f-=1}0===bB(e[n],c)?np(e,n,f):np(e,f+=1,r),f<=t&&(n=f+1),t<=f&&(r=f-1)}}function kB(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,s=i,u=gp(n,o*r),c=gp("int32",o*r),l=function(){var t=f*s,n=e.subarray(t,t+s),i=new Array(n.length);n.forEach((function(e,t){return i[t]={value:e,index:t}})),r<i.length&&(xB(i,r),i=i.slice(0,r)),a&&i.sort(bB);for(var o=f*r,l=u.subarray(o,o+r),h=c.subarray(o,o+r),d=0;d<r;d++)l[d]=i[d].value,h[d]=i[d].index},f=0;f<o;f++)l();var h=t.slice();return h[h.length-1]=r,[_x(h,n,u),_x(h,"int32",c)]}var wB={kernelName:Lm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted;vM(a,"topk");var s=E(kB(n.data.get(a.dataId).values,a.shape,a.dtype,i,o),2),u=s[0],c=s[1];return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};var IB={kernelName:jm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=t.transforms,o=n.interpolation,s=n.fillMode,u=n.fillValue,c=n.outputShape,l=E(a.shape,4),f=l[0],h=l[1],d=l[2],p=l[3],v=E(null!=c?c:[h,d],2),g=v[0],m=v[1],y=[f,g,m,p],b=Ap(a.shape),x=b[0],k=b[1],w=b[2],I=Ap(y),C=I[0],A=I[1],S=I[2],_=gp(a.dtype,sp(y));_.fill(u);for(var T=r.data.get(a.dataId).values,N=r.data.get(i.dataId).values,O=0;O<f;++O){for(var R=1===i.shape[0]?N:N.subarray(8*O,8*O+8),P=0;P<g;++P)for(var D=0;D<m;++D)for(var M=0;M<p;++M){var F=void 0,L=R[6]*D+R[7]*P+1;if(0!==L){var j=(R[0]*D+R[1]*P+R[2])/L,z=(R[3]*D+R[4]*P+R[5])/L,U=CB(j,d,s),B=CB(z,h,s);switch(o){case"nearest":F=SB(T,h,d,x,k,w,O,B,U,M,u);break;case"bilinear":F=_B(T,h,d,x,k,w,O,B,U,M,u);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(o))}_[O*C+P*A+D*S+M]=F}}return r.makeTensorInfo(y,a.dtype,_)}return{dataId:r.write(_,y,a.dtype),shape:a.shape,dtype:a.dtype}}};function CB(e,t,n){switch(n){case"reflect":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{var a=2*t;(n-=a*Math.trunc(n/a))>=t&&(n=a-n-1)}return ep(0,n,t-1)}(e,t);case"wrap":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{var a=t-1;n-=t*Math.trunc(n/a)}return ep(0,n,t-1)}(e,t);case"nearest":return function(e,t){return ep(0,e,t-1)}(e,t);default:return function(e,t){return e}(e)}}function AB(e,t,n,r,a,i,o,s,u,c,l){return 0<=s&&s<t&&0<=u&&u<n?e[o*r+s*a+u*i+c]:l}function SB(e,t,n,r,a,i,o,s,u,c,l){return AB(e,t,n,r,a,i,o,Math.round(s),Math.round(u),c,l)}function _B(e,t,n,r,a,i,o,s,u,c,l){var f=Math.floor(s),h=Math.floor(u),d=f+1,p=h+1;return(d-s)*((p-u)*AB(e,t,n,r,a,i,o,f,h,c,l)+(u-h)*AB(e,t,n,r,a,i,o,f,p,c,l))+(s-f)*((p-u)*AB(e,t,n,r,a,i,o,d,h,c,l)+(u-h)*AB(e,t,n,r,a,i,o,d,p,c,l))}function EB(e,t,n,r){for(var a=pp(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var s=a+1;s<n.length;s++)i[2]*=n[s];for(var u={},c=new Int32Array(n[a]),l=new My(i,r,e),f=[],h=1===i[0]&&1===i[2],d=0;d<n[a];d++){var p=void 0;if(h)p=e[d].toString();else{for(var v=[],g=0;g<i[0];g++)for(var m=0;m<i[2];m++)v.push(l.get(g,d,m));p=v.join(",")}if(void 0!==u[p])c[d]=u[p];else{var y=Object.keys(u).length;u[p]=y,c[d]=y,f.push(d)}}var b=i.slice();b[1]=Object.keys(u).length;var x=new My(b,r);f.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)x.set(l.get(n,e,r),n,t,r)}));var k=n.slice();return k[a]=b[1],{outputValues:x.values,outputShape:k,indices:c}}var TB={kernelName:Um,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;vM(i,"unique");var o=EB(r.data.get(i.dataId).values,a,i.shape,i.dtype),s=o.outputValues,u=o.outputShape,c=o.indices;return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};var NB={kernelName:Bm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,s=a.shape[i],u=new Array(o-1),c=0,l=0;l<o;l++)l!==i&&(u[c++]=a.shape[l]);var f=new Array(o).fill(0),h=a.shape.slice();h[i]=1;for(var d=new Array(s),p=0;p<d.length;p++){f[i]=p;var v=jF({inputs:{x:a},backend:n,attrs:{begin:f,size:h}});d[p]=$M({inputs:{x:v},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(v)}return d}};for(var OB={kernelName:Wm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments;vM(a,"unsortedSegmentSum");for(var s=[],u=[],c=a.shape.length-i.shape.length,l=i,f=0;f<c;++f){var h=WL({inputs:{input:l},backend:n,attrs:{dim:f+1}});l=h,u.push(h)}for(var d=0;d<o;++d){var p=yy(d,"int32"),v=n.makeTensorInfo([],"int32",p),g=ML({inputs:{a:v,b:l},backend:n}),m=HM({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),y=EL({inputs:{a:m,b:a},backend:n}),b=NL({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});s.push(b),u.push(v),u.push(g),u.push(m),u.push(y),u.push(b)}var x=zz({inputs:s,backend:n,attrs:{axis:0}});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),x}},RB=0,PB=[rF,iF,sF,cF,JM,lF,pF,vF,gF,mF,bF,kF,IF,SF,EF,RF,PF,DF,MF,nF,FF,UF,VF,GF,KM,qF,YF,UM,ZF,tL,rL,aL,iL,oL,sL,uL,lL,hL,dL,pL,vL,gL,mL,bL,xL,kL,wL,IL,CL,AL,RL,kM,PL,FL,jL,BL,VL,KL,rj,ij,oj,cj,hj,dj,pj,gj,yj,kj,Cj,IM,Aj,$F,_j,Tj,Oj,AM,Dj,Lj,zj,Wj,Gj,qj,Yj,Jj,$j,ez,rz,oz,sz,uz,cz,lz,fz,hz,dz,gz,mz,xz,Iz,TL,Az,_z,Tz,Oz,Dz,Mz,jz,Uz,Bz,Gz,TM,Kz,Qz,eU,oU,uU,VM,YL,lU,OM,PM,eF,fU,hU,dU,pU,vU,gU,yU,kU,IU,SU,_U,TU,LM,OU,PU,MU,zF,wz,jU,zU,BU,VU,HU,KU,qU,XU,QU,JU,tB,rB,iB,uB,fB,dB,$L,OL,vB,{kernelName:Mm,backendName:"cpu",kernelFunc:gB},yB,wB,IB,dF,TB,NB,OB,Lz];RB<PB.length;RB++){ty(PB[RB])}var DB,MB,FB,LB={},jB={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function zB(e,t){if(!(e in LB)||null!=t){var n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=null==t?function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e):t;n.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete LB[e]}),!1),jp().getBool("SOFTWARE_WEBGL_ENABLED")&&(jB.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",jB)||n.getContext("experimental-webgl",jB);return n.getContext("webgl2",jB)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;LB[e]=n}var r=LB[e];return null==r||r.isContextLost()?(delete LB[e],zB(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),LB[e])}function UB(e,t){return[t,e]}function BB(e){var t=sp(e);return lp(Math.ceil(t/4))}function WB(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function VB(e,t){var n,r,a,i,o,s,u,c,l,f,h=e;return 2===jp().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,u=4,c=1,l=h.HALF_FLOAT,f=h.FLOAT,s=h.RGBA8):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=h.RGBA,o=e.RGBA,u=4,c=4,l=null!=t?t.HALF_FLOAT_OES:null,f=e.FLOAT,s=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:s,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:l,textureTypeFloat:f}}function GB(e,t){var n=t();return jp().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(DB||(DB={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(MB||(MB={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(FB||(FB={}));var HB=5.96e-8,KB=65504;function qB(e){return!!(jp().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||HB<Math.abs(e)&&Math.abs(e)<KB)}function XB(e,t){return iW(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}var YB,ZB,QB=/ERROR: [0-9]+:([0-9]+):/g;function JB(e,t){var n=QB.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return fp((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),f=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(fp(l[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}function $B(e,t){if(GB(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function eW(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(GB(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),GB(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),GB(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function tW(e,t,n,r){GB(e,(function(){return function(e,t,n){oW(e,n),GB(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),GB(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),GB(e,(function(){return e.uniform1i(n,r)}))}function nW(e,t,n){GB(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),GB(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function rW(e,t){GB(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),GB(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function aW(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function iW(e,t,n){var r=GB(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function oW(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function sW(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return sp(e.slice(0,e.length-t))}function uW(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function cW(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[sW(e)].concat(X(uW(e)))),t}function lW(e){return e%2===0}function fW(e,t){if(up(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(lW(n)&&lW(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&lW(e[0])&&lW(t[0])}function hW(e,t){return null!=e.getExtension(t)}function dW(e){try{if(null!=zB(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function pW(e){if(0===e)return!1;var t=zB(e);if(1!==e){if(hW(t,"EXT_color_buffer_float"))return vW(t);var n="EXT_color_buffer_half_float";if(hW(t,n)){var r=t.getExtension(n);return function(e,t){var n=VB(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!hW(t,"OES_texture_float")&&(!!hW(t,"WEBGL_color_buffer_float")&&vW(t))}function vW(e){var t=VB(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function gW(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&ap("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var mW=jp();function yW(){var e,t,n,r,a,i,o,s,u,c;return 2===jp().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=jp().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function bW(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=Ap(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function xW(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=Ap(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")})).join("")}function kW(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=e.map((function(e,t){return t})),a=function(e,t){var n=e.length,r=e.map((function(e){return"".concat(t,"[").concat(e,"]")})),a=new Array(n-1);a[n-2]=r[n-1];for(var i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}(r,t);return a.map((function(t,r){var i="int ".concat(e[r]," = ").concat(n," / ").concat(a[r]),o=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(a[r]):"index -= ".concat(e[r]," * ").concat(a[r]);return"".concat(i,"; ").concat(o,";")})).join("")}function wW(e){var t=Ap(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}mW.registerFlag("HAS_WEBGL",(function(){return mW.getNumber("WEBGL_VERSION")>0})),mW.registerFlag("WEBGL_VERSION",(function(){return dW(2)?2:dW(1)?1:0})),mW.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),mW.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===mW.get("WEBGL_VERSION")})),mW.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),mW.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),mW.registerFlag("WEBGL_PACK",(function(){return mW.getBool("HAS_WEBGL")})),mW.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_PACK_CLIP",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_PACK_REDUCE",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_CONV_IM2COL",(function(){return mW.getBool("WEBGL_PACK")})),mW.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==YB){var t=zB(e);YB=t.getParameter(t.MAX_TEXTURE_SIZE)}return YB}(mW.getNumber("WEBGL_VERSION"))})),mW.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==ZB){var t=zB(e);ZB=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ZB)}(mW.getNumber("WEBGL_VERSION"))})),mW.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=mW.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=zB(e);return hW(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:hW(t,"EXT_disjoint_timer_query")?1:0}(e)})),mW.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return mW.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!ob()})),mW.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=zB(e);if(1===e){if(!hW(t,"OES_texture_float"))return!1}else if(!hW(t,"EXT_color_buffer_float"))return!1;return vW(t)}(mW.getNumber("WEBGL_VERSION"))})),mW.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!mW.getBool("WEBGL_FORCE_F16_TEXTURES")&&mW.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),mW.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return pW(mW.getNumber("WEBGL_VERSION"))})),mW.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=mW.getNumber("WEBGL_VERSION"))&&null!=zB(e).fenceSync;var e})),mW.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return mW.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),mW.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),mW.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return ob()?1:-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),mW.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128})),mW.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(function(){return!1})),mW.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e5})),mW.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(function(){return 128})),mW.registerFlag("WEBGL_EXP_CONV",(function(){return!1})),mW.registerFlag("SOFTWARE_WEBGL_ENABLED",(function(){return mW.getBool("IS_TEST")})),mW.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(function(){return 1/0})),mW.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(function(){return!1})),mW.registerFlag("WEBGL2_ISNAN_CUSTOM",(function(){return!1})),mW.registerFlag("ENGINE_COMPILE_ONLY",(function(){return!1}));var IW="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",CW=rk;function AW(e,t,n){var r=[];if(e.forEach((function(e){var t=sp(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){switch(MW(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape).uniformShape.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((function(e){r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))}));var a,i,o=r.join("\n"),s=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?_W(e,r):SW(e,r);var i=e.shapeInfo.logicalShape,o=t.logicalShape;i.length<=o.length&&(a+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=CW(e.shapeInfo.logicalShape,t.logicalShape),c=DW(s),l=s-o,f=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords.".concat(f[e+l]," = 0;")})).join("\n");var h="";h=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+l])})).join(", ");var d="return outputValue;",p=1===sp(e.shapeInfo.logicalShape),v=sp(t.logicalShape),g=1===v;if(1!==o||p||g){if(p&&!g)d=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var m=o-2,y=o-1;u.indexOf(m)>-1&&u.indexOf(y)>-1?d="return vec4(outputValue.x);":u.indexOf(m)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(y)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(h,");\n      ").concat(d,"\n    }\n  ")}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&up(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=DW(u),f=CW(e.shapeInfo.logicalShape,t.logicalShape),h=u-s,d=["x","y","z","w","u","v"];c=0===s?"":u<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords.".concat(d[e+h]," = 0;")})).join("\n");var p="";p=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(d[t+h])})).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(p,");\n    }\n  ")}(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms)})).join("\n"),u=t.texShape,c=yW(),l=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c),f=function(e){var t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(EW,"\n    ").concat(TW,"\n    ").concat(NW,"\n  ");return t}(c);return t.isPacked?(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(up(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");var a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";for(var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),o=i,s="",u="b, r, c",c=2;c<e.length-1;c++)o*=e[e.length-c-1],s="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+s,u="b".concat(c,", ")+u;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(u,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,u,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(c)):(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(up(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){var r=xW(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(r,"\n    return ivec3(r, c, d);\n  }\n")}var a=bW(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){var r=xW(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}var a=bW(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){var n=bW(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=bW(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,u,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),n.packedInputs&&(f+=OW),[f,l,i,o,a,s,n.userCode].join("\n")}function SW(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");var a=E(e.shapeInfo.texShape,2),i=a[0],o=a[1];if(1===i&&1===o)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=RW(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var u=E(e.shapeInfo.texShape,2),c=u[0],l=u[1];return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(l,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(PW(e),"\n      }\n    ");var a=e.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=RW(n);if(1===o)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===i)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&up(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var o=i[0],s=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}var u=vp(n),c=u.newShape,l=u.keptDims,f=c;if(f.length<n.length){var h=FW(e,f),d=["row","col"];return"\n      ".concat(SW(h,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(LW(d,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(PW(e),"\n      }\n    ");var p=i[0],v=i[1],g=RW(r);if(1===v)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(p,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===p)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(v,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(t)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(g,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(g,";\n    vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],s=vp(n),u=s.newShape,c=s.keptDims,l=u;if(l.length<n.length){var f=FW(e,l),h=["row","col","depth"];return"\n        ".concat(SW(f,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(LW(h,c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(PW(e),"\n      }\n    ");var d=e.shapeInfo.texShape,p=d[0],v=d[1],g=e.shapeInfo.flatOffset;if(v===i&&null==g)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(v,".0, ").concat(p,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(v===o&&null==g)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(v,".0, ").concat(p,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");var m=RW(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(m,";\n        vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,u=vp(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var f=FW(e,c),h=["row","col","depth","depth2"];return"\n      ".concat(SW(f,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(LW(h,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(PW(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],g=p[1],m="int stride2 = ".concat(r,"Shape[3];"),y="int stride1 = ".concat(r,"Shape[2] * stride2;"),b="int stride0 = ".concat(r,"Shape[1] * stride1;");if(g===s&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(m,"\n        ").concat(y,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(g===i&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var x=RW(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(m,"\n      ").concat(y,"\n      ").concat(b,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(x,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index + ").concat(x,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(e,t);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,u=vp(t),c=u.newShape,l=u.keptDims;if(c.length<t.length){var f=FW(e,c),h=["row","col","depth","depth2","depth3"];return"\n      ".concat(SW(f),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(LW(h,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(PW(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],g=p[1];if(g===s&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===a&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var m=RW(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=vp(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var s=FW(e,i),u=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(SW(s),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(LW(u,o),");\n      }\n    ")}var c=t[5],l=t[4]*c,f=t[3]*l,h=t[2]*f,d=t[1]*h;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(d,", ").concat(h,", ").concat(f,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(PW(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,g=v[0],m=v[1];if(m===d&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(h,", ").concat(f,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===c&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=RW(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(d," + col * ").concat(h," + depth * ").concat(f," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function _W(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=yW();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=yW();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");var o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=i[0],s=i[1],u=yW();if(null!=i&&up(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ");var c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],l=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){var s=[1,2],u=FW(e,n.slice(1)),c=["b","row","col"];return"\n        ".concat(_W(u,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(LW(c,s),");\n        }\n      ")}var l=yW();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");var f=o[0],h=o[1],d=Math.ceil(n[2]/2),p=d*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(f,", ").concat(h,", ").concat(p,", ").concat(d,", b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=yW();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");for(var i=e.shapeInfo.logicalShape,o=i.length,s=e.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=u[0],l=u[1],f=Math.ceil(i[o-1]/2),h=f*Math.ceil(i[o-2]/2),d="int b, int row, int col",p="b * ".concat(h," + (row / 2) * ").concat(f," + (col / 2)"),v=2;v<o-1;v++)d="int b".concat(v,", ")+d,h*=i[o-v-1],p="b".concat(v," * ").concat(h," + ")+p;return"\n    vec4 ".concat(r,"(").concat(d,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}var EW="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",TW="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",NW="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",OW="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function RW(e){return"offset".concat(e)}function PW(e){var t=e.name,n=sp(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function DW(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function MW(e,t,n){var r=vp(t),a=r.newShape,i=r.keptDims,o=t.length,s=e&&3===o&&1===t[0],u=s?t.slice(1):a,c=!e&&o>1&&!up(t,n)&&a.length<o||s;return{useSqueezeShape:c,uniformShape:c?u:t,keptDims:i}}function FW(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function LW(e,t){return t.map((function(t){return e[t]})).join(", ")}function jW(e,t,n,r){var a=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=a.map((function(e){return e.shapeInfo})),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=AW(a,o,t),u=function(e,t){var n=iW(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(GB(e,(function(){return e.shaderSource(n,t)})),GB(e,(function(){return e.compileShader(n)})),jp().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw JB(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,s),c=e.createProgram(u);return jp().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},zW(e,t,c))}function zW(e,t,n){var r,a,i,o,s={},u={},c={},l=[],f=null;o=e.getUniformLocation(n,"NAN",!1),1===jp().getNumber("WEBGL_VERSION")&&(f=e.getUniformLocation(n,"INFINITY",!1));for(var h=!1,d=0;d<t.variableNames.length;d++){var p=t.variableNames[d];s[p]=e.getUniformLocation(n,p,h),s["offset".concat(p)]=e.getUniformLocation(n,"offset".concat(p),h),t.enableShapeUniforms&&(u["".concat(p,"Shape")]=e.getUniformLocation(n,"".concat(p,"Shape"),h),c["".concat(p,"TexShape")]=e.getUniformLocation(n,"".concat(p,"TexShape"),h))}return t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",h),i=e.getUniformLocation(n,"outShapeStrides",h),a=e.getUniformLocation(n,"outTexShape",h)),t.customUniforms&&t.customUniforms.forEach((function(t,r){l[r]=e.getUniformLocation(n,t.name,h)})),{uniformLocations:s,customUniformLocations:l,infLoc:f,nanLoc:o,inShapesLocations:u,inTexShapesLocations:c,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:a}}function UW(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!up(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!up(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))}}))}function BW(e){return jp().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var WW=q((function e(t){G(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=DB.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=yW();this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?xW(["r","c","d"],t):bW(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),VW=q((function e(t){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=DB.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=yW();this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?xW(["r","c","d"],t):bW(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),GW=q((function e(t){G(this,e),this.variableNames=["A"],this.outTexUsage=MB.DOWNLOAD;var n=yW();this.outputShape=t,this.userCode="\n      ".concat(IW,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),HW=q((function e(t){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=MB.DOWNLOAD;var n=yW();this.outputShape=t,this.userCode="\n      ".concat(IW,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),KW={R:0,G:1,B:2,A:3},qW=q((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";G(this,e),this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];var a=yW();this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length);var i="result";n&&(i="floor(result * 255. + 0.5)");for(var o="",s=0;s<r.length;s++){var u=r[s];o+="\n          if(offset == ".concat(s,") {\n            result = values[").concat(KW[u],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":wW(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(r.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(r.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(o,"\n        }\n        ").concat(a.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")})),XW=q((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];G(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];var r=yW();this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length);var a="",i="result";n&&(i="floor(result * 255. + 0.5)");for(var o=0;o<=1;o++)for(var s=0;s<=1;s++){var u=2*o+s;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(s," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(s,";\n          if (localCoords[1] + ").concat(o," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(o,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(r.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(u,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(u,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(u,"] = values[2];\n            } else {\n              result[").concat(u,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":wW(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(r.output," = ").concat(i,";\n        }\n    ")}));function YW(e){var t=yW();return function(e,t){var n=iW(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(GB(e,(function(){return e.shaderSource(n,t)})),GB(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function ZW(e){return function(e,t){var n=iW(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return GB(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),GB(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function QW(e){return function(e,t){var n=iW(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return GB(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),GB(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function JW(e,t,n,r,a,i){!function(e,t){var n=jp().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return iW(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return GB(e,(function(){return e.bindTexture(s,o)})),GB(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),GB(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),GB(e,(function(){return e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)})),GB(e,(function(){return e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)})),1===jp().getNumber("WEBGL_VERSION")?GB(e,(function(){return e.texImage2D(s,0,r,t,n,0,a,i,null)})):GB(e,(function(){return e.texStorage2D(s,1,r,t,n)})),GB(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),{texture:o,texShape:[n,t]}}function $W(e){return e.internalFormatFloat}function eV(e){return e.internalFormatHalfFloat}function tV(e){return e.downloadTextureFormat}function nV(e){return e.internalFormatPackedFloat}function rV(e){return e.internalFormatPackedHalfFloat}function aV(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=E(WB(e,t),2);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}var iV=function(){function e(t){G(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];var n=jp().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function(e,t){LB[e]=t}(n,t)):this.gl=zB(n),t=this.gl,2===jp().getNumber("WEBGL_VERSION")){var r=t;this.createVertexArray=function(){return GB(r,(function(){return r.createVertexArray()}))},this.bindVertexArray=function(e){return GB(r,(function(){return r.bindVertexArray(e)}))},this.deleteVertexArray=function(e){return GB(r,(function(){return r.deleteVertexArray(e)}))},this.getVertexArray=function(){return GB(r,(function(){return r.getParameter(r.VERTEX_ARRAY_BINDING)}))}}else if(null!=t){var a=t.getExtension("OES_vertex_array_object");if(null==a)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=function(){return GB(t,(function(){return a.createVertexArrayOES()}))},this.bindVertexArray=function(e){return GB(t,(function(){return a.bindVertexArrayOES(e)}))},this.deleteVertexArray=function(e){return GB(t,(function(){return a.deleteVertexArrayOES(e)}))},this.getVertexArray=function(){return GB(t,(function(){return t.getParameter(a.VERTEX_ARRAY_BINDING_OES)}))}}var i="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===jp().getNumber("WEBGL_VERSION")){var s="OES_texture_half_float";if(this.textureFloatExtension=XB(this.gl,"OES_texture_float"),hW(this.gl,s))this.textureHalfFloatExtension=XB(this.gl,s);else if(jp().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(i),hW(this.gl,o))this.colorBufferHalfFloatExtension=XB(this.gl,o);else if(jp().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(i="EXT_color_buffer_float",hW(this.gl,i))this.colorBufferFloatExtension=this.gl.getExtension(i);else{if(!hW(this.gl,o))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(o)}this.vertexBuffer=ZW(this.gl),this.indexBuffer=QW(this.gl),this.framebuffer=function(e){return iW(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=VB(this.gl,this.textureHalfFloatExtension)}return q(e,[{key:"debug",get:function(){return jp().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;GB(t,(function(){return t.finish()})),GB(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),GB(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),GB(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),GB(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),GB(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(UB(t,n),2);return JW(e,a[0],a[1],$W(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(UB(t,n),2);return JW(e,a[0],a[1],eV(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(UB(t,n),2);return JW(e,a[0],a[1],tV(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){GB(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?2===jp().getNumber("WEBGL_VERSION")?GB(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)})):GB(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):2===jp().getNumber("WEBGL_VERSION")?GB(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)})):GB(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),GB(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,u;GB(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),2===jp().getNumber("WEBGL_VERSION")?GB(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,o)})):GB(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o)})),GB(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(WB(t,n),2);return JW(e,a[0],a[1],rV(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(WB(t,n),2);return JW(e,a[0],a[1],nV(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(rW(this.gl,this.framebuffer),this.outputTexture=null),GB(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=E(UB(t,n),2),i=a[0],o=a[1],s=new Uint8Array(t*n*4);return GB(e,(function(){return e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return aV(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();GB(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return GB(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),GB(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),GB(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(jp().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return GB(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){var t=this;this.throwIfDisposed();var n=this.gl;null==this.vertexShader&&(this.vertexShader=YW(n));var r,a=function(e){return iW(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(n);return GB(n,(function(){return n.attachShader(a,t.vertexShader)})),GB(n,(function(){return n.attachShader(a,e)})),function(e,t){if(GB(e,(function(){return e.linkProgram(t)})),!jp().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(n,a),r=Object.assign(a,{vao:this.createVertexArray()}),this.bindVertexArray(r.vao),GB(n,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer)})),console.assert(function(e,t,n){return GB(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),eW(e,t,"clipSpacePos",n,3,20,0)&&eW(e,t,"uv",n,2,20,12)}(n,r,this.vertexBuffer),"gpgpu_util.bindVertexProgramAttributeStreams not fully successful."),this.debug&&$B(n,r),this.setProgram(r),r}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(GB(this.gl,(function(){return t.gl.deleteProgram(e)})),this.deleteVertexArray(e.vao))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&(this.bindVertexArray(this.program.vao),this.debug&&$B(this.gl,this.program)),GB(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return iW(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),GB(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),tW(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=E(WB(t,n),2),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&$B(this.gl,this.program),aW(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;if(this.debug){var t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}GB(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),GB(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=XB(this.gl,2===jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=V(B().mark((function e(t){var n=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hp((function(){return n.disposed||n.isQueryAvailable(t,jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)){var r=void 0;"setTimeoutCustom"in jp().platform&&(r=jp().platform.setTimeoutCustom.bind(jp().platform)),hp((function(){return n.pollItems(),0===n.itemsToPoll.length}),(function(){return 0}),null,r)}}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),nW(this.gl,e,this.framebuffer),this.debug&&aW(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(nW(this.gl,this.outputTexture,this.framebuffer),this.debug&&aW(this.gl)):rW(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;nW(r,e,this.framebuffer),this.debug&&aW(r),this.outputTexture=e,GB(r,(function(){return r.viewport(0,0,t,n)})),GB(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),GB(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var oV=YM,sV=BF,uV=WF,cV=GM,lV=HF,fV=QF,hV=DL,dV=zL,pV=GL,vV=sj,gV=vj,mV=mj,yV=bj,bV=wj,xV=Rj,kV=Mj,wV=jj,IV=Uj,CV=tz,AV=az,SV=pz,_V=SL,EV=Cz,TV=Rz,NV=Hz,OV=Zz,RV=$z,PV=iU,DV=sU,MV=bU,FV=wU,LV=MM,jV=aF,zV=LF,UV=UU,BV=WU,WV=GU,VV=YU,GV=aB,HV=sB,KV=lB,qV=hB,XV=ZL,YV=mB,ZV=kB,QV=fF,JV=EB;function $V(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function eG(e,t){return 1===t?[e]:$V(e,t)}var tG=function(){function e(t){if(G(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=BW(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=eG("rc",this.rank),r=DW(this.rank),a=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode="\n        void main() {\n          ".concat(r," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}return q(e,[{key:"getSourceCoordsArr",value:function(e){for(var t=[],n=0;n<=1;n++)for(var r=0;r<=1;r++){for(var a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1"),i=2;i<this.rank;i++)a="".concat(e[e.length-1-i],",")+a;t.push(a)}return t}},{key:"getOutOfBoundsCondition",value:function(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);for(var t="",n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}},{key:"getSetup",value:function(e){if(1===this.rank)return"";var t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}},{key:"getOutput",value:function(e){var t=this.getSourceCoordsArr(e);if(1===this.rank){var n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}]),e}(),nG=q((function e(t,n){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length);for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){var n=t?kW(["r","c","d"],"inputShape"):bW(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(n,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":wW(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var rG=function(){function e(t){G(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return q(e,[{key:"acquireTexture",value:function(e,t,n){var r=iG(t,n),a=oG(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=aG(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return r===FB.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===FB.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===FB.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===FB.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===FB.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=iG(n,r),i=oG(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=aG(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=jp().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var u=this.usedTextures[i],c=u.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function aG(e,t,n,r,a){var i,o=function(e,t){switch(e){case FB.PACKED_2X2_FLOAT32:return nV(t);case FB.PACKED_2X2_FLOAT16:return rV(t);case FB.UNPACKED_FLOAT32:return $W(t);case FB.UNPACKED_FLOAT16:return eV(t);case FB.PACKED_4X1_UNSIGNED_BYTE:return tV(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var s=E(WB(e[0],e[1]),2);i=s[0]*s[1]}else{var u=E(UB(e[0],e[1]),2);i=u[0]*u[1]}var c=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*c}function iG(e,t){if(e===MB.UPLOAD)return FB.PACKED_2X2_FLOAT32;if(e===MB.RENDER||null==e)return function(e){return jp().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?FB.PACKED_2X2_FLOAT32:FB.UNPACKED_FLOAT32:e?FB.PACKED_2X2_FLOAT16:FB.UNPACKED_FLOAT16}(t);if(e===MB.DOWNLOAD||e===MB.PIXELS)return FB.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function oG(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var sG=q((function e(t,n){G(this,e),this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),uG="if (isnan(x)) return x;",cG="return x;",lG="return abs(x);";var fG="return (x >= 0.0) ? x : (exp(x) - 1.0);",hG=uG+"\n  return (x < 0.0) ? 0.0 : x;\n",dG=uG+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",pG="return x;",vG="return 1.0 / (1.0 + exp(-1.0 * x));",gG="return x;",mG="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",yG="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",bG="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",xG="return 1.0 / (1.0 + exp(-1.0 * x));",kG=q((function e(t,n){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),wG=q((function e(t){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length);var n=t.length,r=eG("rc",n),a=DW(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")})),IG=YA,CG={};var AG=jp().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),SG=600;var _G=function(e){F(n,e);var t=z(n);function n(e){var r,a,i;if(G(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!jp().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null!=e){if(e instanceof iV)a=e;else{var o=zB(jp().getNumber("WEBGL_VERSION"),e);a=new iV(o)}r.binaryCache={},r.gpgpuCreatedLocally=!1}else{var s=zB(jp().getNumber("WEBGL_VERSION"));a=new iV(s),r.binaryCache=((i=jp().getNumber("WEBGL_VERSION"))in CG||(CG[i]={}),CG[i]),r.gpgpuCreatedLocally=!0}return r.gpgpu=a,r.canvas=r.gpgpu.gl.canvas,r.textureManager=new rG(r.gpgpu),r.numMBBeforeWarning=null==jp().global.screen?1024:jp().global.screen.height*jp().global.screen.width*window.devicePixelRatio*SG/1024/1024,r.texData=new Zd(D(r),Ox()),r}return q(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"writeTexture",value:function(e,t,n,r,a,i){var o=this.makeTensorInfo(t,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,a]},s.texShape=[r,a];var u=cW(t),c=new qW(u,!1,i),l=this.runWebGLProgram(c,[o],n,[[r,a]]);return l.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId}},{key:"write",value:function(e,t,n){if((jp().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||jp().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:MB.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){if(jp().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:MB.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new kG(o,pG):new sG(o,pG);var c=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,h,d=null!=this.activeTimers;(d&&(f=xy()),"complex64"===r)?h=_A(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):h=this.getValuesFromTexture(e);return d&&(this.downloadWaitMs+=xy()-f),this.convertAndCacheOnCPU(e,h)}},{key:"read",value:function(){var e=V(B().mark((function e(t){var n,r,a,i,o,s,u,c,l,f,h,d,p,v,g,m,y,b,x,k,w,I,C;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,o=r.slice,s=r.dtype,u=r.complexTensorInfos,c=r.isPacked,null==o){e.next=11;break}return l=c?new kG(i,pG):new sG(i,pG),f=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:s}],s),h=this.read(f.dataId),this.disposeIntermediateTensorInfo(f),e.abrupt("return",h);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(!jp().getBool("DEBUG")){e.next=16;break}if(jp().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==jp().getNumber("WEBGL_VERSION")){e.next=16;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 16:if(d=null,"complex64"!==s&&jp().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(t),g=this.texData.get(p.dataId),d=(v=this.gpgpu).createBufferFromTexture.apply(v,[g.texture.texture].concat(X(BB(i))))),this.pendingRead.set(t,[]),"complex64"===s){e.next=22;break}return e.next=22,this.gpgpu.createAndWaitForFence();case 22:if("complex64"!==s){e.next=31;break}return e.next=25,Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]);case 25:y=e.sent,b=y[0],x=y[1],m=_A(b,x),e.next=32;break;case 31:null==d?m=this.getValuesFromTexture(t):(k=sp(i),m=this.gpgpu.downloadFloat32MatrixFromBuffer(d,k));case 32:return null!=p&&this.disposeIntermediateTensorInfo(p),null!=d&&GB(w=this.gpgpu.gl,(function(){return w.deleteBuffer(d)})),I=this.convertAndCacheOnCPU(t,m),C=this.pendingRead.get(t),this.pendingRead.delete(t),C.forEach((function(e){return e(I)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Ox().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",I);case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readToGPU",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,s=n.isPacked,u=n.texture;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){var c;c=s?new kG(a,pG):new sG(a,pG);var l=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),f=this.readToGPU(l,t);return this.disposeIntermediateTensorInfo(l),f}if(null==u)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");var h=this.decode(e,t.customTexShape),d=Ox().makeTensorFromTensorInfo(h),p=this.texData.get(h.dataId);return Object.assign({tensorRef:d},p.texture)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return wy(e)}));return _x(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return _x(e.shape,e.dtype,t)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!qB(n)){if(jp().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=sp(n);if(jp().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,s=this.decode(e),u=this.texData.get(s.dataId),c=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[u.texture.texture].concat(X(BB(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(s),c}var l=jp().getBool("WEBGL_PACK")&&!0===a,f=l?cW(n):n,h=l?new HW(f):new GW(f),d=this.runWebGLProgram(h,[{shape:f,dtype:r,dataId:e}],"float32"),p=this.texData.get(d.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture.texture,p.texShape[0],p.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(d),v}},{key:"timerAvailable",value:function(){return jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(e){var t=this,n=this.activeTimers,r=[],a=!1;null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();var i=Cy(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=Cy(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e}));this.activeTimers=n,a&&(this.programTimersStack=null);var s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return V(B().mark((function e(){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=8;break}return e.next=3,Promise.all(i);case 3:n=e.sent,s.kernelMs=rp(n),s.getExtraProfileInfo=function(){return n.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=9;break;case 8:s.kernelMs={error:"WebGL query timers are not supported in this environment."};case 9:return t.uploadWaitMs=0,t.downloadWaitMs=0,e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})))()}},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:xy(),endMs:null}}},{key:"endTimer",value:function(e){return jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=xy(),e)}},{key:"getQueryTime",value:function(){var e=V(B().mark((function e(t){var n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(jp().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e).complexTensorInfos;return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AG;return jp().getBool("WEBGL_CPU_FORWARD")&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&sp(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){Ym("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return IG(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new kG(e.shape,t),a=this.compileAndRun(r,[e],n);return Ox().makeTensorFromTensorInfo(a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=jV(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(jp().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,lG,e.dtype);var n=new sG(e.shape,lG),r=this.compileAndRun(n,[e]);return Ox().makeTensorFromTensorInfo(r)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&xp(n[0])){var a=n.map((function(e){return ky(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){return Ox().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}},{key:"unpackTensor",value:function(e){var t=new wG(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new tG(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[sW(e.shape)].concat(X(uW(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[sW(t)].concat(X(uW(t))),i=new nG(a,n),o=[n],s=this.runWebGLProgram(i,[r],e.dtype,o,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}},{key:"decode",value:function(e,t){var n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype;null!=t&&ap(sp(a)<=t[0]*t[1]*4,(function(){return"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."}));var o,s=cW(a);o=r?new VW(s):new WW(s);var u=[null!=t?t:BB(s)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(o,[{shape:s,dtype:i,dataId:e}],i,u,!0,t).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(s.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===DB.DENSE){var c=null!=o?o:BB(e.outputShape);u.texShape=c.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===sp(s.shape))return u.values=gp(s.dtype,0),s;var l=[],f=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&sp(t.shape)<=jp().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(a.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),l.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!fW(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),l.push(t),n=a.texData.get(t.dataId),r.shape=i}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);var h,d={shape:s.shape,texData:u,isUniform:!1},p=function(e,t,n){var r="";t.concat(n).forEach((function(t){var a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){var i=t.texData.texShape,o=MW(e.packedInputs,t.shape,i),s=o.useSqueezeShape,u=o.uniformShape,c=o.keptDims,l="",f="",h="";if(1===u.length&&e.packedInputs){var d=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];l="".concat(d[0]>1,"_").concat(d[1]>1)}else if(2!==u.length||e.packedInputs){if(u.length>2&&!e.packedInputs){var p=Ap(u);h="".concat(p[0]===i[1],"_").concat(p[p.length-1]===i[1])}}else f="".concat(u[0]>1,"_").concat(u[1]>1);var v=t.shape.length,g=2===u.length&&up(t.shape,i),m=1===sp(t.shape),y=rk(t.shape,n.shape),b=!e.packedInputs&&v===n.shape.length&&up(i,n.texData.texShape),x=e.packedInputs||u.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(v,"_").concat(b,"_").concat(s?c:"","_").concat(u.length,"_").concat(m,"_").concat(y,"_").concat(g,"_").concat(l,"_").concat(f,"_").concat(h,"_").concat(x,"_").concat(a)}else{var k=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(k,"_").concat(a)}}));var a=e.userCode,i=e.constructor.name;return i+"_"+r+"_"+a+"".concat(jp().getNumber("WEBGL_VERSION"))}(e,f,d),v=this.getAndSaveBinary(p,(function(){return jW(a.gpgpu,e,f,d)})),g=null!=this.activeTimers;g&&(h=this.startTimer()),jp().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(UW(t.inShapeInfos,n),UW([t.outShapeInfo],[r]));var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),1===jp().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset".concat(a)],s=t.inShapesLocations["".concat(a,"Shape")],u=t.inTexShapesLocations["".concat(a,"TexShape")];if(s){var c=MW(t.program.packedInputs,n.shape,n.texData.texShape).uniformShape;switch(c.length){case 1:e.gl.uniform1iv(s,new Int32Array(c));break;case 2:e.gl.uniform2iv(s,new Int32Array(c));break;case 3:e.gl.uniform3iv(s,new Int32Array(c));break;case 4:e.gl.uniform4iv(s,new Int32Array(c))}}if(u&&e.gl.uniform2i(u,n.texData.texShape[0],n.texData.texShape[1]),null!=i)if(n.isUniform)if(sp(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var l=n.uniformValues;l instanceof Float32Array||(l=new Float32Array(l)),e.gl.uniform1fv(i,l)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture.texture,i,r)}));var s=t.outShapeLocation;if(s)switch(r.shape.length){case 1:e.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(s,new Int32Array(r.shape))}if(t.outShapeStridesLocation){var u=Ap(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(u));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(u));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(u))}}t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a&&t.program.customUniforms.forEach((function(n,r){var i=t.customUniformLocations[r],o=a[r];if("float"===n.type)e.gl.uniform1fv(i,o);else if("vec2"===n.type)e.gl.uniform2fv(i,o);else if("vec3"===n.type)e.gl.uniform3fv(i,o);else if("vec4"===n.type)e.gl.uniform4fv(i,o);else if("int"===n.type)e.gl.uniform1iv(i,o);else if("ivec2"===n.type)e.gl.uniform2iv(i,o);else if("ivec3"===n.type)e.gl.uniform3iv(i,o);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(i,o)}})),e.executeProgram()}(this.gpgpu,v,f,d,r),l.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),g&&(h=this.endTimer(h),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(h)}));var m=jp().get("WEBGL_FLUSH_THRESHOLD");if(m>0){var y=xy();y-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!jp().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===i){var b=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),b}return s}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,a)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!jp().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Px((function(){if(!jp().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=jp().getBool("DEBUG");jp().set("DEBUG",!1);var n=e.abs(Hx(1e-8)).dataSync()[0];if(jp().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,s=t.isPacked;if(null==i){var u,c=null!=this.activeTimers;c&&(u=xy());var l=t.texShape;if(null==l&&(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=jp().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=jp().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&jp().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,e=e.map((function(t,n){return n>=e.length-2?tp(e[n]):e[n]})),1===e.length&&(e=[2,e[0]])),2!==e.length){var a=vp(e);e=a.newShape}var i=sp(e),o=null;e.length<=1&&i<=n?o=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?o=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);var s=null!=o&&Math.max.apply(Math,X(o))>r&&Math.min.apply(Math,X(o))<=(t?2:1)&&Math.min.apply(Math,X(o))>0;if(null==o||s)if(t){var u=sW(e),c=2,l=2;if(e.length){var f=E(uW(e),2);c=f[0],l=f[1]}o=lp(i=u*(c/2)*(l/2)).map((function(e){return 2*e}))}else o=lp(i);return o}(n,s),t.texShape=l),null!=a){var f,h=cW(n),d=l[1],p=l[0],v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;if(s||!v){var g=E(WB(l[0],l[1]),2);d=g[0],p=g[1]}f=s?new XW(h,v):new qW(h,v);var m=v?[p,d]:l,y=this.makeTensorInfo(m,r),b=this.texData.get(y.dataId);b.usage=v?MB.PIXELS:MB.UPLOAD,b.texShape=m,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),d,p,a);var x=[[p,d]],k=this.runWebGLProgram(f,[y],r,x,!0),w=this.texData.get(k.dataId);t.texShape=w.texShape,t.isPacked=w.isPacked,t.usage=w.usage,jp().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(t.texture=w.texture,t.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=xy()-u)}else{var I=this.acquireTexture(l,o,r,s);t.texture=I}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*bp(t)}},{key:"checkCompileCompletion",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=E(t[e],2)[1];this.checkCompletion_(n)}}},{key:"checkCompileCompletionAsync",value:function(){var e=V(B().mark((function e(){var t,n,r,a,i,o,s,u,c=this;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.gpgpu.parallelCompilationExtension){e.next=6;break}for(n=0,r=Object.entries(this.binaryCache);n<r.length;n++)a=E(r[n],2),i=a[1],t.push(this.checkCompletionAsync_(i));return e.abrupt("return",Promise.all(t));case 6:o=B().mark((function e(){var n,r,a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=E(u[s],2),r=n[1],a=new Promise((function(e){try{c.checkCompletion_(r),e(!0)}catch(bu){throw bu}})),t.push(a);case 3:case"end":return e.stop()}}),e)})),s=0,u=Object.entries(this.binaryCache);case 8:if(!(s<u.length)){e.next=13;break}return e.delegateYield(o(),"t0",10);case 10:s++,e.next=8;break;case 13:return e.abrupt("return",Promise.all(t));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkCompletionAsync_",value:function(){var e=V(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)){e.next=4;break}return e.abrupt("return",this.checkCompletion_(t));case 4:return e.next=6,oA();case 6:return e.abrupt("return",this.checkCompletionAsync_(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkCompletion_",value:function(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw JB(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}},{key:"getUniformLocations",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=E(t[e],2)[1],r=zW(this.gpgpu,n.program,n.webGLProgram),a=r.uniformLocations,i=r.customUniformLocations,o=r.infLoc,s=r.nanLoc,u=r.inShapesLocations,c=r.inTexShapesLocations,l=r.outShapeLocation,f=r.outShapeStridesLocation,h=r.outTexShapeLocation;n.uniformLocations=a,n.customUniformLocations=i,n.infLoc=o,n.nanLoc=s,n.inShapesLocations=u,n.inTexShapesLocations=c,n.outShapeLocation=l,n.outShapeStridesLocation=f,n.outTexShapeLocation=h}}},{key:"createTensorFromGPUData",value:function(e,t,n){e.channels=e.channels||"RGBA";var r=e.texture,a=e.height,i=e.width,o=e.channels,s=Ox().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");var u=s.writeTexture(r,t,n,a,i,o);return Ox().makeTensorFromDataId(u,t,n,s)}}]),n}(Qd);_G.nextDataId=0;sb()&&Fx("webgl",(function(){return new _G}),2);var EG="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",TG=q((function e(t,n,r){G(this,e),this.variableNames=["A","B"],this.outputShape=ik(n,r),this.enableShapeUniforms=BW(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),NG="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",OG=q((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];G(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ik(n,r);var i=this.outputShape.length;this.enableShapeUniforms=BW(i);var o="";if(a)if(0===i||1===sp(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var s=DW(i);if(o="\n          ".concat(s," coords = getOutputCoords();\n        "),1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=eG("coords",i);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= outShape[").concat(i," - 2];\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= outShape[").concat(i," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}));function RG(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var PG={kernelName:ng,backendName:"webgl",kernelFunc:RG};function DG(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=RG({inputs:{x:r},backend:n}),u=RG({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}var MG={kernelName:pv,backendName:"webgl",kernelFunc:DG},FG="return (a < 0.) ? b * a : a;",LG="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var jG={kernelName:ug,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",yy(i,"float32")),s=jp().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new OG(LG,a.shape,o.shape):new TG(FG,a.shape,o.shape),u=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),u}},zG="return (a < 0.) ? b * a : a;",UG="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var BG={kernelName:Vg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=jp().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new OG(UG,r.shape,a.shape):new TG(zG,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},WG="if (isnan(x)) return x;";function VG(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,s=e.backend,u=o.x,c=s,l=a||u.dtype;if(c.shouldExecuteOnCPU([u])&&null!=r){var f=c.texData.get(u.dataId),h=r(f.values,l);return c.makeTensorInfo(u.shape,l,h)}return i=jp().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new kG(u.shape,n):new sG(u.shape,t),c.runWebGLProgram(i,[u],l)}}function GG(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,o=void 0!==i&&i,s=e.cpuKernelImpl,u=e.dtype;return function(e){var r=e.inputs,i=e.backend,c=r.a,l=r.b,f=i;if(o&&"complex64"===c.dtype){var h=f.texData.get(c.dataId),d=f.texData.get(l.dataId),p=[[h.complexTensorInfos.real,d.complexTensorInfos.real],[h.complexTensorInfos.imag,d.complexTensorInfos.imag]].map((function(e){var n=E(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o={dataId:a.dataId,dtype:a.dtype,shape:l.shape},s=new TG(t,c.shape,l.shape);return f.runWebGLProgram(s,[i,o],qy(r.dtype,a.dtype))})),v=E(p,2),g=v[0],m=v[1],y=DG({inputs:{real:g,imag:m},backend:f});return f.disposeIntermediateTensorInfo(g),f.disposeIntermediateTensorInfo(m),y}var b,x=u||qy(c.dtype,l.dtype);if(("string"===c.dtype||"string"===l.dtype||f.shouldExecuteOnCPU([c,l]))&&null!=s){var k=f.texData.get(c.dataId).values,w=f.texData.get(l.dataId).values,I="string"===c.dtype?XA(k):k,C="string"===c.dtype?XA(w):w,A=E(s(c.shape,l.shape,I,C,x),2),S=A[0],_=A[1],T=f.makeTensorInfo(_,x);return f.texData.get(T.dataId).values=S,T}return b=jp().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new OG(n,c.shape,l.shape,a):new TG(t,c.shape,l.shape),f.runWebGLProgram(b,[c,l],x)}}function HG(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?gG:cG;if("relu"===e)return t?yG:hG;if("elu"===e)return t?mG:fG;if("relu6"===e)return t?bG:dG;if("prelu"===e)return t?UG:zG;if("leakyrelu"===e)return t?LG:FG;if("sigmoid"===e)return t?xG:vG;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var KG=q((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];G(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=BW(this.outputShape.length);var l=a?t[1]:t[2],f=Math.ceil(l/2),h=a?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",p=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",m="";s&&(g=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),m="result = activation(result);");var y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");var b="rc.x",x="rc.x";t[0]<n[0]?b="imod(rc.x, ".concat(t[0],")"):n[0]<t[0]&&(x="imod(rc.x, ".concat(n[0],")")),this.userCode="\n      ".concat(g,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(f,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(x,";\n        for (int i = 0; i < ").concat(f,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(v[0],");\n          result += (").concat(p[1]," * ").concat(v[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(m,"\n\n        setOutput(result);\n      }\n    ")})),qG={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},XG=q((function e(t,n,r){G(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ik(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),YG="return a * b;";function ZG(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=qy(a.dtype,i.dtype);if("complex64"===a.dtype){var s=r.texData.get(a.dataId),u=r.texData.get(i.dataId),c=new XG(qG.REAL,a.shape,i.shape),l=new XG(qG.IMAG,a.shape,i.shape),f=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:a.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],h=r.runWebGLProgram(c,f,"float32"),d=r.runWebGLProgram(l,f,"float32"),p=DG({inputs:{real:h,imag:d},backend:r});return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(d),p}if(r.shouldExecuteOnCPU([a,i])){var v=r.texData.get(a.dataId),g=r.texData.get(i.dataId),m=E(_V(a.shape,i.shape,v.values,g.values,o),2),y=m[0],b=m[1],x=r.makeTensorInfo(b,o);return r.texData.get(x.dataId).values=y,x}return t=jp().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new OG(YG,a.shape,i.shape):new TG(YG,a.shape,i.shape),r.runWebGLProgram(t,[a,i],o)}var QG={kernelName:Rg,backendName:"webgl",kernelFunc:ZG};function JG(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=n,s=sp(a.shape),u=dp(i,s),c=sp(u);ap(s===c,(function(){return"The new shape (".concat(u,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."}));var l=o.texData.get(a.dataId);return!l.isPacked||fW(a.shape,u)||null!==l.texture&&fW(l.shape,u)?(o.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){var r=[sW(e.shape)].concat(X(uW(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[sW(t)].concat(X(uW(t))),o=new nG(i,r),s=[r],u=n.runWebGLProgram(o,[a],e.dtype,s,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(a,u,o)}var $G={kernelName:Jg,backendName:"webgl",kernelFunc:JG},eH=q((function e(t,n){G(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s=4*Math.floor(r/4),u=r%4,c="sumValue += dot(values, ones);";if(null!=n){var l=1/n;c="sumValue += dot(values * ".concat(cp(l)?l.toPrecision(2):l,", ones);")}var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")})),tH=q((function e(t,n){G(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),f=r%4,h="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n        if (").concat("min"===n," || ").concat("max"===n,") {\n          minMaxValue = ").concat(u,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),d="vec4";"all"===n?(s="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===n&&(s="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}));function nH(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=lA(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var s,u=a[o],c=u.inSize,l=u.windowSize,f=u.outSize,h=void 0;h="mean"===n?0===o?new eH({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f},c):new eH({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f}):new tH({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f},n),s=i,i=r.runWebGLProgram(h,[i],t),s.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(s)}return i}var rH=q((function e(t,n){G(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=DW(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}));var aH=q((function e(t,n){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=DW(this.rank),o=$V("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var c="vec2(".concat(s.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),f="getChannel(getA(".concat(s.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(f,";\n      if(").concat(l,") {\n        result[1] = ").concat(f,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(f,";\n        if(").concat(l,") {\n          result[3] = ").concat(f,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function iH(e,t,n){var r=jp().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aH(e.shape,t):new rH(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function oH(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,i=e.shape.length,o=pp(a,e.shape),s=o,u=sI(s,i),c=null!=u,l=e;c&&(l=iH(e,u,r),s=cI(s.length,i)),oI("sum",s,i);var f=E(aI(l.shape,s),2),h=f[0],d=f[1],p=h;n&&(p=iI(h,o));var v=sp(d),g=JG({inputs:{x:l},attrs:{shape:[sp(e.shape)/v,v]},backend:r}),m=nH(g,Xy(e.dtype),"sum",r),y=JG({inputs:{x:m},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(m),c&&r.disposeIntermediateTensorInfo(l),y}(t.x,r.axis,r.keepDims,n)}var sH={kernelName:ym,backendName:"webgl",kernelFunc:oH};function uH(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var f=s.texData.get(i.dataId).values,h=QV(f,i.shape,i.dtype,o,c);t=s.makeTensorInfo(c,i.dtype),s.texData.get(t.dataId).values=h}else t=iH(i,o,s);return t}var cH={kernelName:zm,backendName:"webgl",kernelFunc:uH},lH=1e3;function fH(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,f=void 0===l?0:l,h=e.activation,d=void 0===h?null:h,p=t.shape.length,v=n.shape.length,g=r?t.shape[p-2]:t.shape[p-1],m=a?n.shape[v-1]:n.shape[v-2],y=r?t.shape[p-1]:t.shape[p-2],b=a?n.shape[v-2]:n.shape[v-1],x=t.shape.slice(0,-2),k=n.shape.slice(0,-2),w=sp(x),I=sp(k),C=ik(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([y,b]);ap(g===m,(function(){return"Error in matMul: inner shapes (".concat(g,") and (")+"".concat(m,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var A,S=r?[w,g,y]:[w,y,g],_=a?[I,b,m]:[I,m,b],E=JG({inputs:{x:t},backend:i,attrs:{shape:S}}),T=JG({inputs:{x:n},backend:i,attrs:{shape:_}}),N=[E,T],O=Math.max(w,I),R=r?E.shape[1]:E.shape[2],P=null!=s,D=null!=c,M="leakyrelu"===d,F=null!=d?HG(d,!0):null;if((1===y||1===b)&&R>lH&&!1===(P||D||M||null!=F)){var L=E,j=T;r&&(L=uH({inputs:{x:E},backend:i,attrs:{perm:[0,2,1]}}),N.push(L)),a&&(j=uH({inputs:{x:T},backend:i,attrs:{perm:[0,2,1]}}),N.push(j));var z=1===b,U=L;1!==b&&(U=JG({inputs:{x:L},backend:i,attrs:{shape:[O,R,1]}}),N.push(U));var B=1===b?2:1,W=j;z&&(W=JG({inputs:{x:j},backend:i,attrs:{shape:[O,1,R]}}),N.push(W));var V=ZG({inputs:{a:U,b:W},backend:i});A=oH({inputs:{x:V},backend:i,attrs:{axis:B,keepDims:!0}}),N.push(V)}else{var G=qy(t.dtype,n.dtype),H=new KG(S,_,[O,y,b],r,a,P,F,D,M),K=[E,T];if(null!=s&&K.push(s),D&&K.push(c),M){var q=i.makeTensorInfo([],"float32",yy(f,"float32"));K.push(q),N.push(q)}A=i.runWebGLProgram(H,K,G)}var X=JG({inputs:{x:A},backend:i,attrs:{shape:C}});N.push(A);for(var Y=0,Z=N;Y<Z.length;Y++){var Q=Z[Y];i.disposeIntermediateTensorInfo(Q)}return X}var hH={kernelName:Km,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return fH({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},dH="return abs(x);";var pH={kernelName:Vp,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=jV(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=jp().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new kG(a.shape,dH):new sG(a.shape,dH),r.runWebGLProgram(t,[a],a.dtype)}},vH=VG({opSnippet:uG+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),gH={kernelName:Gp,backendName:"webgl",kernelFunc:vH},mH=VG({opSnippet:uG+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),yH={kernelName:Hp,backendName:"webgl",kernelFunc:mH},bH="return a + b;",xH=GG({opSnippet:bH,packedOpSnippet:bH,supportsComplex:!0,cpuKernelImpl:oV}),kH={kernelName:Kp,backendName:"webgl",kernelFunc:xH},wH=q((function e(t,n){G(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),IH=q((function e(t,n){G(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}));var CH={kernelName:qp,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return RG({inputs:{x:a[0]},backend:r});if(a.length>jp().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),s=e({inputs:a.slice(i),backend:r});return e({inputs:[o,s],backend:r})}var u=a.map((function(e){return e.dtype})).reduce((function(e,t){return qy(e,t)})),c=a.map((function(e){return e.shape})),l=jp().getBool("WEBGL_PACK")?new IH(a[0].shape,c):new wH(a[0].shape,c);return r.runWebGLProgram(l,a,u)}};var AH={kernelName:Xp,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=pp(i,a.shape),c=u,l=sI(c,s),f=a;null!=l&&(f=uH({inputs:{x:a},backend:n,attrs:{perm:l}}),c=cI(c.length,s)),oI("all",c,s);var h,d=E(aI(f.shape,c),2),p=d[0],v=JG({inputs:{x:f},backend:n,attrs:{shape:[-1,sp(d[1])]}}),g=nH(v,v.dtype,"all",n);return h=JG(o?{inputs:{x:g},backend:n,attrs:{shape:iI(p,u)}}:{inputs:{x:g},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(f),h}};var SH={kernelName:Yp,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=pp(i,a.shape),c=u,l=sI(c,s),f=a;null!=l&&(f=uH({inputs:{x:a},backend:n,attrs:{perm:l}}),c=cI(c.length,s)),oI("any",c,s);var h,d=E(aI(f.shape,c),2),p=d[0],v=JG({inputs:{x:f},backend:n,attrs:{shape:[-1,sp(d[1])]}}),g=nH(v,v.dtype,"any",n);return h=JG(o?{inputs:{x:g},backend:n,attrs:{shape:iI(p,u)}}:{inputs:{x:g},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(f),h}},_H=q((function e(t,n,r){G(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===n?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")})),EH=q((function e(t,n,r,a){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ap(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var s,u,c=this.outputShape,l=c.length,f=DW(l),h=eG("coords",l);if(1===o){var d=DW(u=l+1);s="\n        ".concat(d," sourceLocR = ").concat(d,"(").concat(h.join(),", 0);\n        ++").concat(h[l-1],";\n        ").concat(d," sourceLocG = ").concat(d,"(").concat(h.join(),", 0);\n        ++").concat(h[l-2],";\n        ").concat(d," sourceLocA = ").concat(d,"(").concat(h.join(),", 0);\n        --").concat(h[l-1],";\n        ").concat(d," sourceLocB = ").concat(d,"(").concat(h.join(),", 0);\n        --").concat(h[l-2],";")}else u=l,s="\n        ".concat(f," sourceLocR = coords;\n        ++").concat(h[l-1],";\n        ").concat(f," sourceLocG = coords;\n        ++").concat(h[l-2],";\n        ").concat(f," sourceLocA = coords;\n        --").concat(h[l-1],";\n        ").concat(f," sourceLocB = coords;\n        --").concat(h[l-2],";");var p=["x","y","z","w","u","v"].slice(0,u),v="."+p[u-1],g=p.map((function(e){return"int "+e})),m=eG("sourceLocR",u-1).concat("inIdx.r"),y=eG("sourceLocG",u-1).concat("inIdx.g"),b=eG("sourceLocB",u-1).concat("inIdx.b"),x=eG("sourceLocA",u-1).concat("inIdx.a"),k="max"===r?"greaterThan":"lessThan",w=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),I="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),C=a?"":"\n      float getBestIndicesAChannel(".concat(g.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(g.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat(C,"\n      void main() {\n        ").concat(f," coords = getOutputCoords();\n        bool hasNextCol = ").concat(h[l-1]," < ").concat(c[l-1]-1,";\n        bool hasNextRow = ").concat(h[l-2]," < ").concat(c[l-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(v,", sourceLocG").concat(v,",\n          sourceLocB").concat(v,", sourceLocA").concat(v,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(I,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(I,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(k,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}));function TH(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var o=lA(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},u=new _H(s,n,null==r),c=[t];null!=r&&c.push(r);var l=e.runWebGLProgram(u,c,"int32");if(1===l.shape[1])return l;var f=TH(e,t,n,l);return e.disposeIntermediateTensorInfo(l),f}function NH(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=lA(a[a.length-1]),o=new EH(a,i,n,null==r),s=null==r?[t]:[t,r],u=e.runWebGLProgram(o,s,"int32");if(u.shape.length===t.shape.length){var c=NH(e,t,n,u);return e.disposeIntermediateTensorInfo(u),c}return u}function OH(e,t,n,r){var a=[n];if(oI("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!jp().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],o=e.texData.get(t.dataId),s=t;null!==o&&o.isPacked&&(s=e.unpackTensor(t),i.push(s));var u=E(aI(s.shape,a),2),c=u[0],l=sp(u[1]),f=JG({inputs:{x:s},backend:e,attrs:{shape:[-1,l]}});i.push(f);var h=TH(e,f,r);i.push(h);var d=JG({inputs:{x:h},backend:e,attrs:{shape:c}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),d}return NH(e,t,r)}var RH={kernelName:Zp,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=pp(r.axis,a.shape),o=sI(i,a.shape.length),s=a,u=[];null!=o&&(s=uH({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=cI(i.length,s.shape.length)),oI("argMax",[i[0]],s.shape.length);var c=OH(n,s,i[0],"max");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}};var PH={kernelName:Qp,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=pp(r.axis,a.shape),o=sI(i,a.shape.length),s=a,u=[];null!=o&&(s=uH({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=cI(i.length,s.shape.length)),oI("argMin",[i[0]],s.shape.length);var c=OH(n,s,i[0],"min");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}},DH=VG({opSnippet:uG+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),MH={kernelName:Jp,backendName:"webgl",kernelFunc:DH},FH=VG({opSnippet:uG+"return log(x + sqrt(x * x + 1.0));"}),LH={kernelName:$p,backendName:"webgl",kernelFunc:FH},jH=VG({opSnippet:uG+"\n  return atan(x);\n"}),zH={kernelName:ev,backendName:"webgl",kernelFunc:jH},UH=GG({opSnippet:EG+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+NG+"\n  return result;\n"}),BH={kernelName:nv,backendName:"webgl",kernelFunc:UH},WH=VG({opSnippet:uG+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),VH={kernelName:tv,backendName:"webgl",kernelFunc:WH},GH=q((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(G(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===n,g="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),m="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="0.0";if(v||(y="-1.0 / 1e-20"),r){this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(">="," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?g:m:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var b="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(b="avgValue / max(count, 1.0)");var x=4*Math.floor(o/4),k=o%4,w="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(x,";\n          if (").concat(1===k,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===k,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===k,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(b,");\n      }\n    ")}})),HH=q((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(G(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,u=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,f=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,v=t.effectiveFilterWidth,g=t.padInfo.front,m=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,x="0.0";if(b||(x="-1.0 / 1e-20"),r){this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(f,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(">="," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(k="avgValue / max(count, 1.0)");var w=4*Math.floor(o/4),I=o%4,C="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(y,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(f,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(C,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===I,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(2===I,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(3===I,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(C,"\n            }\n          }\n        }\n        setOutput(").concat(k,");\n      }\n    ")}}));var KH={kernelName:rv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;gW(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;ap(sw(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=Qk(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&up(c.inShape,c.outShape))return RG({inputs:{x:a},backend:n});var l=new GH(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}};var qH={kernelName:iv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=Jk(a.shape,i,o,[1,1,1],s,u,c),f=new HH(l,"avg",!1);return n.runWebGLProgram(f,[a],"float32")}},XH=q((function e(t){G(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=u-1-t.padInfo.top,f=c-1-t.padInfo.left,h=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(f,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),YH=q((function e(t){G(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=f-1-t.padInfo.front,v=h-1-t.padInfo.top,g=d-1-t.padInfo.left,m=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(v,", ").concat(g,");\n      const float avgMultiplier = float(").concat(m,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var ZH={kernelName:ov,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=Jk(i.shape,o,s,[1,1,1],u,c),f=new YH(l);return n.runWebGLProgram(f,[a],i.dtype)}};var QH={kernelName:av,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;gW([a,i],"avgPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=Qk(o.shape,s,u,1,c),f=new XH(l);return n.runWebGLProgram(f,[a],o.dtype)}};var JH={kernelName:sv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return fH({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},$H=q((function e(t,n,r,a,i,o){G(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],ik(t,n),ik(t,r);var s="0.0";null!=a&&(ik(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=i&&(ik(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),eK=q((function e(t,n,r,a,i,o){G(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ik(t,n),ik(t,r);var s="vec4(0.0)";null!=a&&(ik(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=i&&(ik(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),tK={kernelName:Qv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,s=t.offset,u=t.scale;ap(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),ap(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),ap(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var c=r.varianceEpsilon;null==c&&(c=.001);var l=[a,i,o],f=null;null!=s&&(f=s.shape,l.push(s));var h=null;null!=u&&(h=u.shape,l.push(u));var d=jp().getBool("WEBGL_PACK_NORMALIZATION")?new eK(a.shape,i.shape,o.shape,f,h,c):new $H(a.shape,i.shape,o.shape,f,h,c);return n.runWebGLProgram(d,l,l[0].dtype)}},nK=q((function e(t){G(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n=DW(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var r,a=function(e){if(1===e)return"sourceLoc";if(e<=6)return rK.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),i=t.map((function(e,t){return"sourceLoc.".concat(rK[t]," = start[").concat(t,"] + coords.").concat(rK[t],";")}));r="\n        ".concat(n," sourceLoc;\n        ").concat(n," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")})),rK=["x","y","z","w","u","v"];var aK=q((function e(t){G(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var n=DW(this.rank),r=eG("coords",this.rank),a=eG("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      void main() {\n        ".concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}));function iK(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=E(Gk(a,r.begin,r.size),2),o=i[0],s=i[1];if(Uk(a,o,s),0===sp(s))return n.makeTensorInfo(s,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var u=n.texData.get(a.dataId),c=zV(u.values,o,s,a.shape,a.dtype);return n.makeTensorInfo(s,a.dtype,c)}var l=n.texData.get(a.dataId).isPacked,f=Wk(a.shape,o,s);if(l||!f){var h=jp().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aK(s):new nK(s),d=[o];return n.runWebGLProgram(h,[a],a.dtype,d)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;var s=Vk(t,Ap(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};var u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}(a,o,s,n)}var oK={kernelName:fm,backendName:"webgl",kernelFunc:iK},sK={kernelName:uv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;ap(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=hA(a.shape,i,s),c=dA(u.length,i.length),l=pA(a.shape,i,s),f=vA(o,i.length),h=gA(l,o,i.length),d=[],p=JG({inputs:{x:a},backend:n,attrs:{shape:u}}),v=uH({inputs:{x:p},backend:n,attrs:{perm:c}}),g=JG({inputs:{x:v},backend:n,attrs:{shape:l}}),m=iK({inputs:{x:g},backend:n,attrs:{begin:f,size:h}});return d.push(p),d.push(v),d.push(g),d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}};var uK={kernelName:cv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=sV(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}};var cK={kernelName:lv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=ik(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},lK=GG({opSnippet:"return float(a != b);",cpuKernelImpl:TV,dtype:"bool"}),fK={kernelName:Dg,backendName:"webgl",kernelFunc:lK};function hK(e){var t=e.inputs,n=e.backend,r=t.input;return RG({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var dK={kernelName:Yg,backendName:"webgl",kernelFunc:hK},pK="return float(int(x));";var vK={kernelName:fv,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return RG({inputs:{x:i},backend:r});var s=pI(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),c=DG({inputs:{real:u,imag:s},backend:r});return s.dispose(),r.disposeIntermediateTensorInfo(u),c}if("complex64"===i.dtype){var l=hK({inputs:{input:i},backend:r}),f=e({inputs:{x:l},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(l),f}if(!yp(i.dtype,o)){var h=RG({inputs:{x:i},backend:r});return{dataId:h.dataId,shape:h.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){var d=r.texData.get(i.dataId).values,p=E(cV(d,i.shape,i.dtype,o),3),v=p[0],g=p[1],m=p[2];return r.makeTensorInfo(v,g,m)}if("int32"===o)return function(e,t){var n=new sG(e.shape,pK),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var y=r.makeTensorInfo([],"bool",gp("bool",1)),b=lK({inputs:{a:i,b:y},backend:r});return r.disposeIntermediateTensorInfo(y),b}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},gK="return ceil(x);",mK=VG({opSnippet:gK,packedOpSnippet:gK,cpuKernelImpl:lV}),yK={kernelName:hv,backendName:"webgl",kernelFunc:mK},bK=q((function e(t){G(this,e),this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "})),xK=q((function e(t){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}));var kK={kernelName:dv,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,s=a.clipValueMax;t=jp().getBool("WEBGL_PACK_CLIP")?new xK(i.shape):new bK(i.shape);var u=[[o],[s]];return r.runWebGLProgram(t,[i],i.dtype,u)}},wK=q((function e(t){G(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}));function IK(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var CK={kernelName:vv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new wK(r.shape),o=[IK(r,a.complexTensorInfos.real),IK(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},AK=q((function e(t){G(this,e),this.outputShape=[],this.outputShape=uA(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var s=n.length,u=n[n.length-1];a.push("else setOutput(getT".concat(s,"(yR, yC-").concat(u,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),SK=q((function e(t,n){G(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=uA(t,n);var r=this.outputShape,a=r.length,i=DW(a),o=eG("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var u=new Array(t.length-1);u[0]=t[0][n];for(var c=1;c<u.length;c++)u[c]=u[c-1]+t[c][n];for(var l=s[n],f=s.slice(-2),h=s.join(),d="if (".concat(l," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(h,"), vec2(").concat(f.join(),"));\n        }"),p=1;p<u.length;p++){var v=u[p-1];d+="\n        if (".concat(l," < ").concat(u[p],"  && ").concat(l," >= ").concat(u[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(_K(s,l,v),"),\n            vec2(").concat(_K(f,l,v),"));\n        }")}var g=u.length,m=u[u.length-1];d+="\n        return getChannel(\n          getT".concat(g,"(").concat(_K(s,l,m),"),\n          vec2(").concat(_K(f,l,m),"));"),this.userCode="\n      float getValue(".concat(s.map((function(e){return"int "+e})),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}));function _K(e,t,n){var r=e.indexOf(t),a=e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e}));return a.join()}function EK(e){var t=e.inputs,n=e.backend,r=t.input;return RG({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var TK={kernelName:ag,backendName:"webgl",kernelFunc:EK};function NK(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return hK({inputs:{input:e},backend:n})})),i=e.map((function(e){return EK({inputs:{input:e},backend:n})})),o=NK(a,t,n),s=NK(i,t,n),u=DG({inputs:{real:o,imag:s},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}var c=n.shouldExecuteOnCPU(e);if("string"===r&&(c=!0),c){var l=e.map((function(e){var r=sp(e.shape.slice(t));return JG({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),f=l.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),h=uA(l.map((function(e){return e.shape})),1),d=1===l[0].shape[0],p=fV(f,h,r,d),v=uA(e.map((function(e){return e.shape})),t),g=n.makeTensorInfo(v,r,p);return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}var m=e.filter((function(e){return sp(e.shape)>0})),y=jp().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&m[0].shape.length>1;if(1===m.length){var b=y?new sG(e[0].shape,pG):new kG(e[0].shape,pG);return n.runWebGLProgram(b,e,r)}var x=jp().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(m.length>x){for(var k=[],w=0;w<m.length;w+=x){var I=m.slice(w,w+x);k.push(NK(I,t,n))}for(var C=NK(k,t,n),A=0,S=k;A<S.length;A++){var _=S[A];n.disposeIntermediateTensorInfo(_)}return C}if(y){var E=new SK(m.map((function(e){return e.shape})),t);return n.runWebGLProgram(E,m,r)}var T=function(e,t,n){var r=uA(e.map((function(e){return e.shape})),t),a=e.map((function(e){return JG({inputs:{x:e},attrs:{shape:[-1,sp(e.shape.slice(t))]},backend:n})}));return{tensors2D:a,outShape:r}}(m,t,n),N=T.tensors2D,O=T.outShape,R=new AK(N.map((function(e){return e.shape}))),P=n.runWebGLProgram(R,N,r);N.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var D=JG({inputs:{x:P},attrs:{shape:O},backend:n});return n.disposeIntermediateTensorInfo(P),D}function OK(e){var t=e.inputs,n=e.backend,r=pp(e.attrs.axis,t[0].shape)[0],a=t.map((function(e){return e.shape}));sA(a,r);var i=uA(t.map((function(e){return e.shape})),r);if(0===sp(i))return n.makeTensorInfo(i,t[0].dtype,[]);var o=t.filter((function(e){return sp(e.shape)>0}));return 1===o.length?RG({inputs:{x:o[0]},backend:n}):NK(o,r,n)}var RK={kernelName:gv,backendName:"webgl",kernelFunc:OK},PK=q((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];G(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,f=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),v=t.inChannels%4,g="channelsLast"===t.dataFormat,m=g?1:2,y=g?2:3,b=g?3:1,x="",k="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),k="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(m,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(g,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===v,") {\n\n              if (").concat(g,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===v,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===v,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(k,"\n        setOutput(result);\n      }\n    ")})),DK=q((function e(t){G(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,f=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(f,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),MK=q((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];G(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=BW(this.outputShape.length);for(var o=t.padInfo.left,s=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,f=l,h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;",d=0;d<l;d++)h+="\n           vec4 xTexelC".concat(2*d,";\n           int xTexelC").concat(2*d,"Ready;\n           vec4 xTexelC").concat(2*d+1,";\n           int xTexelC").concat(2*d+1,"Ready;\n           vec4 xC").concat(d,";");h+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(var p=0;p<l;p++)h+="\n           xTexelC".concat(2*p," = vec4(0.0);\n           xTexelC").concat(2*p,"Ready = 0;\n           xTexelC").concat(2*p+1," = vec4(0.0);\n           xTexelC").concat(2*p+1,"Ready = 0;\n           xC").concat(p," = vec4(0.0);");h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(var v=0;v<(f+1)/2;v++){var g=2*v;if(h+="\n           xC = xCCorner + ".concat(g*u,";\n           "),1===s){if(g<l&&(o%2===1?(h+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                   xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(g,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g,"Ready = 1;\n                 }\n               "),h+=1===u&&g>0?"\n                 xC".concat(g," = vec4(xTexelC").concat(g-2,".zw, xTexelC").concat(g,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(g," = vec4(previous.zw, xTexelC").concat(g,".xy);\n                   } else {\n                     xC").concat(g," = vec4(0.0, 0.0, xTexelC").concat(g,".xy);\n                   }\n                   ")):h+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                   xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(g,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g,"Ready = 1;\n                 }\n\n                 xC").concat(g," = xTexelC").concat(g,";\n                 "),g+1<l)){var m=o%2===0?tp(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(h+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(m,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                     xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(g+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(g+1,"Ready = 1;\n                   }\n                   "),h+=u>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(g+1," = vec4(previous.zw, xTexelC").concat(g+1,".xy);\n                     } else {\n                      xC").concat(g+1," = vec4(0.0, 0.0, xTexelC").concat(g+1,".xy);\n                     }\n                     "):"\n                     xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".xy);\n                     ")):h+=1===m?"\n                     xC".concat(g+1," = xTexelC").concat(g,";\n                     "):"\n                     xCOffset = xC + ".concat(m,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                       xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(g+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(g+1,"Ready = 1;\n                     }\n\n                     xC").concat(g+1," = xTexelC").concat(g+1,";\n                     ")}}else g<l&&(o%2===1?(h+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                   xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(g,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                   xTexelC").concat(g+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(g+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g+1,"Ready = 1;\n                 }\n\n                 xC").concat(g," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n               "),g+1<l&&(h+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(g+1," = vec4(xTexelC").concat(g+1,".xy, final.xy);\n                 "))):(h+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                   xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(g,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(g,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                   xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(g+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(g+1,"Ready = 1;\n                 }\n\n                 xC").concat(g," = vec4(\n                   xTexelC").concat(g,".xy, xTexelC").concat(g+1,".xy);\n               "),g+1<l&&(h+="\n                   xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n                 "))));g<l&&(h+="\n             wTexel = getW(r, ".concat(g,", d1, d2);\n             dotProd += xC").concat(g,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(g,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),g+1<l&&(h+="\n               wTexel = getW(r, ".concat(g+1,", d1, d2);\n               dotProd += xC").concat(g+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(g+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";var y="",b="";r&&(y=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(r,"\n         }"):i?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(r,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(r,"\n         }"),b="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(y,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(h,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(x,"\n         ").concat(b,"\n         setOutput(result);\n       }\n     ")})),FK=q((function e(t,n){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=BW(this.outputShape.length);for(var r=n.dataFormat,a=yW(),i="channelsLast"===r,o=i?1:2,s=i?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {"),c="",l=0;l<=1;l++)for(var f=0;f<=1;f++)c+="\n          blockIndex = rc.z + ".concat(f,";\n          pos = rc.y + ").concat(l,";\n\n          ").concat(u,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(o,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(s,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*l+f,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*l+f,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(a.output," = result;\n      }\n    ")}));function LK(e,t){var n=e.length;return n>=3?[].concat(X(e.slice(0,-3)),t?[e[n-3]*e[n-2],e[n-1]]:[e[n-3],e[n-2]*e[n-1]]):!t&&1===n&&e[0]>1?[e[0],1]:null}function jK(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,f=void 0===l?0:l,h=e.activation,d=void 0===h?null:h,p=n.shape,v=i.texData.get(n.dataId),g=a.inChannels,m=p[0]*p[1]*p[2],y=a.outChannels,b="channelsLast"===a.dataFormat,x=[];if(null!=c){var k=LK(c.shape,b);null!=k&&(c=JG({inputs:{x:c},backend:i,attrs:{shape:k}}),x.push(c))}if(null!=s){var w=LK(s.shape,b);null!=w&&(s=JG({inputs:{x:s},backend:i,attrs:{shape:w}}),x.push(s))}if(!((1===m||1===y)&&g>lH)&&v.isPacked&&b&&null!=v.texture&&p[2]%2!==0&&up(v.shape.slice(-3),p.slice(-3))){var I=p[0]*p[1]*(p[2]+1),C={dataId:n.dataId,shape:[1,I,a.inChannels],dtype:n.dtype},A=v.shape;v.shape=v.shape.slice(),v.shape[v.shape.length-2]++,ap(fW(v.shape,C.shape),(function(){return"packed reshape ".concat(v.shape," to ").concat(C.shape," isn't free")}));var S=JG({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});x.push(S);var _=fH({a:C,b:S,backend:i,transposeA:!1,transposeB:false,bias:s,activation:d,preluActivationWeights:c,leakyreluAlpha:f}),E=i.texData.get(_.dataId);ap(E.isPacked,(function(){return"batchMatMul result is expected to be packed"})),v.shape=A,E.shape=a.outShape,(t=RG({inputs:{x:_},backend:i})).shape=a.outShape,x.push(_)}else{var T=a.outHeight*a.outWidth,N=JG({inputs:{x:n},backend:i,attrs:{shape:b?[a.batchSize,T,a.inChannels]:[a.batchSize,a.inChannels,T]}}),O=JG({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),R=fH({a:b?N:O,b:b?O:N,transposeA:!b,transposeB:false,backend:i,bias:s,activation:d,preluActivationWeights:c,leakyreluAlpha:f});t=JG({inputs:{x:R},backend:i,attrs:{shape:a.outShape}}),x.push(N),x.push(O),x.push(R)}for(var P=0,D=x;P<D.length;P++){var M=D[P];i.disposeIntermediateTensorInfo(M)}return t}function zK(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,c=e.leakyreluAlpha,l=void 0===c?0:c,f=e.activation,h=void 0===f?null:f,d=r.filterWidth,p=r.filterHeight,v=r.inChannels,g=r.outWidth,m=r.outHeight,y="channelsLast"===r.dataFormat,b=d*p*v,x=m*g,k=[r.batchSize,b,x],w=[];if(null!=u){var I=LK(u.shape,y);null!=I&&(u=JG({inputs:{x:u},backend:a,attrs:{shape:I}}),w.push(u))}if(null!=o){var C=LK(o.shape,y);null!=C&&(o=JG({inputs:{x:o},backend:a,attrs:{shape:C}}),w.push(o))}var A=JG({inputs:{x:n},backend:a,attrs:{shape:[1,b,sp(n.shape)/b]}});w.push(A);var S=new FK(k,r),_=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],E=a.runWebGLProgram(S,[t],"float32",_),T=JG({inputs:{x:E},backend:a,attrs:{shape:k}});w.push(E),w.push(T);var N=null!=o,O=null!=u,R="leakyrelu"===h,P=h?HG(h,!0):null,D=new KG(y?T.shape:A.shape,y?A.shape:T.shape,y?[r.batchSize,x,r.outChannels]:[r.batchSize,r.outChannels,x],!0,!1,N,P,O,R),M=y?[T,A]:[A,T];if(o&&M.push(o),O&&M.push(u),R){var F=a.makeTensorInfo([],"float32",yy(l,"float32"));M.push(F),w.push(F)}var L=a.runWebGLProgram(D,M,"float32"),j=JG({inputs:{x:L},backend:a,attrs:{shape:r.outShape}});w.push(L);for(var z=0,U=w;z<U.length;z++){var B=U[z];a.disposeIntermediateTensorInfo(B)}return j}var UK={kernelName:mv,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dataFormat,l=a.dilations,f=a.dimRoundingMode,h=cw(c),d=$k(i.shape,o.shape,s,l,u,f,!1,h);if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===h&&jp().getBool("WEBGL_EXP_CONV")){var p=new MK(d),v=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];t=r.runWebGLProgram(p,[i,o],"float32",v)}else if(jp().getBool("WEBGL_CONV_IM2COL"))t=zK({x:i,filter:o,convInfo:d,backend:r});else{var g=new PK(d);t=r.runWebGLProgram(g,[i,o],"float32")}else t=jK({x:i,filter:o,convInfo:d,backend:r});var m=JG({inputs:{x:t},backend:r,attrs:{shape:d.outShape}});return r.disposeIntermediateTensorInfo(t),m}},BK=q((function e(t){G(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),WK=q((function e(t){G(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=n-1-t.padInfo.top,u=r-1-t.padInfo.left,c=o?1:2,l=o?2:3,f=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(f,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),VK=q((function e(t){G(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),GK=q((function e(t){G(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=n-1-t.padInfo.front,c=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var HK={kernelName:yv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,f=cw(u),h=$k(a.shape,l,o,1,s,c,!1,f),d=new BK(h);return n.runWebGLProgram(d,[a,i],"float32")}};var KK={kernelName:bv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,f=cw(c),h=$k(o,i.shape,s,1,u,l,!1,f),d=new WK(h);return n.runWebGLProgram(d,[a,i],"float32")}};var qK={kernelName:xv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=ew(a.shape,i.shape,o,u,s),l=new DK(c);return n.runWebGLProgram(l,[a,i],"float32")}};var XK={kernelName:kv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape,c=ew(a.shape,u,o,1,s),l=new VK(c);return n.runWebGLProgram(l,[a,i],"float32")}};var YK,ZK={kernelName:wv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=ew(r.inputShape,i.shape,s,1,o),c=new GK(u);return n.runWebGLProgram(c,[a,i],"float32")}},QK=VG({opSnippet:WG+"\n  return cos(x);\n"}),JK={kernelName:Iv,backendName:"webgl",kernelFunc:QK},$K=VG({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),eq={kernelName:Cv,backendName:"webgl",kernelFunc:$K},tq=q((function e(t,n,r,a,i){G(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=E(t,4),s=o[0],u=o[1],c=o[2],l=o[3],f=E(n,1)[0],h=E(r,2),d=h[0],p=h[1];this.outputShape=[f,d,p,l];var v="bilinear"===a?1:0,g="".concat(u-1,".0"),m="".concat(c-1,".0"),y=E(d>1?["".concat((u-1)/(d-1)),"(y2-y1) * height_ratio","y1*".concat(g," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(g)],3),b=y[0],x=y[1],k=y[2],w=E(p>1?["".concat((c-1)/(p-1)),"(x2-x1) * width_ratio","x1*".concat(m," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(m)],3),I=w[0],C=w[1],A=w[2];this.userCode="\n      const float height_ratio = float(".concat(b,");\n      const float width_ratio = float(").concat(I,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(x,";\n        float width_scale = ").concat(C,";\n\n        float in_y = ").concat(k,";\n        if( in_y < 0.0 || in_y > ").concat(g," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(A,";\n        if( in_x < 0.0 || in_x > ").concat(m," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(v," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),nq={kernelName:_v,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new tq(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(YK||(YK={}));var rq=q((function e(t,n,r,a){G(this,e),this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];var i=this.outputShape.length,o=this.op===YK.Prod?"1.0":"0.0",s=r?o:"getX(".concat(aq(i,"coords",this.op),")"),u=this.outputShape[this.outputShape.length-1],c="",l="";r?(c=a?"end != ".concat(u-1):"end != 0",l=a?"end + 1":"end - 1"):(c=a?"end + pow2 < ".concat(u):"end >= pow2",l=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(DW(i)," coords = getOutputCoords();\n        int end = ").concat(iq(i,"coords",this.op),";\n        float val = ").concat(s,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(l,";\n          ").concat(iq(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(aq(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}));function aq(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function iq(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function oq(e,t,n,r,a,i){var o=t.shape.length,s=sI([r],o),u=t;null!=s&&(u=uH({inputs:{x:t},backend:n,attrs:{perm:s}}));var c=cI(1,o)[0];if(c!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));for(var l=u.shape[c],f=RG({inputs:{x:u},backend:n}),h=0;h<=Math.ceil(Math.log2(l))-1;h++){var d=new rq(e,u.shape,!1,i),p=[[h]],v=f;f=n.runWebGLProgram(d,[f],f.dtype,p),n.disposeIntermediateTensorInfo(v)}if(a){var g=new rq(e,u.shape,a,i),m=f;f=n.runWebGLProgram(g,[f],f.dtype),n.disposeIntermediateTensorInfo(m)}if(null!=s){var y=uH({inputs:{x:f},backend:n,attrs:{perm:uI(s)}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(u),y}return f}var sq={kernelName:Av,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return oq(YK.Prod,a,n,i,o,s)}};var uq={kernelName:Sv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return oq(YK.Sum,a,n,i,o,s)}};var cq={kernelName:Ev,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=sV(u,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var f=n.bufferSync(a),h=n.bufferSync(i),d=uV(f,h,o,s);return n.makeTensorInfo(d.shape,i.dtype,d.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},lq=function(){function e(t,n,r){G(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return q(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var fq={kernelName:Tv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat,s=a.shape[0],u=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),f=new lq("NHWC"===o?[s,u,c,l]:[s,l,u,c],i,o);return n.runWebGLProgram(f,[a],a.dtype)}},hq=q((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];G(this,e),this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=BW(this.outputShape.length);var o=t.filterHeight,s=t.filterWidth,u=t.outChannels/t.inChannels,c="",l="";r&&(c=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),l="result = activation(result);");var f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(u,";\n        int q = d2 - d1 * ").concat(u,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(f,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")})),dq=q((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];G(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=BW(this.outputShape.length);for(var o=t.outChannels/t.inChannels,s=t.padInfo.left,u=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,f=t.filterWidth,h=f,d="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",p=0;p<f;p++)d+="\n          vec4 xTexelC".concat(2*p,";\n          int xTexelC").concat(2*p,"Ready;\n          vec4 xTexelC").concat(2*p+1,";\n          int xTexelC").concat(2*p+1,"Ready;\n          vec4 xC").concat(p,";");d+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(var v=0;v<f;v++)d+="\n          xTexelC".concat(2*v," = vec4(0.0);\n          xTexelC").concat(2*v,"Ready = 0;\n          xTexelC").concat(2*v+1," = vec4(0.0);\n          xTexelC").concat(2*v+1,"Ready = 0;\n          xC").concat(v," = vec4(0.0);");d+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(var g=0;g<(h+1)/2;g++){var m=2*g;if(d+="\n          xC = xCCorner + ".concat(m*c,";\n          "),1===u){if(m<f&&(s%2===1?(d+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                  xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(m,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(m,"Ready = 1;\n                }\n              "),d+=1===c&&m>0?"\n                xC".concat(m," = vec4(xTexelC").concat(m-2,".zw, xTexelC").concat(m,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(m," = vec4(previous.zw, xTexelC").concat(m,".xy);\n                  } else {\n                    xC").concat(m," = vec4(0.0, 0.0, xTexelC").concat(m,".xy);\n                  }\n                  ")):d+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                  xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(m,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(m,"Ready = 1;\n                }\n\n                xC").concat(m," = xTexelC").concat(m,";\n                "),m+1<f)){var y=s%2===0?tp(c):c;c%2===0&&s%2===1||c%2!==0&&s%2!==1?(d+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(y,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                    xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(m+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(m+1,"Ready = 1;\n                  }\n                  "),d+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(m+1," = vec4(previous.zw, xTexelC").concat(m+1,".xy);\n                    } else {\n                     xC").concat(m+1," = vec4(0.0, 0.0, xTexelC").concat(m+1,".xy);\n                    }\n                    "):"\n                    xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".xy);\n                    ")):d+=1===y?"\n                    xC".concat(m+1," = xTexelC").concat(m,";\n                    "):"\n                    xCOffset = xC + ".concat(y,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                      xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(m+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(m+1,"Ready = 1;\n                    }\n\n                    xC").concat(m+1," = xTexelC").concat(m+1,";\n                    ")}}else m<f&&(s%2===1?(d+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                  xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(m,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(m,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                  xTexelC").concat(m+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(m+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(m+1,"Ready = 1;\n                }\n\n                xC").concat(m," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n              "),m+1<f&&(d+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(m+1," = vec4(xTexelC").concat(m+1,".xy, final.xy);\n                "))):(d+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                  xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(m,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(m,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                  xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(m+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(m+1,"Ready = 1;\n                }\n\n                xC").concat(m," = vec4(\n                  xTexelC").concat(m,".xy, xTexelC").concat(m+1,".xy);\n              "),m+1<f&&(d+="\n                  xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n                "))));m<f&&(d+="\n            wTexel = getW(r, ".concat(m,", d1, q);\n            dotProd += xC").concat(m," * vec4(wTexel.xz, wTexel.xz);\n          "),m+1<f&&(d+="\n              wTexel = getW(r, ".concat(m+1,", d1, q);\n              dotProd += xC").concat(m+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}d+="\n    }\n  ",d+="\n      }\n    ";var b="",x="";r&&(b=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),x="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(d,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(k,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}));var pq={kernelName:Nv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode,l=u;null==l&&(l=[1,1]),ap(sw(o,l),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var f,h=$k(a.shape,i.shape,o,l,s,c,!0);f=jp().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new dq(h):new hq(h);var d=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(f,[a,i],"float32",d)}},vq=q((function e(t){G(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),gq=q((function e(t){G(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,s=r-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var mq={kernelName:Ov,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape,f=$k(a.shape,l,o,s,u,c,!0),h=new vq(f);return n.runWebGLProgram(h,[a,i],"float32")}};var yq={kernelName:Rv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=$k(r.inputShape,i.shape,o,s,u,c,!0),f=new gq(l);return n.runWebGLProgram(f,[a,i],"float32")}},bq=q((function e(t){G(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}));var xq={kernelName:Pv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat(X(r.shape),X(r.shape)),i=sp(r.shape),o=JG({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new bq(i),u=n.runWebGLProgram(s,[o],o.dtype),c=JG({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}},kq=q((function e(t){G(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,u=t.filterWidth,c=t.dilationHeight,l=t.dilationWidth,f=a.top,h=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}));var wq={kernelName:Dv,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dilations,l=Zk(i.shape,o.shape,s,u,"NHWC",c),f=new kq(l),h=JG({inputs:{x:t=r.runWebGLProgram(f,[i,o],"float32")},backend:r,attrs:{shape:l.outShape}});return r.disposeIntermediateTensorInfo(t),h}};var Iq={kernelName:jv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=MA(e.attrs.equation,r.length),i=a.allDims,o=a.summedDims,s=a.idDims;LA(i.length,s,r);for(var u=jA(o,s),c=u.path,l=u.steps,f=l.length,h=null,d=i.length,p=[],v=0;v<f;++v){var g,m=U(l[v]);try{for(m.s();!(g=m.n()).done;){var y=g.value,b=FA(d,s[y]),x=b.permutationIndices,k=b.expandDims,w=void 0;zA(x)?w=r[y]:(w=uH({inputs:{x:r[y]},backend:n,attrs:{perm:x}}),p.push(w));for(var I=w.shape.slice(),C=0;C<k.length;++C)I.splice(k[C],0,1);up(w.shape,I)||(w=JG({inputs:{x:w},backend:n,attrs:{shape:I}}),p.push(w)),null===h?h=w:(h=ZG({inputs:{a:w,b:h},backend:n}),p.push(h))}}catch(Wse){m.e(Wse)}finally{m.f()}v<f-1&&(c[v]>=0&&(h=oH({inputs:{x:h},backend:n,attrs:{axis:c[v]-(i.length-d),keepDims:!1}}),p.push(h)),d--)}for(var A=0,S=p;A<S.length;A++){var _=S[A];_!==h&&n.disposeIntermediateTensorInfo(_)}return h}},Cq=VG({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),Aq={kernelName:zv,backendName:"webgl",kernelFunc:Cq},Sq={kernelName:Uv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=jp().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new OG("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new TG("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},_q=GG({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:hV}),Eq={kernelName:Wv,backendName:"webgl",kernelFunc:_q},Tq=VG({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(kA,";\n  float a1 = ").concat(wA,";\n  float a2 = ").concat(IA,";\n  float a3 = ").concat(CA,";\n  float a4 = ").concat(AA,";\n  float a5 = ").concat(SA,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),Nq={kernelName:Bv,backendName:"webgl",kernelFunc:Tq},Oq=VG({opSnippet:WG+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:dV,dtype:"float32"}),Rq={kernelName:Vv,backendName:"webgl",kernelFunc:Oq};function Pq(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,s=i.shape.slice(),u=a;return a<0&&(ap(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+a+1),s.splice(u,0,1),JG({inputs:{x:i},backend:r,attrs:{shape:s}})}var Dq={kernelName:Gv,backendName:"webgl",kernelFunc:Pq},Mq="return exp(x) - 1.0;",Fq=VG({opSnippet:Mq,packedOpSnippet:Mq,cpuKernelImpl:pV}),Lq={kernelName:Hv,backendName:"webgl",kernelFunc:Fq},jq=q((function e(t,n,r){G(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}));function zq(e,t,n){var r=n.texData.get(e.dataId),a=sp(e.shape),i=e.shape[e.shape.length-1],o=JG({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,u=new jq("real",s,t),c=new jq("imag",s,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],f=n.runWebGLProgram(u,l,"float32"),h=n.runWebGLProgram(c,l,"float32"),d=DG({inputs:{real:f,imag:h},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h);var p=JG({inputs:{x:d},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(d),p}var Uq={kernelName:Kv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return zq(t.input,!1,n)}},Bq=q((function e(t,n){G(this,e),this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}));function Wq(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||wp(a))){var o=mp(i,sp(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var s=new Bq(r,a),u=[[a]];return t.runWebGLProgram(s,[],i,u)}var Vq,Gq={kernelName:qv,backendName:"webgl",kernelFunc:Wq},Hq=q((function e(t){G(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),Kq={kernelName:Xv,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new Hq(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},qq="return floor(x);",Xq=VG({opSnippet:qq,packedOpSnippet:qq,cpuKernelImpl:vV}),Yq={kernelName:Yv,backendName:"webgl",kernelFunc:Xq},Zq=GG({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Qq={kernelName:Zv,backendName:"webgl",kernelFunc:Zq},Jq=q((function e(t){G(this,e),this.variableNames=["A"];var n=yW(),r=E(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),$q=q((function e(t){G(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=yW(),r=E(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),eX={kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,u=E(o?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),c=u[0],l=u[1],f=[l,c],h=[l,c,i];if(s||o){var d=jp().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=Vq&&d===tX||(tX=d,Vq=document.createElement("canvas").getContext("2d",{willReadFrequently:tX})),Vq.canvas.width=c,Vq.canvas.height=l,Vq.drawImage(a,0,0,c,l),a=Vq.canvas}var p=n.makeTensorInfo(f,"int32");n.texData.get(p.dataId).usage=MB.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);var v=jp().getBool("WEBGL_PACK")?new $q(h):new Jq(h),g=n.runWebGLProgram(v,[p],"int32");return n.disposeData(p.dataId),g}},tX=jp().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var nX={kernelName:qm,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=n.bias,u=n.preluActivationWeights,c=a.strides,l=a.pad,f=a.dataFormat,h=a.dilations,d=a.dimRoundingMode,p=a.activation,v=a.leakyreluAlpha,g=cw(f),m=$k(i.shape,o.shape,c,h,l,d,!1,g),y=[],b=null!=s,x=null!=u,k="leakyrelu"===p,w=function(){var e=[i,o],t=function(e,t){if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){var n=JG({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return y.push(n),n}return e};if(b&&e.push(t(s,f)),x&&e.push(t(u,f)),k){var n=r.makeTensorInfo([],"float32",yy(v,"float32"));e.push(n),y.push(n)}return e};if(1!==m.filterHeight||1!==m.filterWidth||1!==m.dilationHeight||1!==m.dilationWidth||1!==m.strideHeight||1!==m.strideWidth||"SAME"!==m.padInfo.type&&"VALID"!==m.padInfo.type)if(m.strideWidth<=2&&"channelsLast"===g&&jp().getBool("WEBGL_EXP_CONV")){var I=p?HG(p,!0):null,C=new MK(m,b,I,x,k),A=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],S=w();t=r.runWebGLProgram(C,S,"float32",A)}else if(jp().getBool("WEBGL_CONV_IM2COL"))t=zK({x:i,filter:o,convInfo:m,backend:r,bias:s,activation:p,preluActivationWeights:u,leakyreluAlpha:v});else{var _=p?HG(p,!1):null,E=new PK(m,b,_,x,k),T=w();t=r.runWebGLProgram(E,T,"float32")}else t=jK({x:i,filter:o,convInfo:m,backend:r,bias:s,activation:p,preluActivationWeights:u,leakyreluAlpha:v});var N=JG({inputs:{x:t},backend:r,attrs:{shape:m.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),N}};var rX={kernelName:Xm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dilations,f=r.dimRoundingMode,h=r.activation,d=r.leakyreluAlpha,p=[],v=l;null==v&&(v=[1,1]),ap(sw(u,v),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(v,"'")}));var g,m=$k(a.shape,i.shape,u,v,c,f,!0),y=jp().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,b=h?HG(h,y):null,x=[a,i],k=null!=o,w=null!=s,I="leakyrelu"===h;if(k&&x.push(o),w&&x.push(s),I){var C=n.makeTensorInfo([],"float32",yy(d,"float32"));x.push(C),p.push(C)}g=y?new dq(m,k,b,w,I):new hq(m,k,b,w,I);var A=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],S=n.runWebGLProgram(g,x,"float32",A);return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),S}},aX=q((function e(t,n,r,a){G(this,e),this.sliceDim=t,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;for(var i=DW(r.length),o="\n    int index;",s=0;s<this.sliceDim;s++)o+="\n          index = round(getIndices(coords[0], ".concat(s,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[s],";\n          flattenIndex += index * ").concat(this.strides[s],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}));var iX={kernelName:$v,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],s=sp(r.shape),u=E(mA(r,a),4),c=u[0],l=u[1],f=u[2],h=u[3],d=JG({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),p=JG({inputs:{x:r},backend:n,attrs:{shape:[sp(r.shape)/f,f]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var v=n.readSync(a.dataId),g=n.bufferSync(r),m=gV(v,g,r.dtype,l,o,f,h,r.shape,s);return n.makeTensorInfo(c,r.dtype,m.values)}var y=new aX(o,h,[l,f],r.shape),b=n.runWebGLProgram(y,[p,d],p.dtype),x=JG({inputs:{x:b},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(b),x}},oX=q((function e(t,n){G(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=DW(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("index"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}));function sX(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims,u=pp(o,a.shape)[0];if(jp().get("DEBUG"))for(var c=n.readSync(i.dataId),l=a.shape[u],f=function(){var e=c[h];ap(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},h=0;h<c.length;++h)f();var d=qA(a,i,u,s),p=sp(i.shape),v=[],g=JG({inputs:{x:a},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),m=JG({inputs:{x:i},backend:n,attrs:{shape:[d.batchSize,p/d.batchSize]}});v.push(g),v.push(m);var y=[d.batchSize,d.outerSize,p/d.batchSize,d.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var b=n.bufferSync(m),x=n.bufferSync(g),k=mV(x,b,y);return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(d.outputShape,k.dtype,k.values)}var w=new oX(g.shape,y),I=n.runWebGLProgram(w,[g,m],g.dtype);v.push(I);var C=JG({inputs:{x:I},backend:n,attrs:{shape:d.outputShape}});return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),C}var uX={kernelName:Jv,backendName:"webgl",kernelFunc:sX},cX=GG({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:yV,dtype:"bool"}),lX={kernelName:eg,backendName:"webgl",kernelFunc:cX},fX=GG({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:bV}),hX={kernelName:tg,backendName:"webgl",kernelFunc:fX};var dX={kernelName:rg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return zq(t.input,!0,n)}},pX=VG({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),vX={kernelName:ig,backendName:"webgl",kernelFunc:pX},gX=VG({opSnippet:"return float(isinf(x));",dtype:"bool"}),mX={kernelName:og,backendName:"webgl",kernelFunc:gX},yX=VG({opSnippet:"return float(isnan(x));",dtype:"bool"}),bX={kernelName:sg,backendName:"webgl",kernelFunc:yX},xX=GG({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:xV,dtype:"bool"}),kX={kernelName:cg,backendName:"webgl",kernelFunc:xX},wX=GG({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:kV,dtype:"bool"}),IX={kernelName:lg,backendName:"webgl",kernelFunc:wX};var CX={kernelName:fg,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=wV(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},AX=VG({opSnippet:WG+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:IV}),SX={kernelName:hg,backendName:"webgl",kernelFunc:AX},_X=VG({opSnippet:WG+"\n  return log(1.0 + x);\n"}),EX={kernelName:dg,backendName:"webgl",kernelFunc:_X},TX=GG({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),NX={kernelName:pg,backendName:"webgl",kernelFunc:TX},OX=VG({opSnippet:"return float(!(x >= 1.0));"}),RX={kernelName:vg,backendName:"webgl",kernelFunc:OX},PX=GG({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),DX={kernelName:gg,backendName:"webgl",kernelFunc:PX},MX=q((function e(t,n,r,a,i){G(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")})),FX=q((function e(t,n,r,a,i){G(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")})),LX={kernelName:mg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta,c=jp().getBool("WEBGL_PACK_NORMALIZATION")?new FX(a.shape,i,o,s,u):new MX(a.shape,i,o,s,u);return n.runWebGLProgram(c,[a],a.dtype)}},jX=q((function e(t,n,r,a,i){G(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),zX={kernelName:yg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,f=new jX(a.shape,s,u,c,l);return n.runWebGLProgram(f,[a,i,o],a.dtype)}};function UX(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=a.shape.length,u=pp(i,a.shape),c=u,l=sI(c,s),f=null!=l,h=n.shouldExecuteOnCPU([a]),d=a;if(f){if(h){for(var p=n.texData.get(d.dataId).values,v=new Array(s),g=0;g<v.length;g++)v[g]=a.shape[l[g]];var m=QV(p,a.shape,a.dtype,l,v);d=n.makeTensorInfo(v,a.dtype),n.texData.get(d.dataId).values=m}else d=iH(a,l,n);c=cI(c.length,s)}oI("max",c,s);var y,b=E(aI(d.shape,c),2),x=b[0],k=b[1],w=x;if(o&&(w=iI(x,u)),h){var I=n.texData.get(d.dataId).values,C=CV(I,sp(k),w,a.dtype);y=n.makeTensorInfo(w,a.dtype),n.texData.get(y.dataId).values=C}else y=function(e,t,n,r){var a=sp(t),i=JG({inputs:{x:e},attrs:{shape:[sp(e.shape)/a,a]},backend:r}),o=nH(i,e.dtype,"max",r),s=JG({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(d,k,w,n);return f&&n.disposeIntermediateTensorInfo(d),y}var BX={kernelName:bg,backendName:"webgl",kernelFunc:UX},WX=GG({opSnippet:EG+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+NG+"\n  return result;\n",cpuKernelImpl:AV}),VX={kernelName:xg,backendName:"webgl",kernelFunc:WX};var GX={kernelName:kg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;gW(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;ap(sw(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=Qk(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&up(c.inShape,c.outShape))return RG({inputs:{x:a},backend:n});var l=new GH(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}};var HX={kernelName:Ig,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=Jk(a.shape,i,o,[1,1,1],s,c,u),f=new HH(l,"max",!1);return n.runWebGLProgram(f,[a],a.dtype)}},KX=q((function e(t){G(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,u=o-1-t.padInfo.left,c=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),qX=q((function e(t){G(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,f=u-1-t.padInfo.front,h=c-1-t.padInfo.top,d=l-1-t.padInfo.left,p=u*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var XX={kernelName:Cg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=Jk(i.shape,o,s,[1,1,1],u,c),f=new HH(l,"max",!0),h=n.runWebGLProgram(f,[i],i.dtype),d=new qX(l),p=n.runWebGLProgram(d,[a,h],i.dtype);return n.disposeIntermediateTensorInfo(h),p}};var YX={kernelName:wg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;gW([i,t.output],"maxPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,f=Qk(o.shape,s,u,1,c,l),h=new GH(f,"max",!0),d=n.runWebGLProgram(h,[o],o.dtype),p=new KX(f),v=n.runWebGLProgram(p,[a,d],o.dtype);return n.disposeIntermediateTensorInfo(d),v}};var ZX={kernelName:Ag,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;ap(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var l=[1,1];ap(sw(o,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(l,"'")}));var f=Qk(a.shape,i,o,l,s),h=function(e,t,n,r){var a=new GH(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new GH(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,u,f,c),d=E(h,2);return[d[0],d[1]]}};var QX={kernelName:Sg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,o=n.axis,s=r,u=a.shape.length,c=pp(o,a.shape),l=c,f=sI(l,u),h=null!=f,d=s.shouldExecuteOnCPU([a]),p=[],v=a;if(h){if(d){for(var g=s.texData.get(v.dataId).values,m=new Array(u),y=0;y<m.length;y++)m[y]=a.shape[f[y]];var b=QV(g,a.shape,a.dtype,f,m);v=s.makeTensorInfo(m,a.dtype),s.texData.get(v.dataId).values=b}else v=iH(a,f,s);p.push(v),l=cI(l.length,u)}oI("sum",l,u);var x=E(aI(v.shape,l),2),k=x[0],w=x[1],I=k;i&&(I=iI(k,c));for(var C=function(e,t,n,r){var a=sp(t),i=JG({inputs:{x:e},attrs:{shape:[sp(e.shape)/a,a]},backend:r}),o=nH(i,"float32","mean",r),s=JG({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(v,w,I,s),A=0,S=p;A<S.length;A++){var _=S[A];s.disposeIntermediateTensorInfo(_)}return C}};var JX={kernelName:_g,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=pp(i,a.shape),c=u,l=sI(c,s),f=a;null!=l&&(f=uH({inputs:{x:a},backend:n,attrs:{perm:l}}),c=cI(c.length,a.shape.length)),oI("min",c,s);var h,d=E(aI(f.shape,c),2),p=d[0],v=JG({inputs:{x:f},backend:n,attrs:{shape:[-1,sp(d[1])]}}),g=nH(v,v.dtype,"min",n);return h=JG(o?{inputs:{x:g},backend:n,attrs:{shape:iI(p,u)}}:{inputs:{x:g},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(f),h}},$X=GG({opSnippet:EG+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+NG+"\n  return result;\n",cpuKernelImpl:SV}),eY={kernelName:Eg,backendName:"webgl",kernelFunc:$X},tY=q((function e(t,n,r){G(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=DW(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),c="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")})),nY=q((function e(t,n,r){G(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=DW(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=eG("rc",a),c=eG("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),h="reflect"===r?0:1,d="";if(1===a){var p="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(p,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(p,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        }\n      ")}else{var v="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(v,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(v,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")})),rY={kernelName:Tg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,s=jp().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nY(a.shape,i,o):new tY(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},aY=GG({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+NG+"\n  return result;\n"}),iY={kernelName:Ng,backendName:"webgl",kernelFunc:aY},oY=q((function e(t,n,r){G(this,e),this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")})),sY=GG({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),uY={kernelName:Lv,backendName:"webgl",kernelFunc:sY},cY="return a - b;",lY=GG({opSnippet:cY,packedOpSnippet:cY,supportsComplex:!0,cpuKernelImpl:XV}),fY={kernelName:Pm,backendName:"webgl",kernelFunc:lY};function hY(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=pp([r.dim],a.shape),o=UX({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),s=iI(o.shape,i),u=JG({inputs:{x:o},backend:n,attrs:{shape:s}}),c=lY({inputs:{a:a,b:u},backend:n}),l=Oq({inputs:{x:c},backend:n}),f=oH({inputs:{x:l},backend:n,attrs:{axis:i,keepDims:!1}}),h=JG({inputs:{x:f},backend:n,attrs:{shape:s}}),d=sY({inputs:{a:l,b:h},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),d}var dY={kernelName:km,backendName:"webgl",kernelFunc:hY};var pY={kernelName:Og,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:hY({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],f=new oY(c,l,i),h=[[o]],d=n.runWebGLProgram(f,[u],"int32",h);return s||n.disposeIntermediateTensorInfo(u),d}},vY=uG+"\n  return -x;\n",gY="\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n";var mY={kernelName:Pg,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),o=E(EV(i.values,a.shape,a.dtype),2),s=o[0],u=o[1];return r.makeTensorInfo(u,a.dtype,s)}return t=jp().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new kG(a.shape,gY):new sG(a.shape,vY),r.runWebGLProgram(t,[a],a.dtype)}},yY=bC;var bY={kernelName:Mg,backendName:"webgl",kernelFunc:function(e){Ym("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=n.readSync(a.dataId),l=n.readSync(i.dataId),f=yY(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},xY=xC;var kY={kernelName:Fg,backendName:"webgl",kernelFunc:function(e){Ym("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize,l=n.readSync(a.dataId),f=n.readSync(i.dataId),h=xY(l,f,o,s,u,c),d=h.selectedIndices,p=h.validOutputs;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},wY=kC;var IY={kernelName:Lg,backendName:"webgl",kernelFunc:function(e){Ym("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=n.readSync(a.dataId),f=n.readSync(i.dataId),h=wY(l,f,o,s,u,c),d=h.selectedIndices,p=h.selectedScores;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},CY=q((function e(t,n,r,a){G(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),AY={kernelName:zg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,s=r.onValue,u=r.offValue,c=sp(a.shape),l=new CY(c,o,s,u),f=JG({inputs:{x:a},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(l,[f],i);n.disposeIntermediateTensorInfo(f);var d=JG({inputs:{x:h},backend:n,attrs:{shape:[].concat(X(a.shape),[o])}});return n.disposeIntermediateTensorInfo(h),d}};function SY(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=hK({inputs:{input:r},backend:n}),i=SY({inputs:{x:a},backend:n}),o=EK({inputs:{input:r},backend:n}),s=SY({inputs:{x:o},backend:n}),u=DG({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return Wq({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var _Y={kernelName:Vm,backendName:"webgl",kernelFunc:SY};var EY={kernelName:jg,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=hK({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=EK({inputs:{input:a},backend:r}),u=SY({inputs:{x:s},backend:r}),c=DG({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return Wq({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var TY={kernelName:Ug,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return Pq({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){ip(a,e.shape,"All tensors passed to stack must have matching shapes"),ap(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=t.map((function(e){var t=Pq({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),u=OK({inputs:s,backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}},NY=q((function e(t,n,r){G(this,e),this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=DW(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")})),OY=q((function e(t,n,r){G(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=DW(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=eG("rc",a),c=eG("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),h=["".concat(i," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(l,") {")],d=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",v=0,g=1===a?2:4;v<g;v++)p+="\n        ".concat(h[v],"\n        if (").concat(d,") {\n          result[").concat(v,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")})),RY=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;if(0===sp(a.shape)){var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]}));return Wq({backend:n,attrs:{shape:s,value:o,dtype:a.dtype}})}var u=jp().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new OY(a.shape,i,o):new NY(a.shape,i,o),c=[[o]];return n.runWebGLProgram(u,[a],a.dtype,c)},PY={kernelName:Bg,backendName:"webgl",kernelFunc:RY},DY=GG({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+NG+"\n  return result;\n"}),MY={kernelName:Wg,backendName:"webgl",kernelFunc:DY};var FY={kernelName:Gg,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims,u=i.shape.length,c=[],l=pp(o,i.shape),f=l,h=sI(f,u),d=i;if(null!=h&&(d=uH({inputs:{x:i},backend:r,attrs:{perm:h}}),f=cI(f.length,u),c.push(d)),oI("prod",f,u),r.shouldExecuteOnCPU([d])){var p=r.texData.get(d.dataId).values,v=NV(d.shape,d.dtype,p,f),g=v.outVals,m=v.outShape,y=v.outDtype;t=r.makeTensorInfo(m,y,g)}else{var b=E(aI(d.shape,f),2),x=b[0],k=sp(b[1]),w=JG({inputs:{x:d},backend:r,attrs:{shape:[-1,k]}}),I=nH(w,Xy(i.dtype),"prod",r);t=JG({inputs:{x:I},backend:r,attrs:{shape:x}}),c.push(w),c.push(I)}if(s){c.push(t);var C=iI(t.shape,l);t=JG({inputs:{x:t},backend:r,attrs:{shape:C}})}return c.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}};var LY={kernelName:Hg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,s=r.outputRaggedRank,u=a.map((function(e){return n.readSync(e.dataId)})),c=a.map((function(e){return e.shape})),l=n.readSync(i.dataId),f=n.readSync(o.dataId),h=E(OV(u,c,l,i.shape,i.dtype,f,o.shape,s),3),d=h[0],p=h[1],v=h[2],g=d.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),m=n.makeTensorInfo(v,i.dtype,p);return g.concat([m])}};var jY={kernelName:Kg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=E(RV(o,r.shape,r.dtype,s,a.shape,u,i.shape),2),l=c[0],f=c[1];return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([f.length],r.dtype,f)]}};var zY={kernelName:qg,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,s=t.rowPartitionTensors,u=r.rowPartitionTypes,c=n.readSync(a.dataId),l=n.readSync(i.dataId),f=n.readSync(o.dataId),h=s.map((function(e){return n.readSync(e.dataId)})),d=s.map((function(e){return e.shape})),p=E(PV(c,a.shape,l,i.shape,i.dtype,f,o.shape,h,d,u),2),v=p[0],g=p[1];return n.makeTensorInfo(v,i.dtype,g)}},UY=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=DV(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},BY={kernelName:Xg,backendName:"webgl",kernelFunc:UY},WY=VG({opSnippet:"return 1.0 / x;"}),VY={kernelName:Zg,backendName:"webgl",kernelFunc:WY},GY=VG({opSnippet:uG+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),HY={kernelName:Qg,backendName:"webgl",kernelFunc:GY},KY=VG({opSnippet:uG+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),qY={kernelName:rm,backendName:"webgl",kernelFunc:KY},XY=q((function e(t,n,r,a,i){G(this,e),this.variableNames=["A"],this.outputShape=[];var o=E(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var f,h=[a&&n>1?u-1:u,a&&r>1?c-1:c],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(h[0]/d[0],",\n          ").concat(h[1]/d[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),YY=q((function e(t,n,r,a,i){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=E(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var f,h=[a&&n>1?u-1:u,a&&r>1?c-1:c],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(h[0]/d[0],",\n          ").concat(h[1]/d[1],",\n          ").concat(h[1]/d[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}));var ZY={kernelName:tm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=E(r.size,2),u=s[0],c=s[1],l=jp().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new YY(a.shape,u,c,i,o):new XY(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],"float32")}},QY=q((function e(t,n,r){G(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=E(n,3),i=a[1],o=a[2],s=E(t,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],f=[r&&u>1?u-1:u,r&&c>1?c-1:c],h=l[0]/f[0],d=l[1]/f[1],p=1/h,v=1/d,g=2*Math.ceil(p)+2,m=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(h,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(m,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var JY={kernelName:nm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new QY(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},$Y=q((function e(t,n,r,a,i){G(this,e),this.variableNames=["A"],this.outputShape=[];var o=E(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var f,h=[a&&n>1?u-1:u,a&&r>1?c-1:c],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";f=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(h[0]/d[0],",\n          ").concat(h[1]/d[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")})),eZ=q((function e(t,n,r,a,i){G(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=E(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var f,h=[a&&n>1?u-1:u,a&&r>1?c-1:c],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";f=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(h[0]/d[0],",\n          ").concat(h[1]/d[1],",\n          ").concat(h[1]/d[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}));var tZ={kernelName:$g,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=E(r.size,2),u=s[0],c=s[1],l=jp().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new eZ(a.shape,u,c,i,o):new $Y(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],a.dtype)}},nZ=q((function e(t,n,r){G(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=E(n,3),i=a[1],o=a[2],s=E(t,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],f=[r&&u>1?u-1:u,r&&c>1?c-1:c],h=l[0]/f[0],d=l[1]/f[1],p=1/h,v=1/d,g=2*Math.ceil(p)+2,m=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(h,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(m,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(l[0],") *\n                (float(dyR) / float(").concat(f[0],"));\n\n            float sourceFracCol =\n                float(").concat(l[1],") *\n                  (float(dyC) / float(").concat(f[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var rZ={kernelName:em,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new nZ(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},aZ=q((function e(t,n){G(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=DW(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),iZ=q((function e(t,n){G(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=eG("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=DW(r);function u(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return u(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",u(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}));var oZ={kernelName:am,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,s=pp(i,a.shape);if(0===o)return RG({inputs:{x:a},backend:n});var u=jp().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new iZ(a.shape,s):new aZ(a.shape,s);return n.runWebGLProgram(u,[a],a.dtype)}},sZ=q((function e(t,n){G(this,e),this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),uZ={kernelName:Hm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=new sZ(a.shape,o),l=E(fA(s,a.shape[1],a.shape[2]),2),f=[[l[0],l[1],Math.sin(i),Math.cos(i)]];return u.runWebGLProgram(c,[a],a.dtype,f)}},cZ=VG({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),lZ={kernelName:im,backendName:"webgl",kernelFunc:cZ},fZ=VG({opSnippet:"return inversesqrt(x);",cpuKernelImpl:MV}),hZ={kernelName:om,backendName:"webgl",kernelFunc:fZ},dZ=q((function e(t,n,r,a,i,o){G(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=DW(i.length),u=DW(o.length),c="";1===r?c="i":2===r&&(c="i, j");var l="getIndices(".concat(c,")"),f="";1===a?f="i":2===a&&(f="i, coords[1]");var h="getUpdates(".concat(f,")"),d=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(d,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")}));var pZ={kernelName:sm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=yA(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,f=s.strides,h=s.outputSize,d=[h/l,l];if(0===h)return n.makeTensorInfo(o,a.dtype);var p=JG({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),v=JG({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),m=new dZ(c,u,p.shape.length,v.shape.length,f,d),y=n.runWebGLProgram(m,[v,p,g],v.dtype),b=JG({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}},vZ=q((function e(t,n,r,a){G(this,e),this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];var i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(n+1)),"; ++i) { if (left >= right) break;"),o=2===jp().getNumber("WEBGL_VERSION")?"while (left < right) {":i,s="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}));var gZ={kernelName:um,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,s=new vZ(a.shape[0],a.shape[1],i.shape[1],o),u=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",u)}},mZ=q((function e(t,n,r){var a,i;if(G(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],c=0;c<n.length;c++)u.push("".concat(o[c])),c<t&&s.push("".concat(o[c]));a=s.join(),i=u.join()}var l=DW(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}));var yZ={kernelName:cm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new mZ(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],qy(a.dtype,i.dtype))}},bZ=VG({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(bA,";\n  float scale = ").concat(xA,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),xZ={kernelName:lm,backendName:"webgl",kernelFunc:bZ},kZ=VG({opSnippet:WG+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:LV}),wZ={kernelName:vm,backendName:"webgl",kernelFunc:kZ},IZ=VG({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),CZ={kernelName:pm,backendName:"webgl",kernelFunc:IZ},AZ=VG({opSnippet:WG+"\n  return sin(x);\n"}),SZ={kernelName:hm,backendName:"webgl",kernelFunc:AZ},_Z=VG({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),EZ={kernelName:dm,backendName:"webgl",kernelFunc:_Z},TZ=VG({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),NZ={kernelName:gm,backendName:"webgl",kernelFunc:TZ},OZ={kernelName:bm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;ap(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,X(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=[],f=RY({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),h=hA(f.shape,i,s,!1),d=dA(h.length,i.length,!1),p=pA(f.shape,i,s,!1),v=JG({inputs:{x:f},backend:n,attrs:{shape:h}}),g=uH({inputs:{x:v},backend:n,attrs:{perm:d}}),m=JG({inputs:{x:g},backend:n,attrs:{shape:p}});return l.push(f),l.push(v),l.push(g),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}};var RZ={kernelName:wm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.readSync(r.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],f=E(UV(s,r.shape,r.dtype,u,a.dtype,c,l),5),h=f[0],d=f[1],p=f[2],v=f[3],g=f[4];return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],a.dtype,p),n.makeTensorInfo([v.length],"bool",new Uint8Array(v.map((function(e){return Number(e)})))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};var PZ={kernelName:Im,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(i.dataId)),c=E(BV(s,r.shape,r.dtype,o,u),3),l=c[0],f=c[1],h=c[2];return[n.makeTensorInfo(f,r.dtype,l),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}};var DZ={kernelName:Cm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));var o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=E(WV(o,r.shape,r.dtype,s,u,!0),2),l=c[0],f=c[1];return n.makeTensorInfo(f,r.dtype,l)}};var MZ={kernelName:Am,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));var o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=E(WV(o,r.shape,r.dtype,s,u),2),l=c[0],f=c[1];return n.makeTensorInfo(f,r.dtype,l)}};var FZ={kernelName:Sm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=yA(0,a,s),c=u.sliceRank,l=u.numUpdates,f=u.sliceSize,h=u.strides,d=u.outputSize;if("string"===i.dtype){var p=n.bufferSync(a),v=n.bufferSync(i),g=wy(n.readSync(o.dataId)[0]),m=FV(p,v,s,d,f,l,c,h,g,false);return n.makeTensorInfo(s,m.dtype,m.values)}var y=new dZ(l,c,a.shape.length,i.shape.length,h,[d,1],false),b=n.runWebGLProgram(y,[i,a,o],i.dtype),x=JG({inputs:{x:b},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(b),x}};var LZ={kernelName:xm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=pp(r.axis,a.shape)[0],s=BA(a,i,o),u=a.shape.length,c=new Array(u).fill(0),l=a.shape.slice();return s.map((function(e){var t=X(l);t[o]=e;var r=iK({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,r}))}},jZ="return sqrt(x);",zZ=VG({opSnippet:jZ,packedOpSnippet:jZ,cpuKernelImpl:VV}),UZ={kernelName:mm,backendName:"webgl",kernelFunc:zZ},BZ={kernelName:Em,backendName:"webgl",kernelFunc:VG({opSnippet:"return x * x;"})},WZ="return (a - b) * (a - b);",VZ=GG({opSnippet:WZ,packedOpSnippet:WZ}),GZ={kernelName:_m,backendName:"webgl",kernelFunc:VZ};var HZ={kernelName:Gm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=uG+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new sG(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},KZ=q((function e(t,n,r){G(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=DW(r.length),o=DW(r.length),s="";if(1===a)s="coords * strides + begin";else{var u=0;s=r.map((function(e,t){return u++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(u-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}));var qZ={kernelName:Tm,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,s=a.end,u=a.strides,c=a.beginMask,l=a.endMask,f=a.ellipsisMask,h=a.newAxisMask,d=a.shrinkAxisMask,p=Hk(i.shape,o,s,u,c,l,f,h,d),v=p.finalShapeSparse,g=p.finalShape,m=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,x=p.begin,k=p.end,w=p.strides;if(m)t=JG({inputs:{x:i},backend:r,attrs:{shape:g}});else if(y||b){ap(i.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(i.shape.length)}));var I=Bk(x,k,w),C=iK({inputs:{x:i},backend:r,attrs:{begin:x,size:I}});t=JG({inputs:{x:C},backend:r,attrs:{shape:g}}),r.disposeIntermediateTensorInfo(C)}else{if(r.shouldExecuteOnCPU([i])){var A=r.readSync(i.dataId),S=_x(i.shape,i.dtype,A),_=GV(v,S,w,x);t=r.makeTensorInfo(g,i.dtype,_.values)}else{var E=new KZ(x,w,v);t=r.runWebGLProgram(E,[i],i.dtype)}}var T=JG({inputs:{x:t},backend:r,attrs:{shape:g}});return r.disposeIntermediateTensorInfo(t),T}};var XZ={kernelName:Nm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,c=r.preserveShortSequences,l=t.data,f=t.dataSplits,h=n.readSync(l.dataId),d=n.readSync(f.dataId),p=E(HV(h,d,a,i,o,s,u,c),2),v=p[0],g=p[1];return[n.makeTensorInfo([v.length],"string",v),n.makeTensorInfo(f.shape,"int32",g)]}};var YZ={kernelName:Om,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=n.readSync(a.dataId),s=n.readSync(i.dataId)[0],u=E(KV(o,s,r),3),c=u[0],l=u[1],f=u[2],h=l.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(f))]}};var ZZ={kernelName:Rm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=n.readSync(a.dataId),o=qV(i,r);return n.makeTensorInfo(a.shape,"int32",o)}},QZ=VG({opSnippet:"return tan(x);"}),JZ={kernelName:Dm,backendName:"webgl",kernelFunc:QZ},$Z=VG({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),eQ={kernelName:Mm,backendName:"webgl",kernelFunc:$Z},tQ=q((function e(t,n){G(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=DW(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}));function nQ(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype||a.shape.length>5){var o=n.readSync(a.dataId),s="string"===a.dtype?o.map((function(e){return wy(e)})):o,u=_x(a.shape,a.dtype,s),c=YV(u,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}var l=new tQ(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}var rQ={kernelName:Fm,backendName:"webgl",kernelFunc:nQ},aQ=q((function e(t){G(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "})),iQ=q((function e(t){G(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}));function oQ(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function sQ(e){for(var t=1;t<e;)t*=2;return t}var uQ={kernelName:Lm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,s=jp().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=jp().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,l=c[c.length-1];if(n.shouldExecuteOnCPU([a])||l<s||i>u){var f=n.readSync(a.dataId),h=E(ZV(f,c,a.dtype,i,o),2),d=h[0],p=h[1];return[n.makeTensorInfo(d.shape,d.dtype,d.values),n.makeTensorInfo(p.shape,p.dtype,p.values)]}if(0===i)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===l)return[a,Wq({attrs:{shape:c,dtype:"int32",value:0},backend:n})];var v=n.texData.get(a.dataId),g=null!==v&&v.isPacked,m=g?n.unpackTensor(a):a,y=sp(c)/l,b=JG({inputs:{x:m},attrs:{shape:[y,l]},backend:n});g&&oQ(n,m);for(var x=sQ(i),k=sQ(l),w=null,I=function(){return null===w?[b,b]:[b,w]},C=function(e,t,r){var a=I(),i=new aQ(r),o=[[l],[null===w?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=w;w=n.runWebGLProgram(i,a,"int32",o),oQ(n,s)},A=1;A<x;A*=2)for(var S=2*A,_=A;_>=1;_/=2)C(S,_,[y,k]);for(var T=k;T>x;T/=2){var N=I(),O=new iQ([y,T/2]),R=[[l],[null===w?1:0],[x]],P=w;w=n.runWebGLProgram(O,N,"int32",R),oQ(n,P);for(var D=x/2,M=2*D,F=D;F>=1;F/=2)C(M,F,w.shape)}var L=w;w=iK({inputs:{x:w},backend:n,attrs:{begin:0,size:[y,i]}}),oQ(n,L);var j=sX({inputs:{x:b,indices:w},backend:n,attrs:{axis:1,batchDims:1}});oQ(n,b);var z=c.slice(0,-1);z.push(i),L=w,w=JG({inputs:{x:w},attrs:{shape:z},backend:n}),oQ(n,L);var U=j;return j=JG({inputs:{x:j},attrs:{shape:z},backend:n}),oQ(n,U),[j,w]}},cQ=q((function e(t,n,r,a,i,o){G(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var s,u="nearest"===r?1:2;switch(a){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(u," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}));var lQ={kernelName:jm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.transforms,o=r.interpolation,s=r.fillMode,u=r.fillValue,c=r.outputShape,l=E(a.shape,4),f=l[0],h=l[1],d=l[2],p=l[3],v=E(null!=c?c:[h,d],2),g=v[0],m=v[1],y=new cQ(h,d,o,s,u,[f,g,m,p]);return n.runWebGLProgram(y,[a,i],"float32")}};var fQ={kernelName:Um,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;gW(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=JV(o,a,i.shape,i.dtype),u=s.outputValues,c=s.outputShape,l=s.indices;return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}};var hQ={kernelName:Bm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1),l=0,f=0;f<s;f++)f!==i&&(c[l++]=o.shape[f]);var h=[],d=new Array(s).fill(0),p=o.shape.slice();p[i]=1;for(var v=new Array(u),g=0;g<v.length;g++){d[i]=g;var m=iK({inputs:{x:o},backend:n,attrs:{begin:d,size:p}}),y=JG({inputs:{x:m},backend:n,attrs:{shape:c}});v[g]=y,h.push(m)}return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}},dQ=q((function e(t,n){G(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var u=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}));for(var pQ={kernelName:Wm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,s=a.shape.length,u=[],c=0,l=sI([c],s),f=a;null!=l&&(f=uH({inputs:{x:a},backend:n,attrs:{perm:l}}),u.push(f),c=cI(1,s)[0]);var h=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(f.shape,c,o),d=sp([f.shape[c]]),p=JG({inputs:{x:f},backend:n,attrs:{shape:[-1,d]}});u.push(p);var v=function e(t,r,a,i,o){var s=t.shape[0],c=t.shape[1],l=function(e,t){var n,r=!1;for(e<=cA?(n=e,r=!0):n=Cp(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Cp(e,n+1);return n}(c,o),f=new dQ({windowSize:l,inSize:c,batchSize:s,numSegments:o},r),h=n.compileAndRun(f,[t,a],i);if(u.push(h),h.shape[1]===o)return h;var d=UY({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),p=nQ({inputs:{x:d},backend:n,attrs:{reps:[c/l]}});return u.push(d),u.push(p),e(h,r,p,i,o)}(p,"unsortedSegmentSum",i,Xy(a.dtype),o),g=JG({inputs:{x:v},backend:n,attrs:{shape:h}}),m=g;if(null!=l){u.push(g);var y=uI(l);m=uH({inputs:{x:m},backend:n,attrs:{perm:y}})}return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}},vQ=0,gQ=[hH,pH,gH,yH,kH,CH,AH,SH,RH,PH,MH,LH,zH,BH,VH,KH,qH,ZH,QH,JH,tK,sK,uK,cK,vK,yK,kK,MG,CK,RK,UK,HK,KK,qK,XK,ZK,JK,eq,nq,sq,uq,cq,fq,pq,mq,yq,xq,wq,Iq,Aq,Sq,Eq,Nq,Rq,Dq,Lq,Uq,Gq,Kq,Yq,Qq,eX,nX,rX,iX,uX,lX,hX,PG,dX,TK,vX,mX,bX,jG,kX,IX,CX,SX,EX,NX,RX,DX,LX,zX,BX,VX,GX,HX,XX,YX,ZX,QX,JX,eY,rY,iY,pY,QG,mY,bY,kY,IY,fK,AY,EY,TY,PY,MY,BG,FY,LY,jY,zY,BY,dK,uY,VY,HY,qY,$G,ZY,JY,tZ,rZ,oZ,uZ,lZ,hZ,pZ,gZ,yZ,xZ,wZ,CZ,SZ,EZ,oK,dY,NZ,OZ,RZ,PZ,DZ,MZ,FZ,LZ,UZ,BZ,GZ,HZ,qZ,XZ,YZ,ZZ,fY,sH,JZ,eQ,rQ,uQ,lQ,cH,fQ,hQ,pQ,_Y];vQ<gQ.length;vQ++){ty(gQ[vQ])}function mQ(e,t){var n;if(null!==e&&void 0!==e&&e.type)return e;var r=null===e||void 0===e?void 0:e.data,a=function(e){var t,n,r,a,i,o,s,u,c,l,f,h,d,p,v,g,m,y,b,x,k,w,I,C,A,S,_,E,T,N,O,R,P,D,M,F,L,j=" ";j=null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.domain?null===e||void 0===e||null===(r=e.data)||void 0===r||null===(a=r.url)||void 0===a?void 0:a.replaceAll("amp;",""):null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.link_url;"redgifs.com"===(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.domain)&&(j=null===e||void 0===e||null===(o=e.data)||void 0===o||null===(s=o.media)||void 0===s||null===(u=s.oembed)||void 0===u||null===(c=u.html)||void 0===c||null===(l=c.split('"')[1])||void 0===l?void 0:l.replaceAll("amp;",""));"v.redd.it"===(null===e||void 0===e||null===(f=e.data)||void 0===f?void 0:f.domain)&&(j=null===e||void 0===e||null===(h=e.data)||void 0===h||null===(d=h.media)||void 0===d||null===(p=d.reddit_video)||void 0===p||null===(v=p.fallback_url)||void 0===v?void 0:v.replaceAll("amp;",""));"i.redd.it"===(null===e||void 0===e||null===(g=e.data)||void 0===g?void 0:g.domain)&&(j=null===e||void 0===e||null===(m=e.data)||void 0===m||null===(y=m.url)||void 0===y?void 0:y.replaceAll("amp;",""));if(null!==e&&void 0!==e&&null!==(b=e.data)&&void 0!==b&&null!==(x=b.domain)&&void 0!==x&&x.includes("imgur")){var z,U,B,W,V=null===e||void 0===e||null===(z=e.data)||void 0===z?void 0:z.url;j=null!==V&&void 0!==V&&V.includes("jpg")||null!==V&&void 0!==V&&V.includes("png")?V:null===e||void 0===e||null===(U=e.data)||void 0===U||null===(B=U.preview)||void 0===B||null===(W=B.reddit_video_preview)||void 0===W?void 0:W.fallback_url}"gfycat.com"===(null===e||void 0===e||null===(k=e.data)||void 0===k?void 0:k.domain)&&(j=null===e||void 0===e||null===(w=e.data)||void 0===w||null===(I=w.media)||void 0===I||null===(C=I.oembed)||void 0===C||null===(A=C.html)||void 0===A||null===(S=A.split('"')[3])||void 0===S?void 0:S.replaceAll("amp;",""));"m.youtube.com"===(null===e||void 0===e||null===(_=e.data)||void 0===_?void 0:_.domain)&&(j="https://www.youtube.com/embed/"+(null===e||void 0===e||null===(E=e.data)||void 0===E||null===(T=E.url)||void 0===T?void 0:T.split("=")[1]));j&&null!==(N=j)&&void 0!==N&&N.includes("&")&&(j=null===(O=j)||void 0===O?void 0:O.split("&")[0]);null!==e&&void 0!==e&&null!==(R=e.data)&&void 0!==R&&null!==(P=R.domain)&&void 0!==P&&P.includes("gfycat")&&(j=null===e||void 0===e||null===(D=e.data)||void 0===D||null===(M=D.preview)||void 0===M||null===(F=M.reddit_video_preview)||void 0===F||null===(L=F.fallback_url)||void 0===L?void 0:L.replaceAll("amp;",""));return j}(e),i=kQ(e)||a,o=(null===r||void 0===r?void 0:r.selftext)||(null===r||void 0===r?void 0:r.body),s=null===r||void 0===r?void 0:r.title;o&&"string"===typeof o&&(o=(o=(o=o.replaceAll("&amp;","&")).replaceAll("&gt;",">")).replaceAll("&lt;","<")),s&&"string"===typeof s&&(s=(s=(s=s.replaceAll("&amp;","&")).replaceAll("&gt;",">")).replaceAll("&lt;","<"));var u=(Y(n={id:(null===e||void 0===e?void 0:e.kind)+"_"+(null===r||void 0===r?void 0:r.id),mainUrl:a,type:wQ(e,a),displayType:IQ(a),previewUrl:i||a,title:s,permalink:null===r||void 0===r?void 0:r.permalink},"title",null===r||void 0===r?void 0:r.title),Y(n,"subreddit_name_prefixed",null===r||void 0===r?void 0:r.subreddit_name_prefixed),Y(n,"author",null===r||void 0===r?void 0:r.author),Y(n,"text",o),Y(n,"kind",null===e||void 0===e?void 0:e.kind),Y(n,"index",null===e||void 0===e?void 0:e.index),n);return u=YQ(u)}var yQ=!0;function bQ(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(BQ("raw post array"),BQ(e),!Array.isArray(e))return zQ("error: parseRawPostArray given a non array object"),[[],null];if(0==e.length)return[[],null];var r=[];e.forEach((function(e){var t=mQ(e);r.push(t)}));var a=null===(t=r[r.length-1])||void 0===t?void 0:t.id;return zQ("last post id: "+a+" from:"),zQ(r[r.length-1]),yQ&&(r=function(e,t){var n=[];return e.forEach((function(e){return null!==e&&void 0!==e&&e.id?e.previewUrl&&e.previewUrl.includes("gallery")?(zQ("removed invalid post (preview url is a gallery link) with data:"),zQ(e),null):"string"!==typeof e.previewUrl?(zQ("removed invalid post (preview url is not a string) with data:"),zQ(e),null):"text"===(null===e||void 0===e?void 0:e.displayType)||e.previewUrl.includes(".jpg")||e.previewUrl.includes(".png")||e.previewUrl.includes(".g")?e.mainUrl||e.text?e&&xQ(e,n)||e&&xQ(e,t)?(zQ("removed invalid post (post has same preview url of an existing post) with data:"),zQ(e),null):void n.push(e):(zQ("removed invalid post (post has not main url and no text content) with data:"),zQ(e),null):(zQ("removed invalid post (preview url is not a standard image type) with data:"),zQ(e),null):null})),n}(r,n)),[r,a]}function xQ(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,r=t.length;r>0&&r>t.length-100;r--){var a,i=null===(a=t[r])||void 0===a?void 0:a.previewUrl;typeof i===nA&&(i=i.split("?")[0]);var o=null===e||void 0===e?void 0:e.previewUrl;typeof o===nA&&(o=o.split("?")[0]),i===o&&(n=!0)}return n}function kQ(e){var t,n,r="";try{var a,i,o,s,u,c,l,f;r=null!==e&&void 0!==e&&null!==(a=e.data)&&void 0!==a&&a.domain?null===e||void 0===e||null===(i=e.data)||void 0===i||null===(o=i.preview)||void 0===o||null===(s=o.images[0])||void 0===s||null===(u=s.source)||void 0===u||null===(c=u.url)||void 0===c?void 0:c.replaceAll("amp;",""):null===e||void 0===e||null===(l=e.data)||void 0===l||null===(f=l.linkurl)||void 0===f?void 0:f.replaceAll("amp;","")}catch(h){}r||(r=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.url);r||(r=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.url_overridden_by_dest);return r}function wQ(e,t){var n="image";try{var r,a,i,o,s;("redgifs.com"===(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.domain)||"v.redd.it"===(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.domain)||"gfycat.com"===(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.domain)||"imgur.com"===(null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.domain)||"m.youtube.com"===(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.domain)||null!==t&&void 0!==t&&t.includes("gif")||null!==t&&void 0!==t&&t.includes(".mp4"))&&(n="video")}catch(u){}return n}function IQ(e){if(!e)return"none";var t="";try{e.includes("gifv")&&e.includes("imgur")||(t=e.includes("redgif")?"iframe":null!==e&&void 0!==e&&e.includes(".jpg")||null!==e&&void 0!==e&&e.includes(".png")||null!==e&&void 0!==e&&e.includes(".gifv")||null!==e&&void 0!==e&&e.includes(".gif")?"image":null!==e&&void 0!==e&&e.includes("/r/")?"text":null!==e&&void 0!==e&&e.includes("gallery")?"none":"video")}catch(n){t="none"}return t}function CQ(e,t){e&&e.stopPropagation();var n=window.location.href,r="";r=null!==t&&void 0!==t&&t.includes("http")?t:n.includes("localhost")?"http://localhost:3000/?"+t:"https://abeapple.github.io/redflix2/?"+t,window.open(r,"_blank")}function AQ(e){return"string"===typeof e?e.replaceAll("amp;",""):""}function SQ(){var e,t=window.location.href;return t=null===(e=t)||void 0===e?void 0:e.split("?"),t=Array.isArray(t)&&t.length>1?t[1]:"home"}var _Q=Ks({name:"dataSlice",initialState:{sub:null,linkToAdd:null,postArray:[],page:"home",showAddToListMenu:!1,lastPostId:null,loading:!0,adminPostData:null},reducers:{setPage:function(e,t){e.page=t.payload},setLoading:function(e,t){e.loading=t.payload},parseSub:function(e,t){var n=SQ();e.sub=n,e.linkToAdd=n},setLastPostId:function(e,t){e.lastPostId=t.payload},setLinkToAdd:function(e,t){e.linkToAdd=t.payload},pushToPosts:function(e,t){if(t.payload&&Array.isArray(t.payload)){var n=[].concat(X(e.postArray),X(t.payload));e.postArray=n,e.loading=!1}},setPosts:function(e,t){e.postArray=t.payload},setShowAddToListMenu:function(e,t){e.showAddToListMenu=t.payload},setAdminPostData:function(e,t){e.adminPostData=t.payload}}}),EQ=_Q.reducer,TQ=_Q.actions,NQ=TQ.parseSub,OQ=TQ.pushToPosts,RQ=TQ.setPage,PQ=TQ.setShowAddToListMenu,DQ=TQ.setLinkToAdd,MQ=TQ.setPosts,FQ=(TQ.setLastPostId,TQ.setLoading),LQ=TQ.setAdminPostData,jQ=!1;function zQ(e){jQ&&console.log(e)}var UQ=!1;function BQ(e){UQ&&console.log(e)}function WQ(e){if(e&&"string"===typeof e&&!e.includes("user/")){var t=e.split("/")[1];Yd(Rd(uJ,"redflix/stats/pages/"+t),(function(e){return e?e.count++:((e={}).count=1,e.dates=[]),e}))}}function VQ(e){if(e&&"string"===typeof e&&!e.includes("r/")){var t=e.split("/");t=t.length>1?t[1]:t[0],Yd(Rd(uJ,"redflix/stats/userPages/"+t),(function(e){return e?e.count++:((e={}).count=1,e.dates=[]),e}))}}function GQ(e,t,n,r){HQ(e)&&HQ(t)&&HQ(n)&&Yd(Rd(uJ,"redflix/"+e+"/"+t+"/"+n),(function(e){return e?e.count++:((e={}).count=1,HQ(r)&&(e.link=r)),e}))}function HQ(e){return!(!e||"string"!==typeof e||e.length<1)}function KQ(e,t){var n=[];return e.forEach((function(e){(null===e||void 0===e?void 0:e.id)!=t&&n.push(e)})),n}function qQ(e,t){e||(e=new Date);var n=e.getFullYear().toString()+"-"+XQ((e.getMonth()+1).toString())+"-"+XQ(e.getDate().toString());return t&&(n+=" "+[XQ(e.getHours()),XQ(e.getMinutes()),XQ(e.getSeconds())].join(":")),n}function XQ(e){var t=e.toString();return t.length<2?"0"+t:t}var YQ=function e(t){var n={};return Object.keys(t).forEach((function(r){t[r]===Object(t[r])?n[r]=e(t[r]):void 0!==t[r]&&(n[r]=t[r])})),n};var ZQ=Ks({name:"logSlice",initialState:{userId:null,subUrl:null,sessionId:null,postsInView:[],postsInThresholdView:[],mainPostInView:null,scrollActions:[]},reducers:{parseSubForLog:function(e){var t=SQ();if(e.subUrl!=t){var n=t+" "+qQ(null,!0),r=n.split("/");r.length>1&&(n=r[0]+"_"+r[1]),e.sessionId=n}e.subUrl=t},setUserIdForLog:function(e,t){var n=t.payload;e.userId!=n&&function(e){if(e){var t=qQ();Fd(Rd(uJ,"redflix/loginDates/"+e+"/"+t),!0)}}(n),e.userId=n},logScrollMovement:function(e,t){},postInView:function(e,t){var n=tt({},t.payload.postData);n.timeFirstVisible=t.payload.timeOfThreshold,e.postsInView.push(n)},postThresholdInView:function(e,t){var n=tt({},t.payload.postData);n.timeAtThreshold=t.payload.timeOfThreshold,e.postsInThresholdView.push(n)},postOutOfView:function(e,t){var n,r,a,i;e.postsInView=KQ(e.postsInView,null===t||void 0===t||null===(n=t.payload)||void 0===n||null===(r=n.postData)||void 0===r?void 0:r.id),e.postsInThresholdView=KQ(e.postsInThresholdView,null===t||void 0===t||null===(a=t.postData)||void 0===a||null===(i=a.post)||void 0===i?void 0:i.id)},postIsMain:function(e,t){zQ("postIsMain"),zQ(t.payload)},userSelectedPost:function(e,t){var n=tt({},t.payload);n.selectedData=(new Date).toString(),function(e,t){if(HQ(t)){var n=null===e||void 0===e?void 0:e.id;GQ("stats","posts",n,null===e||void 0===e?void 0:e.permalink),GQ("userActivity",t+"/postClicks",n,null===e||void 0===e?void 0:e.permalink);var r=null===e||void 0===e?void 0:e.subreddit_name_prefixed;if(HQ(r)){var a=r.split("/");r=a[1]}GQ("stats","pages",r),GQ("userActivity",t+"/pageClicks",r);var i=null===e||void 0===e?void 0:e.author;GQ("stats","userPages",i),GQ("userActivity",t+"/userPagesClicks",i)}}(n=YQ(n),e.userId),Yd(Rd(uJ,"redflix/userActivity/"+e.userId+"/sessions/"+e.sessionId),(function(t){return t?(t.clickCount++,t.postClickIdArray.push(n.id)):((t={}).date=qQ(),t.subUrl=e.subUrl,t.viewCount=0,t.clickCount=1,t.postViewIdArray=["a"],t.postClickIdArray=[n.id]),t}))},userSavedPost:function(e,t){zQ("userSavedPost"),zQ(t.payload)},userSavedPage:function(e,t){zQ("userSavedPage"),zQ(t.payload)},userRating:function(e,t){zQ("userRating"),zQ(t.payload),Fd(Rd(uJ,"redflix/userActivity/"+e.userId+"/userRatings/"+t.payload.postID+t.payload.type),t.payload)},userMessage:function(e,t){zQ("userMessage"),zQ(t.payload)},incrementPostsViewedCount:function(e,t){e.postViewCount++,e.userId&&e.sessionId?Yd(Rd(uJ,"redflix/userActivity/"+e.userId+"/sessions/"+e.sessionId),(function(n){return n?(n.viewCount++,n.postViewIdArray.push(t.payload)):((n={}).date=qQ(),n.subUrl=e.subUrl,n.viewCount=1,n.clickCount=0,n.postViewIdArray=[t.payload],n.postClickIdArray=["a"]),n})):console.log("no user id or no session id in incrementPostsViewedCount")},incrementSessionPageClick:function(e,t){Yd(Rd(uJ,"redflix/userActivity/"+e.userId+"/sessions/"+e.sessionId),(function(e){return e?(e.pageClicks||(e.pageClicks=[]),e.pageClicks.push(t.payload)):((e={}).date=qQ(),e.pageClicks=[],e.pageClicks.push(t.payload)),e}))}}}),QQ=ZQ.reducer,JQ=ZQ.actions,$Q=JQ.setUserIdForLog,eJ=(JQ.logScrollMovement,JQ.postInView,JQ.postThresholdInView,JQ.postOutOfView,JQ.postIsMain,JQ.userSelectedPost),tJ=(JQ.userSavedPost,JQ.userSavedPage),nJ=JQ.userRating,rJ=(JQ.userMessage,JQ.parseSubForLog),aJ=JQ.incrementPostsViewedCount,iJ=JQ.incrementSessionPageClick,oJ=Ft({apiKey:"AIzaSyBDWCKZwSBi_Qp4U0u3D2tKrcIU290IrDE",authDomain:"defaultproject-c023e.firebaseapp.com",databaseURL:"https://defaultproject-c023e-default-rtdb.firebaseio.com",projectId:"defaultproject-c023e",storageBucket:"defaultproject-c023e.appspot.com",messagingSenderId:"147977670881",appId:"1:147977670881:web:fe1532718095f374bbe7a0",measurementId:"G-VY1DMS0BKY"}),sJ=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt(),t=Ot(e,"auth");if(t.isInitialized())return t.getImmediate();var n=function(e,t){var n=Ot(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(Oe(n.getOptions(),null!==t&&void 0!==t?t:{}))return r;ln(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:to,persistence:[Ya,Ia,Aa]}),r=de("authTokenSyncURL");if(r){var a=lo(r);!function(e,t,n){Be(e).beforeAuthStateChanged(t,n)}(n,a,(function(){return a(n.currentUser)})),function(e,t,n,r){Be(e).onIdTokenChanged(t,n,r)}(n,(function(e){return a(e)}))}var i=le("auth");return i&&Sr(n,"http://".concat(i)),n}(oJ),uJ=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt(),t=arguments.length>1?arguments[1]:void 0,n=Ot(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){var r=fe("database");r&&qd.apply(void 0,[n].concat(X(r)))}return n}(oJ);var cJ=Ks({name:"userDataSlice",initialState:{userId:null,favColor:null,displayName:"Anonymous User",lists:[],allUsersJson:{},listToAddTo:null,listToView:null,isAnonymous:!1,isAdmin:!1,showLikeButtons:!0,postWeightArray:[{link:"r/petitegonewild",type:"nsfw",weight:50},{link:"r/gonewild",type:"nsfw",weight:50},{link:"r/realgirls",type:"nsfw",weight:50},{link:"r/jilling",type:"nsfw",weight:50},{link:"r/collegesluts",type:"nsfw",weight:50},{link:"r/onoff",type:"nsfw",weight:50},{link:"r/itookapicture",type:"sfw",weight:50},{link:"r/earthporn",type:"sfw",weight:10},{link:"r/art",type:"sfw",weight:10},{link:"r/jokes",type:"sfw",weight:10}],postViewCount:0,blur:!1,seenAdminPosts:[],adminPostArray:[],userAdminPostArray:[],userRatings:{}},reducers:{setUserId:function(e,t){e.userId=t.payload},setBlur:function(e,t){e.blur=t.payload,e.userId&&Fd(Rd(uJ,"redflix/userData/"+e.userId+"/blur"),t.payload)},setAnonymous:function(e,t){e.isAnonymous=t.payload},saveAllUsersJson:function(e,t){e.allUsersJson=t.payload},saveUserLists:function(e,t){if(t.payload){var n=[];Object.entries(t.payload).forEach((function(t,r){var a,i,o={id:t[0],name:null===(a=t[1])||void 0===a?void 0:a.name,links:null===(i=t[1])||void 0===i?void 0:i.links,index:r,description:t[1].description};if(n.push(o),"home"==o.name)try{var s=function(e){var t=[];return e.forEach((function(e){t.push({link:e,weight:50,type:"nsfw"})})),t}(o.links),u=X(e.postWeightArray);s.forEach((function(e){var t=!1;u.forEach((function(n){var r,a;(null===n||void 0===n||null===(r=n.link)||void 0===r?void 0:r.toLowerCase())==(null===e||void 0===e||null===(a=e.link)||void 0===a?void 0:a.toLowerCase())&&(t=!0)})),t||u.push(e)})),e.postWeightArray=u}catch(c){}})),n.sort((function(e,t){return(null===e||void 0===e?void 0:e.index)-(null===t||void 0===t?void 0:t.index)})),e.lists=n}},setPostWeightArray:function(e,t){e.postWeightArray=t.payload},addLinkToPostDataArray:function(e,t){e.postWeightArray.push({link:t.payload.link,weight:t.payload.weight})},saveUserData:function(e,t){var n,r,a,i,o,s,u=null===(n=t.payload)||void 0===n?void 0:n.name;u||(u="Anonymous User"),e.displayName=u;var c=null===(r=t.payload)||void 0===r?void 0:r.favColor;c||(c="slateblue"),e.favColor=c,e.isAdmin=null===(a=t.payload)||void 0===a?void 0:a.isAdmin,e.blur=null===(i=t.payload)||void 0===i?void 0:i.blur,e.seenAdminPosts=null===(o=t.payload)||void 0===o?void 0:o.seenAdminPosts;null===(s=t.payload)||void 0===s||s.userAdminPosts},addList:function(e,t){e.userId&&Fd(Dd(Rd(uJ,"redflix/userData/"+e.userId+"/lists")),{name:t.payload,links:[],index:e.lists.length})},deleteList:function(e,t){t.payload&&e.userId&&Fd(Rd(uJ,"redflix/userData/"+e.userId+"/lists/"+t.payload),null)},copyList:function(e,t){if(t.payload&&e.userId){var n=e.lists.find((function(e){return e.id===t.payload}));if(n){var r=Dd(Rd(uJ,"redflix/userData/"+e.userId+"/lists"));Fd(r,{name:n.name+" (copy)",links:n.links,index:e.lists.length}),e.listToView=r.key}}},addUrlToList:function(e,t){var n;if(e.userId){var r=e.listToAddTo;if(r||(r=null===(n=e.lists[0])||void 0===n?void 0:n.id),r){var a=e.lists.find((function(e){return e.id===r})).links;a||(a=[]),a.find((function(e){return e===t.payload}))||(a.push(t.payload),Fd(Rd(uJ,"redflix/userData/"+e.userId+"/lists/"+r+"/links"),a))}}},removeUrlFromList:function(e,t){var n;if(e.listToView){var r=null===(n=e.lists.find((function(t){return(null===t||void 0===t?void 0:t.id)===e.listToView})))||void 0===n?void 0:n.links,a=[];r.forEach((function(e){e!==t.payload&&a.push(e)})),Fd(Rd(uJ,"redflix/userData/"+e.userId+"/lists/"+e.listToView+"/links"),a)}},setListToAddTo:function(e,t){e.listToAddTo=t.payload},setListToView:function(e,t){e.listToView=t.payload},updateListName:function(e,t){t.payload.newListName&&t.payload.listId&&Fd(Rd(uJ,"redflix/userData/"+e.userId+"/lists/"+t.payload.listId+"/name"),t.payload.newListName)},updateListDescription:function(e,t){t.payload.newListDescription&&t.payload.listId&&Fd(Rd(uJ,"redflix/userData/"+e.userId+"/lists/"+t.payload.listId+"/description"),t.payload.newListDescription)},updateUserName:function(e,t){if(e.userId&&t.payload){Fd(Rd(uJ,"redflix/userData/"+e.userId+"/name"),t.payload);var n=e.userId;setTimeout((function(){Fd(Rd(uJ,"redflix/users/"+n+"/name"),t.payload)}),500)}},updateUserFavColor:function(e,t){if(e.userId&&t.payload){Fd(Rd(uJ,"redflix/userData/"+e.userId+"/favColor"),t.payload);var n=e.userId;setTimeout((function(){Fd(Rd(uJ,"redflix/users/"+n+"/favColor"),t.payload)}),500)}},sawAdminPost:function(e,t){console.log("saw admin post "+t.payload+" on "+qQ());var n={postID:t.payload,date:qQ()},r="redflix/userData/"+e.userId+"/seenAdminPosts";console.log("saving to: "+r),console.log(n),Fd(Dd(Rd(uJ,"redflix/userData/"+e.userId+"/seenAdminPosts")),n)},saveAdminPostArray:function(e,t){console.log("saving admin post array: "),console.log(t.payload),t.payload&&Array.isArray(t.payload)?e.adminPostArray=t.payload:console.log("invalid admin post array in saveAdminPostArray")},saveSeenAdminPosts:function(e,t){e.seenAdminPosts=t.payload},saveUserRatings:function(e,t){e.userRatings=t.payload}}}),lJ=cJ.reducer,fJ=cJ.actions,hJ=fJ.setUserId,dJ=fJ.saveAllUsersJson,pJ=fJ.saveUserLists,vJ=fJ.addList,gJ=fJ.setListToAddTo,mJ=fJ.addUrlToList,yJ=fJ.setListToView,bJ=fJ.removeUrlFromList,xJ=fJ.updateListName,kJ=fJ.updateUserName,wJ=fJ.updateUserFavColor,IJ=fJ.saveUserData,CJ=fJ.deleteList,AJ=fJ.copyList,SJ=fJ.setAnonymous,_J=(fJ.addLinkToPostDataArray,fJ.setPostWeightArray),EJ=fJ.updateListDescription,TJ=fJ.setBlur,NJ=fJ.sawAdminPost,OJ=fJ.saveAdminPostArray,RJ=fJ.saveSeenAdminPosts,PJ=fJ.saveUserRatings;var DJ=function(){var e=g((function(e){return e.userDataSlice.userId})),t=g((function(e){return e.userDataSlice.isAnonymous})),n=E((0,r.useState)(!0),2),a=n[0],i=n[1],o=E((0,r.useState)(""),2),s=o[0],u=o[1],c=(0,r.useRef)(),l=(0,r.useRef)();function f(e){"Firebase: Error (auth/invalid-email)."===e?u("Invalid Email"):"Firebase: Error (auth/wrong-password)."===e?u("Check Password"):"Firebase: Error (auth/email-already-in-use)."===e?u("Email Already in use"):"Firebase: Error (auth/user-not-found)."===e?u("There is no account associate with that email"):(u("Auth error"),console.log("auth error: "+e))}function h(e){i(e),u("")}return(0,O.jsx)(O.Fragment,{children:e&&!t?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{children:"Account Actions"}),(0,O.jsx)("button",{onClick:function(){(function(e){return Be(e).signOut()})(sJ).then((function(e){})).catch((function(e){console.log("sign out error: "+e)}))},children:"Log Out"})]}):(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{className:"authTitle",title:"If the browser cache is cleared all local data will be lost.\nAn account allows data to be saved and used on multiple devices.",children:a?"Create Account":"Login"}),(0,O.jsx)("div",{children:(0,O.jsx)("input",{placeholder:"email",ref:c})}),(0,O.jsx)("div",{children:(0,O.jsx)("input",{placeholder:"pass",type:"password",ref:l})}),a&&(0,O.jsx)("input",{placeholder:"pass confirmation"}),(0,O.jsx)("div",{children:a?(0,O.jsx)("button",{onClick:function(){var e=c.current.value,t=l.current.value;(function(e,t,n){return ma.apply(this,arguments)})(sJ,e,t).then((function(e){})).catch((function(e){f(e.message)}))},children:"Create Account"}):(0,O.jsx)("button",{onClick:function(){var e=c.current.value,t=l.current.value;(function(e,t,n){return va(Be(e),Zr.credential(t,n))})(sJ,e,t).then((function(e){})).catch((function(e){f(e.message)}))},children:"Log In"})}),(0,O.jsxs)("div",{className:"loginBottomText",children:[(0,O.jsx)("div",{className:"errorMessage",children:s}),a?(0,O.jsxs)("div",{children:["Already a member?",(0,O.jsx)("a",{onClick:function(){return h(!1)},children:"Sign In"})]}):(0,O.jsxs)("div",{children:["New Here?",(0,O.jsx)("a",{onClick:function(){return h(!0)},children:"Sign Up now"})]})]})]})})},MJ=n.p+"static/media/shuffleIcon.947cd6c985050e6d0926.png";var FJ=function(e){var t=e.close,n=g((function(e){return e.userDataSlice.displayName})),a=g((function(e){return e.userDataSlice.favColor})),i=g((function(e){return e.userDataSlice.isAnonymous})),o=A(),s=(0,r.useRef)(),u=(0,r.useRef)(),c=(0,r.useRef)(),l=(0,r.useRef)();return(0,O.jsxs)("div",{className:"authMenu",children:[(0,O.jsx)("div",{className:"authTitle",title:"If the browser cache is cleared all local data will be lost.\nAn account allows data to be saved and used on multiple devices.",children:"Account ".concat(i?" (Local Only)":"")}),(0,O.jsx)("div",{className:"closeButton",onClick:t,children:"X"}),(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{children:"User Name"}),(0,O.jsx)("input",{defaultValue:n,ref:s,onChange:function(){clearTimeout(c.current),c.current=setTimeout((function(){!function(){var e=s.current.value;if(!e||""===e||" "===e)return;o(kJ(e))}()}),500)}})]}),(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{children:"Display Color (HTML) "}),(0,O.jsxs)("div",{className:"favColorInput",children:[(0,O.jsx)("input",{defaultValue:a,ref:u,onChange:function(){clearTimeout(l.current),l.current=setTimeout((function(){!function(){var e=u.current.value;if(!e||""===e||" "===e)return;o(wJ(e))}()}),500)}},a),(0,O.jsx)("div",{className:"inputIcon",onClick:function(){var e="rgb(".concat(Math.round(255*Math.random(0,255)),", ").concat(Math.round(255*Math.random(0,255)),", ").concat(Math.round(255*Math.random(0,255)),")");o(wJ(e))},children:(0,O.jsx)("img",{src:MJ,title:"Random Color"})})]})]}),(0,O.jsx)("div",{className:"hl"}),(0,O.jsx)(DJ,{})]})};function LJ(e){var t=e.array,n=e.pageRange,a=e.setPageRange,i=(e.defaultIncrement,E((0,r.useState)(10),2)),o=i[0],s=i[1],u=(0,r.useRef)(),c=(0,r.useRef)();return(0,r.useEffect)((function(){}),[]),(0,r.useEffect)((function(){u.current.value=n[0],c.current.value=n[1]}),[n]),(0,O.jsxs)("div",{onClick:function(e){return e.stopPropagation()},className:"pageRangeSelector",children:[(0,O.jsx)("div",{className:"button",onClick:function(){var e=n[0]-o,t=n[1]-o;n[0]-o<0?a([0,o]):a([e,t])},children:"<"}),(0,O.jsxs)("div",{className:"pageRangeText",children:[(0,O.jsx)("input",{defaultValue:n[0],ref:u,onChange:function(){var e=Number.parseInt(u.current.value);"number"!==typeof e||Number.isNaN(e)||(s(n[1]-e),a([e,n[1]]))}}),"to",(0,O.jsx)("input",{defaultValue:n[1],ref:c,onChange:function(){var e=Number.parseInt(c.current.value);"number"!==typeof e||Number.isNaN(e)||(s(e-n[0]),a([n[0],e]))}}),"of ",null===t||void 0===t?void 0:t.length]}),(0,O.jsx)("div",{className:"button",onClick:function(){var e=n[0]+o,t=n[1]+o;a([e,t])},children:">"})]})}LJ.defaultProps={defaultIncrement:20};var jJ=LJ;var zJ=function(e){var t=e.array,n=e.Component,a=(e.defaultPageRange,E((0,r.useState)([0,10]),2)),i=a[0],o=a[1];return(0,O.jsxs)("div",{children:[(0,O.jsx)(jJ,{pageRange:i,setPageRange:o,array:t}),(0,O.jsx)("div",{children:function(e){var t=[];return e.forEach((function(e,n){n>=i[0]&&n<i[1]&&t.push(e)})),t}(t).map((function(e){return(0,O.jsx)(n,{data:e},Math.random())}))})]})};function UJ(e){return(0,O.jsxs)("div",{className:"confirmationBox",children:[(0,O.jsx)("div",{className:"closeButton",onClick:e.close,children:"X"}),(0,O.jsx)("div",{className:"message",children:e.message}),(0,O.jsx)("button",{onClick:e.close,children:"Cancel"}),(0,O.jsx)("button",{onClick:e.continue,children:"Continue"})]})}UJ.defaultProps={message:"Are you sure you wish to continue?",continue:function(){console.log("Continued with confirmation box action")},close:function(){console.log("Closed confirmation box")}};var BJ=UJ;var WJ=function(e){var t=e.post,n=e.close,a=(0,r.useRef)(),i=g((function(e){return e.userDataSlice.blur}));(0,r.useEffect)((function(){var e,n;null===(e=a.current)||void 0===e||e.addEventListener("dragstart",s),null===(n=a.current)||void 0===n||n.addEventListener("dragend",c),console.log("opened post: "),console.log(t)}),[]);var o=(0,r.useRef)({x:0,y:0});function s(e){o.current.x=e.clientX,o.current.y=e.clientY}var u=(0,r.useRef)({x:0,y:0});function c(e){u.current.x=e.clientX,u.current.y=e.clientY,function(){var e=u.current.x-o.current.x,t=u.current.y-o.current.y;l.current.x=l.current.x+e,l.current.y=l.current.y+t,l.current.x<20&&(l.current.x=20);l.current.y<20&&(l.current.y=20);a.current&&(a.current.style.left=l.current.x+"px",a.current.style.top=l.current.y+"px")}()}var l=(0,r.useRef)({x:10,y:10});return(0,O.jsxs)("div",{className:"postViewer",draggable:!0,ref:a,children:[(0,O.jsx)("div",{className:"closeButton",onClick:function(e){return n(e)},children:"X"}),(0,O.jsx)("div",{className:i&&"blur",style:{width:"100%",height:"100%"},children:"image"===t.displayType?(0,O.jsx)("img",{src:t.mainUrl}):"iframe"===t.displayType?(0,O.jsx)("iframe",{src:t.mainUrl+"?source=fallback",autoPlay:!0,muted:!0,loop:!0}):"video"===t.displayType?(0,O.jsx)("video",{src:t.mainUrl+"?source=fallback",autoPlay:!0,muted:!0,loop:!0,controls:!0}):"text"===t.displayType?(0,O.jsx)("pre",{className:"textViewer",children:t.text}):(0,O.jsx)("video",{src:t.mainUrl+"?source=fallback",autoplay:!0,controls:!0,loop:!0})})]})},VJ=n.p+"static/media/settingsIconSW.b499a5d49e22273bfd1a.png";var GJ=function(e){var t=E((0,r.useState)(),2),n=t[0],a=t[1],i=(0,r.useRef)(),o=E((0,r.useState)(),2),s=o[0],u=o[1],c=E((0,r.useState)(0),2),l=c[0],f=c[1],h=E((0,r.useState)(),2),d=h[0],p=h[1],v=g((function(e){return e.userDataSlice.listToView})),m=A();function y(){return(y=V(B().mark((function e(){var t,n;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0==(t=window.localStorage.getItem("urlPreviewFor"+i.current))||"undefined"===t){e.next=5;break}u([t]),e.next=11;break;case 5:return console.log("looking for a preview url"),e.next=8,b();case 8:n=e.sent,u(n),window.localStorage.setItem("urlPreviewFor"+i.current,n[0]);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return x.apply(this,arguments)}function x(){return(x=V(B().mark((function e(){var t,r,a,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("fetching preview urls for "+i.current),i.current){e.next=4;break}return console.log("no link"),e.abrupt("return",null);case 4:if(!(i.current.split("/").length>2)){e.next=10;break}return t="https://www.reddit.com/"+i.current+".json",r=[],e.next=9,fetch(t).then((function(e){return e.json()})).then((function(e){var t=kQ(e[0].data.children[0]);f(0),r=[t],window.localStorage.setItem("urlPreviewFor"+i.current,t)}));case 9:return e.abrupt("return",r);case 10:return a="https://www.reddit.com/"+n+".json?limit=10",o=[],e.next=14,fetch(a).then((function(e){return e.json()})).then((function(e){var t=e.data.children;t&&Array.isArray(t)&&t.forEach((function(e){var t=kQ(e);t&&o.push(t)}))}));case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return k=V(B().mark((function e(t){var r,a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),r=s,!(s.length<2)){e.next=7;break}return e.next=5,b();case 5:r=e.sent,u(r);case 7:(a=l+1)>=r.length&&(a=0),f(a),s.length>1&&window.localStorage.setItem("urlPreviewFor"+n,s[a]);case 11:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function w(e){n.split("/").length<=2?CQ(e,n):function(){I.apply(this,arguments)}()}function I(){return I=V(B().mark((function e(){var t,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(n);case 2:t=e.sent,r=mQ(t),p(r);case 5:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function C(e){return S.apply(this,arguments)}function S(){return(S=V(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://www.reddit.com/"+t+".json",e.next=3,fetch(n).then((function(e){return e.json()})).then((function(e){var t,n,a=null===(t=e[0])||void 0===t||null===(n=t.data)||void 0===n?void 0:n.children[0];r=a}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,r.useEffect)((function(){i.current=e.link||e.data,a(i.current),function(){y.apply(this,arguments)}()}),[]),(0,O.jsxs)("div",{className:"linkPreview",onClick:function(e){return w(e)},children:[(0,O.jsx)("div",{className:"title",children:n}),(0,O.jsxs)("div",{className:"settingsGear",children:[(0,O.jsx)("img",{className:"linkPreviewImg",src:VJ}),(0,O.jsxs)("div",{className:"settingsGearHover",children:[(0,O.jsx)("div",{onClick:function(e){return function(e){return k.apply(this,arguments)}(e)},children:"Change Image"}),v&&(0,O.jsx)("div",{onClick:function(e){return function(e){e.stopPropagation(),m(bJ(n))}(e)},children:"Delete"})]})]}),s&&Array.isArray(s)&&s.length>0&&(0,O.jsx)("img",{className:"linkPreviewImg",src:s[l]}),d&&(0,O.jsx)(WJ,{post:d,close:function(e){return function(e){e.stopPropagation(),p(null)}(e)}})]})};var HJ=function(){var e=g((function(e){return e.userDataSlice.listToView})),t=g((function(e){return e.userDataSlice.lists})),n=E((0,r.useState)(),2),a=n[0],i=n[1],o=E((0,r.useState)(),2),s=o[0],u=o[1],c=(0,r.useRef)(),l=(0,r.useRef)(),f=E((0,r.useState)([0,10]),2),h=f[0];f[1],(0,r.useEffect)((function(){i(t.find((function(t){return t.id===e})))}),[e,t]);var d=A(),p=(0,r.useRef)(),v=(0,r.useRef)();return(0,O.jsxs)("div",{className:"listViewer",children:[(0,O.jsx)("div",{className:"closeButton",onClick:function(){return d(yJ(null))},children:"X"}),(0,O.jsxs)("div",{className:"topMenu",children:[(0,O.jsx)("button",{onClick:function(){return u(!0)},children:"Delete List"}),(0,O.jsx)("button",{onClick:function(){return d(AJ(null===a||void 0===a?void 0:a.id))},children:"Copy List"}),(0,O.jsx)("input",{defaultValue:null===a||void 0===a?void 0:a.name,ref:c,onChange:function(){clearTimeout(p.current),p.current=setTimeout((function(){!function(){var e=c.current.value;d(xJ({listId:a.id,newListName:e}))}()}),500)}}),(0,O.jsx)("textarea",{defaultValue:null===a||void 0===a?void 0:a.description,ref:l,onChange:function(){clearTimeout(v.current),v.current=setTimeout((function(){!function(){var e=l.current.value;d(EJ({listId:a.id,newListDescription:e}))}()}),500)}},null===a||void 0===a?void 0:a.id)]}),(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{children:function(){if(!a||!Array.isArray(null===a||void 0===a?void 0:a.links))return[];var e=[];return null===a||void 0===a||a.links.forEach((function(t){t.includes("http")&&e.push(t)})),e}().map((function(e,t){return(0,O.jsx)(O.Fragment,{children:t>h[0]&&t<h[1]&&(0,O.jsx)("div",{className:"postButton listPostButton",onClick:function(t){return CQ(t,e)},children:e},e)})}))}),(0,O.jsx)(zJ,{array:function(){if(!a||!Array.isArray(null===a||void 0===a?void 0:a.links))return[];var e=[];return null===a||void 0===a||a.links.forEach((function(t){t.includes("http")||e.push(t)})),e}(),Component:GJ})]}),s&&(0,O.jsx)(BJ,{close:function(){return u(!1)},message:"Permenantly delete list: "+(null===a||void 0===a?void 0:a.name)+" and all of its content?",continue:function(){d(CJ(null===a||void 0===a?void 0:a.id)),d(yJ(null))}})]})};var KJ=function(e){var t=E((0,r.useState)(),2),n=t[0],a=t[1],i=E((0,r.useState)("Lists"),2),o=i[0],s=i[1],u=(0,r.useRef)(),c=g((function(e){return e.userDataSlice.lists})),l=g((function(e){return e.userDataSlice.listToAddTo})),f=A();function h(e){"Escape"==e.key&&a(!1),"Enter"==e.key&&d()}function d(){if(u.current){var e=u.current.value;""!==e&&(f(vJ(e)),a(!1))}}(0,r.useEffect)((function(){return e.adder&&s(l),window.addEventListener("keydown",h),function(){window.removeEventListener("keydown",h)}}),[]);var p=E((0,r.useState)(""),2),v=p[0],m=p[1];return(0,O.jsx)("div",{className:"dropDown",children:(0,O.jsxs)("div",{className:"listsContainer "+v,children:[(0,O.jsx)("div",{className:"selectedItemName",children:function(e){var t=null===c||void 0===c?void 0:c.find((function(t){return t.id==e}));return t?null===t||void 0===t?void 0:t.name:"Lists"}(o)}),(0,O.jsx)("div",{className:"dropDownItem",onClick:function(){a(!0),setTimeout((function(){u.current.defaultValue="",u.current.focus()}),100)},children:"+ Add List +"}),n&&(0,O.jsxs)("div",{className:"dropDownItem",children:[(0,O.jsx)("input",{ref:u,onMouseEnter:function(){return window.focus(u.current)}}),(0,O.jsx)("div",{className:"addButton",onClick:d,children:"+"})]}),(0,O.jsx)("div",{className:"listSelectorOptions",children:Array.isArray(c)&&c.map((function(t,n){return(0,O.jsx)("div",{className:"dropDownItem",title:"Open "+(null===t||void 0===t?void 0:t.name),onClick:function(n){return function(t,n){n&&n.stopPropagation(),s(t.id),e.adder?f(gJ(t.id)):f(yJ(t.id)),m("hideItems"),setTimeout((function(){m("")}),100)}(t,n)},children:t.name.toString()},n+(null===t||void 0===t?void 0:t.name))}))})]})})},qJ=n.p+"static/media/chatIconTransparentSmall.832f7334b35929ae1fcd.png";function XJ(e){var t=e.close,n=g((function(e){return e.userDataSlice.postWeightArray})),a=E((0,r.useState)([]),2),i=a[0],o=a[1],s=A();return(0,r.useEffect)((function(){o(n)}),[n]),(0,O.jsxs)("div",{className:"linkWeightViewer",children:[(0,O.jsx)("div",{className:"closeButton",onClick:t,children:"X"}),i.map((function(e,t){return(0,O.jsxs)("div",{className:"linkWeightRow",children:[(0,O.jsx)("input",{className:"row rowLink",defaultValue:e.link},e.link+"RowLink"+t),(0,O.jsx)("input",{className:"row rowWeight",defaultValue:e.weight},e.link+"RowWeight"+t)]})})),(0,O.jsx)("button",{onClick:function(){var e=X(i);e.push({link:"",weight:50}),o(e)},children:"Add Line"}),(0,O.jsx)("button",{onClick:function(){for(var e=[],t=document.getElementsByClassName("rowLink"),n=document.getElementsByClassName("rowWeight"),r=0;r<t.length;r++)e.push({link:t[r].value,weight:Number.parseInt(n[r].value)});console.log("updating link weight array state to: "),console.log(e),s(_J(e))},children:"Update"})]})}XJ.defaultProps={close:function(){console.log("closing window")}};var YJ=XJ;var ZJ=function(){var e=E((0,r.useState)(),2),t=(e[0],e[1],E((0,r.useState)(!1),2)),n=t[0],a=t[1],i=g((function(e){return e.userDataSlice.favColor})),o=(g((function(e){return e.userDataSlice.listToView})),g((function(e){return e.userDataSlice.isAdmin}))),s=(g((function(e){return e.userDataSlice.userId})),g((function(e){return e.dataSlice.subUrl})),A());(0,r.useEffect)((function(){return window.addEventListener("scroll",m),function(){return window.removeEventListener("scroll",m)}}),[]);var u=(0,r.useRef)(),c=(0,r.useRef)(),l=E((0,r.useState)(!0),2),f=l[0],h=l[1],d=E((0,r.useState)(!0),2),p=d[0],v=d[1];function m(){window.scrollY<300?w(!0):window.scrollY<u.current?(c.current+=u.current-window.scrollY,c.current>20&&w(!0)):(w(!1),c.current=0),u.current=window.scrollY}var y=(0,r.useRef)(),b=(0,r.useRef)(),x=(0,r.useRef)(),k=(0,r.useRef)();function w(e){if(e)y.current||(clearTimeout(b.current),b.current=null,v(!0),x.current=!0,setTimeout((function(){h(!0),y.current=!0}),10));else if(y.current){if(k.current)return;h(!1),y.current=!1,b.current||(b.current=setTimeout((function(){v(!1),y.current=!1}),800))}}var I=E((0,r.useState)(!1),2),C=I[0],S=I[1];return(0,O.jsxs)("div",{className:"navBar ".concat(!f&&" opacityZero"," ").concat(!p&&" displayHidden"),children:[(0,O.jsx)("img",{className:"logo",src:N,onClick:function(){s(RQ("home")),function(e,t){e&&e.stopPropagation();var n=window.location.href,r="";r=null!==t&&void 0!==t&&t.includes("http")?t:n.includes("localhost")?t?"http://localhost:3000/?"+t:"http://localhost:3000/":t?"https://abeapple.github.io/redflix-public/?"+t:"https://abeapple.github.io/redflix-public/",window.location.href=r}("")}}),(0,O.jsx)("img",{className:"avatar",style:{backgroundColor:i},src:T,onClick:function(){a(!0)}}),n&&(0,O.jsx)(FJ,{close:function(){return a(!1)}}),(0,O.jsxs)("div",{className:"topNavButtons",children:[o&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{className:"navButton",onClick:function(){return S(!0)},children:"LWV"}),(0,O.jsx)("div",{className:"navButton",onClick:function(){s(RQ("admin"))},children:"Admin Page"})]}),(0,O.jsx)("div",{className:"addToList",onClick:function(){return s(PQ(!0))},title:"Add Page To List",children:"+"}),(0,O.jsx)(KJ,{}),(0,O.jsx)("div",{className:"addToList",onClick:function(){return s(RQ("forum"))},title:"Open Forum",children:(0,O.jsx)("img",{src:qJ})})]}),C&&(0,O.jsx)(YJ,{close:function(){return S(!1)}})]})};var QJ=function(e){var t=e.data,n=E((0,r.useState)(!1),2),a=n[0],i=n[1];return(0,O.jsxs)("div",{className:"linkDisplay",onClick:function(e){e.stopPropagation(),i(!a)},children:[(0,O.jsxs)("div",{children:["Clicks: ",null===t||void 0===t?void 0:t.count]}),a?(0,O.jsx)(GJ,{link:null===t||void 0===t?void 0:t.link}):(0,O.jsx)("div",{className:"linkDisplayText",children:null===t||void 0===t?void 0:t.link})]})};var JJ=function(e){var t=e.text,n=e.title,a=E((0,r.useState)(!1),2),i=a[0],o=a[1],s=E((0,r.useState)(!1),2),u=s[0],c=s[1];function l(e,t){t.stopPropagation(),o(e)}return(0,r.useEffect)((function(){t&&"string"===typeof t&&t.length>260&&c(!0)}),[]),(0,O.jsxs)("pre",{className:"textViewer",children:[(0,O.jsx)("div",{className:"textViewerTitle",children:n}),function(){if(u)return i?(0,O.jsx)("div",{children:(0,O.jsx)("div",{className:"postButton",onClick:function(e){return l(!1,e)},children:"Hide"})}):(0,O.jsx)("div",{children:(0,O.jsx)("div",{className:"postButton",onClick:function(e){return l(!0,e)},children:"Show All"})})}(),i?t:function(e){return e&&"string"===typeof e?e.length>260?e.substring(0,260)+"... ":e:""}(t)]})},$J=n.p+"static/media/playIcon.e238d077a3396991a0c5.png",e$=n.p+"static/media/redditIconSW.8a3e88bb67187166a950.png",t$=n.p+"static/media/likeIcon.2844dd2af022af22ec74.png",n$=n.p+"static/media/likeIconFilledIn2.17792005cb6494790e13.png";var r$=function(e){var t=E((0,r.useState)(),2),n=t[0],a=t[1],i=E((0,r.useState)(),2),o=i[0],s=i[1],u=A(),c=g((function(e){return e.userDataSlice.showLikeButtons})),l=g((function(e){return e.userDataSlice.userRatings}));function f(t,n){var r,a;n.stopPropagation(),s(t),"temp"!==(null===(r=e.post)||void 0===r?void 0:r.id)&&u(nJ({type:"like",input:t,postID:null===(a=e.post)||void 0===a?void 0:a.id}))}return(0,r.useEffect)((function(){}),[]),(0,r.useEffect)((function(){var t;if(l){var n=(null===(t=e.post)||void 0===t?void 0:t.id)+"like";if(l[n]){var r,a=null===(r=l[n])||void 0===r?void 0:r.input;s(a)}}}),[l]),(0,O.jsx)(O.Fragment,{children:c&&(0,O.jsxs)("div",{className:"postButton likeBox",onMouseLeave:function(){return a(null)},title:"Improve Reccomendations",children:[(0,O.jsx)("div",{className:"like dislike",onMouseEnter:function(){return a("dislike")},onClick:function(e){return f("dislike",e)},title:"Nope.",children:"dislike"===o||"dislike"===n?(0,O.jsx)("img",{src:n$}):(0,O.jsx)("img",{src:t$})}),(0,O.jsx)("div",{className:"like",onMouseEnter:function(){return a("like")},onClick:function(e){return f("like",e)},title:"Yup.",children:"like"===o||"like"===n?(0,O.jsx)("img",{src:n$}):(0,O.jsx)("img",{src:t$})})]})})},a$=n.p+"static/media/starIconW.750f708caf3fbba55ab8.png",i$="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAQIXpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZppctw6kIT/4xRzBGIt4DhYI+YGc/z5CiDbkiwvkp8UFtvsJghUZmVlgW3m//3vMv/DT4w5mRAlp5LSxU8oobjKi3ydn7b/2ivsv/vneYv/vztvXm84TnmO/vy3uPvzz3n7GuAcKq/im4HKPZJt79+oz/j5w0D3jbzOSG827oHqPZB35w0b7lWl+waes5/MKJUs75bW71vbfJ/KP/552fd8Df7x/0GI6oh6J2fc9HrT6b13Z2Ze/3lfOVr+Oh+dvhJeB5/4G72GYM+4XJfoiMzoLJuPM9xli33euJdxlqURe3N+30LfIOLPss3bdV+K/WdQ+1+cf36YmFnzeveh1/EDf16v7OfnzUf+5Hp/xH+APb2On543Nn7Okx2fN3cuzyv3/rxvB0PzmuAb2Ncaee01s4oaEiCne1HPUvYrPkcSBb11NkwtgUiC1Zmj/hZ+M0B17jWuTsY1XhfrgGrZYIetdtm5j912phjcNE544VwHfz2Zvbji+gY46K9dTnzxw2co0jffgnevudh923J1s++WufOwfNRZBrNc8uVf89UL1uoaInvlV6yYl3MabKahyOlfPgYGdt1BjTvAz+/Hn8P7wKeIsmHkQmDbGaJF+0Ob/Aba88HI8aSHlfFKnMCtI5OxHgRAzfpoEznmnFhLIDMAVabufHANBGyMbjBJF7xPYJOd3ppLxO6Puug4bTiPvIJEJLMFbIqvgBVChD8SMhyqpHuIMaYoMccSa/IppJhSkqQyXcVLMBIliUiWIjX7HDJCniXnXHItrnhkPJZUpORSSq3cszJy5erKB2ptrvkWWjQtNWm5lVY79Omhx5669NxLr8MNP1CukYaMPMqo006oNMOMM02ZeZZZF1Rb3qyw4kpLVl5l1RdqN6w//X4BNXuj5jZS+kF5ocZZkWcIq3ISFTMAcyZYEBeFAEI7xezKNgSnyClm1CWyIjomGRWzYRUxEAzTurjsg51xB1FF7p9wMxLe4ea+i5xR6L6I3M+4fYba0DrXN2InCzWolyf7eH/m6tBiyu9PR/OrN86xabCGJhFhnQ18NICjcT+3qowxY49tRC8mjei6lER1nNTnXmpnYsLUyvLd+jVb61EqMeLcWLPXVpdvnK+d3Oi5joX8GdRTkFQYa+uYudS8sviYywplxKpXLjI+jQU7BvFoAsrJdmC4Fgowr5FkiIGJc1wyL254XdFP1wY5yFmmleoYUsZ+p1efZYaUFvcqQVqpa5fgEwfzmwB96fgXA6mca8iD9CC1B1vDLD6tlXKbZQn8s2mZGMZoMTQ7Y86Xz1dYLrU51rnat+5LJerP1ZRWadSJ+3rC01rJzRquL06K29d3z32kE8O16lw2TggMgiKruTpbn3qeFBzLuQYG0rsfgDoo2SAGEzdg5EleQX4ANmzyft6A9dJIgWsDhsdCIQBMdKl6sfkO3BCRdPDv8DZfA5xEAfINw4ejyb9446vHdwP9HdCf42z8bHsh30ILZ9mQrlJdMmVM3tcQOsxu40o/crdkKgolDcxG7zEv10MhpWGKj9WGqPYqJplNGIVBjPOMIowSk44SYu4A1buO4tIcFa8irlKeO/4pn1GYSf+Q5OarWf6rJDdfzfJ/SNq/S2rzPbB/Tmrzp6z+26Q2f8rqDfMD9zl+muTmq1n+qyQ3X83yXyW5+WqW5/8o+1e6TsXzliJZplulxa1HLUmJ9B6DBBEwSpPq16npMaw2im3Ylr6CL6yCeYpeBGg5UTrtNdeF45iZAplILbAu4LRYaom4AxIVU0RdxUXgdGg/GWXmX02UC6kih1Qw0lOqw6zjcAoGMYdVinJqczL7i1limosGMLWwab0yfrhBToM9uGZq1sPLisMhAnPVa7SZgtqDleaMF/SNTpHMWpnUHWis6rV2rIpMZ2DFDpbGilHwuu3ECm5KL3m6HStO+0KsbF6iPvabSftLDd5B2IlpfpOZjRYxR3Wcl14yc5x67EURXhNHCOllhSgNe6w4ah5am6pCDIuxZotBOiuaYfViR19llD7natB+tNzdivimNuoe0pYiCFuFOqvXdErAeFitM1bOdCGbCo3ncNwEyjVNGvxjKQ0RXwhDS8sZsYWMEoyzhpP7DNbehmDCdJga2tT5j0uLDTGXfb6TlxeWdN9wqjaZrziOd9oU7qHuOJpfBTJid1eGAV6nkJGegNfkOs0DqlSHaHKuUXuMGZ0FDs+Jc/ZUM0udiKxLS86Wsd8chXRjAaxzdWeSJ/fQYKZJVgMh4xQKnN7Ltd5ZFRTnROOGfY4uzB2RuvTq4lbOrCC4ZWQxF5DQC1E1yD9PDikRl7pgv3YyhalWO68fuVRd12WeXDKF7B7pJNOVCZ4GfSejDlT3DaYNqANZrbywcmYraUID5EZXSE97y1SrVbUEIjrmSLUgfrBwOYbwk64HYZqrZ8/l1xi+AvoWqKLqwmeNjp5T2olbkf19N9IX4lEB6HBgOSPlTPeDNYGKWosoi63MtKni2wx5mtG2eiVUrVxz9hlbFbqNuTSTvGZS/RjYD3GdGkVzOpYvSxL0WbdEekrQsBgtuNtdO5BclBf4ncc6GqncduBT5wHFVclJdrUDGCabo/TERICfbiZV+rG1YqYSwZrbJWUoxdxiBC4dihljlCi/9JKoxZBqN6zUgjASjd98OxkId/NDWzGY/mYml85CDde2IB9qgPlvPO1vB4JKlJQnhMChrGbWLWkItzxomblDaBSSdFG0o6g8BPpIBRxDiWd4nKqM2PCY+XGqFMEi23fgVG0QDJ1Rq4pK27gcZiYoWSIWoAcso3V00riGTjIjUfgULcuynCfqkKt0R4uK/fG+a7CzkiFjkDpcIA+Co1xMS75Son1CTg8X7KIg+E4yFQCNHbEC01wnIlzMpB5TLAFLLRTEUQ+0F7WN88WisN/5Mc7Yb13UMc7YAzp7xdF5UyzOmYqTSe/xrIu6nyyxozDeJoyj6LoCyp9qy4F11WbjqGiTahTlqM2m6k0yPCbAggz8sW/pPfttAfAyFrHy281pUMKG2dT/qDv+dKAjiklJ/4Y+GsfCxE42t21XHupcwVBMs+3878uXPlciP/hKY+WG20HCCzkUV27eEtagcLeFcSvx8qtPi0NI05UypWqxuR7ymW+xb5MPTnyMkfoOJATX0RA5ZLCqXR/N3UqgisANGGgK5V8wyqhc4joKumTK/DWo/WsXOwwAHRwZdtt5OrM04N1DpLncjCTadvMWjfLXS98SiWqOvv2rvFFFnuyiFhDuPJ/skjazv7MLOmi4y51dgZp0EW5PuD15NTIl3MRPupbvHM3bLvdLAvTSn6KFFlvTBM/SLaIX1faNAAN2s0LxwqWksFW7Y+tarrQBA0sogwyNl+b4A7XJ2GYX++j1ZjExLU6xZiCIFbZ/gsrRYR4r3GLa+iDO6hA3RvbCsOcASCXci0CyXFSQqPMMTpMxWUeNWL7Ql6foX1TW+bPMG/fTngZJh5/GDKqffvRkg3jrSdxWMGw9sZdkp3pimj9+qGm38w9MMFABwsa9s7CZfbeaP5h9Ws2b2afTLJvZu9PclXuorblpjRciZEEeWvuxG49D67Ij1m9aV5C+gtLaV7UTs/95i/VPR5im/ipve9xQM814X28W7G3YhwV9Z3xSFsCBdJHxTKtoxscXA1iO4QNBHgYEddcPA8pO034zoFtJVBoYQB3eqrgl9dkN9ualqWc7+NbUqGyOR1N1N/hSTb0+Xvz2WvOHi/v6y2iZV9jUsqPZtFUR+47BHmp/VeIrRbEuTa1Lxa96GTqlAUF0b54s9TUZ2ommjgo205qm4IEXcHGbIXdhZp5bIKBE77cNhflzx6HhhjlLp5bUP2t/p2Y6qECWRfRBwUjevrahBPS9osEjaJ3uJuz9ABfHrLop4MgseqZ8ifPMmJLtPbGmS9rZar7o884mPqHEre8Os+l2y6jDxHlhRqhfnUBo66Jzo90r6rijzm0yN1rISqoheXtuqVAMaOb0ed2kl2Zuhon5Ef7VR2C0Tktctl8uJW7Yz7k8JF87s+9Y02KcXiWdT9RoiTZYqOqbr9YL+Lt0T+r0jXZo22jhoNl9Y9e+p5RX39iwVDWk3Tf6jPCrJxsq9Ay0vf5PtzBfrWF2t3+Zpsqfhr5kbRKXaXfjnHV3YFKRdDNheSR0YC9315xE23265r1lF2EAL67PC+QfZqFbVheN3yZ33k1iwi0vyO02HAib7tOhoXsvGT3oCUtw2L1gkJeu8oQ4jLxz0WGzoZw+zrs8vthnjV2QYT5Nsm9U8B8thFp97UjrpTsRqOVY5OUOKFI5O3l1klUiLa94qhkBdYIbU1Kb0f/Bhu5yrv33uIzylmkk3SrhPFK/EkKpydlqH4ti6BA4KZ4uYMXz9OyUv7x0p5XyF6niENLKOPu0Wv/U2dGo6ncRzndOpnoelbZNVhIV2HTjQKuaUL21A6diNBN0mxYhmLgaIqfbQ62WbnVPTq6/by3Mh96ikTvf8hLmNhPavtPsM9Cziao7xsQPf0D86tzxI+Tljl/vjfhlLRCCNhEjAjjtt52x7h9u/pt3EvGTzv/Qnq30Oxk0F4ZdOxcoRD0Vlh7NDznt8y5MGUWZkdho0OEqeg9rbDnbJfbzumR+U4eGIuj3s6E88qT1aLBVdFfQIVAOWtOxOILjZzJCo+JogGBMSFfprD3pNlvDfFEmunVbhF3AC6EfDWGcJQTKcX70QfA2+shnM+yakxqjDrlf/LeJ79B6YpwRiiZbJ6H50l3L0qlBs7STZIM+idFN39tKLWgRknuvSb9UxIlnrwlPKcW92WjK/d1Gk1Y0/ZKO4pRz67pp+/LsquTx8ew+a8rent37QlaDoGtlnSc+aW9EPVvLhBK7f/g/z+660vfsK7s8NSJ+J6Brnxht888G+/bXRnstLQh3lPTZA/U7AddCXWfUzlE0RhNj3Ym+jK6Bp88jreMYWjO6jUYfvtDlco8nVtrfVEXvR3+DSonG6vQ3hBFC7f5mDD+S5ukwmqj9P5iU6SfL8Md3Aqmzq37uBNL8WW1L2Hxn7Hw4+YNu6neyQOHO/jh/bxWOcfudtzOfJtnuuM8DNPGqK6GgK/sRmG4KqK7o8zPtSzxKg79zRrfDqApqBnWTW3cVhtURHJ1N0Mtr171pTIZuTTTQoNhoq1P0my4IjtXHCd4k7gep6QmU6TSgnWtsefvAvtHUvH2Ai+xc9ccj3Lw3nY1KuraE+g3DZf1SnxHiVBBP1q1Z7TE+82w/UxxtF1aVvOIX9355NJN8iDQdf7U5/9MxIuyZICU8pHPrYmQkqdFr4HG0XuqTpLHFXXNNbQ2VYT8j04eGFEQ5fSdX7b4zZaNFK+muim7r+rSfTcneyXCsEMxUr7qjDV3OwriBvnntvXwXlF33eZY+EjHferamxW92WEmhIp6saZqk2736zRt9SvDmuQomggx4PVkp1/OQXt2f7jV+cGTmWDK180jB/wP+Cbbm0CWj5QAAAYVpQ0NQSUNDIHByb2ZpbGUAAHicfZE9SMNQFIVPU0WRioNFVBwiVCcroiKOUsUiWChthVYdTF76B00akhQXR8G14ODPYtXBxVlXB1dBEPwBcXVxUnSREu9LCi1ivPB4H+fdc3jvPkColZhqtk0AqmYZiWhETGdWxY5X+DCAPoxjWGKmHksupuBZX/fUTXUX5lnefX9Wt5I1GeATieeYbljEG8Qzm5bOeZ84yAqSQnxOPGbQBYkfuS67/MY577DAM4NGKjFPHCQW8y0stzArGCrxNHFIUTXKF9IuK5y3OKulCmvck78wkNVWklynNYQolhBDHCJkVFBECRbCtGukmEjQecTDP+j44+SSyVUEI8cCylAhOX7wP/g9WzM3NekmBSJA+4ttf4wAHbtAvWrb38e2XT8B/M/Aldb0l2vA7Cfp1aYWOgJ6toGL66Ym7wGXO0D/ky4ZkiP5aQm5HPB+Rt+UAXpvga41d26Nc5w+ACma1fINcHAIjOYpe93j3Z2tc/u3pzG/H88acsxosv4hAAAOVWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9ImdpbXA6ZG9jaWQ6Z2ltcDo1ZTA3NmE1YS1iMTc4LTQ1M2MtYjI4YS02YzNmYjM2ZDE5OTciCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODcwNDE0YmItZjcxNy00MmI2LTk0YjAtNDU1YWJkNWQwOGUzIgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MGU5NmFjZTAtN2VlYi00NzVhLTliMDgtNTVmYWE1ZTg2OWIxIgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iV2luZG93cyIKICAgR0lNUDpUaW1lU3RhbXA9IjE2NzQ2ODY4MTY5NjQwMDMiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMiIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiCiAgIHhtcDpNZXRhZGF0YURhdGU9IjIwMjM6MDE6MjVUMTc6NDY6NTUtMDU6MDAiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDIzOjAxOjI1VDE3OjQ2OjU1LTA1OjAwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MjhmMjJlNjktODYyZi00MmE3LWFhZWMtZWEwZDA5YWY4MGE0IgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTAxLTI1VDE3OjMzOjUyIi8+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InNhdmVkIgogICAgICBzdEV2dDpjaGFuZ2VkPSIvIgogICAgICBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFmNDUwZTRlLTY0ODMtNGI4Zi1hODY0LWEzYmFlMDJkNTA4ZSIKICAgICAgc3RFdnQ6c29mdHdhcmVBZ2VudD0iR2ltcCAyLjEwIChXaW5kb3dzKSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyMy0wMS0yNVQxNzo0Njo1NiIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz4PFnAmAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5wEZFi447EreTwAAAmNJREFUeNrt3c1OwzAUROE48vu/MixAQiwK/XFjX883O8QC6jn3OE4hPQ4REZG8fHwneQ1OGGSnJU//r4VorTGAMEDi9CdbgAEYwPQnW4ABGMD0J1uAARjA9CdbgAEYwPQnW4ABGMD0J1uAARjA9CdbgAEYwPQnW4ABGMD0J1uAARjA9CdbgAEYwPQnW4ABGMD0J1uAARjA9CdbgAHCA4CC5gHAZiUAAIAAMP0AEMfAutNf9UjIAAxg+pMtwAAMYPqTLdAUng1EU3I2HE3J2XA0BWcD0pScDUdTcjYcTeHZcSMo3Qi0n70dNHt/9rVAcwGYfSHoFJB+CnDez74/cPOGAQj2L/9PAECwf/n/AgCCvcu/CwAQ7Fv+3QCAYM/yHwIABPuV/zAAINir/KcAAME+5T8NAAj2KP8lAEBQv/yXAQBB7fKHAACCuuUPAwAENcsfCgAI6pU/HAAg1Cr/bQCAYP3i3w4ACNYv/+0AgGDt8i8BAATrln8ZACBYs/xLAQDBeuVfDgAI1ip/CgAgWKf8aQCAYI3ypwIAgvnlH4d/D48PAAAgABAACAAk8QTiCJh9FGQAW4AAQAAgAJCJmXVRfCa9WGEAAYAAQAAgX/FHoasVcvEtYQawBQgABAACAHEKcAJIOwmc6Qtd7ePeR6ebsJ+vEw3Vk4u/9f0kELris0HY+gkho/b3yr97pAGGP0tvYyN0xWeD0BWfDcKp/Jo/O94Aqyx+dRuUe1Dk6lNX7bV2E59thK74bBC64rNB6IrPBqErPhuE6Z8XkP5+/Oz16SY+2win8rO3wK54NhARkch8AspOVQ6C9C5GAAAAAElFTkSuQmCC";var o$=function(e){var t=E((0,r.useState)(null),2),n=t[0],a=t[1],i=E((0,r.useState)(null),2),o=i[0],s=i[1],u=A(),c=g((function(e){return e.userDataSlice.showLikeButtons})),l=g((function(e){return e.userDataSlice.userRatings}));function f(t,n){n.stopPropagation(),s(t),function(t){var n,r,a,i;if("temp"===(null===(n=e.post)||void 0===n?void 0:n.id))return;var o=null===(r=e.post)||void 0===r?void 0:r.id,s=null===(a=e.post)||void 0===a?void 0:a.author,c=null===(i=e.post)||void 0===i?void 0:i.subreddit_name_prefixed;c=(c=c.split("/")).length>1?c[1]:c[0];u(nJ({type:"star",input:t,postID:o,page:c,userPage:s}))}(t)}return(0,r.useEffect)((function(){var t;if(l){var n=(null===(t=e.post)||void 0===t?void 0:t.id)+"star";if(l[n]){var r,a=null===(r=l[n])||void 0===r?void 0:r.input;s(a)}}}),[l]),(0,O.jsx)(O.Fragment,{children:c&&(0,O.jsxs)("div",{className:"postButton starBox",onMouseLeave:function(){return a(null)},title:"Improve Reccomendations",children:[(0,O.jsx)("div",{className:"ratingStar",onMouseOver:function(){return a(1)},onClick:function(e){return f(1,e)},title:"Nope.",children:o>=1||n>=1?(0,O.jsx)("img",{src:i$}):(0,O.jsx)("img",{src:a$})}),(0,O.jsx)("div",{className:"ratingStar",onMouseOver:function(){return a(2)},onClick:function(e){return f(2,e)},title:"Meh",children:o>=2||n>=2?(0,O.jsx)("img",{src:i$}):(0,O.jsx)("img",{src:a$})}),(0,O.jsx)("div",{className:"ratingStar",onMouseOver:function(){return a(3)},onClick:function(e){return f(3,e)},title:"Its ok!",children:o>=3||n>=3?(0,O.jsx)("img",{src:i$}):(0,O.jsx)("img",{src:a$})}),(0,O.jsx)("div",{className:"ratingStar",onMouseOver:function(){return a(4)},onClick:function(e){return f(4,e)},title:"Great",children:o>=4||n>=4?(0,O.jsx)("img",{src:i$}):(0,O.jsx)("img",{src:a$})}),(0,O.jsx)("div",{className:"ratingStar",onMouseOver:function(){return a(5)},onClick:function(e){return f(5,e)},title:"Amazing!",children:o>=5||n>=5?(0,O.jsx)("img",{src:i$}):(0,O.jsx)("img",{src:a$})})]})})};var s$=function(e){var t,n=e.postData,a=e.lastPost,i=(e.index,e.customClass,e.data),o=g((function(e){return e.userDataSlice.blur})),s=E((0,r.useState)(),2),u=s[0],c=s[1],l=E((0,r.useState)((Y(t={id:null,mainUrl:null,type:null,displayType:null,previewUrl:null,title:null,permalink:null},"title",null),Y(t,"subreddit_name_prefixed",null),Y(t,"author",null),Y(t,"text",null),Y(t,"kind",null),t)),2),f=l[0],h=l[1],d=A();return(0,r.useEffect)((function(){h(n||i)}),[n]),(0,O.jsxs)(O.Fragment,{children:[u&&(0,O.jsx)(WJ,{post:f,close:function(e){return function(e){e.stopPropagation(),c(!1)}(e)}}),(null===f||void 0===f?void 0:f.id)&&(0,O.jsx)("div",{className:(a?"last-post":"")+"  "+(null!==f&&void 0!==f&&f.adminPost?"admin-post":""),onClick:function(e){e.stopPropagation(),console.log("clicked post")},children:(0,O.jsxs)("div",{className:"unobserved post Index="+(null===f||void 0===f?void 0:f.index)+" ID="+(null===f||void 0===f?void 0:f.id),onClick:function(e){return function(e){e.stopPropagation(),null!==n&&void 0!==n&&n.adminPost||d(eJ(f)),c(!0)}(e)},children:[(0,O.jsx)(O.Fragment,{children:(0,O.jsxs)("div",{className:"postButtons",children:[((null===f||void 0===f?void 0:f.subreddit_name_prefixed)||(null===f||void 0===f?void 0:f.pageUrl))&&(0,O.jsx)("div",{className:"postButton",onClick:function(e){CQ(e,(null===f||void 0===f?void 0:f.subreddit_name_prefixed)||(null===f||void 0===f?void 0:f.pageUrl)),null!==f&&void 0!==f&&f.subreddit_name_prefixed&&(WQ(f.subreddit_name_prefixed),d(iJ(f.subreddit_name_prefixed)))},title:"Open "+((null===f||void 0===f?void 0:f.subreddit_name_prefixed)||(null===f||void 0===f?void 0:f.pageUrl))+" in a new tab",children:(null===f||void 0===f?void 0:f.subreddit_name_prefixed)||(null===f||void 0===f?void 0:f.pageUrl)}),((null===f||void 0===f?void 0:f.author)||(null===f||void 0===f?void 0:f.userPageUrl))&&(0,O.jsx)("div",{className:"postButton",onClick:function(e){CQ(e,"user/"+((null===f||void 0===f?void 0:f.author)||(null===f||void 0===f?void 0:f.userPageUrl))),null!==f&&void 0!==f&&f.author&&(VQ("user/"+f.author),d(iJ(f.author)))},title:"Open user/"+((null===f||void 0===f?void 0:f.author)||(null===f||void 0===f?void 0:f.userPageUrl))+" in a new tab",children:"user/"+((null===f||void 0===f?void 0:f.author)||(null===f||void 0===f?void 0:f.userPageUrl))}),((null===f||void 0===f?void 0:f.author)||(null===f||void 0===f?void 0:f.redditUrl))&&(0,O.jsx)("div",{className:"postButton",onClick:function(e){CQ(e,"http://reddit.com/"+((null===f||void 0===f?void 0:f.permalink)||(null===f||void 0===f?void 0:f.redditLink)))},title:"Open post on reddit in a new tab",children:(0,O.jsx)("img",{src:e$})}),(null===f||void 0===f?void 0:f.author)&&(0,O.jsx)("div",{className:"postButton",title:"Add post to list",onClick:function(e){e.stopPropagation(),d(PQ(!0)),d(DQ(f.permalink))},children:"+"})]})}),"video"===(null===f||void 0===f?void 0:f.type)&&(0,O.jsx)("div",{className:"playButton",children:(0,O.jsx)("img",{src:$J})}),(0,O.jsx)(O.Fragment,{children:"text"===(null===f||void 0===f?void 0:f.displayType)?(0,O.jsx)(JJ,{title:null===f||void 0===f?void 0:f.title,text:null===f||void 0===f?void 0:f.text}):(0,O.jsx)("img",{src:null===f||void 0===f?void 0:f.previewUrl,className:o?"blur":""})}),(0,O.jsxs)("div",{className:"text"===f.displayType?"":"postTextTitle",children:[!("text"===(null===f||void 0===f?void 0:f.displayType))&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{className:"postTitle",children:null===f||void 0===f?void 0:f.title}),(0,O.jsx)("div",{className:"postText",children:null===f||void 0===f?void 0:f.text})]}),(0,O.jsxs)("div",{children:[(0,O.jsx)(o$,{post:f}),(0,O.jsx)(r$,{post:f})]})]})]})})]})};var u$=n(1694),c$=n.n(u$),l$=function(e,t){return l$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},l$(e,t)};function f$(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}l$(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function h$(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}var d$="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{};var p$=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},v$="object"==typeof d$&&d$&&d$.Object===Object&&d$,g$="object"==typeof self&&self&&self.Object===Object&&self,m$=v$||g$||Function("return this")(),y$=m$,b$=function(){return y$.Date.now()},x$=/\s/;var k$=function(e){for(var t=e.length;t--&&x$.test(e.charAt(t)););return t},w$=/^\s+/;var I$=function(e){return e?e.slice(0,k$(e)+1).replace(w$,""):e},C$=m$.Symbol,A$=C$,S$=Object.prototype,_$=S$.hasOwnProperty,E$=S$.toString,T$=A$?A$.toStringTag:void 0;var N$=function(e){var t=_$.call(e,T$),n=e[T$];try{e[T$]=void 0;var r=!0}catch(i){}var a=E$.call(e);return r&&(t?e[T$]=n:delete e[T$]),a},O$=Object.prototype.toString;var R$=function(e){return O$.call(e)},P$=N$,D$=R$,M$="[object Null]",F$="[object Undefined]",L$=C$?C$.toStringTag:void 0;var j$=function(e){return null==e?void 0===e?F$:M$:L$&&L$ in Object(e)?P$(e):D$(e)};var z$=function(e){return null!=e&&"object"==typeof e},U$=j$,B$=z$,W$="[object Symbol]";var V$=function(e){return"symbol"==typeof e||B$(e)&&U$(e)==W$},G$=I$,H$=p$,K$=V$,q$=NaN,X$=/^[-+]0x[0-9a-f]+$/i,Y$=/^0b[01]+$/i,Z$=/^0o[0-7]+$/i,Q$=parseInt;var J$=function(e){if("number"==typeof e)return e;if(K$(e))return q$;if(H$(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=H$(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=G$(e);var n=Y$.test(e);return n||Z$.test(e)?Q$(e.slice(2),n?2:8):X$.test(e)?q$:+e},$$=p$,e0=b$,t0=J$,n0="Expected a function",r0=Math.max,a0=Math.min;var i0=function(e,t,n){var r,a,i,o,s,u,c=0,l=!1,f=!1,h=!0;if("function"!=typeof e)throw new TypeError(n0);function d(t){var n=r,i=a;return r=a=void 0,c=t,o=e.apply(i,n)}function p(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-c>=i}function v(){var e=e0();if(p(e))return g(e);s=setTimeout(v,function(e){var n=t-(e-u);return f?a0(n,i-(e-c)):n}(e))}function g(e){return s=void 0,h&&r?d(e):(r=a=void 0,o)}function m(){var e=e0(),n=p(e);if(r=arguments,a=this,u=e,n){if(void 0===s)return function(e){return c=e,s=setTimeout(v,t),l?d(e):o}(u);if(f)return clearTimeout(s),s=setTimeout(v,t),d(u)}return void 0===s&&(s=setTimeout(v,t)),o}return t=t0(t)||0,$$(n)&&(l=!!n.leading,i=(f="maxWait"in n)?r0(t0(n.maxWait)||0,t):i,h="trailing"in n?!!n.trailing:h),m.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=u=a=s=void 0},m.flush=function(){return void 0===s?o:g(e0())},m},o0=i0,s0=p$,u0="Expected a function";var c0=function(e,t,n){var r=!0,a=!0;if("function"!=typeof e)throw new TypeError(u0);return s0(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),o0(e,t,{leading:r,maxWait:t,trailing:a})},l0=function(e,t,n,r){switch(t){case"debounce":return i0(e,n,r);case"throttle":return c0(e,n,r);default:return e}},f0=function(e){return"function"===typeof e},h0=function(){return"undefined"===typeof window},d0=function(e){return e instanceof Element||e instanceof HTMLDocument},p0=function(e,t,n,r){return function(a){var i=a.width,o=a.height;t((function(t){return t.width===i&&t.height===o||t.width===i&&!r||t.height===o&&!n?t:(e&&f0(e)&&e(i,o),{width:i,height:o})}))}},v0=function(e){function t(t){var n=e.call(this,t)||this;n.cancelHandler=function(){n.resizeHandler&&n.resizeHandler.cancel&&(n.resizeHandler.cancel(),n.resizeHandler=null)},n.attachObserver=function(){var e=n.props,t=e.targetRef,r=e.observerOptions;if(!h0()){t&&t.current&&(n.targetRef.current=t.current);var a=n.getElement();a&&(n.observableElement&&n.observableElement===a||(n.observableElement=a,n.resizeObserver.observe(a,r)))}},n.getElement=function(){var e=n.props,t=e.querySelector,r=e.targetDomEl;if(h0())return null;if(t)return document.querySelector(t);if(r&&d0(r))return r;if(n.targetRef&&d0(n.targetRef.current))return n.targetRef.current;var a=(0,s.findDOMNode)(n);if(!a)return null;switch(n.getRenderType()){case"renderProp":case"childFunction":case"child":case"childArray":return a;default:return a.parentElement}},n.createResizeHandler=function(e){var t=n.props,r=t.handleWidth,a=void 0===r||r,i=t.handleHeight,o=void 0===i||i,s=t.onResize;if(a||o){var u=p0(s,n.setState.bind(n),a,o);e.forEach((function(e){var t=e&&e.contentRect||{},r=t.width,a=t.height;!n.skipOnMount&&!h0()&&u({width:r,height:a}),n.skipOnMount=!1}))}},n.getRenderType=function(){var e=n.props,t=e.render,a=e.children;return f0(t)?"renderProp":f0(a)?"childFunction":(0,r.isValidElement)(a)?"child":Array.isArray(a)?"childArray":"parent"};var a=t.skipOnMount,i=t.refreshMode,o=t.refreshRate,u=void 0===o?1e3:o,c=t.refreshOptions;return n.state={width:void 0,height:void 0},n.skipOnMount=a,n.targetRef=(0,r.createRef)(),n.observableElement=null,h0()||(n.resizeHandler=l0(n.createResizeHandler,i,u,c),n.resizeObserver=new window.ResizeObserver(n.resizeHandler)),n}return f$(t,e),t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){h0()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var e,t=this.props,n=t.render,a=t.children,i=t.nodeType,o=void 0===i?"div":i,s=this.state,u={width:s.width,height:s.height,targetRef:this.targetRef};switch(this.getRenderType()){case"renderProp":return n&&n(u);case"childFunction":return(e=a)(u);case"child":if((e=a).type&&"string"===typeof e.type){var c=h$(u,["targetRef"]);return(0,r.cloneElement)(e,c)}return(0,r.cloneElement)(e,u);case"childArray":return(e=a).map((function(e){return!!e&&(0,r.cloneElement)(e,u)}));default:return r.createElement(o,null)}},t}(r.PureComponent);h0()?r.useEffect:r.useLayoutEffect;var g0=n(6181),m0=n.n(g0),y0=n(3629),b0=n.n(y0),x0=n(2066),k0=n.n(x0),w0=n(298),I0=n.n(w0),C0=n(6769),A0=n.n(C0),S0=function(e){return 0===e?0:e>0?1:-1},_0=function(e){return A0()(e)&&e.indexOf("%")===e.length-1},E0=function(e){return I0()(e)&&!k0()(e)},T0=function(e){return E0(e)||A0()(e)},N0=0,O0=function(e){var t=++N0;return"".concat(e||"").concat(t)},R0=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!E0(e)&&!A0()(e))return r;if(_0(e)){var i=e.indexOf("%");n=t*parseFloat(e.slice(0,i))/100}else n=+e;return k0()(n)&&(n=r),a&&n>t&&(n=t),n},P0=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},D0=function(e,t){return E0(e)&&E0(t)?function(n){return e+n*(t-e)}:function(){return t}};function M0(e,t,n){return e&&e.length?e.find((function(e){return e&&("function"===typeof t?t(e):m0()(e,t))===n})):null}var F0=!1,L0=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(F0&&"undefined"!==typeof console&&console.warn&&(void 0===t&&console.warn("LogUtils requires an error message argument"),!e))if(void 0===t)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var i=0;console.warn(t.replace(/%s/g,(function(){return r[i++]})))}};function j0(){return j0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j0.apply(this,arguments)}function z0(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(Wse){c=!0,a=Wse}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return U0(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U0(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B0=(0,r.forwardRef)((function(e,t){var n=e.aspect,a=e.width,i=void 0===a?"100%":a,o=e.height,s=void 0===o?"100%":o,u=e.minWidth,c=e.minHeight,l=e.maxHeight,f=e.children,h=e.debounce,d=void 0===h?0:h,p=e.id,v=e.className,g=z0((0,r.useState)({containerWidth:-1,containerHeight:-1}),2),m=g[0],y=g[1],b=(0,r.useRef)(null);(0,r.useImperativeHandle)(t,(function(){return b}),[b]);var x=(0,r.useCallback)((function(){return b.current?{containerWidth:b.current.clientWidth,containerHeight:b.current.clientHeight}:null}),[]),k=(0,r.useCallback)((function(){var e=x();if(e){var t=e.containerWidth,n=e.containerHeight;y((function(e){var r=e.containerWidth,a=e.containerHeight;return t!==r||n!==a?{containerWidth:t,containerHeight:n}:e}))}}),[x]),w=(0,r.useMemo)((function(){var e=m.containerWidth,t=m.containerHeight;if(e<0||t<0)return null;L0(_0(i)||_0(s),"The width(%s) and height(%s) are both fixed numbers,\n       maybe you don't need to use a ResponsiveContainer.",i,s),L0(!n||n>0,"The aspect(%s) must be greater than zero.",n);var a=_0(i)?e:i,o=_0(s)?t:s;return n&&n>0&&(a?o=a/n:o&&(a=o*n),l&&o>l&&(o=l)),L0(a>0||o>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",a,o,i,s,u,c,n),(0,r.cloneElement)(f,{width:a,height:o})}),[n,f,s,l,c,u,m,i]);(0,r.useEffect)((function(){var e=x();e&&y(e)}),[x]);var I={width:i,height:s,minWidth:u,minHeight:c,maxHeight:l};return r.createElement(v0,{handleWidth:!0,handleHeight:!0,onResize:k,targetRef:b,refreshMode:d>0?"debounce":void 0,refreshRate:d},r.createElement("div",j0({},null!=p?{id:"".concat(p)}:{},{className:c$()("recharts-responsive-container",v),style:I,ref:b}),w))})),W0=n(2730),V0=n.n(W0),G0=n(1211),H0=n.n(G0),K0=n(4786),q0=n.n(K0),X0=n(3038),Y0=n.n(X0),Z0=n(4286),Q0=n.n(Z0),J0=n(6222),$0=n.n(J0),e1=n(5633),t1=n.n(e1),n1=n(5127),r1=n.n(n1),a1=n(8092),i1=n.n(a1),o1=n(8493);function s1(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function u1(e){return u1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u1(e)}var c1=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],l1=["points","pathLength"],f1={svg:["viewBox","children"],polygon:l1,polyline:l1},h1=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],d1=function(e,t){if(!e||"function"===typeof e||"boolean"===typeof e)return null;var n=e;if((0,r.isValidElement)(e)&&(n=e.props),!i1()(n))return null;var a={};return Object.keys(n).forEach((function(e){h1.includes(e)&&(a[e]=t||function(t){return n[e](n,t)})})),a},p1=function(e,t,n){if(!i1()(e)||"object"!==u1(e))return null;var r=null;return Object.keys(e).forEach((function(a){var i=e[a];h1.includes(a)&&"function"===typeof i&&(r||(r={}),r[a]=function(e,t,n){return function(r){return e(t,n,r),null}}(i,t,n))})),r},v1=["children"],g1=["children"];function m1(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var y1={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},b1=function(e){return"string"===typeof e?e:e?e.displayName||e.name||"Component":""},x1=null,k1=null,w1=function e(t){if(t===x1&&b0()(k1))return k1;var n=[];return r.Children.forEach(t,(function(t){t1()(t)||((0,o1.isFragment)(t)?n=n.concat(e(t.props.children)):n.push(t))})),k1=n,x1=t,n};function I1(e,t){var n=[],r=[];return r=b0()(t)?t.map((function(e){return b1(e)})):[b1(t)],w1(e).forEach((function(e){var t=m0()(e,"type.displayName")||m0()(e,"type.name");-1!==r.indexOf(t)&&n.push(e)})),n}function C1(e,t){var n=I1(e,t);return n&&n[0]}var A1=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!E0(n)||n<=0||!E0(r)||r<=0)},S1=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],_1=function(e){return e&&e.type&&A0()(e.type)&&S1.indexOf(e.type)>=0},E1=function(e,t,n){if(!e||"function"===typeof e||"boolean"===typeof e)return null;var a=e;if((0,r.isValidElement)(e)&&(a=e.props),!i1()(a))return null;var i={};return Object.keys(a).forEach((function(e){var r;(function(e,t,n,r){var a,i=null!==(a=null===f1||void 0===f1?void 0:f1[r])&&void 0!==a?a:[];return!q0()(e)&&(r&&i.includes(t)||c1.includes(t))||n&&h1.includes(t)})(null===(r=a)||void 0===r?void 0:r[e],e,t,n)&&(i[e]=a[e])})),i},T1=function e(t,n){if(t===n)return!0;var a=r.Children.count(t);if(a!==r.Children.count(n))return!1;if(0===a)return!0;if(1===a)return N1(b0()(t)?t[0]:t,b0()(n)?n[0]:n);for(var i=0;i<a;i++){var o=t[i],s=n[i];if(b0()(o)||b0()(s)){if(!e(o,s))return!1}else if(!N1(o,s))return!1}return!0},N1=function(e,t){if(t1()(e)&&t1()(t))return!0;if(!t1()(e)&&!t1()(t)){var n=e.props||{},r=n.children,a=m1(n,v1),i=t.props||{},o=i.children,s=m1(i,g1);return r&&o?s1(a,s)&&T1(r,o):!r&&!o&&s1(a,s)}return!1},O1=function(e,t){var n=[],r={};return w1(e).forEach((function(e,a){if(_1(e))n.push(e);else if(e){var i=b1(e.type),o=t[i]||{},s=o.handler,u=o.once;if(s&&(!u||!r[i])){var c=s(e,i,a);n.push(c),r[i]=!0}}})),n},R1=function(e){var t=e&&e.type;return t&&y1[t]?y1[t]:null},P1=["children","width","height","viewBox","className","style"];function D1(){return D1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},D1.apply(this,arguments)}function M1(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function F1(e){var t=e.children,n=e.width,a=e.height,i=e.viewBox,o=e.className,s=e.style,u=M1(e,P1),c=i||{width:n,height:a,x:0,y:0},l=c$()("recharts-surface",o);return r.createElement("svg",D1({},E1(u,!0,"svg"),{className:l,width:n,height:a,style:s,viewBox:"".concat(c.x," ").concat(c.y," ").concat(c.width," ").concat(c.height)}),r.createElement("title",null,e.title),r.createElement("desc",null,e.desc),t)}var L1=["children","className"];function j1(){return j1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j1.apply(this,arguments)}function z1(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var U1=r.forwardRef((function(e,t){var n=e.children,a=e.className,i=z1(e,L1),o=c$()("recharts-layer",a);return r.createElement("g",j1({className:o},E1(i,!0),{ref:t}),n)})),B1=n(6339),W1=n.n(B1),V1=n(2007),G1=n.n(V1),H1=n(5244);function K1(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1;requestAnimationFrame((function r(a){n<0&&(n=a),a-n>t?(e(a),n=-1):requestAnimationFrame(r)}))}function q1(e){return q1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q1(e)}function X1(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Y1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y1(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y1(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Z1(){var e=function(){return null},t=!1,n=function n(r){if(!t){if(Array.isArray(r)){if(!r.length)return;var a=X1(r),i=a[0],o=a.slice(1);return"number"===typeof i?void K1(n.bind(null,o),i):(n(i),void K1(n.bind(null,o)))}"object"===q1(r)&&e(r),"function"===typeof r&&r()}};return{stop:function(){t=!0},start:function(e){t=!1,n(e)},subscribe:function(t){return e=t,function(){e=function(){return null}}}}}function Q1(e){return Q1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q1(e)}function J1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J1(Object(n),!0).forEach((function(t){e2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J1(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function e2(e,t,n){return t=function(e){var t=function(e,t){if("object"!==Q1(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Q1(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Q1(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var t2=["Webkit","Moz","O","ms"],n2=["-webkit-","-moz-","-o-","-ms-"],r2=["transform","transformOrigin","transition"],a2=function(e){return e},i2=function(e,t){return Object.keys(t).reduce((function(n,r){return $1($1({},n),{},e2({},r,e(r,t[r])))}),{})},o2=function(e){return Object.keys(e).reduce((function(e,t){return $1($1({},e),function(e,t){if(-1===r2.indexOf(e))return e2({},e,t);var n="transition"===e,r=e.replace(/(\w)/,(function(e){return e.toUpperCase()})),a=t;return t2.reduce((function(e,i,o){return n&&(a=t.replace(/(transform|transform-origin)/gim,"".concat(n2[o],"$1"))),$1($1({},e),{},e2({},i+r,a))}),{})}(t,e[t]))}),e)},s2=function(e,t,n){return e.map((function(e){return"".concat((r=e,r.replace(/([A-Z])/g,(function(e){return"-".concat(e.toLowerCase())})))," ").concat(t,"ms ").concat(n);var r})).join(",")},u2=function(e,t,n,r,a,i,o,s){};function c2(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(Wse){c=!0,a=Wse}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||f2(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l2(e){return function(e){if(Array.isArray(e))return h2(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f2(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f2(e,t){if(e){if("string"===typeof e)return h2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h2(e,t):void 0}}function h2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d2=1e-4,p2=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},v2=function(e,t){return e.map((function(e,n){return e*Math.pow(t,n)})).reduce((function(e,t){return e+t}))},g2=function(e,t){return function(n){var r=p2(e,t);return v2(r,n)}},m2=function(e,t){return function(n){var r=p2(e,t),a=[].concat(l2(r.map((function(e,t){return e*t})).slice(1)),[0]);return v2(a,n)}},y2=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],a=t[1],i=t[2],o=t[3];if(1===t.length)switch(t[0]){case"linear":r=0,a=0,i=1,o=1;break;case"ease":r=.25,a=.1,i=.25,o=1;break;case"ease-in":r=.42,a=0,i=1,o=1;break;case"ease-out":r=.42,a=0,i=.58,o=1;break;case"ease-in-out":r=0,a=0,i=.58,o=1;break;default:var s=t[0].split("(");if("cubic-bezier"===s[0]&&4===s[1].split(")")[0].split(",").length){var u=s[1].split(")")[0].split(",").map((function(e){return parseFloat(e)})),c=c2(u,4);r=c[0],a=c[1],i=c[2],o=c[3]}else u2(!1,"[configBezier]: arguments should be one of oneOf 'linear', 'ease', 'ease-in', 'ease-out', 'ease-in-out','cubic-bezier(x1,y1,x2,y2)', instead received %s",t)}u2([r,i,a,o].every((function(e){return"number"===typeof e&&e>=0&&e<=1})),"[configBezier]: arguments should be x1, y1, x2, y2 of [0, 1] instead received %s",t);var l=g2(r,i),f=g2(a,o),h=m2(r,i),d=function(e){return e>1?1:e<0?0:e},p=function(e){for(var t=e>1?1:e,n=t,r=0;r<8;++r){var a=l(n)-t,i=h(n);if(Math.abs(a-t)<d2||i<d2)return f(n);n=d(n-a/i)}return f(n)};return p.isStepper=!1,p},b2=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stiff,n=void 0===t?100:t,r=e.damping,a=void 0===r?8:r,i=e.dt,o=void 0===i?17:i,s=function(e,t,r){var i=r+(-(e-t)*n-r*a)*o/1e3,s=r*o/1e3+e;return Math.abs(s-t)<d2&&Math.abs(i)<d2?[t,0]:[s,i]};return s.isStepper=!0,s.dt=o,s};function x2(e){return x2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x2(e)}function k2(e){return function(e){if(Array.isArray(e))return _2(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S2(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w2(Object(n),!0).forEach((function(t){C2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w2(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C2(e,t,n){return t=function(e){var t=function(e,t){if("object"!==x2(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==x2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===x2(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A2(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(Wse){c=!0,a=Wse}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||S2(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S2(e,t){if(e){if("string"===typeof e)return _2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_2(e,t):void 0}}function _2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E2=function(e,t,n){return e+(t-e)*n},T2=function(e){return e.from!==e.to},N2=function e(t,n,r){var a=i2((function(e,n){if(T2(n)){var r=A2(t(n.from,n.to,n.velocity),2),a=r[0],i=r[1];return I2(I2({},n),{},{from:a,velocity:i})}return n}),n);return r<1?i2((function(e,t){return T2(t)?I2(I2({},t),{},{velocity:E2(t.velocity,a[e].velocity,r),from:E2(t.from,a[e].from,r)}):t}),n):e(t,a,r-1)},O2=function(e,t,n,r,a){var i,o,s,u,c=(i=e,o=t,[Object.keys(i),Object.keys(o)].reduce((function(e,t){return e.filter((function(e){return t.includes(e)}))}))),l=c.reduce((function(n,r){return I2(I2({},n),{},C2({},r,[e[r],t[r]]))}),{}),f=c.reduce((function(n,r){return I2(I2({},n),{},C2({},r,{from:e[r],velocity:0,to:t[r]}))}),{}),h=-1,d=function(){return null};return d=n.isStepper?function(r){s||(s=r);var i=(r-s)/n.dt;f=N2(n,f,i),a(I2(I2(I2({},e),t),i2((function(e,t){return t.from}),f))),s=r,Object.values(f).filter(T2).length&&(h=requestAnimationFrame(d))}:function(i){u||(u=i);var o=(i-u)/r,s=i2((function(e,t){return E2.apply(void 0,k2(t).concat([n(o)]))}),l);if(a(I2(I2(I2({},e),t),s)),o<1)h=requestAnimationFrame(d);else{var c=i2((function(e,t){return E2.apply(void 0,k2(t).concat([n(1)]))}),l);a(I2(I2(I2({},e),t),c))}},function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(h)}}},R2=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function P2(e){return P2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P2(e)}function D2(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function M2(e){return function(e){if(Array.isArray(e))return F2(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return F2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F2(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L2(Object(n),!0).forEach((function(t){H2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L2(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,K2(r.key),r)}}function U2(e,t){return U2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U2(e,t)}function B2(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=G2(e);if(t){var a=G2(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return W2(this,n)}}function W2(e,t){if(t&&("object"===P2(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return V2(e)}function V2(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G2(e){return G2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},G2(e)}function H2(e,t,n){return(t=K2(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K2(e){var t=function(e,t){if("object"!==P2(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==P2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===P2(t)?t:String(t)}var q2=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U2(e,t)}(o,e);var t,n,a,i=B2(o);function o(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var r=(n=i.call(this,e,t)).props,a=r.isActive,s=r.attributeName,u=r.from,c=r.to,l=r.steps,f=r.children;if(n.handleStyleChange=n.handleStyleChange.bind(V2(n)),n.changeStyle=n.changeStyle.bind(V2(n)),!a)return n.state={style:{}},"function"===typeof f&&(n.state={style:c}),W2(n);if(l&&l.length)n.state={style:l[0].style};else if(u){if("function"===typeof f)return n.state={style:u},W2(n);n.state={style:s?H2({},s,u):u}}else n.state={style:{}};return n}return t=o,n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isActive,n=e.canBegin;this.mounted=!0,t&&n&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isActive,r=t.canBegin,a=t.attributeName,i=t.shouldReAnimate;if(r)if(n){if(!((0,H1.deepEqual)(e.to,this.props.to)&&e.canBegin&&e.isActive)){var o=!e.canBegin||!e.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var s=o||i?this.props.from:e.to;if(this.state&&this.state.style){var u={style:a?H2({},a,s):s};(a&&this.state.style[a]!==s||!a&&this.state.style!==s)&&this.setState(u)}this.runAnimation(j2(j2({},this.props),{},{from:s,begin:0}))}}else{var c={style:a?H2({},a,this.props.to):this.props.to};this.state&&this.state.style&&(a&&this.state.style[a]!==this.props.to||!a&&this.state.style!==this.props.to)&&this.setState(c)}}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation()}},{key:"runJSAnimation",value:function(e){var t=this,n=e.from,r=e.to,a=e.duration,i=e.easing,o=e.begin,s=e.onAnimationEnd,u=e.onAnimationStart,c=O2(n,r,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if("string"===typeof r)switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return y2(r);case"spring":return b2();default:if("cubic-bezier"===r.split("(")[0])return y2(r);u2(!1,"[configEasing]: first argument should be one of 'ease', 'ease-in', 'ease-out', 'ease-in-out','cubic-bezier(x1,y1,x2,y2)', 'linear' and 'spring', instead  received %s",t)}return"function"===typeof r?r:(u2(!1,"[configEasing]: first argument type should be function or string, instead received %s",t),null)}(i),a,this.changeStyle);this.manager.start([u,o,function(){t.stopJSAnimation=c()},a,s])}},{key:"runStepAnimation",value:function(e){var t=this,n=e.steps,r=e.begin,a=e.onAnimationStart,i=n[0],o=i.style,s=i.duration,u=void 0===s?0:s;return this.manager.start([a].concat(M2(n.reduce((function(e,r,a){if(0===a)return e;var i=r.duration,o=r.easing,s=void 0===o?"ease":o,u=r.style,c=r.properties,l=r.onAnimationEnd,f=a>0?n[a-1]:r,h=c||Object.keys(u);if("function"===typeof s||"spring"===s)return[].concat(M2(e),[t.runJSAnimation.bind(t,{from:f.style,to:u,duration:i,easing:s}),i]);var d=s2(h,i,s),p=j2(j2(j2({},f.style),u),{},{transition:d});return[].concat(M2(e),[p,i,l]).filter(a2)}),[o,Math.max(u,r)])),[e.onAnimationEnd]))}},{key:"runAnimation",value:function(e){this.manager||(this.manager=Z1());var t=e.begin,n=e.duration,r=e.attributeName,a=e.to,i=e.easing,o=e.onAnimationStart,s=e.onAnimationEnd,u=e.steps,c=e.children,l=this.manager;if(this.unSubscribe=l.subscribe(this.handleStyleChange),"function"!==typeof i&&"function"!==typeof c&&"spring"!==i)if(u.length>1)this.runStepAnimation(e);else{var f=r?H2({},r,a):a,h=s2(Object.keys(f),n,i);l.start([o,t,j2(j2({},f),{},{transition:h}),n,s])}else this.runJSAnimation(e)}},{key:"handleStyleChange",value:function(e){this.changeStyle(e)}},{key:"changeStyle",value:function(e){this.mounted&&this.setState({style:e})}},{key:"render",value:function(){var e=this.props,t=e.children,n=(e.begin,e.duration,e.attributeName,e.easing,e.isActive),a=(e.steps,e.from,e.to,e.canBegin,e.onAnimationEnd,e.shouldReAnimate,e.onAnimationReStart,D2(e,R2)),i=r.Children.count(t),o=o2(this.state.style);if("function"===typeof t)return t(o);if(!n||0===i)return t;var s=function(e){var t=e.props,n=t.style,i=void 0===n?{}:n,s=t.className;return(0,r.cloneElement)(e,j2(j2({},a),{},{style:j2(j2({},i),o),className:s}))};return 1===i?s(r.Children.only(t)):r.createElement("div",null,r.Children.map(t,(function(e){return s(e)})))}}],n&&z2(t.prototype,n),a&&z2(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);H2(q2,"displayName","Animate"),H2(q2,"propTypes",{from:G1().oneOfType([G1().object,G1().string]),to:G1().oneOfType([G1().object,G1().string]),attributeName:G1().string,duration:G1().number,begin:G1().number,easing:G1().oneOfType([G1().string,G1().func]),steps:G1().arrayOf(G1().shape({duration:G1().number.isRequired,style:G1().object.isRequired,easing:G1().oneOfType([G1().oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),G1().func]),properties:G1().arrayOf("string"),onAnimationEnd:G1().func})),children:G1().oneOfType([G1().node,G1().func]),isActive:G1().bool,canBegin:G1().bool,onAnimationEnd:G1().func,shouldReAnimate:G1().bool,onAnimationStart:G1().func,onAnimationReStart:G1().func}),H2(q2,"defaultProps",{begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}});var X2=q2,Y2=n(8267),Z2=["children","appearOptions","enterOptions","leaveOptions"];function Q2(e){return Q2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q2(e)}function J2(){return J2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},J2.apply(this,arguments)}function $2(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function e3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e3(Object(n),!0).forEach((function(t){s3(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e3(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function n3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u3(r.key),r)}}function r3(e,t){return r3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r3(e,t)}function a3(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=o3(e);if(t){var a=o3(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Q2(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i3(e)}(this,n)}}function i3(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o3(e){return o3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},o3(e)}function s3(e,t,n){return(t=u3(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u3(e){var t=function(e,t){if("object"!==Q2(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Q2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Q2(t)?t:String(t)}void 0===Number.isFinite&&(Number.isFinite=function(e){return"number"===typeof e&&isFinite(e)});var c3=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.steps,n=e.duration;return t&&t.length?t.reduce((function(e,t){return e+(Number.isFinite(t.duration)&&t.duration>0?t.duration:0)}),0):Number.isFinite(n)?n:0},l3=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r3(e,t)}(o,e);var t,n,a,i=a3(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return s3(i3(e=i.call.apply(i,[this].concat(n))),"state",{isActive:!1}),s3(i3(e),"handleEnter",(function(t,n){var r=e.props,a=r.appearOptions,i=r.enterOptions;e.handleStyleActive(n?a:i)})),s3(i3(e),"handleExit",(function(){e.handleStyleActive(e.props.leaveOptions)})),e}return t=o,(n=[{key:"handleStyleActive",value:function(e){if(e){var t=e.onAnimationEnd?function(){e.onAnimationEnd()}:null;this.setState(t3(t3({},e),{},{onAnimationEnd:t,isActive:!0}))}}},{key:"parseTimeout",value:function(){var e=this.props,t=e.appearOptions,n=e.enterOptions,r=e.leaveOptions;return c3(t)+c3(n)+c3(r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,a=(t.appearOptions,t.enterOptions,t.leaveOptions,$2(t,Z2));return r.createElement(Y2.Transition,J2({},a,{onEnter:this.handleEnter,onExit:this.handleExit,timeout:this.parseTimeout()}),(function(){return r.createElement(X2,e.state,r.Children.only(n))}))}}])&&n3(t.prototype,n),a&&n3(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.Component);s3(l3,"propTypes",{appearOptions:G1().object,enterOptions:G1().object,leaveOptions:G1().object,children:G1().element});var f3=l3;function h3(e){var t=e.component,n=e.children,a=e.appear,i=e.enter,o=e.leave;return r.createElement(Y2.TransitionGroup,{component:t},r.Children.map(n,(function(e,t){return r.createElement(f3,{appearOptions:a,enterOptions:i,leaveOptions:o,key:"child-".concat(t)},e)})))}h3.propTypes={appear:G1().object,enter:G1().object,leave:G1().object,children:G1().oneOfType([G1().array,G1().element]),component:G1().any},h3.defaultProps={component:"span"};var d3=X2;function p3(e){return p3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p3(e)}function v3(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(Wse){c=!0,a=Wse}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return g3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g3(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g3(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m3(Object(n),!0).forEach((function(t){I3(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m3(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C3(r.key),r)}}function x3(e,t){return x3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},x3(e,t)}function k3(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w3(e);if(t){var a=w3(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===p3(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function w3(e){return w3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w3(e)}function I3(e,t,n){return(t=C3(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C3(e){var t=function(e,t){if("object"!==p3(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p3(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p3(t)?t:String(t)}function A3(e){return b0()(e)&&T0(e[0])&&T0(e[1])?e.join(" ~ "):e}var S3=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x3(e,t)}(o,e);var t,n,a,i=k3(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,n=[{key:"renderContent",value:function(){var e=this.props,t=e.payload,n=e.separator,a=e.formatter,i=e.itemStyle,o=e.itemSorter;if(t&&t.length){var s=(o?Q0()(t,o):t).map((function(e,o){if("none"===e.type)return null;var s=y3({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},i),u=e.formatter||a||A3,c=e.value,l=e.name;if(u&&null!=c&&null!=l){var f=u(c,l,e,o,t);if(Array.isArray(f)){var h=v3(f,2);c=h[0],l=h[1]}else c=f}return r.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(o),style:s},T0(l)?r.createElement("span",{className:"recharts-tooltip-item-name"},l):null,T0(l)?r.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,r.createElement("span",{className:"recharts-tooltip-item-value"},c),r.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))}));return r.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},s)}return null}},{key:"render",value:function(){var e=this.props,t=e.wrapperClassName,n=e.contentStyle,a=e.labelClassName,i=e.labelStyle,o=e.label,s=e.labelFormatter,u=e.payload,c=y3({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),l=y3({margin:0},i),f=!t1()(o),h=f?o:"",d=c$()("recharts-default-tooltip",t),p=c$()("recharts-tooltip-label",a);return f&&s&&void 0!==u&&null!==u&&(h=s(o,u)),r.createElement("div",{className:d,style:c},r.createElement("p",{className:p,style:l},r.isValidElement(h)?h:"".concat(h)),this.renderContent())}}],n&&b3(t.prototype,n),a&&b3(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);I3(S3,"displayName","DefaultTooltipContent"),I3(S3,"defaultProps",{separator:" : ",contentStyle:{},itemStyle:{},labelStyle:{}});var _3={isSsr:!("undefined"!==typeof window&&window.document&&window.document.createElement&&window.setTimeout),get:function(e){return _3[e]},set:function(e,t){if("string"===typeof e)_3[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach((function(t){_3[t]=e[t]}))}}};function E3(e){return E3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E3(e)}function T3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T3(Object(n),!0).forEach((function(t){F3(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T3(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L3(r.key),r)}}function R3(e,t){return R3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R3(e,t)}function P3(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M3(e);if(t){var a=M3(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===E3(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return D3(e)}(this,n)}}function D3(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M3(e){return M3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M3(e)}function F3(e,t,n){return(t=L3(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L3(e){var t=function(e,t){if("object"!==E3(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==E3(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===E3(t)?t:String(t)}var j3="recharts-tooltip-wrapper";function z3(e){return e.dataKey}var U3=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R3(e,t)}(o,e);var t,n,a,i=P3(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return F3(D3(e=i.call.apply(i,[this].concat(n))),"state",{boxWidth:-1,boxHeight:-1,dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),F3(D3(e),"getTranslate",(function(t){var n=t.key,r=t.tooltipDimension,a=t.viewBoxDimension,i=e.props,o=i.allowEscapeViewBox,s=i.reverseDirection,u=i.coordinate,c=i.offset,l=i.position,f=i.viewBox;if(l&&E0(l[n]))return l[n];var h=u[n]-r-c,d=u[n]+c;return o[n]?s[n]?h:d:s[n]?h<f[n]?Math.max(d,f[n]):Math.max(h,f[n]):d+r>f[n]+a?Math.max(h,f[n]):Math.max(d,f[n])})),e}return t=o,(n=[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"updateBBox",value:function(){var e=this.state,t=e.boxWidth,n=e.boxHeight;if(e.dismissed?(this.wrapperNode.blur(),this.props.coordinate.x===this.state.dismissedAtCoordinate.x&&this.props.coordinate.y===this.state.dismissedAtCoordinate.y||this.setState({dismissed:!1})):this.wrapperNode.focus({preventScroll:!0}),this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-t)>1||Math.abs(r.height-n)>1)&&this.setState({boxWidth:r.width,boxHeight:r.height})}else-1===t&&-1===n||this.setState({boxWidth:-1,boxHeight:-1})}},{key:"render",value:function(){var e,t,n,a=this,i=this.props,o=i.payload,s=i.isAnimationActive,u=i.animationDuration,c=i.animationEasing,l=i.filterNull,f=function(e,t){return!0===e?W1()(t,z3):q0()(e)?W1()(t,e):t}(i.payloadUniqBy,l&&o&&o.length?o.filter((function(e){return!t1()(e.value)})):o),h=f&&f.length,d=this.props,p=d.content,v=d.viewBox,g=d.coordinate,m=d.position,y=d.active,b=d.wrapperStyle,x=N3({pointerEvents:"none",visibility:!this.state.dismissed&&y&&h?"visible":"hidden",position:"absolute",top:0,left:0},b);if(m&&E0(m.x)&&E0(m.y))t=m.x,n=m.y;else{var k=this.state,w=k.boxWidth,I=k.boxHeight;w>0&&I>0&&g?(t=this.getTranslate({key:"x",tooltipDimension:w,viewBoxDimension:v.width}),n=this.getTranslate({key:"y",tooltipDimension:I,viewBoxDimension:v.height})):x.visibility="hidden"}x=N3(N3({},o2({transform:this.props.useTranslate3d?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")})),x),s&&y&&(x=N3(N3({},o2({transition:"transform ".concat(u,"ms ").concat(c)})),x));var C=c$()(j3,(F3(e={},"".concat(j3,"-right"),E0(t)&&g&&E0(g.x)&&t>=g.x),F3(e,"".concat(j3,"-left"),E0(t)&&g&&E0(g.x)&&t<g.x),F3(e,"".concat(j3,"-bottom"),E0(n)&&g&&E0(g.y)&&n>=g.y),F3(e,"".concat(j3,"-top"),E0(n)&&g&&E0(g.y)&&n<g.y),e));return r.createElement("div",{tabIndex:-1,role:"dialog",onKeyDown:function(e){"Escape"===e.key&&a.setState({dismissed:!0,dismissedAtCoordinate:N3(N3({},a.state.dismissedAtCoordinate),{},{x:a.props.coordinate.x,y:a.props.coordinate.y})})},className:C,style:x,ref:function(e){a.wrapperNode=e}},function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):q0()(e)?r.createElement(e,t):r.createElement(S3,t)}(p,N3(N3({},this.props),{},{payload:f})))}}])&&O3(t.prototype,n),a&&O3(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);F3(U3,"displayName","Tooltip"),F3(U3,"defaultProps",{active:!1,allowEscapeViewBox:{x:!1,y:!1},reverseDirection:{x:!1,y:!1},offset:10,viewBox:{x1:0,x2:0,y1:0,y2:0},coordinate:{x:0,y:0},cursorStyle:{},separator:" : ",wrapperStyle:{},contentStyle:{},itemStyle:{},labelStyle:{},cursor:!0,trigger:"hover",isAnimationActive:!_3.isSsr,animationEasing:"ease",animationDuration:400,filterNull:!0,useTranslate3d:!1});var B3=n(2085),W3=n.n(B3),V3=(Math.abs,Math.atan2,Math.cos),G3=(Math.max,Math.min,Math.sin),H3=Math.sqrt,K3=Math.PI,q3=2*K3;var X3,Y3,Z3,Q3,J3,$3,e4,t4,n4,r4,a4,i4,o4,s4,u4={draw:function(e,t){var n=H3(t/K3);e.moveTo(n,0),e.arc(0,0,n,0,q3)}},c4={draw:function(e,t){var n=H3(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},l4=H3(1/3),f4=2*l4,h4={draw:function(e,t){var n=H3(t/f4),r=n*l4;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},d4={draw:function(e,t){var n=H3(t),r=-n/2;e.rect(r,r,n,n)}},p4=G3(K3/10)/G3(7*K3/10),v4=G3(q3/10)*p4,g4=-V3(q3/10)*p4,m4={draw:function(e,t){var n=H3(.8908130915292852*t),r=v4*n,a=g4*n;e.moveTo(0,-n),e.lineTo(r,a);for(var i=1;i<5;++i){var o=q3*i/5,s=V3(o),u=G3(o);e.lineTo(u*n,-s*n),e.lineTo(s*r-u*a,u*r+s*a)}e.closePath()}},y4=H3(3),b4={draw:function(e,t){var n=-H3(t/(3*y4));e.moveTo(0,2*n),e.lineTo(-y4*n,-n),e.lineTo(y4*n,-n),e.closePath()}},x4=-.5,k4=H3(3)/2,w4=1/H3(12),I4=3*(w4/2+1),C4={draw:function(e,t){var n=H3(t/I4),r=n/2,a=n*w4,i=r,o=n*w4+n,s=-i,u=o;e.moveTo(r,a),e.lineTo(i,o),e.lineTo(s,u),e.lineTo(x4*r-k4*a,k4*r+x4*a),e.lineTo(x4*i-k4*o,k4*i+x4*o),e.lineTo(x4*s-k4*u,k4*s+x4*u),e.lineTo(x4*r+k4*a,x4*a-k4*r),e.lineTo(x4*i+k4*o,x4*o-k4*i),e.lineTo(x4*s+k4*u,x4*u-k4*s),e.closePath()}};function A4(e){return function(){return e}}function S4(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var _4=Math.PI,E4=2*_4,T4=1e-6,N4=E4-T4;function O4(e){this._+=e[0];for(var t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}var R4=function(){function e(t){G(this,e),this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?O4:function(e){var t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return O4;var n=Math.pow(10,t);return function(e){this._+=e[0];for(var t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(t)}return q(e,[{key:"moveTo",value:function(e,t){this._append(X3||(X3=S4(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(Y3||(Y3=S4(["Z"]))))}},{key:"lineTo",value:function(e,t){this._append(Z3||(Z3=S4(["L",",",""])),this._x1=+e,this._y1=+t)}},{key:"quadraticCurveTo",value:function(e,t,n,r){this._append(Q3||(Q3=S4(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}},{key:"bezierCurveTo",value:function(e,t,n,r,a,i){this._append(J3||(J3=S4(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+a,this._y1=+i)}},{key:"arcTo",value:function(e,t,n,r,a){if(e=+e,t=+t,n=+n,r=+r,(a=+a)<0)throw new Error("negative radius: ".concat(a));var i=this._x1,o=this._y1,s=n-e,u=r-t,c=i-e,l=o-t,f=c*c+l*l;if(null===this._x1)this._append($3||($3=S4(["M",",",""])),this._x1=e,this._y1=t);else if(f>T4)if(Math.abs(l*s-u*c)>T4&&a){var h=n-i,d=r-o,p=s*s+u*u,v=h*h+d*d,g=Math.sqrt(p),m=Math.sqrt(f),y=a*Math.tan((_4-Math.acos((p+f-v)/(2*g*m)))/2),b=y/m,x=y/g;Math.abs(b-1)>T4&&this._append(t4||(t4=S4(["L",",",""])),e+b*c,t+b*l),this._append(n4||(n4=S4(["A",",",",0,0,",",",",",""])),a,a,+(l*h>c*d),this._x1=e+x*s,this._y1=t+x*u)}else this._append(e4||(e4=S4(["L",",",""])),this._x1=e,this._y1=t);else;}},{key:"arc",value:function(e,t,n,r,a,i){if(e=+e,t=+t,i=!!i,(n=+n)<0)throw new Error("negative radius: ".concat(n));var o=n*Math.cos(r),s=n*Math.sin(r),u=e+o,c=t+s,l=1^i,f=i?r-a:a-r;null===this._x1?this._append(r4||(r4=S4(["M",",",""])),u,c):(Math.abs(this._x1-u)>T4||Math.abs(this._y1-c)>T4)&&this._append(a4||(a4=S4(["L",",",""])),u,c),n&&(f<0&&(f=f%E4+E4),f>N4?this._append(i4||(i4=S4(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,l,e-o,t-s,n,n,l,this._x1=u,this._y1=c):f>T4&&this._append(o4||(o4=S4(["A",",",",0,",",",",",",",""])),n,n,+(f>=_4),l,this._x1=e+n*Math.cos(a),this._y1=t+n*Math.sin(a)))}},{key:"rect",value:function(e,t,n,r){this._append(s4||(s4=S4(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}},{key:"toString",value:function(){return this._}}]),e}();function P4(e){var t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{var r=Math.floor(n);if(!(r>=0))throw new RangeError("invalid digits: ".concat(n));t=r}return e},function(){return new R4(t)}}R4.prototype;H3(3),H3(3);function D4(e){return D4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D4(e)}function M4(){return M4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M4.apply(this,arguments)}function F4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,B4(r.key),r)}}function L4(e,t){return L4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L4(e,t)}function j4(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z4(e);if(t){var a=z4(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===D4(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function z4(e){return z4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},z4(e)}function U4(e,t,n){return(t=B4(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B4(e){var t=function(e,t){if("object"!==D4(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==D4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===D4(t)?t:String(t)}var W4={symbolCircle:u4,symbolCross:c4,symbolDiamond:h4,symbolSquare:d4,symbolStar:m4,symbolTriangle:b4,symbolWye:C4},V4=Math.PI/180,G4=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L4(e,t)}(o,e);var t,n,a,i=j4(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,n=[{key:"getPath",value:function(){var e=this.props,t=e.size,n=e.sizeType,r=e.type,a=function(e){var t="symbol".concat(W3()(e));return W4[t]||u4}(r),i=function(e,t){var n=null,r=P4(a);function a(){var a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"===typeof e?e:A4(e||u4),t="function"===typeof t?t:A4(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"===typeof t?t:A4(t),a):e},a.size=function(e){return arguments.length?(t="function"===typeof e?e:A4(+e),a):t},a.context=function(e){return arguments.length?(n=null==e?null:e,a):n},a}().type(a).size(function(e,t,n){if("area"===t)return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var r=18*V4;return 1.25*e*e*(Math.tan(r)-Math.tan(2*r)*Math.pow(Math.tan(r),2));case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}}(t,n,r));return i()}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.cx,a=e.cy,i=e.size,o=E1(this.props,!0);return n===+n&&a===+a&&i===+i?r.createElement("path",M4({},o,{className:c$()("recharts-symbols",t),transform:"translate(".concat(n,", ").concat(a,")"),d:this.getPath()})):null}}],n&&F4(t.prototype,n),a&&F4(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function H4(e){return H4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H4(e)}function K4(){return K4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},K4.apply(this,arguments)}function q4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$4(r.key),r)}}function Y4(e,t){return Y4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Y4(e,t)}function Z4(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Q4(e);if(t){var a=Q4(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===H4(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Q4(e){return Q4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Q4(e)}function J4(e,t,n){return(t=$4(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $4(e){var t=function(e,t){if("object"!==H4(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==H4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===H4(t)?t:String(t)}U4(G4,"defaultProps",{type:"circle",size:64,sizeType:"area"}),U4(G4,"registerSymbol",(function(e,t){W4["symbol".concat(W3()(e))]=t}));var e5=32,t5=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y4(e,t)}(o,e);var t,n,a,i=Z4(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,n=[{key:"renderIcon",value:function(e){var t=this.props.inactiveColor,n=16,a=e5/6,i=e5/3,o=e.inactive?t:e.color;if("plainline"===e.type)return r.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:n,x2:e5,y2:n,className:"recharts-legend-icon"});if("line"===e.type)return r.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(n,"h").concat(i,"\n            A").concat(a,",").concat(a,",0,1,1,").concat(2*i,",").concat(n,"\n            H").concat(e5,"M").concat(2*i,",").concat(n,"\n            A").concat(a,",").concat(a,",0,1,1,").concat(i,",").concat(n),className:"recharts-legend-icon"});if("rect"===e.type)return r.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(4,"h").concat(e5,"v").concat(24,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(r.isValidElement(e.legendIcon)){var s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q4(Object(n),!0).forEach((function(t){J4(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q4(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return delete s.legendIcon,r.cloneElement(e.legendIcon,s)}return r.createElement(G4,{fill:o,cx:n,cy:n,size:e5,sizeType:"diameter",type:e.type})}},{key:"renderItems",value:function(){var e=this,t=this.props,n=t.payload,a=t.iconSize,i=t.layout,o=t.formatter,s=t.inactiveColor,u={x:0,y:0,width:e5,height:e5},c={display:"horizontal"===i?"inline-block":"block",marginRight:10},l={display:"inline-block",verticalAlign:"middle",marginRight:4};return n.map((function(t,n){var i,f=t.formatter||o,h=c$()((J4(i={"recharts-legend-item":!0},"legend-item-".concat(n),!0),J4(i,"inactive",t.inactive),i));if("none"===t.type)return null;var d=t.inactive?s:t.color;return r.createElement("li",K4({className:h,style:c,key:"legend-item-".concat(n)},p1(e.props,t,n)),r.createElement(F1,{width:a,height:a,viewBox:u,style:l},e.renderIcon(t)),r.createElement("span",{className:"recharts-legend-item-text",style:{color:d}},f?f(t.value,t,n):t.value))}))}},{key:"render",value:function(){var e=this.props,t=e.payload,n=e.layout,a=e.align;if(!t||!t.length)return null;var i={padding:0,margin:0,textAlign:"horizontal"===n?a:"left"};return r.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}],n&&X4(t.prototype,n),a&&X4(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function n5(e){return n5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n5(e)}J4(t5,"displayName","Legend"),J4(t5,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var r5=["ref"];function a5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i5(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a5(Object(n),!0).forEach((function(t){f5(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a5(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h5(r.key),r)}}function s5(e,t){return s5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s5(e,t)}function u5(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l5(e);if(t){var a=l5(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===n5(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c5(e)}(this,n)}}function c5(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l5(e){return l5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l5(e)}function f5(e,t,n){return(t=h5(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h5(e){var t=function(e,t){if("object"!==n5(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==n5(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===n5(t)?t:String(t)}function d5(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function p5(e){return e.value}function v5(e,t){return!0===e?W1()(t,p5):q0()(e)?W1()(t,e):t}var g5=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s5(e,t)}(o,e);var t,n,a,i=u5(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return f5(c5(e=i.call.apply(i,[this].concat(n))),"state",{boxWidth:-1,boxHeight:-1}),e}return t=o,a=[{key:"getWithHeight",value:function(e,t){var n=e.props.layout;return"vertical"===n&&E0(e.props.height)?{height:e.props.height}:"horizontal"===n?{width:e.props.width||t}:null}}],(n=[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){return this.wrapperNode&&this.wrapperNode.getBoundingClientRect?this.wrapperNode.getBoundingClientRect():null}},{key:"getBBoxSnapshot",value:function(){var e=this.state,t=e.boxWidth,n=e.boxHeight;return t>=0&&n>=0?{width:t,height:n}:null}},{key:"getDefaultPosition",value:function(e){var t,n,r=this.props,a=r.layout,i=r.align,o=r.verticalAlign,s=r.margin,u=r.chartWidth,c=r.chartHeight;return e&&(void 0!==e.left&&null!==e.left||void 0!==e.right&&null!==e.right)||(t="center"===i&&"vertical"===a?{left:((u||0)-(this.getBBoxSnapshot()||{width:0}).width)/2}:"right"===i?{right:s&&s.right||0}:{left:s&&s.left||0}),e&&(void 0!==e.top&&null!==e.top||void 0!==e.bottom&&null!==e.bottom)||(n="middle"===o?{top:((c||0)-(this.getBBoxSnapshot()||{height:0}).height)/2}:"bottom"===o?{bottom:s&&s.bottom||0}:{top:s&&s.top||0}),i5(i5({},t),n)}},{key:"updateBBox",value:function(){var e=this.state,t=e.boxWidth,n=e.boxHeight,r=this.props.onBBoxUpdate;if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();(Math.abs(a.width-t)>1||Math.abs(a.height-n)>1)&&this.setState({boxWidth:a.width,boxHeight:a.height},(function(){r&&r(a)}))}else-1===t&&-1===n||this.setState({boxWidth:-1,boxHeight:-1},(function(){r&&r(null)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.content,a=t.width,i=t.height,o=t.wrapperStyle,s=t.payloadUniqBy,u=t.payload,c=i5(i5({position:"absolute",width:a||"auto",height:i||"auto"},this.getDefaultPosition(o)),o);return r.createElement("div",{className:"recharts-legend-wrapper",style:c,ref:function(t){e.wrapperNode=t}},function(e,t){if(r.isValidElement(e))return r.cloneElement(e,t);if(q0()(e))return r.createElement(e,t);t.ref;var n=d5(t,r5);return r.createElement(t5,n)}(n,i5(i5({},this.props),{},{payload:v5(s,u)})))}}])&&o5(t.prototype,n),a&&o5(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function m5(){}function y5(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function b5(e){this._context=e}function x5(e){this._context=e}function k5(e){this._context=e}function w5(e){this._context=e}function I5(e){this._context=e}function C5(e){return new I5(e)}function A5(e){return e<0?-1:1}function S5(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),s=(i*a+o*r)/(r+a);return(A5(i)+A5(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function _5(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function E5(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,s=(i-r)/3;e._context.bezierCurveTo(r+s,a+s*t,i-s,o-s*n,i,o)}function T5(e){this._context=e}function N5(e){this._context=new O5(e)}function O5(e){this._context=e}function R5(e){this._context=e}function P5(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function D5(e,t){this._context=e,this._t=t}f5(g5,"displayName","Legend"),f5(g5,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"}),b5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:y5(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:y5(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},x5.prototype={areaStart:m5,areaEnd:m5,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:y5(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},k5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:y5(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},w5.prototype={areaStart:m5,areaEnd:m5,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},I5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},T5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:E5(this,this._t0,_5(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,E5(this,_5(this,n=S5(this,e,t)),n);break;default:E5(this,this._t0,n=S5(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(N5.prototype=Object.create(T5.prototype)).point=function(e,t){T5.prototype.point.call(this,t,e)},O5.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},R5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=P5(e),a=P5(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},D5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};Array.prototype.slice;function M5(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function F5(e){return e[0]}function L5(e){return e[1]}function j5(e,t){var n=A4(!0),r=null,a=C5,i=null,o=P4(s);function s(s){var u,c,l,f=(s=M5(s)).length,h=!1;for(null==r&&(i=a(l=o())),u=0;u<=f;++u)!(u<f&&n(c=s[u],u,s))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(c,u,s),+t(c,u,s));if(l)return i=null,l+""||null}return e="function"===typeof e?e:void 0===e?F5:A4(e),t="function"===typeof t?t:void 0===t?L5:A4(t),s.x=function(t){return arguments.length?(e="function"===typeof t?t:A4(+t),s):e},s.y=function(e){return arguments.length?(t="function"===typeof e?e:A4(+e),s):t},s.defined=function(e){return arguments.length?(n="function"===typeof e?e:A4(!!e),s):n},s.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),s):a},s.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),s):r},s}function z5(e,t,n){var r=null,a=A4(!0),i=null,o=C5,s=null,u=P4(c);function c(c){var l,f,h,d,p,v=(c=M5(c)).length,g=!1,m=new Array(v),y=new Array(v);for(null==i&&(s=o(p=u())),l=0;l<=v;++l){if(!(l<v&&a(d=c[l],l,c))===g)if(g=!g)f=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=l-1;h>=f;--h)s.point(m[h],y[h]);s.lineEnd(),s.areaEnd()}g&&(m[l]=+e(d,l,c),y[l]=+t(d,l,c),s.point(r?+r(d,l,c):m[l],n?+n(d,l,c):y[l]))}if(p)return s=null,p+""||null}function l(){return j5().defined(a).curve(o).context(i)}return e="function"===typeof e?e:void 0===e?F5:A4(+e),t="function"===typeof t?t:A4(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?L5:A4(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:A4(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:A4(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:A4(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:A4(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:A4(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:A4(+e),c):n},c.lineX0=c.lineY0=function(){return l().x(e).y(t)},c.lineY1=function(){return l().x(e).y(n)},c.lineX1=function(){return l().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"===typeof e?e:A4(!!e),c):a},c.curve=function(e){return arguments.length?(o=e,null!=i&&(s=o(i)),c):o},c.context=function(e){return arguments.length?(null==e?i=s=null:s=o(i=e),c):i},c}function U5(e){return U5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U5(e)}function B5(){return B5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B5.apply(this,arguments)}function W5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V5(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W5(Object(n),!0).forEach((function(t){X5(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W5(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y5(r.key),r)}}function H5(e,t){return H5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H5(e,t)}function K5(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=q5(e);if(t){var a=q5(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===U5(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function q5(e){return q5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},q5(e)}function X5(e,t,n){return(t=Y5(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y5(e){var t=function(e,t){if("object"!==U5(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==U5(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===U5(t)?t:String(t)}var Z5={curveBasisClosed:function(e){return new x5(e)},curveBasisOpen:function(e){return new k5(e)},curveBasis:function(e){return new b5(e)},curveLinearClosed:function(e){return new w5(e)},curveLinear:C5,curveMonotoneX:function(e){return new T5(e)},curveMonotoneY:function(e){return new N5(e)},curveNatural:function(e){return new R5(e)},curveStep:function(e){return new D5(e,.5)},curveStepAfter:function(e){return new D5(e,1)},curveStepBefore:function(e){return new D5(e,0)}},Q5=function(e){return e.x===+e.x&&e.y===+e.y},J5=function(e){return e.x},$5=function(e){return e.y},e6=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H5(e,t)}(o,e);var t,n,a,i=K5(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,n=[{key:"getPath",value:function(){var e,t=this.props,n=t.type,r=t.points,a=t.baseLine,i=t.layout,o=t.connectNulls,s=function(e,t){if(q0()(e))return e;var n="curve".concat(W3()(e));return"curveMonotone"===n&&t?Z5["".concat(n).concat("vertical"===t?"Y":"X")]:Z5[n]||C5}(n,i),u=o?r.filter((function(e){return Q5(e)})):r;if(b0()(a)){var c=o?a.filter((function(e){return Q5(e)})):a,l=u.map((function(e,t){return V5(V5({},e),{},{base:c[t]})}));return e="vertical"===i?z5().y($5).x1(J5).x0((function(e){return e.base.x})):z5().x(J5).y1($5).y0((function(e){return e.base.y})),e.defined(Q5).curve(s),e(l)}return(e="vertical"===i&&E0(a)?z5().y($5).x1(J5).x0(a):E0(a)?z5().x(J5).y1($5).y0(a):j5().x(J5).y($5)).defined(Q5).curve(s),e(u)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.points,a=e.path,i=e.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?this.getPath():a;return r.createElement("path",B5({},E1(this.props),d1(this.props),{className:c$()("recharts-curve",t),d:o,ref:i}))}}],n&&G5(t.prototype,n),a&&G5(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function t6(e){return t6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t6(e)}function n6(){return n6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n6.apply(this,arguments)}function r6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s6(r.key),r)}}function a6(e,t){return a6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a6(e,t)}function i6(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=o6(e);if(t){var a=o6(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===t6(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function o6(e){return o6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},o6(e)}function s6(e){var t=function(e,t){if("object"!==t6(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==t6(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===t6(t)?t:String(t)}X5(e6,"defaultProps",{type:"linear",points:[],connectNulls:!1});var u6=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a6(e,t)}(o,e);var t,n,a,i=i6(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,n=[{key:"render",value:function(){var e=this.props,t=e.x,n=e.y,a=e.width,i=e.height,s=e.top,u=e.left,c=e.className;return E0(t)&&E0(n)&&E0(a)&&E0(i)&&E0(s)&&E0(u)?r.createElement("path",n6({},E1(this.props,!0),{className:c$()("recharts-cross",c),d:o.getPath(t,n,a,i,s,u)})):null}}],a=[{key:"getPath",value:function(e,t,n,r,a,i){return"M".concat(e,",").concat(a,"v").concat(r,"M").concat(i,",").concat(t,"h").concat(n)}}],n&&r6(t.prototype,n),a&&r6(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function c6(e){return c6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c6(e)}function l6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f6(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l6(Object(n),!0).forEach((function(t){h6(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l6(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h6(e,t,n){return t=function(e){var t=function(e,t){if("object"!==c6(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c6(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c6(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){(t=s6(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(u6,"defaultProps",{x:0,y:0,top:0,left:0,width:0,height:0});var d6=Math.PI/180,p6=function(e){return 180*e/Math.PI},v6=function(e,t,n,r){return{x:e+Math.cos(-d6*r)*n,y:t+Math.sin(-d6*r)*n}},g6=function(e,t){var n=e.x,r=e.y,a=t.cx,i=t.cy,o=function(e,t){var n=e.x,r=e.y,a=t.x,i=t.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-i,2))}({x:n,y:r},{x:a,y:i});if(o<=0)return{radius:o};var s=(n-a)/o,u=Math.acos(s);return r>i&&(u=2*Math.PI-u),{radius:o,angle:p6(u),angleInRadian:u}},m6=function(e,t){var n=t.startAngle,r=t.endAngle,a=Math.floor(n/360),i=Math.floor(r/360);return e+360*Math.min(a,i)},y6=function(e,t){var n=e.x,r=e.y,a=g6({x:n,y:r},t),i=a.radius,o=a.angle,s=t.innerRadius,u=t.outerRadius;if(i<s||i>u)return!1;if(0===i)return!0;var c,l=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),a=Math.floor(n/360),i=Math.min(r,a);return{startAngle:t-360*i,endAngle:n-360*i}}(t),f=l.startAngle,h=l.endAngle,d=o;if(f<=h){for(;d>h;)d-=360;for(;d<f;)d+=360;c=d>=f&&d<=h}else{for(;d>f;)d-=360;for(;d<h;)d+=360;c=d>=h&&d<=f}return c?f6(f6({},t),{},{radius:i,angle:m6(d,t)}):null};function b6(e){return b6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b6(e)}function x6(){return x6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x6.apply(this,arguments)}function k6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,A6(r.key),r)}}function w6(e,t){return w6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w6(e,t)}function I6(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C6(e);if(t){var a=C6(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===b6(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function C6(e){return C6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C6(e)}function A6(e){var t=function(e,t){if("object"!==b6(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==b6(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===b6(t)?t:String(t)}var S6=function(e){var t=e.cx,n=e.cy,r=e.radius,a=e.angle,i=e.sign,o=e.isExternal,s=e.cornerRadius,u=e.cornerIsExternal,c=s*(o?1:-1)+r,l=Math.asin(s/c)/d6,f=u?a:a+i*l,h=u?a-i*l:a;return{center:v6(t,n,c,f),circleTangency:v6(t,n,r,f),lineTangency:v6(t,n,c*Math.cos(l*d6),h),theta:l}},_6=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,i=e.startAngle,o=function(e,t){return S0(t-e)*Math.min(Math.abs(t-e),359.999)}(i,e.endAngle),s=i+o,u=v6(t,n,a,i),c=v6(t,n,a,s),l="M ".concat(u.x,",").concat(u.y,"\n    A ").concat(a,",").concat(a,",0,\n    ").concat(+(Math.abs(o)>180),",").concat(+(i>s),",\n    ").concat(c.x,",").concat(c.y,"\n  ");if(r>0){var f=v6(t,n,r,i),h=v6(t,n,r,s);l+="L ".concat(h.x,",").concat(h.y,"\n            A ").concat(r,",").concat(r,",0,\n            ").concat(+(Math.abs(o)>180),",").concat(+(i<=s),",\n            ").concat(f.x,",").concat(f.y," Z")}else l+="L ".concat(t,",").concat(n," Z");return l},E6=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w6(e,t)}(o,e);var t,n,a,i=I6(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,n=[{key:"render",value:function(){var e=this.props,t=e.cx,n=e.cy,a=e.innerRadius,i=e.outerRadius,o=e.cornerRadius,s=e.forceCornerRadius,u=e.cornerIsExternal,c=e.startAngle,l=e.endAngle,f=e.className;if(i<a||c===l)return null;var h,d=c$()("recharts-sector",f),p=i-a,v=R0(o,p,0,!0);return h=v>0&&Math.abs(c-l)<360?function(e){var t=e.cx,n=e.cy,r=e.innerRadius,a=e.outerRadius,i=e.cornerRadius,o=e.forceCornerRadius,s=e.cornerIsExternal,u=e.startAngle,c=e.endAngle,l=S0(c-u),f=S6({cx:t,cy:n,radius:a,angle:u,sign:l,cornerRadius:i,cornerIsExternal:s}),h=f.circleTangency,d=f.lineTangency,p=f.theta,v=S6({cx:t,cy:n,radius:a,angle:c,sign:-l,cornerRadius:i,cornerIsExternal:s}),g=v.circleTangency,m=v.lineTangency,y=v.theta,b=s?Math.abs(u-c):Math.abs(u-c)-p-y;if(b<0)return o?"M ".concat(d.x,",").concat(d.y,"\n        a").concat(i,",").concat(i,",0,0,1,").concat(2*i,",0\n        a").concat(i,",").concat(i,",0,0,1,").concat(2*-i,",0\n      "):_6({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:u,endAngle:c});var x="M ".concat(d.x,",").concat(d.y,"\n    A").concat(i,",").concat(i,",0,0,").concat(+(l<0),",").concat(h.x,",").concat(h.y,"\n    A").concat(a,",").concat(a,",0,").concat(+(b>180),",").concat(+(l<0),",").concat(g.x,",").concat(g.y,"\n    A").concat(i,",").concat(i,",0,0,").concat(+(l<0),",").concat(m.x,",").concat(m.y,"\n  ");if(r>0){var k=S6({cx:t,cy:n,radius:r,angle:u,sign:l,isExternal:!0,cornerRadius:i,cornerIsExternal:s}),w=k.circleTangency,I=k.lineTangency,C=k.theta,A=S6({cx:t,cy:n,radius:r,angle:c,sign:-l,isExternal:!0,cornerRadius:i,cornerIsExternal:s}),S=A.circleTangency,_=A.lineTangency,E=A.theta,T=s?Math.abs(u-c):Math.abs(u-c)-C-E;if(T<0&&0===i)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(_.x,",").concat(_.y,"\n      A").concat(i,",").concat(i,",0,0,").concat(+(l<0),",").concat(S.x,",").concat(S.y,"\n      A").concat(r,",").concat(r,",0,").concat(+(T>180),",").concat(+(l>0),",").concat(w.x,",").concat(w.y,"\n      A").concat(i,",").concat(i,",0,0,").concat(+(l<0),",").concat(I.x,",").concat(I.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x}({cx:t,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(v,p/2),forceCornerRadius:s,cornerIsExternal:u,startAngle:c,endAngle:l}):_6({cx:t,cy:n,innerRadius:a,outerRadius:i,startAngle:c,endAngle:l}),r.createElement("path",x6({},E1(this.props,!0),{className:d,d:h,role:"img"}))}}],n&&k6(t.prototype,n),a&&k6(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function T6(e){return T6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T6(e)}function N6(){return N6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N6.apply(this,arguments)}function O6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,R6(r.key),r)}}function R6(e){var t=function(e,t){if("object"!==T6(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==T6(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===T6(t)?t:String(t)}function P6(e,t){return P6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P6(e,t)}function D6(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=M6(e);if(t){var a=M6(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===T6(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function M6(e){return M6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M6(e)}!function(e,t,n){(t=A6(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(E6,"defaultProps",{cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1});var F6=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P6(e,t)}(o,e);var t,n,a,i=D6(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,n=[{key:"render",value:function(){var e=this.props,t=e.cx,n=e.cy,a=e.r,i=e.className,o=c$()("recharts-dot",i);return t===+t&&n===+n&&a===+a?r.createElement("circle",N6({},E1(this.props),d1(this.props),{className:o,cx:t,cy:n,r:a})):null}}],n&&O6(t.prototype,n),a&&O6(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function L6(e){return L6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L6(e)}function j6(){return j6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j6.apply(this,arguments)}function z6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,H6(r.key),r)}}function U6(e,t){return U6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U6(e,t)}function B6(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=V6(e);if(t){var a=V6(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===L6(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return W6(e)}(this,n)}}function W6(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V6(e){return V6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},V6(e)}function G6(e,t,n){return(t=H6(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H6(e){var t=function(e,t){if("object"!==L6(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==L6(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===L6(t)?t:String(t)}var K6=function(e,t,n,r,a){var i,o=Math.min(Math.abs(n)/2,Math.abs(r)/2),s=r>=0?1:-1,u=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0;if(o>0&&a instanceof Array){for(var l=[0,0,0,0],f=0;f<4;f++)l[f]=a[f]>o?o:a[f];i="M".concat(e,",").concat(t+s*l[0]),l[0]>0&&(i+="A ".concat(l[0],",").concat(l[0],",0,0,").concat(c,",").concat(e+u*l[0],",").concat(t)),i+="L ".concat(e+n-u*l[1],",").concat(t),l[1]>0&&(i+="A ".concat(l[1],",").concat(l[1],",0,0,").concat(c,",\n        ").concat(e+n,",").concat(t+s*l[1])),i+="L ".concat(e+n,",").concat(t+r-s*l[2]),l[2]>0&&(i+="A ".concat(l[2],",").concat(l[2],",0,0,").concat(c,",\n        ").concat(e+n-u*l[2],",").concat(t+r)),i+="L ".concat(e+u*l[3],",").concat(t+r),l[3]>0&&(i+="A ".concat(l[3],",").concat(l[3],",0,0,").concat(c,",\n        ").concat(e,",").concat(t+r-s*l[3])),i+="Z"}else if(o>0&&a===+a&&a>0){var h=Math.min(o,a);i="M ".concat(e,",").concat(t+s*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+u*h,",").concat(t,"\n            L ").concat(e+n-u*h,",").concat(t,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n,",").concat(t+s*h,"\n            L ").concat(e+n,",").concat(t+r-s*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+n-u*h,",").concat(t+r,"\n            L ").concat(e+u*h,",").concat(t+r,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+r-s*h," Z")}else i="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return i},q6=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,a=t.x,i=t.y,o=t.width,s=t.height;if(Math.abs(o)>0&&Math.abs(s)>0){var u=Math.min(a,a+o),c=Math.max(a,a+o),l=Math.min(i,i+s),f=Math.max(i,i+s);return n>=u&&n<=c&&r>=l&&r<=f}return!1},X6=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U6(e,t)}(o,e);var t,n,a,i=B6(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return G6(W6(e=i.call.apply(i,[this].concat(n))),"state",{totalLength:-1}),e}return t=o,n=[{key:"componentDidMount",value:function(){if(this.node&&this.node.getTotalLength)try{var e=this.node.getTotalLength();e&&this.setState({totalLength:e})}catch(Wse){}}},{key:"render",value:function(){var e=this,t=this.props,n=t.x,a=t.y,i=t.width,o=t.height,s=t.radius,u=t.className,c=this.state.totalLength,l=this.props,f=l.animationEasing,h=l.animationDuration,d=l.animationBegin,p=l.isAnimationActive,v=l.isUpdateAnimationActive;if(n!==+n||a!==+a||i!==+i||o!==+o||0===i||0===o)return null;var g=c$()("recharts-rectangle",u);return v?r.createElement(d3,{canBegin:c>0,from:{width:i,height:o,x:n,y:a},to:{width:i,height:o,x:n,y:a},duration:h,animationEasing:f,isActive:v},(function(t){var n=t.width,a=t.height,i=t.x,o=t.y;return r.createElement(d3,{canBegin:c>0,from:"0px ".concat(-1===c?1:c,"px"),to:"".concat(c,"px 0px"),attributeName:"strokeDasharray",begin:d,duration:h,isActive:p,easing:f},r.createElement("path",j6({},E1(e.props,!0),{className:g,d:K6(i,o,n,a,s),ref:function(t){e.node=t}})))})):r.createElement("path",j6({},E1(this.props,!0),{className:g,d:K6(n,a,i,o,s)}))}}],n&&z6(t.prototype,n),a&&z6(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function Y6(e){return Y6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y6(e)}function Z6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q6(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z6(Object(n),!0).forEach((function(t){J6(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z6(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J6(e,t,n){return t=function(e){var t=function(e,t){if("object"!==Y6(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Y6(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Y6(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $6(e){return function(e){if(Array.isArray(e))return e8(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return e8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e8(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e8(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}G6(X6,"defaultProps",{x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"});var t8={widthCache:{},cacheCount:0},n8=2e3,r8={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},a8=["minWidth","maxWidth","width","minHeight","maxHeight","height","top","left","fontSize","lineHeight","padding","margin","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom"],i8="recharts_measurement_span";var o8=function(e){return Object.keys(e).reduce((function(t,n){return"".concat(t).concat((r=n,r.split("").reduce((function(e,t){return t===t.toUpperCase()?[].concat($6(e),["-",t.toLowerCase()]):[].concat($6(e),[t])}),[]).join("")),":").concat(function(e,t){return a8.indexOf(e)>=0&&t===+t?"".concat(t,"px"):t}(n,e[n]),";");var r}),"")},s8=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e||_3.isSsr)return{width:0,height:0};var n="".concat(e),r=o8(t),a="".concat(n,"-").concat(r);if(t8.widthCache[a])return t8.widthCache[a];try{var i=document.getElementById(i8);i||((i=document.createElement("span")).setAttribute("id",i8),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=Q6(Q6({},r8),t);Object.keys(o).map((function(e){return i.style[e]=o[e],e})),i.textContent=n;var s=i.getBoundingClientRect(),u={width:s.width,height:s.height};return t8.widthCache[a]=u,++t8.cacheCount>n8&&(t8.cacheCount=0,t8.widthCache={}),u}catch(c){return{width:0,height:0}}},u8=n(2692),c8=n.n(u8),l8=["dx","dy","textAnchor","verticalAnchor","scaleToFit","angle","lineHeight","capHeight","className","breakAll"];function f8(e){return f8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f8(e)}function h8(){return h8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h8.apply(this,arguments)}function d8(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function p8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C8(r.key),r)}}function v8(e,t){return v8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v8(e,t)}function g8(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y8(e);if(t){var a=y8(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===f8(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m8(e)}(this,n)}}function m8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y8(e){return y8=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y8(e)}function b8(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(Wse){c=!0,a=Wse}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return x8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x8(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x8(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w8(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k8(Object(n),!0).forEach((function(t){I8(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k8(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I8(e,t,n){return(t=C8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C8(e){var t=function(e,t){if("object"!==f8(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f8(t)?t:String(t)}var A8=/[ \f\n\r\t\v\u2028\u2029]+/,S8=function(e){try{var t=[];return t1()(e.children)||(t=e.breakAll?e.children.toString().split(""):e.children.toString().split(A8)),{wordsWithComputedWidth:t.map((function(t){return{word:t,width:s8(t,e.style).width}})),spaceWidth:e.breakAll?0:s8("\xa0",e.style).width}}catch(n){return null}},_8=function(e){return[{words:t1()(e)?[]:e.toString().split(A8)}]},E8=function(e,t){if((e.width||e.scaleToFit)&&!_3.isSsr&&t){var n=S8(e);return n?function(e,t,n,r,a){var i=E0(e.maxLines),o=e.children,s=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,t){var i=t.word,o=t.width,s=e[e.length-1];if(s&&(null==r||a||s.width+o+n<r))s.words.push(i),s.width+=o+n;else{var u={words:[i],width:o};e.push(u)}return e}),[])},u=s(t);if(!i)return u;for(var c,l=function(t){var n=o.slice(0,t),a=S8(w8(w8({},e),{},{children:n+"\u2026"})).wordsWithComputedWidth,i=s(a),u=i.length>e.maxLines||function(e){return e.reduce((function(e,t){return e.width>t.width?e:t}))}(i).width>r;return[u,i]},f=0,h=o.length-1,d=0;f<=h&&d<=o.length-1;){var p=Math.floor((f+h)/2),v=b8(l(p-1),2),g=v[0],m=v[1],y=b8(l(p),1)[0];if(g||y||(f=p+1),g&&y&&(h=p-1),!g&&y){c=m;break}d++}return c||u}(e,n.wordsWithComputedWidth,n.spaceWidth,e.width,e.scaleToFit):_8(e.children)}return _8(e.children)},T8=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v8(e,t)}(o,e);var t,n,a,i=g8(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return I8(m8(e=i.call.apply(i,[this].concat(n))),"state",{}),e}return t=o,n=[{key:"render",value:function(){var e=this.props,t=e.dx,n=e.dy,a=e.textAnchor,i=e.verticalAnchor,s=e.scaleToFit,u=e.angle,c=e.lineHeight,l=e.capHeight,f=e.className,h=e.breakAll,d=d8(e,l8),p=this.state.wordsByLines;if(!T0(d.x)||!T0(d.y))return null;var v,g=d.x+(E0(t)?t:0),m=d.y+(E0(n)?n:0);switch(i){case"start":v=c8()("calc(".concat(l,")"));break;case"middle":v=c8()("calc(".concat((p.length-1)/2," * -").concat(c," + (").concat(l," / 2))"));break;default:v=c8()("calc(".concat(p.length-1," * -").concat(c,")"))}var y=[];if(s){var b=p[0].width,x=this.props.width;y.push("scale(".concat((E0(x)?x/b:1)/b,")"))}return u&&y.push("rotate(".concat(u,", ").concat(g,", ").concat(m,")")),y.length&&(d.transform=y.join(" ")),r.createElement("text",h8({},E1(d,!0),{x:g,y:m,className:c$()("recharts-text",f),textAnchor:a,fill:d.fill.includes("url")?o.defaultProps.fill:d.fill}),p.map((function(e,t){return r.createElement("tspan",{x:g,dy:0===t?v:c,key:t},e.words.join(h?"":" "))})))}}],a=[{key:"getDerivedStateFromProps",value:function(e,t){if(e.width!==t.prevWidth||e.scaleToFit!==t.prevScaleToFit||e.children!==t.prevChildren||e.style!==t.prevStyle||e.breakAll!==t.prevBreakAll){var n=e.children!==t.prevChildren||e.style!==t.prevStyle||e.breakAll!==t.prevBreakAll;return{prevWidth:e.width,prevScaleToFit:e.scaleToFit,prevChildren:e.children,prevStyle:e.style,wordsByLines:E8(e,n)}}return null}}],n&&p8(t.prototype,n),a&&p8(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.Component);function N8(e){return N8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N8(e)}function O8(e){return function(e){if(Array.isArray(e))return R8(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return R8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R8(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R8(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D8(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P8(Object(n),!0).forEach((function(t){M8(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P8(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M8(e,t,n){return t=function(e){var t=function(e,t){if("object"!==N8(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==N8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===N8(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F8(){return F8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},F8.apply(this,arguments)}I8(T8,"defaultProps",{x:0,y:0,lineHeight:"1em",capHeight:"0.71em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",fill:"#808080"});var L8=function(e){var t=e.value,n=e.formatter,r=t1()(e.children)?t:e.children;return q0()(n)?n(r):r},j8=function(e,t,n){var a,i,o=e.position,s=e.viewBox,u=e.offset,c=e.className,l=s,f=l.cx,h=l.cy,d=l.innerRadius,p=l.outerRadius,v=l.startAngle,g=l.endAngle,m=l.clockWise,y=(d+p)/2,b=function(e,t){return S0(t-e)*Math.min(Math.abs(t-e),360)}(v,g),x=b>=0?1:-1;"insideStart"===o?(a=v+x*u,i=m):"insideEnd"===o?(a=g-x*u,i=!m):"end"===o&&(a=g+x*u,i=m),i=b<=0?i:!i;var k=v6(f,h,y,a),w=v6(f,h,y,a+359*(i?1:-1)),I="M".concat(k.x,",").concat(k.y,"\n    A").concat(y,",").concat(y,",0,1,").concat(i?0:1,",\n    ").concat(w.x,",").concat(w.y),C=t1()(e.id)?O0("recharts-radial-line-"):e.id;return r.createElement("text",F8({},n,{dominantBaseline:"central",className:c$()("recharts-radial-bar-label",c)}),r.createElement("defs",null,r.createElement("path",{id:C,d:I})),r.createElement("textPath",{xlinkHref:"#".concat(C)},t))},z8=function(e){var t=e.viewBox,n=e.offset,r=e.position,a=t,i=a.cx,o=a.cy,s=a.innerRadius,u=a.outerRadius,c=(a.startAngle+a.endAngle)/2;if("outside"===r){var l=v6(i,o,u+n,c),f=l.x;return{x:f,y:l.y,textAnchor:f>=i?"start":"end",verticalAnchor:"middle"}}if("center"===r)return{x:i,y:o,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===r)return{x:i,y:o,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===r)return{x:i,y:o,textAnchor:"middle",verticalAnchor:"end"};var h=v6(i,o,(s+u)/2,c);return{x:h.x,y:h.y,textAnchor:"middle",verticalAnchor:"middle"}},U8=function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,a=e.position,i=t,o=i.x,s=i.y,u=i.width,c=i.height,l=c>=0?1:-1,f=l*r,h=l>0?"end":"start",d=l>0?"start":"end",p=u>=0?1:-1,v=p*r,g=p>0?"end":"start",m=p>0?"start":"end";if("top"===a)return D8(D8({},{x:o+u/2,y:s-l*r,textAnchor:"middle",verticalAnchor:h}),n?{height:Math.max(s-n.y,0),width:u}:{});if("bottom"===a)return D8(D8({},{x:o+u/2,y:s+c+f,textAnchor:"middle",verticalAnchor:d}),n?{height:Math.max(n.y+n.height-(s+c),0),width:u}:{});if("left"===a){var y={x:o-v,y:s+c/2,textAnchor:g,verticalAnchor:"middle"};return D8(D8({},y),n?{width:Math.max(y.x-n.x,0),height:c}:{})}if("right"===a){var b={x:o+u+v,y:s+c/2,textAnchor:m,verticalAnchor:"middle"};return D8(D8({},b),n?{width:Math.max(n.x+n.width-b.x,0),height:c}:{})}var x=n?{width:u,height:c}:{};return"insideLeft"===a?D8({x:o+v,y:s+c/2,textAnchor:m,verticalAnchor:"middle"},x):"insideRight"===a?D8({x:o+u-v,y:s+c/2,textAnchor:g,verticalAnchor:"middle"},x):"insideTop"===a?D8({x:o+u/2,y:s+f,textAnchor:"middle",verticalAnchor:d},x):"insideBottom"===a?D8({x:o+u/2,y:s+c-f,textAnchor:"middle",verticalAnchor:h},x):"insideTopLeft"===a?D8({x:o+v,y:s+f,textAnchor:m,verticalAnchor:d},x):"insideTopRight"===a?D8({x:o+u-v,y:s+f,textAnchor:g,verticalAnchor:d},x):"insideBottomLeft"===a?D8({x:o+v,y:s+c-f,textAnchor:m,verticalAnchor:h},x):"insideBottomRight"===a?D8({x:o+u-v,y:s+c-f,textAnchor:g,verticalAnchor:h},x):i1()(a)&&(E0(a.x)||_0(a.x))&&(E0(a.y)||_0(a.y))?D8({x:o+R0(a.x,u),y:s+R0(a.y,c),textAnchor:"end",verticalAnchor:"end"},x):D8({x:o+u/2,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},x)},B8=function(e){return"cx"in e&&E0(e.cx)};function W8(e){var t,n=e.viewBox,a=e.position,i=e.value,o=e.children,s=e.content,u=e.className,c=void 0===u?"":u,l=e.textBreakAll;if(!n||t1()(i)&&t1()(o)&&!(0,r.isValidElement)(s)&&!q0()(s))return null;if((0,r.isValidElement)(s))return(0,r.cloneElement)(s,e);if(q0()(s)){if(t=(0,r.createElement)(s,e),(0,r.isValidElement)(t))return t}else t=L8(e);var f=B8(n),h=E1(e,!0);if(f&&("insideStart"===a||"insideEnd"===a||"end"===a))return j8(e,t,h);var d=f?z8(e):U8(e);return r.createElement(T8,F8({className:c$()("recharts-label",c)},h,d,{breakAll:l}),t)}W8.displayName="Label",W8.defaultProps={offset:5};var V8=function(e){var t=e.cx,n=e.cy,r=e.angle,a=e.startAngle,i=e.endAngle,o=e.r,s=e.radius,u=e.innerRadius,c=e.outerRadius,l=e.x,f=e.y,h=e.top,d=e.left,p=e.width,v=e.height,g=e.clockWise,m=e.labelViewBox;if(m)return m;if(E0(p)&&E0(v)){if(E0(l)&&E0(f))return{x:l,y:f,width:p,height:v};if(E0(h)&&E0(d))return{x:h,y:d,width:p,height:v}}return E0(l)&&E0(f)?{x:l,y:f,width:0,height:0}:E0(t)&&E0(n)?{cx:t,cy:n,startAngle:a||r||0,endAngle:i||r||0,innerRadius:u||0,outerRadius:c||s||o||0,clockWise:g}:e.viewBox?e.viewBox:{}},G8=function(e,t){return e?!0===e?r.createElement(W8,{key:"label-implicit",viewBox:t}):T0(e)?r.createElement(W8,{key:"label-implicit",viewBox:t,value:e}):(0,r.isValidElement)(e)?e.type===W8?(0,r.cloneElement)(e,{key:"label-implicit",viewBox:t}):r.createElement(W8,{key:"label-implicit",content:e,viewBox:t}):q0()(e)?r.createElement(W8,{key:"label-implicit",content:e,viewBox:t}):i1()(e)?r.createElement(W8,F8({viewBox:t},e,{key:"label-implicit"})):null:null};W8.parseViewBox=V8,W8.renderCallByParent=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.children&&n&&!e.label)return null;var a=e.children,i=V8(e),o=I1(a,W8).map((function(e,n){return(0,r.cloneElement)(e,{viewBox:t||i,key:"label-".concat(n)})}));return n?[G8(e.label,t||i)].concat(O8(o)):o};var H8=["viewBox"],K8=["viewBox"],q8=["ticks"];function X8(e){return X8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X8(e)}function Y8(){return Y8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Y8.apply(this,arguments)}function Z8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q8(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z8(Object(n),!0).forEach((function(t){r9(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z8(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J8(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function $8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a9(r.key),r)}}function e9(e,t){return e9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e9(e,t)}function t9(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=n9(e);if(t){var a=n9(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===X8(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function n9(e){return n9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n9(e)}function r9(e,t,n){return(t=a9(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a9(e){var t=function(e,t){if("object"!==X8(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==X8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===X8(t)?t:String(t)}var i9=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e9(e,t)}(o,e);var t,n,a,i=t9(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).state={fontSize:"",letterSpacing:""},t}return t=o,n=[{key:"shouldComponentUpdate",value:function(e,t){var n=e.viewBox,r=J8(e,H8),a=this.props,i=a.viewBox,o=J8(a,K8);return!s1(n,i)||!s1(r,o)||!s1(t,this.state)}},{key:"componentDidMount",value:function(){var e=this.layerReference;if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];t&&this.setState({fontSize:window.getComputedStyle(t).fontSize,letterSpacing:window.getComputedStyle(t).letterSpacing})}}},{key:"getTickLineCoord",value:function(e){var t,n,r,a,i,o,s=this.props,u=s.x,c=s.y,l=s.width,f=s.height,h=s.orientation,d=s.tickSize,p=s.mirror,v=s.tickMargin,g=p?-1:1,m=e.tickSize||d,y=E0(e.tickCoord)?e.tickCoord:e.coordinate;switch(h){case"top":t=n=e.coordinate,o=(r=(a=c+ +!p*f)-g*m)-g*v,i=y;break;case"left":r=a=e.coordinate,i=(t=(n=u+ +!p*l)-g*m)-g*v,o=y;break;case"right":r=a=e.coordinate,i=(t=(n=u+ +p*l)+g*m)+g*v,o=y;break;default:t=n=e.coordinate,o=(r=(a=c+ +p*f)+g*m)+g*v,i=y}return{line:{x1:t,y1:r,x2:n,y2:a},tick:{x:i,y:o}}}},{key:"getTickTextAnchor",value:function(){var e,t=this.props,n=t.orientation,r=t.mirror;switch(n){case"left":e=r?"start":"end";break;case"right":e=r?"end":"start";break;default:e="middle"}return e}},{key:"getTickVerticalAnchor",value:function(){var e=this.props,t=e.orientation,n=e.mirror,r="end";switch(t){case"left":case"right":r="middle";break;case"top":r=n?"start":"end";break;default:r=n?"end":"start"}return r}},{key:"renderAxisLine",value:function(){var e=this.props,t=e.x,n=e.y,a=e.width,i=e.height,o=e.orientation,s=e.mirror,u=e.axisLine,c=Q8(Q8(Q8({},E1(this.props)),E1(u)),{},{fill:"none"});if("top"===o||"bottom"===o){var l=+("top"===o&&!s||"bottom"===o&&s);c=Q8(Q8({},c),{},{x1:t,y1:n+l*i,x2:t+a,y2:n+l*i})}else{var f=+("left"===o&&!s||"right"===o&&s);c=Q8(Q8({},c),{},{x1:t+f*a,y1:n,x2:t+f*a,y2:n+i})}return r.createElement("line",Y8({},c,{className:c$()("recharts-cartesian-axis-line",m0()(u,"className"))}))}},{key:"renderTicks",value:function(e,t,n){var a=this,i=this.props,s=i.tickLine,u=i.stroke,c=i.tick,l=i.tickFormatter,f=i.unit,h=o.getTicks(Q8(Q8({},this.props),{},{ticks:e}),t,n),d=this.getTickTextAnchor(),p=this.getTickVerticalAnchor(),v=E1(this.props),g=E1(c),m=Q8(Q8({},v),{},{fill:"none"},E1(s)),y=h.map((function(e,t){var n=a.getTickLineCoord(e),i=n.line,y=n.tick,b=Q8(Q8(Q8(Q8({textAnchor:d,verticalAnchor:p},v),{},{stroke:"none",fill:u},g),y),{},{index:t,payload:e,visibleTicksCount:h.length,tickFormatter:l});return r.createElement(U1,Y8({className:"recharts-cartesian-axis-tick",key:"tick-".concat(t)},p1(a.props,e,t)),s&&r.createElement("line",Y8({},m,i,{className:c$()("recharts-cartesian-axis-tick-line",m0()(s,"className"))})),c&&o.renderTickItem(c,b,"".concat(q0()(l)?l(e.value,t):e.value).concat(f||"")))}));return r.createElement("g",{className:"recharts-cartesian-axis-ticks"},y)}},{key:"render",value:function(){var e=this,t=this.props,n=t.axisLine,a=t.width,i=t.height,o=t.ticksGenerator,s=t.className;if(t.hide)return null;var u=this.props,c=u.ticks,l=J8(u,q8),f=c;return q0()(o)&&(f=c&&c.length>0?o(this.props):o(l)),a<=0||i<=0||!f||!f.length?null:r.createElement(U1,{className:c$()("recharts-cartesian-axis",s),ref:function(t){e.layerReference=t}},n&&this.renderAxisLine(),this.renderTicks(f,this.state.fontSize,this.state.letterSpacing),W8.renderCallByParent(this.props))}}],a=[{key:"getTicks",value:function(e,t,n){var r=e.tick,a=e.ticks,i=e.viewBox,s=e.minTickGap,u=e.orientation,c=e.interval,l=e.tickFormatter,f=e.unit;return a&&a.length&&r?E0(c)||_3.isSsr?o.getNumberIntervalTicks(a,"number"===typeof c&&E0(c)?c:0):"preserveStartEnd"===c?o.getTicksStart({ticks:a,tickFormatter:l,viewBox:i,orientation:u,minTickGap:s,unit:f,fontSize:t,letterSpacing:n},!0):"preserveStart"===c?o.getTicksStart({ticks:a,tickFormatter:l,viewBox:i,orientation:u,minTickGap:s,unit:f,fontSize:t,letterSpacing:n}):o.getTicksEnd({ticks:a,tickFormatter:l,viewBox:i,orientation:u,minTickGap:s,unit:f,fontSize:t,letterSpacing:n}):[]}},{key:"getNumberIntervalTicks",value:function(e,t){return e.filter((function(e,n){return n%(t+1)===0}))}},{key:"getTicksStart",value:function(e,t){var n,r,a=e.ticks,i=e.tickFormatter,o=e.viewBox,s=e.orientation,u=e.minTickGap,c=e.unit,l=e.fontSize,f=e.letterSpacing,h=o.x,d=o.y,p=o.width,v=o.height,g="top"===s||"bottom"===s?"width":"height",m=(a||[]).slice(),y=c&&"width"===g?s8(c,{fontSize:l,letterSpacing:f})[g]:0,b=m.length,x=b>=2?S0(m[1].coordinate-m[0].coordinate):1;if(1===x?(n="width"===g?h:d,r="width"===g?h+p:d+v):(n="width"===g?h+p:d+v,r="width"===g?h:d),t){var k=a[b-1],w=q0()(i)?i(k.value,b-1):k.value,I=s8(w,{fontSize:l,letterSpacing:f})[g]+y,C=x*(k.coordinate+x*I/2-r);m[b-1]=k=Q8(Q8({},k),{},{tickCoord:C>0?k.coordinate-C*x:k.coordinate}),x*(k.tickCoord-x*I/2-n)>=0&&x*(k.tickCoord+x*I/2-r)<=0&&(r=k.tickCoord-x*(I/2+u),m[b-1]=Q8(Q8({},k),{},{isShow:!0}))}for(var A=t?b-1:b,S=0;S<A;S++){var _=m[S],E=q0()(i)?i(_.value,S):_.value,T=s8(E,{fontSize:l,letterSpacing:f})[g]+y;if(0===S){var N=x*(_.coordinate-x*T/2-n);m[S]=_=Q8(Q8({},_),{},{tickCoord:N<0?_.coordinate-N*x:_.coordinate})}else m[S]=_=Q8(Q8({},_),{},{tickCoord:_.coordinate});x*(_.tickCoord-x*T/2-n)>=0&&x*(_.tickCoord+x*T/2-r)<=0&&(n=_.tickCoord+x*(T/2+u),m[S]=Q8(Q8({},_),{},{isShow:!0}))}return m.filter((function(e){return e.isShow}))}},{key:"getTicksEnd",value:function(e){var t,n,r=e.ticks,a=e.tickFormatter,i=e.viewBox,o=e.orientation,s=e.minTickGap,u=e.unit,c=e.fontSize,l=e.letterSpacing,f=i.x,h=i.y,d=i.width,p=i.height,v="top"===o||"bottom"===o?"width":"height",g=u&&"width"===v?s8(u,{fontSize:c,letterSpacing:l})[v]:0,m=(r||[]).slice(),y=m.length,b=y>=2?S0(m[1].coordinate-m[0].coordinate):1;1===b?(t="width"===v?f:h,n="width"===v?f+d:h+p):(t="width"===v?f+d:h+p,n="width"===v?f:h);for(var x=y-1;x>=0;x--){var k=m[x],w=q0()(a)?a(k.value,y-x-1):k.value,I=s8(w,{fontSize:c,letterSpacing:l})[v]+g;if(x===y-1){var C=b*(k.coordinate+b*I/2-n);m[x]=k=Q8(Q8({},k),{},{tickCoord:C>0?k.coordinate-C*b:k.coordinate})}else m[x]=k=Q8(Q8({},k),{},{tickCoord:k.coordinate});b*(k.tickCoord-b*I/2-t)>=0&&b*(k.tickCoord+b*I/2-n)<=0&&(n=k.tickCoord-b*(I/2+s),m[x]=Q8(Q8({},k),{},{isShow:!0}))}return m.filter((function(e){return e.isShow}))}},{key:"renderTickItem",value:function(e,t,n){return r.isValidElement(e)?r.cloneElement(e,t):q0()(e)?e(t):r.createElement(T8,Y8({},t,{className:"recharts-cartesian-axis-tick-value"}),n)}}],n&&$8(t.prototype,n),a&&$8(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.Component);function o9(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function s9(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}r9(i9,"displayName","CartesianAxis"),r9(i9,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var u9=function(e){F(n,e);var t=z(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h9;if(G(this,n),r=t.call(this),Object.defineProperties(D(r),{_intern:{value:new Map},_key:{value:a}}),null!=e){var i,o=U(e);try{for(o.s();!(i=o.n()).done;){var s=E(i.value,2),u=s[0],c=s[1];r.set(u,c)}}catch(Wse){o.e(Wse)}finally{o.f()}}return r}return q(n,[{key:"get",value:function(e){return P(R(n.prototype),"get",this).call(this,c9(this,e))}},{key:"has",value:function(e){return P(R(n.prototype),"has",this).call(this,c9(this,e))}},{key:"set",value:function(e,t){return P(R(n.prototype),"set",this).call(this,l9(this,e),t)}},{key:"delete",value:function(e){return P(R(n.prototype),"delete",this).call(this,f9(this,e))}}]),n}(Q(Map));Set;function c9(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):t}function l9(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function f9(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)&&(t=n.get(r),n.delete(r)),t}function h9(e){return null!==e&&"object"===typeof e?e.valueOf():e}var d9=Symbol("implicit");function p9(){var e=new u9,t=[],n=[],r=d9;function a(a){var i=e.get(a);if(void 0===i){if(r!==d9)return r;e.set(a,i=t.push(a)-1)}return n[i%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new u9;var r,i=U(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.has(o)||e.set(o,t.push(o)-1)}}catch(Wse){i.e(Wse)}finally{i.f()}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return p9(t,n).unknown(r)},o9.apply(a,arguments),a}function v9(){var e,t,n=p9().unknown(void 0),r=n.domain,a=n.range,i=0,o=1,s=!1,u=0,c=0,l=.5;function f(){var n=r().length,f=o<i,h=f?o:i,d=f?i:o;e=(d-h)/Math.max(1,n-u+2*c),s&&(e=Math.floor(e)),h+=(d-h-e*(n-u))*l,t=e*(1-u),s&&(h=Math.round(h),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}(n).map((function(t){return h+e*t}));return a(f?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),f()):r()},n.range=function(e){var t;return arguments.length?(t=E(e,2),i=t[0],o=t[1],i=+i,o=+o,f()):[i,o]},n.rangeRound=function(e){var t;return t=E(e,2),i=t[0],o=t[1],i=+i,o=+o,s=!0,f()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,f()):s},n.padding=function(e){return arguments.length?(u=Math.min(1,c=+e),f()):u},n.paddingInner=function(e){return arguments.length?(u=Math.min(1,e),f()):u},n.paddingOuter=function(e){return arguments.length?(c=+e,f()):c},n.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),f()):l},n.copy=function(){return v9(r(),[i,o]).round(s).paddingInner(u).paddingOuter(c).align(l)},o9.apply(f(),arguments)}function g9(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return g9(t())},e}function m9(){return g9(v9.apply(null,arguments).paddingInner(1))}var y9=n(8111),b9=n.n(y9),x9=n(9627),k9=n.n(x9),w9=n(6452),I9=n.n(w9),C9=n(5008),A9=n.n(C9),S9=Math.sqrt(50),_9=Math.sqrt(10),E9=Math.sqrt(2);function T9(e,t,n){var r,a,i,o=(t-e)/Math.max(0,n),s=Math.floor(Math.log10(o)),u=o/Math.pow(10,s),c=u>=S9?10:u>=_9?5:u>=E9?2:1;return s<0?(i=Math.pow(10,-s)/c,(r=Math.round(e*i))/i<e&&++r,(a=Math.round(t*i))/i>t&&--a,i=-i):(i=Math.pow(10,s)*c,(r=Math.round(e/i))*i<e&&++r,(a=Math.round(t/i))*i>t&&--a),a<r&&.5<=n&&n<2?T9(e,t,2*n):[r,a,i]}function N9(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];var r=t<e,a=E(r?T9(t,e,n):T9(e,t,n),3),i=a[0],o=a[1],s=a[2];if(!(o>=i))return[];var u=o-i+1,c=new Array(u);if(r)if(s<0)for(var l=0;l<u;++l)c[l]=(o-l)/-s;else for(var f=0;f<u;++f)c[f]=(o-f)*s;else if(s<0)for(var h=0;h<u;++h)c[h]=(i+h)/-s;else for(var d=0;d<u;++d)c[d]=(i+d)*s;return c}function O9(e,t,n){return T9(e=+e,t=+t,n=+n)[2]}function R9(e,t,n){n=+n;var r=(t=+t)<(e=+e),a=r?O9(t,e,n):O9(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function P9(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function D9(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function M9(e){var t,n,r;function a(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<0?a=o+1:i=o}while(a<i)}return a}return 2!==e.length?(t=P9,n=function(t,n){return P9(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===P9||e===D9?e:F9,n=e,r=e),{left:a,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=a(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return i>n&&r(e[i-1],t)>-r(e[i],t)?i-1:i},right:function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<=0?a=o+1:i=o}while(a<i)}return a}}}function F9(){return 0}var L9=B().mark(z9);function j9(e){return null===e?NaN:+e}function z9(e,t){var n,r,a,i,o,s,u;return B().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(void 0!==t){c.next=21;break}n=U(e),c.prev=2,n.s();case 4:if((r=n.n()).done){c.next=11;break}if(!(null!=(a=r.value)&&(a=+a)>=a)){c.next=9;break}return c.next=9,a;case 9:c.next=4;break;case 11:c.next=16;break;case 13:c.prev=13,c.t0=c.catch(2),n.e(c.t0);case 16:return c.prev=16,n.f(),c.finish(16);case 19:c.next=40;break;case 21:i=-1,o=U(e),c.prev=23,o.s();case 25:if((s=o.n()).done){c.next=32;break}if(u=s.value,!(null!=(u=t(u,++i,e))&&(u=+u)>=u)){c.next=30;break}return c.next=30,u;case 30:c.next=25;break;case 32:c.next=37;break;case 34:c.prev=34,c.t1=c.catch(23),o.e(c.t1);case 37:return c.prev=37,o.f(),c.finish(37);case 40:case"end":return c.stop()}}),L9,null,[[2,13,16,19],[23,34,37,40]])}var U9=M9(P9),B9=U9.right,W9=(U9.left,M9(j9).center,B9);function V9(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function G9(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function H9(){}var K9=.7,q9=1/K9,X9="\\s*([+-]?\\d+)\\s*",Y9="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Z9="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Q9=/^#([0-9a-f]{3,8})$/,J9=new RegExp("^rgb\\(".concat(X9,",").concat(X9,",").concat(X9,"\\)$")),$9=new RegExp("^rgb\\(".concat(Z9,",").concat(Z9,",").concat(Z9,"\\)$")),e7=new RegExp("^rgba\\(".concat(X9,",").concat(X9,",").concat(X9,",").concat(Y9,"\\)$")),t7=new RegExp("^rgba\\(".concat(Z9,",").concat(Z9,",").concat(Z9,",").concat(Y9,"\\)$")),n7=new RegExp("^hsl\\(".concat(Y9,",").concat(Z9,",").concat(Z9,"\\)$")),r7=new RegExp("^hsla\\(".concat(Y9,",").concat(Z9,",").concat(Z9,",").concat(Y9,"\\)$")),a7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function i7(){return this.rgb().formatHex()}function o7(){return this.rgb().formatRgb()}function s7(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Q9.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?u7(t):3===n?new f7(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?c7(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?c7(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=J9.exec(e))?new f7(t[1],t[2],t[3],1):(t=$9.exec(e))?new f7(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=e7.exec(e))?c7(t[1],t[2],t[3],t[4]):(t=t7.exec(e))?c7(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=n7.exec(e))?m7(t[1],t[2]/100,t[3]/100,1):(t=r7.exec(e))?m7(t[1],t[2]/100,t[3]/100,t[4]):a7.hasOwnProperty(e)?u7(a7[e]):"transparent"===e?new f7(NaN,NaN,NaN,0):null}function u7(e){return new f7(e>>16&255,e>>8&255,255&e,1)}function c7(e,t,n,r){return r<=0&&(e=t=n=NaN),new f7(e,t,n,r)}function l7(e,t,n,r){return 1===arguments.length?function(e){return e instanceof H9||(e=s7(e)),e?new f7((e=e.rgb()).r,e.g,e.b,e.opacity):new f7}(e):new f7(e,t,n,null==r?1:r)}function f7(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function h7(){return"#".concat(g7(this.r)).concat(g7(this.g)).concat(g7(this.b))}function d7(){var e=p7(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(v7(this.r),", ").concat(v7(this.g),", ").concat(v7(this.b)).concat(1===e?")":", ".concat(e,")"))}function p7(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function v7(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function g7(e){return((e=v7(e))<16?"0":"")+e.toString(16)}function m7(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new b7(e,t,n,r)}function y7(e){if(e instanceof b7)return new b7(e.h,e.s,e.l,e.opacity);if(e instanceof H9||(e=s7(e)),!e)return new b7;if(e instanceof b7)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,s=i-a,u=(i+a)/2;return s?(o=t===i?(n-r)/s+6*(n<r):n===i?(r-t)/s+2:(t-n)/s+4,s/=u<.5?i+a:2-i-a,o*=60):s=u>0&&u<1?0:o,new b7(o,s,u,e.opacity)}function b7(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function x7(e){return(e=(e||0)%360)<0?e+360:e}function k7(e){return Math.max(0,Math.min(1,e||0))}function w7(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function I7(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}V9(H9,s7,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:i7,formatHex:i7,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return y7(this).formatHsl()},formatRgb:o7,toString:o7}),V9(f7,l7,G9(H9,{brighter:function(e){return e=null==e?q9:Math.pow(q9,e),new f7(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?K9:Math.pow(K9,e),new f7(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new f7(v7(this.r),v7(this.g),v7(this.b),p7(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:h7,formatHex:h7,formatHex8:function(){return"#".concat(g7(this.r)).concat(g7(this.g)).concat(g7(this.b)).concat(g7(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:d7,toString:d7})),V9(b7,(function(e,t,n,r){return 1===arguments.length?y7(e):new b7(e,t,n,null==r?1:r)}),G9(H9,{brighter:function(e){return e=null==e?q9:Math.pow(q9,e),new b7(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?K9:Math.pow(K9,e),new b7(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new f7(w7(e>=240?e-240:e+120,a,r),w7(e,a,r),w7(e<120?e+240:e-120,a,r),this.opacity)},clamp:function(){return new b7(x7(this.h),k7(this.s),k7(this.l),p7(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=p7(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(x7(this.h),", ").concat(100*k7(this.s),"%, ").concat(100*k7(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));var C7=function(e){return function(){return e}};function A7(e,t){return function(n){return e+n*t}}function S7(e){return 1===(e=+e)?_7:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):C7(isNaN(t)?n:t)}}function _7(e,t){var n=t-e;return n?A7(e,n):C7(isNaN(e)?t:e)}var E7=function e(t){var n=S7(t);function r(e,t){var r=n((e=l7(e)).r,(t=l7(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=_7(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function T7(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),s=new Array(a);for(n=0;n<a;++n)r=l7(t[n]),i[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return i=e(i),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=s(e),r+""}}}T7((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,s=r<t-1?e[r+2]:2*i-a;return I7((n-r/t)*t,o,a,i,s)}})),T7((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return I7((n-r/t)*t,a,i,o,s)}}));function N7(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=j7(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function O7(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function R7(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function P7(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=j7(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var D7=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,M7=new RegExp(D7.source,"g");function F7(e,t){var n,r,a,i=D7.lastIndex=M7.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=D7.exec(e))&&(r=M7.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:R7(n,r)})),i=M7.lastIndex;return i<t.length&&(a=t.slice(i),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function L7(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function j7(e,t){var n,r=typeof t;return null==t||"boolean"===r?C7(t):("number"===r?R7:"string"===r?(n=s7(t))?(t=n,E7):F7:t instanceof s7?E7:t instanceof Date?O7:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?L7:Array.isArray(t)?N7:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?P7:R7)(e,t)}function z7(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function U7(e){return+e}var B7=[0,1];function W7(e){return e}function V7(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function G7(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=V7(a,r),i=n(o,i)):(r=V7(r,a),i=n(i,o)),function(e){return i(r(e))}}function H7(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=V7(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=W9(e,t,1,r)-1;return i[n](a[n](t))}}function K7(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function q7(){var e,t,n,r,a,i,o=B7,s=B7,u=j7,c=W7;function l(){var e=Math.min(o.length,s.length);return c!==W7&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?H7:G7,a=i=null,f}function f(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),s,u)))(e(c(t)))}return f.invert=function(n){return c(t((i||(i=r(s,o.map(e),R7)))(n)))},f.domain=function(e){return arguments.length?(o=Array.from(e,U7),l()):o.slice()},f.range=function(e){return arguments.length?(s=Array.from(e),l()):s.slice()},f.rangeRound=function(e){return s=Array.from(e),u=z7,l()},f.clamp=function(e){return arguments.length?(c=!!e||W7,l()):c!==W7},f.interpolate=function(e){return arguments.length?(u=e,l()):u},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,l()}}function X7(){return q7()(W7,W7)}var Y7,Z7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Q7(e){if(!(t=Z7.exec(e)))throw new Error("invalid format: "+e);var t;return new J7({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function J7(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function $7(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function eee(e){return(e=$7(Math.abs(e)))?e[1]:NaN}function tee(e,t){var n=$7(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Q7.prototype=J7.prototype,J7.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var nee={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return tee(100*e,t)},r:tee,s:function(e,t){var n=$7(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(Y7=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+$7(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function ree(e){return e}var aee,iee,oee,see=Array.prototype.map,uee=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function cee(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?ree:(t=see.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,s=t[0],u=0;a>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),i.push(e.substring(a-=s,a+s)),!((u+=s+1)>r));)s=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?ree:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(see.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=Q7(e)).fill,n=e.align,f=e.sign,h=e.symbol,d=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;"n"===y?(v=!0,y="g"):nee[y]||(void 0===g&&(g=12),m=!0,y="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var b="$"===h?a:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===h?i:/[%p]/.test(y)?u:"",k=nee[y],w=/[defgprs%]/.test(y);function I(e){var a,i,u,h=b,I=x;if("c"===y)I=k(e)+I,e="";else{var C=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:k(Math.abs(e),g),m&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),C&&0===+e&&"+"!==f&&(C=!1),h=(C?"("===f?f:c:"-"===f||"("===f?"":f)+h,I=("s"===y?uee[8+Y7/3]:"")+I+(C&&"("===f?")":""),w)for(a=-1,i=e.length;++a<i;)if(48>(u=e.charCodeAt(a))||u>57){I=(46===u?o+e.slice(a+1):e.slice(a))+I,e=e.slice(0,a);break}}v&&!d&&(e=r(e,1/0));var A=h.length+e.length+I.length,S=A<p?new Array(p-A+1).join(t):"";switch(v&&d&&(e=r(S+e,S.length?p-I.length:1/0),S=""),n){case"<":e=h+e+I+S;break;case"=":e=h+S+e+I;break;case"^":e=S.slice(0,A=S.length>>1)+h+e+I+S.slice(A);break;default:e=S+h+e+I}return s(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),I.toString=function(){return e+""},I}return{format:f,formatPrefix:function(e,t){var n=f(((e=Q7(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(eee(t)/3))),a=Math.pow(10,-r),i=uee[8+r/3];return function(e){return n(a*e)+i}}}}function lee(e,t,n,r){var a,i=R9(e,t,n);switch((r=Q7(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(eee(t)/3)))-eee(Math.abs(e)))}(i,o))||(r.precision=a),oee(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,eee(t)-eee(e))+1}(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(e){return Math.max(0,-eee(Math.abs(e)))}(i))||(r.precision=a-2*("%"===r.type))}return iee(r)}function fee(e){var t=e.domain;return e.ticks=function(e){var n=t();return N9(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return lee(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,s=i.length-1,u=i[o],c=i[s],l=10;for(c<u&&(a=u,u=c,c=a,a=o,o=s,s=a);l-- >0;){if((a=O9(u,c,n))===r)return i[o]=u,i[s]=c,t(i);if(a>0)u=Math.floor(u/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;u=Math.ceil(u*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function hee(){var e=X7();return e.copy=function(){return K7(e,hee())},o9.apply(e,arguments),fee(e)}function dee(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,U7),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return dee(e).unknown(t)},e=arguments.length?Array.from(e,U7):[0,1],fee(n)}function pee(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function vee(e){return Math.log(e)}function gee(e){return Math.exp(e)}function mee(e){return-Math.log(-e)}function yee(e){return-Math.exp(-e)}function bee(e){return isFinite(e)?+("1e"+e):e<0?0:e}function xee(e){return function(t,n){return-e(-t,n)}}function kee(e){var t,n,r=e(vee,gee),a=r.domain,i=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(i),n=function(e){return 10===e?bee:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(i),a()[0]<0?(t=xee(t),n=xee(n),e(mee,yee)):e(vee,gee),r}return r.base=function(e){return arguments.length?(i=+e,o()):i},r.domain=function(e){return arguments.length?(a(e),o()):a()},r.ticks=function(e){var r=a(),o=r[0],s=r[r.length-1],u=s<o;if(u){var c=[s,o];o=c[0],s=c[1]}var l,f,h=t(o),d=t(s),p=null==e?10:+e,v=[];if(!(i%1)&&d-h<p){if(h=Math.floor(h),d=Math.ceil(d),o>0){for(;h<=d;++h)for(l=1;l<i;++l)if(!((f=h<0?l/n(-h):l*n(h))<o)){if(f>s)break;v.push(f)}}else for(;h<=d;++h)for(l=i-1;l>=1;--l)if(!((f=h>0?l/n(-h):l*n(h))<o)){if(f>s)break;v.push(f)}2*v.length<p&&(v=N9(o,s,p))}else v=N9(h,d,Math.min(d-h,p)).map(n);return u?v.reverse():v},r.tickFormat=function(e,a){if(null==e&&(e=10),null==a&&(a=10===i?"s":","),"function"!==typeof a&&(i%1||null!=(a=Q7(a)).precision||(a.trim=!0),a=iee(a)),e===1/0)return a;var o=Math.max(1,i*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=o?a(e):""}},r.nice=function(){return a(pee(a(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function wee(){var e=kee(q7()).domain([1,10]);return e.copy=function(){return K7(e,wee()).base(e.base())},o9.apply(e,arguments),e}function Iee(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Cee(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Aee(e){var t=1,n=e(Iee(t),Cee(t));return n.constant=function(n){return arguments.length?e(Iee(t=+n),Cee(t)):t},fee(n)}function See(){var e=Aee(q7());return e.copy=function(){return K7(e,See()).constant(e.constant())},o9.apply(e,arguments)}function _ee(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Eee(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Tee(e){return e<0?-e*e:e*e}function Nee(e){var t=e(W7,W7),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(W7,W7):.5===n?e(Eee,Tee):e(_ee(n),_ee(1/n)):n},fee(t)}function Oee(){var e=Nee(q7());return e.copy=function(){return K7(e,Oee()).exponent(e.exponent())},o9.apply(e,arguments),e}function Ree(){return Oee.apply(null,arguments).exponent(.5)}function Pee(e){return Math.sign(e)*e*e}function Dee(){var e,t=X7(),n=[0,1],r=!1;function a(n){var a=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(a)?e:r?Math.round(a):a}return a.invert=function(e){return t.invert(Pee(e))},a.domain=function(e){return arguments.length?(t.domain(e),a):t.domain()},a.range=function(e){return arguments.length?(t.range((n=Array.from(e,U7)).map(Pee)),a):n.slice()},a.rangeRound=function(e){return a.range(e).round(!0)},a.round=function(e){return arguments.length?(r=!!e,a):r},a.clamp=function(e){return arguments.length?(t.clamp(e),a):t.clamp()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return Dee(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},o9.apply(a,arguments),fee(a)}function Mee(e,t){var n;if(void 0===t){var r,a=U(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n<i||void 0===n&&i>=i)&&(n=i)}}catch(Wse){a.e(Wse)}finally{a.f()}}else{var o,s=-1,u=U(e);try{for(u.s();!(o=u.n()).done;){var c=o.value;null!=(c=t(c,++s,e))&&(n<c||void 0===n&&c>=c)&&(n=c)}}catch(Wse){u.e(Wse)}finally{u.f()}}return n}function Fee(e,t){var n;if(void 0===t){var r,a=U(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n>i||void 0===n&&i>=i)&&(n=i)}}catch(Wse){a.e(Wse)}finally{a.f()}}else{var o,s=-1,u=U(e);try{for(u.s();!(o=u.n()).done;){var c=o.value;null!=(c=t(c,++s,e))&&(n>c||void 0===n&&c>=c)&&(n=c)}}catch(Wse){u.e(Wse)}finally{u.f()}}return n}function Lee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P9;if(e===P9)return jee;if("function"!==typeof e)throw new TypeError("compare is not a function");return function(t,n){var r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function jee(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function zee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=void 0===a?jee:Lee(a);r>n;){if(r-n>600){var i=r-n+1,o=t-n+1,s=Math.log(i),u=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*u*(i-u)/i)*(o-i/2<0?-1:1);zee(e,t,Math.max(n,Math.floor(t-o*u/i+c)),Math.min(r,Math.floor(t+(i-o)*u/i+c)),a)}var l=e[t],f=n,h=r;for(Uee(e,n,t),a(e[r],l)>0&&Uee(e,n,r);f<h;){for(Uee(e,f,h),++f,--h;a(e[f],l)<0;)++f;for(;a(e[h],l)>0;)--h}0===a(e[n],l)?Uee(e,n,h):Uee(e,++h,r),h<=t&&(n=h+1),t<=h&&(r=h-1)}return e}function Uee(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Bee(e,t,n){if((r=(e=Float64Array.from(z9(e,n))).length)&&!isNaN(t=+t)){if(t<=0||r<2)return Fee(e);if(t>=1)return Mee(e);var r,a=(r-1)*t,i=Math.floor(a),o=Mee(zee(e,i).subarray(0,i+1));return o+(Fee(e.subarray(i+1))-o)*(a-i)}}function Wee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j9;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e);return o+(+n(e[i+1],i+1,e)-o)*(a-i)}}function Vee(){var e,t=[],n=[],r=[];function a(){var e=0,a=Math.max(1,n.length);for(r=new Array(a-1);++e<a;)r[e-1]=Wee(t,e/a);return i}function i(t){return null==t||isNaN(t=+t)?e:n[W9(r,t)]}return i.invertExtent=function(e){var a=n.indexOf(e);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},i.domain=function(e){if(!arguments.length)return t.slice();t=[];var n,r=U(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null==i||isNaN(i=+i)||t.push(i)}}catch(Wse){r.e(Wse)}finally{r.f()}return t.sort(P9),a()},i.range=function(e){return arguments.length?(n=Array.from(e),a()):n.slice()},i.unknown=function(t){return arguments.length?(e=t,i):e},i.quantiles=function(){return r.slice()},i.copy=function(){return Vee().domain(t).range(n).unknown(e)},o9.apply(i,arguments)}function Gee(){var e,t=0,n=1,r=1,a=[.5],i=[0,1];function o(t){return null!=t&&t<=t?i[W9(a,t,0,r)]:e}function s(){var e=-1;for(a=new Array(r);++e<r;)a[e]=((e+1)*n-(e-r)*t)/(r+1);return o}return o.domain=function(e){var r;return arguments.length?(r=E(e,2),t=r[0],n=r[1],t=+t,n=+n,s()):[t,n]},o.range=function(e){return arguments.length?(r=(i=Array.from(e)).length-1,s()):i.slice()},o.invertExtent=function(e){var o=i.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,a[0]]:o>=r?[a[r-1],n]:[a[o-1],a[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return a.slice()},o.copy=function(){return Gee().domain([t,n]).range(i).unknown(e)},o9.apply(fee(o),arguments)}function Hee(){var e,t=[.5],n=[0,1],r=1;function a(a){return null!=a&&a<=a?n[W9(t,a,0,r)]:e}return a.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),a):t.slice()},a.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),a):n.slice()},a.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return Hee().domain(t).range(n).unknown(e)},o9.apply(a,arguments)}aee=cee({thousands:",",grouping:[3],currency:["$",""]}),iee=aee.format,oee=aee.formatPrefix;var Kee=1e3,qee=60*Kee,Xee=60*qee,Yee=24*Xee,Zee=7*Yee,Qee=30*Yee,Jee=365*Yee,$ee=new Date,ete=new Date;function tte(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,s=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return s;do{s.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return s},a.filter=function(n){return tte((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return $ee.setTime(+t),ete.setTime(+r),e($ee),e(ete),Math.floor(n($ee,ete))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var nte=tte((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));nte.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?tte((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):nte:null};nte.range;var rte=tte((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*Kee)}),(function(e,t){return(t-e)/Kee}),(function(e){return e.getUTCSeconds()})),ate=(rte.range,tte((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Kee)}),(function(e,t){e.setTime(+e+t*qee)}),(function(e,t){return(t-e)/qee}),(function(e){return e.getMinutes()}))),ite=(ate.range,tte((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*qee)}),(function(e,t){return(t-e)/qee}),(function(e){return e.getUTCMinutes()}))),ote=(ite.range,tte((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Kee-e.getMinutes()*qee)}),(function(e,t){e.setTime(+e+t*Xee)}),(function(e,t){return(t-e)/Xee}),(function(e){return e.getHours()}))),ste=(ote.range,tte((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Xee)}),(function(e,t){return(t-e)/Xee}),(function(e){return e.getUTCHours()}))),ute=(ste.range,tte((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*qee)/Yee}),(function(e){return e.getDate()-1}))),cte=(ute.range,tte((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Yee}),(function(e){return e.getUTCDate()-1}))),lte=(cte.range,tte((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Yee}),(function(e){return Math.floor(e/Yee)})));lte.range;function fte(e){return tte((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*qee)/Zee}))}var hte=fte(0),dte=fte(1),pte=fte(2),vte=fte(3),gte=fte(4),mte=fte(5),yte=fte(6);hte.range,dte.range,pte.range,vte.range,gte.range,mte.range,yte.range;function bte(e){return tte((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/Zee}))}var xte=bte(0),kte=bte(1),wte=bte(2),Ite=bte(3),Cte=bte(4),Ate=bte(5),Ste=bte(6),_te=(xte.range,kte.range,wte.range,Ite.range,Cte.range,Ate.range,Ste.range,tte((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),Ete=(_te.range,tte((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),Tte=(Ete.range,tte((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));Tte.every=function(e){return isFinite(e=Math.floor(e))&&e>0?tte((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};Tte.range;var Nte=tte((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));Nte.every=function(e){return isFinite(e=Math.floor(e))&&e>0?tte((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};Nte.range;function Ote(e,t,n,r,a,i){var o=[[rte,1,Kee],[rte,5,5*Kee],[rte,15,15*Kee],[rte,30,30*Kee],[i,1,qee],[i,5,5*qee],[i,15,15*qee],[i,30,30*qee],[a,1,Xee],[a,3,3*Xee],[a,6,6*Xee],[a,12,12*Xee],[r,1,Yee],[r,2,2*Yee],[n,1,Zee],[t,1,Qee],[t,3,3*Qee],[e,1,Jee]];function s(t,n,r){var a=Math.abs(n-t)/r,i=M9((function(e){return E(e,3)[2]})).right(o,a);if(i===o.length)return e.every(R9(t/Jee,n/Jee,r));if(0===i)return nte.every(Math.max(R9(t,n,r),1));var s=E(o[a/o[i-1][2]<o[i][2]/a?i-1:i],2),u=s[0],c=s[1];return u.every(c)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}var Rte=E(Ote(Nte,Ete,xte,lte,ste,ite),2),Pte=Rte[0],Dte=Rte[1],Mte=E(Ote(Tte,_te,hte,ute,ote,ate),2),Fte=Mte[0],Lte=Mte[1];function jte(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zte(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ute(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var Bte,Wte,Vte,Gte={"-":"",_:" ",0:"0"},Hte=/^\s*\d+/,Kte=/^%/,qte=/[\\^$*+?|[\]().{}]/g;function Xte(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function Yte(e){return e.replace(qte,"\\$&")}function Zte(e){return new RegExp("^(?:"+e.map(Yte).join("|")+")","i")}function Qte(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function Jte(e,t,n){var r=Hte.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function $te(e,t,n){var r=Hte.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ene(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function tne(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function nne(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function rne(e,t,n){var r=Hte.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function ane(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ine(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function one(e,t,n){var r=Hte.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function sne(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function une(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function cne(e,t,n){var r=Hte.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function lne(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function fne(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function hne(e,t,n){var r=Hte.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function dne(e,t,n){var r=Hte.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function pne(e,t,n){var r=Hte.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function vne(e,t,n){var r=Kte.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function gne(e,t,n){var r=Hte.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function mne(e,t,n){var r=Hte.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function yne(e,t){return Xte(e.getDate(),t,2)}function bne(e,t){return Xte(e.getHours(),t,2)}function xne(e,t){return Xte(e.getHours()%12||12,t,2)}function kne(e,t){return Xte(1+ute.count(Tte(e),e),t,3)}function wne(e,t){return Xte(e.getMilliseconds(),t,3)}function Ine(e,t){return wne(e,t)+"000"}function Cne(e,t){return Xte(e.getMonth()+1,t,2)}function Ane(e,t){return Xte(e.getMinutes(),t,2)}function Sne(e,t){return Xte(e.getSeconds(),t,2)}function _ne(e){var t=e.getDay();return 0===t?7:t}function Ene(e,t){return Xte(hte.count(Tte(e)-1,e),t,2)}function Tne(e){var t=e.getDay();return t>=4||0===t?gte(e):gte.ceil(e)}function Nne(e,t){return e=Tne(e),Xte(gte.count(Tte(e),e)+(4===Tte(e).getDay()),t,2)}function One(e){return e.getDay()}function Rne(e,t){return Xte(dte.count(Tte(e)-1,e),t,2)}function Pne(e,t){return Xte(e.getFullYear()%100,t,2)}function Dne(e,t){return Xte((e=Tne(e)).getFullYear()%100,t,2)}function Mne(e,t){return Xte(e.getFullYear()%1e4,t,4)}function Fne(e,t){var n=e.getDay();return Xte((e=n>=4||0===n?gte(e):gte.ceil(e)).getFullYear()%1e4,t,4)}function Lne(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Xte(t/60|0,"0",2)+Xte(t%60,"0",2)}function jne(e,t){return Xte(e.getUTCDate(),t,2)}function zne(e,t){return Xte(e.getUTCHours(),t,2)}function Une(e,t){return Xte(e.getUTCHours()%12||12,t,2)}function Bne(e,t){return Xte(1+cte.count(Nte(e),e),t,3)}function Wne(e,t){return Xte(e.getUTCMilliseconds(),t,3)}function Vne(e,t){return Wne(e,t)+"000"}function Gne(e,t){return Xte(e.getUTCMonth()+1,t,2)}function Hne(e,t){return Xte(e.getUTCMinutes(),t,2)}function Kne(e,t){return Xte(e.getUTCSeconds(),t,2)}function qne(e){var t=e.getUTCDay();return 0===t?7:t}function Xne(e,t){return Xte(xte.count(Nte(e)-1,e),t,2)}function Yne(e){var t=e.getUTCDay();return t>=4||0===t?Cte(e):Cte.ceil(e)}function Zne(e,t){return e=Yne(e),Xte(Cte.count(Nte(e),e)+(4===Nte(e).getUTCDay()),t,2)}function Qne(e){return e.getUTCDay()}function Jne(e,t){return Xte(kte.count(Nte(e)-1,e),t,2)}function $ne(e,t){return Xte(e.getUTCFullYear()%100,t,2)}function ere(e,t){return Xte((e=Yne(e)).getUTCFullYear()%100,t,2)}function tre(e,t){return Xte(e.getUTCFullYear()%1e4,t,4)}function nre(e,t){var n=e.getUTCDay();return Xte((e=n>=4||0===n?Cte(e):Cte.ceil(e)).getUTCFullYear()%1e4,t,4)}function rre(){return"+0000"}function are(){return"%"}function ire(e){return+e}function ore(e){return Math.floor(+e/1e3)}function sre(e){return new Date(e)}function ure(e){return e instanceof Date?+e:+new Date(+e)}function cre(e,t,n,r,a,i,o,s,u,c){var l=X7(),f=l.invert,h=l.domain,d=c(".%L"),p=c(":%S"),v=c("%I:%M"),g=c("%I %p"),m=c("%a %d"),y=c("%b %d"),b=c("%B"),x=c("%Y");function k(e){return(u(e)<e?d:s(e)<e?p:o(e)<e?v:i(e)<e?g:r(e)<e?a(e)<e?m:y:n(e)<e?b:x)(e)}return l.invert=function(e){return new Date(f(e))},l.domain=function(e){return arguments.length?h(Array.from(e,ure)):h().map(sre)},l.ticks=function(t){var n=h();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?k:c(t)},l.nice=function(e){var n=h();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?h(pee(n,e)):l},l.copy=function(){return K7(l,cre(e,t,n,r,a,i,o,s,u,c))},l}function lre(){return o9.apply(cre(Fte,Lte,Tte,_te,hte,ute,ote,ate,rte,Wte).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function fre(){return o9.apply(cre(Pte,Dte,Nte,Ete,xte,cte,ste,ite,rte,Vte).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function hre(){var e,t,n,r,a,i=0,o=1,s=W7,u=!1;function c(t){return null==t||isNaN(t=+t)?a:s(0===n?.5:(t=(r(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,r,a;return arguments.length?(r=(n=E(t,2))[0],a=n[1],s=e(r,a),c):[s(0),s(1)]}}return c.domain=function(a){var s;return arguments.length?(s=E(a,2),i=s[0],o=s[1],e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),c):[i,o]},c.clamp=function(e){return arguments.length?(u=!!e,c):u},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=l(j7),c.rangeRound=l(z7),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),c}}function dre(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function pre(){var e=fee(hre()(W7));return e.copy=function(){return dre(e,pre())},s9.apply(e,arguments)}function vre(){var e=kee(hre()).domain([1,10]);return e.copy=function(){return dre(e,vre()).base(e.base())},s9.apply(e,arguments)}function gre(){var e=Aee(hre());return e.copy=function(){return dre(e,gre()).constant(e.constant())},s9.apply(e,arguments)}function mre(){var e=Nee(hre());return e.copy=function(){return dre(e,mre()).exponent(e.exponent())},s9.apply(e,arguments)}function yre(){return mre.apply(null,arguments).exponent(.5)}function bre(){var e=[],t=W7;function n(n){if(null!=n&&!isNaN(n=+n))return t((W9(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];var r,a=U(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;null==i||isNaN(i=+i)||e.push(i)}}catch(Wse){a.e(Wse)}finally{a.f()}return e.sort(P9),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map((function(n,r){return t(r/(e.length-1))}))},n.quantiles=function(t){return Array.from({length:t+1},(function(n,r){return Bee(e,r/t)}))},n.copy=function(){return bre(t).domain(e)},s9.apply(n,arguments)}function xre(){var e,t,n,r,a,i,o,s=0,u=.5,c=1,l=1,f=W7,h=!1;function d(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(l*e<l*t?r:a),f(h?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a,i;return arguments.length?(r=(n=E(t,3))[0],a=n[1],i=n[2],f=function(e,t){void 0===t&&(t=e,e=j7);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}(e,[r,a,i]),d):[f(0),f(.5),f(1)]}}return d.domain=function(o){var f;return arguments.length?(f=E(o,3),s=f[0],u=f[1],c=f[2],e=i(s=+s),t=i(u=+u),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,d):[s,u,c]},d.clamp=function(e){return arguments.length?(h=!!e,d):h},d.interpolator=function(e){return arguments.length?(f=e,d):f},d.range=p(j7),d.rangeRound=p(z7),d.unknown=function(e){return arguments.length?(o=e,d):o},function(o){return i=o,e=o(s),t=o(u),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,d}}function kre(){var e=fee(xre()(W7));return e.copy=function(){return dre(e,kre())},s9.apply(e,arguments)}function wre(){var e=kee(xre()).domain([.1,1,10]);return e.copy=function(){return dre(e,wre()).base(e.base())},s9.apply(e,arguments)}function Ire(){var e=Aee(xre());return e.copy=function(){return dre(e,Ire()).constant(e.constant())},s9.apply(e,arguments)}function Cre(){var e=Nee(xre());return e.copy=function(){return dre(e,Cre()).exponent(e.exponent())},s9.apply(e,arguments)}function Are(){return Cre.apply(null,arguments).exponent(.5)}function Sre(e,t){if((a=e.length)>1)for(var n,r,a,i=1,o=e[t[0]],s=o.length;i<a;++i)for(r=o,o=e[t[i]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function _re(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function Ere(e,t){return e[t]}function Tre(e){var t=[];return t.key=e,t}!function(e){Bte=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,c=Zte(a),l=Qte(a),f=Zte(i),h=Qte(i),d=Zte(o),p=Qte(o),v=Zte(s),g=Qte(s),m=Zte(u),y=Qte(u),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:yne,e:yne,f:Ine,g:Dne,G:Fne,H:bne,I:xne,j:kne,L:wne,m:Cne,M:Ane,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ire,s:ore,S:Sne,u:_ne,U:Ene,V:Nne,w:One,W:Rne,x:null,X:null,y:Pne,Y:Mne,Z:Lne,"%":are},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:jne,e:jne,f:Vne,g:ere,G:nre,H:zne,I:Une,j:Bne,L:Wne,m:Gne,M:Hne,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ire,s:ore,S:Kne,u:qne,U:Xne,V:Zne,w:Qne,W:Jne,x:null,X:null,y:$ne,Y:tre,Z:rre,"%":are},k={a:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return C(e,t,n,r)},d:une,e:une,f:pne,g:ane,G:rne,H:lne,I:lne,j:cne,L:dne,m:sne,M:fne,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:one,Q:gne,s:mne,S:hne,u:$te,U:ene,V:tne,w:Jte,W:nne,x:function(e,t,r){return C(e,n,t,r)},X:function(e,t,n){return C(e,r,t,n)},y:ane,Y:rne,Z:ine,"%":vne};function w(e,t){return function(n){var r,a,i,o=[],s=-1,u=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(o.push(e.slice(u,s)),null!=(a=Gte[r=e.charAt(++s)])?r=e.charAt(++s):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),u=s+1);return o.push(e.slice(u,s)),o.join("")}}function I(e,t){return function(n){var r,a,i=Ute(1900,void 0,1);if(C(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=zte(Ute(i.y,0,1))).getUTCDay(),r=a>4||0===a?kte.ceil(r):kte(r),r=cte.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=jte(Ute(i.y,0,1))).getDay(),r=a>4||0===a?dte.ceil(r):dte(r),r=ute.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?zte(Ute(i.y,0,1)).getUTCDay():jte(Ute(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,zte(i)):jte(i)}}function C(e,t,n,r){for(var a,i,o=0,s=t.length,u=n.length;o<s;){if(r>=u)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=k[a in Gte?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=I(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=I(e+="",!0);return t.toString=function(){return e},t}}}(e),Wte=Bte.format,Bte.parse,Vte=Bte.utcFormat,Bte.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Nre=n(4234),Ore=n.n(Nre);function Rre(e){return function(e){if(Array.isArray(e))return Pre(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Pre(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pre(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pre(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dre=function(e){return e},Mre={"@@functional/placeholder":!0},Fre=function(e){return e===Mre},Lre=function(e){return function t(){return 0===arguments.length||1===arguments.length&&Fre(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},jre=function(e){return function e(t,n){return 1===t?n:Lre((function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var o=a.filter((function(e){return e!==Mre})).length;return o>=t?n.apply(void 0,a):e(t-o,Lre((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=a.map((function(e){return Fre(e)?t.shift():e}));return n.apply(void 0,Rre(i).concat(t))})))}))}(e.length,e)},zre=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},Ure=jre((function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map((function(e){return t[e]})).map(e)})),Bre=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return Dre;var r=t.reverse(),a=r[0],i=r.slice(1);return function(){return i.reduce((function(e,t){return t(e)}),a.apply(void 0,arguments))}},Wre=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},Vre=function(e){var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t&&a.every((function(e,n){return e===t[n]}))?n:(t=a,n=e.apply(void 0,a))}};var Gre=jre((function(e,t,n){var r=+e;return r+n*(+t-r)})),Hre=jre((function(e,t,n){var r=t-+e;return(n-e)/(r=r||1/0)})),Kre=jre((function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))})),qre={rangeStep:function(e,t,n){for(var r=new(Ore())(e),a=0,i=[];r.lt(t)&&a<1e5;)i.push(r.toNumber()),r=r.add(n),a++;return i},getDigitCount:function(e){return 0===e?1:Math.floor(new(Ore())(e).abs().log(10).toNumber())+1},interpolateNumber:Gre,uninterpolateNumber:Hre,uninterpolateTruncation:Kre};function Xre(e){return function(e){if(Array.isArray(e))return Qre(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Zre(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yre(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(Wse){a=!0,i=Wse}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||Zre(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zre(e,t){if(e){if("string"===typeof e)return Qre(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qre(e,t):void 0}}function Qre(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jre(e){var t=Yre(e,2),n=t[0],r=t[1],a=n,i=r;return n>r&&(a=r,i=n),[a,i]}function $re(e,t,n){if(e.lte(0))return new(Ore())(0);var r=qre.getDigitCount(e.toNumber()),a=new(Ore())(10).pow(r),i=e.div(a),o=1!==r?.05:.1,s=new(Ore())(Math.ceil(i.div(o).toNumber())).add(n).mul(o).mul(a);return t?s:new(Ore())(Math.ceil(s))}function eae(e,t,n){var r=1,a=new(Ore())(e);if(!a.isint()&&n){var i=Math.abs(e);i<1?(r=new(Ore())(10).pow(qre.getDigitCount(e)-1),a=new(Ore())(Math.floor(a.div(r).toNumber())).mul(r)):i>1&&(a=new(Ore())(Math.floor(e)))}else 0===e?a=new(Ore())(Math.floor((t-1)/2)):n||(a=new(Ore())(Math.floor(e)));var o=Math.floor((t-1)/2),s=Bre(Ure((function(e){return a.add(new(Ore())(e-o).mul(r)).toNumber()})),zre);return s(0,t)}function tae(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new(Ore())(0),tickMin:new(Ore())(0),tickMax:new(Ore())(0)};var i,o=$re(new(Ore())(t).sub(e).div(n-1),r,a);i=e<=0&&t>=0?new(Ore())(0):(i=new(Ore())(e).add(t).div(2)).sub(new(Ore())(i).mod(o));var s=Math.ceil(i.sub(e).div(o).toNumber()),u=Math.ceil(new(Ore())(t).sub(i).div(o).toNumber()),c=s+u+1;return c>n?tae(e,t,n,r,a+1):(c<n&&(u=t>0?u+(n-c):u,s=t>0?s:s+(n-c)),{step:o,tickMin:i.sub(new(Ore())(s).mul(o)),tickMax:i.add(new(Ore())(u).mul(o))})}var nae=Vre((function(e){var t=Yre(e,2),n=t[0],r=t[1],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Math.max(a,2),s=Yre(Jre([n,r]),2),u=s[0],c=s[1];if(u===-1/0||c===1/0){var l=c===1/0?[u].concat(Xre(zre(0,a-1).map((function(){return 1/0})))):[].concat(Xre(zre(0,a-1).map((function(){return-1/0}))),[c]);return n>r?Wre(l):l}if(u===c)return eae(u,a,i);var f=tae(u,c,o,i),h=f.step,d=f.tickMin,p=f.tickMax,v=qre.rangeStep(d,p.add(new(Ore())(.1).mul(h)),h);return n>r?Wre(v):v})),rae=(Vre((function(e){var t=Yre(e,2),n=t[0],r=t[1],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Math.max(a,2),s=Yre(Jre([n,r]),2),u=s[0],c=s[1];if(u===-1/0||c===1/0)return[n,r];if(u===c)return eae(u,a,i);var l=$re(new(Ore())(c).sub(u).div(o-1),i,0),f=Bre(Ure((function(e){return new(Ore())(u).add(new(Ore())(e).mul(l)).toNumber()})),zre),h=f(0,o).filter((function(e){return e>=u&&e<=c}));return n>r?Wre(h):h})),Vre((function(e,t){var n=Yre(e,2),r=n[0],a=n[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Yre(Jre([r,a]),2),s=o[0],u=o[1];if(s===-1/0||u===1/0)return[r,a];if(s===u)return[s];var c=Math.max(t,2),l=$re(new(Ore())(u).sub(s).div(c-1),i,0),f=[].concat(Xre(qre.rangeStep(new(Ore())(s),new(Ore())(u).sub(new(Ore())(.99).mul(l)),l)),[u]);return r>a?Wre(f):f}))),aae=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function iae(){return iae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iae.apply(this,arguments)}function oae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(Wse){c=!0,a=Wse}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return sae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uae(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function cae(e){var t=e.offset,n=e.layout,a=e.width,i=e.dataKey,o=e.data,s=e.dataPointFormatter,u=e.xAxis,c=e.yAxis,l=uae(e,aae),f=E1(l),h=o.map((function(e,o){var l=s(e,i),h=l.x,d=l.y,p=l.value,v=l.errorVal;if(!v)return null;var g,m,y=[];if(Array.isArray(v)){var b=oae(v,2);g=b[0],m=b[1]}else g=m=v;if("vertical"===n){var x=u.scale,k=d+t,w=k+a,I=k-a,C=x(p-g),A=x(p+m);y.push({x1:A,y1:w,x2:A,y2:I}),y.push({x1:C,y1:k,x2:A,y2:k}),y.push({x1:C,y1:w,x2:C,y2:I})}else if("horizontal"===n){var S=c.scale,_=h+t,E=_-a,T=_+a,N=S(p-g),O=S(p+m);y.push({x1:E,y1:O,x2:T,y2:O}),y.push({x1:_,y1:N,x2:_,y2:O}),y.push({x1:E,y1:N,x2:T,y2:N})}return r.createElement(U1,iae({className:"recharts-errorBar",key:"bar-".concat(o)},f),y.map((function(e,t){return r.createElement("line",iae({},e,{key:"line-".concat(t)}))})))}));return r.createElement(U1,{className:"recharts-errorBars"},h)}function lae(e){return lae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lae(e)}function fae(e){return function(e){if(Array.isArray(e))return hae(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return hae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hae(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dae(Object(n),!0).forEach((function(t){vae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vae(e,t,n){return t=function(e){var t=function(e,t){if("object"!==lae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==lae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===lae(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gae(e,t,n){return t1()(e)||t1()(t)?n:T0(t)?m0()(e,t,n):q0()(t)?t(e):n}function mae(e,t,n,r){var a=A9()(e,(function(e){return gae(e,t)}));if("number"===n){var i=a.filter((function(e){return E0(e)||parseFloat(e)}));return i.length?[I9()(i),k9()(i)]:[1/0,-1/0]}return(r?a.filter((function(e){return!t1()(e)})):a).map((function(e){return T0(e)||e instanceof Date?e:""}))}cae.defaultProps={stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"},cae.displayName="ErrorBar";var yae=function(e){var t,n=e.type.displayName,r=e.props,a=r.stroke,i=r.fill;switch(n){case"Line":t=a;break;case"Area":case"Radar":t=a&&"none"!==a?a:i;break;default:t=i}return t},bae=function(e){var t,n=e.children,r=e.formattedGraphicalItems,a=e.legendWidth,i=e.legendContent,o=C1(n,g5);return o?(t=o.props&&o.props.payload?o.props&&o.props.payload:"children"===i?(r||[]).reduce((function(e,t){var n=t.item,r=t.props,a=r.sectors||r.data||[];return e.concat(a.map((function(e){return{type:o.props.iconType||n.props.legendType,value:e.name,color:e.fill,payload:e}})))}),[]):(r||[]).map((function(e){var t=e.item,n=t.props,r=n.dataKey,a=n.name,i=n.legendType;return{inactive:n.hide,dataKey:r,type:o.props.iconType||i||"square",color:yae(t),value:a||r,payload:t.props}})),pae(pae(pae({},o.props),g5.getWithHeight(o,a)),{},{payload:t,item:o})):null},xae=function(e,t,n,r,a){var i=I1(t.props.children,cae).filter((function(e){return function(e,t,n){return!!t1()(t)||("horizontal"===e?"yAxis"===t:"vertical"===e||"x"===n?"xAxis"===t:"y"!==n||"yAxis"===t)}(r,a,e.props.direction)}));if(i&&i.length){var o=i.map((function(e){return e.props.dataKey}));return e.reduce((function(e,t){var r=gae(t,n,0),a=b0()(r)?[I9()(r),k9()(r)]:[r,r],i=o.reduce((function(e,n){var r=gae(t,n,0),i=a[0]-Math.abs(b0()(r)?r[0]:r),o=a[1]+Math.abs(b0()(r)?r[1]:r);return[Math.min(i,e[0]),Math.max(o,e[1])]}),[1/0,-1/0]);return[Math.min(i[0],e[0]),Math.max(i[1],e[1])]}),[1/0,-1/0])}return null},kae=function(e,t,n,r,a){var i=t.map((function(t){var i=t.props.dataKey;return"number"===n&&i&&xae(e,t,i,r)||mae(e,i,n,a)}));if("number"===n)return i.reduce((function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}),[1/0,-1/0]);var o={};return i.reduce((function(e,t){for(var n=0,r=t.length;n<r;n++)o[t[n]]||(o[t[n]]=!0,e.push(t[n]));return e}),[])},wae=function(e,t){return"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t},Iae=function(e,t,n){var r,a,i=e.map((function(e){return e.coordinate===t&&(r=!0),e.coordinate===n&&(a=!0),e.coordinate}));return r||i.push(t),a||i.push(n),i},Cae=function(e,t,n){if(!e)return null;var r=e.scale,a=e.duplicateDomain,i=e.type,o=e.range,s="scaleBand"===e.realScaleType?r.bandwidth()/2:2,u=(t||n)&&"category"===i&&r.bandwidth?r.bandwidth()/s:0;return u="angleAxis"===e.axisType?2*S0(o[0]-o[1])*u:u,t&&(e.ticks||e.niceTicks)?(e.ticks||e.niceTicks).map((function(e){var t=a?a.indexOf(e):e;return{coordinate:r(t)+u,value:e,offset:u}})):e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map((function(e,t){return{coordinate:r(e)+u,value:e,index:t,offset:u}})):r.ticks&&!n?r.ticks(e.tickCount).map((function(e){return{coordinate:r(e)+u,value:e,offset:u}})):r.domain().map((function(e,t){return{coordinate:r(e)+u,value:a?a[e]:e,index:t,offset:u}}))},Aae=function(e,t,n){var r;return q0()(n)?r=n:q0()(t)&&(r=t),q0()(e)||r?function(t,n,a,i){q0()(e)&&e(t,n,a,i),q0()(r)&&r(t,n,a,i)}:null},Sae=1e-4,_ae={sign:function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,i=0,o=0;o<t;++o){var s=k0()(e[o][n][1])?e[o][n][0]:e[o][n][1];s>=0?(e[o][n][0]=a,e[o][n][1]=a+s,a=e[o][n][1]):(e[o][n][0]=i,e[o][n][1]=i+s,i=e[o][n][1])}},expand:function(e,t){if((r=e.length)>0){for(var n,r,a,i=0,o=e[0].length;i<o;++i){for(a=n=0;n<r;++n)a+=e[n][i][1]||0;if(a)for(n=0;n<r;++n)e[n][i][1]/=a}Sre(e,t)}},none:Sre,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,a=e[t[0]],i=a.length;r<i;++r){for(var o=0,s=0;o<n;++o)s+=e[o][r][1]||0;a[r][1]+=a[r][0]=-s/2}Sre(e,t)}},wiggle:function(e,t){if((a=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,a,i=0,o=1;o<r;++o){for(var s=0,u=0,c=0;s<a;++s){for(var l=e[t[s]],f=l[o][1]||0,h=(f-(l[o-1][1]||0))/2,d=0;d<s;++d){var p=e[t[d]];h+=(p[o][1]||0)-(p[o-1][1]||0)}u+=f,c+=h*f}n[o-1][1]+=n[o-1][0]=i,u&&(i-=c/u)}n[o-1][1]+=n[o-1][0]=i,Sre(e,t)}},positive:function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,i=0;i<t;++i){var o=k0()(e[i][n][1])?e[i][n][0]:e[i][n][1];o>=0?(e[i][n][0]=a,e[i][n][1]=a+o,a=e[i][n][1]):(e[i][n][0]=0,e[i][n][1]=0)}}},Eae=function(e,t,n){var r=t.map((function(e){return e.props.dataKey})),a=function(){var e=A4([]),t=_re,n=Sre,r=Ere;function a(a){var i,o,s,u=Array.from(e.apply(this,arguments),Tre),c=u.length,l=-1,f=U(a);try{for(f.s();!(s=f.n()).done;){var h=s.value;for(i=0,++l;i<c;++i)(u[i][l]=[0,+r(h,u[i].key,l,a)]).data=h}}catch(Wse){f.e(Wse)}finally{f.f()}for(i=0,o=M5(t(u));i<c;++i)u[o[i]].index=i;return n(u,o),u}return a.keys=function(t){return arguments.length?(e="function"===typeof t?t:A4(Array.from(t)),a):e},a.value=function(e){return arguments.length?(r="function"===typeof e?e:A4(+e),a):r},a.order=function(e){return arguments.length?(t=null==e?_re:"function"===typeof e?e:A4(Array.from(e)),a):t},a.offset=function(e){return arguments.length?(n=null==e?Sre:e,a):n},a}().keys(r).value((function(e,t){return+gae(e,t,0)})).order(_re).offset(_ae[n]);return a(e)},Tae=function(e){var t=e.axis,n=e.ticks,r=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if("category"===t.type){if(!t.allowDuplicatedCategory&&t.dataKey&&!t1()(a[t.dataKey])){var s=M0(n,"value",a[t.dataKey]);if(s)return s.coordinate+r/2}return n[i]?n[i].coordinate+r/2:null}var u=gae(a,t1()(o)?t.dataKey:o);return t1()(u)?null:t.scale(u)},Nae=function(e){var t=e.axis,n=e.ticks,r=e.offset,a=e.bandSize,i=e.entry,o=e.index;if("category"===t.type)return n[o]?n[o].coordinate+r:null;var s=gae(i,t.dataKey,t.domain[o]);return t1()(s)?null:t.scale(s)-a/2+r},Oae=function(e,t,n){return Object.keys(e).reduce((function(r,a){var i=e[a].stackedData.reduce((function(e,r){var a=r.slice(t,n+1).reduce((function(e,t){return[I9()(t.concat([e[0]]).filter(E0)),k9()(t.concat([e[1]]).filter(E0))]}),[1/0,-1/0]);return[Math.min(e[0],a[0]),Math.max(e[1],a[1])]}),[1/0,-1/0]);return[Math.min(i[0],r[0]),Math.max(i[1],r[1])]}),[1/0,-1/0]).map((function(e){return e===1/0||e===-1/0?0:e}))},Rae=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Pae=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Dae=function(e,t,n){if(q0()(e))return e(t,n);if(!b0()(e))return t;var r=[];if(E0(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(Rae.test(e[0])){var a=+Rae.exec(e[0])[1];r[0]=t[0]-a}else q0()(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(E0(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(Pae.test(e[1])){var i=+Pae.exec(e[1])[1];r[1]=t[1]+i}else q0()(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},Mae=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=Q0()(t,(function(e){return e.coordinate})),i=1/0,o=1,s=a.length;o<s;o++){var u=a[o],c=a[o-1];i=Math.min((u.coordinate||0)-(c.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0},Fae=function(e,t,n){return e&&e.length?b9()(e,m0()(n,"type.defaultProps.domain"))?t:e:t},Lae=function(e,t){var n=e.props,r=n.dataKey,a=n.name,i=n.unit,o=n.formatter,s=n.tooltipType,u=n.chartType;return pae(pae({},E1(e)),{},{dataKey:r,unit:i,formatter:o,name:a||r,color:yae(e),value:gae(t,r),type:s,payload:t,chartType:u})};function jae(e){return jae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jae(e)}function zae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zae(Object(n),!0).forEach((function(t){Bae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bae(e,t,n){return t=function(e){var t=function(e,t){if("object"!==jae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==jae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===jae(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wae=["Webkit","Moz","O","ms"];function Vae(e){return Vae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vae(e)}function Gae(){return Gae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gae.apply(this,arguments)}function Hae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hae(Object(n),!0).forEach((function(t){Jae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$ae(r.key),r)}}function Xae(e,t){return Xae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xae(e,t)}function Yae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qae(e);if(t){var a=Qae(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Vae(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Zae(e)}(this,n)}}function Zae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qae(e){return Qae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qae(e)}function Jae(e,t,n){return(t=$ae(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $ae(e){var t=function(e,t){if("object"!==Vae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Vae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Vae(t)?t:String(t)}var eie=function(e){return e.changedTouches&&!!e.changedTouches.length},tie=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xae(e,t)}(o,e);var t,n,a,i=Yae(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),Jae(Zae(t=i.call(this,e)),"handleDrag",(function(e){t.leaveTimer&&(clearTimeout(t.leaveTimer),t.leaveTimer=null),t.state.isTravellerMoving?t.handleTravellerMove(e):t.state.isSlideMoving&&t.handleSlideDrag(e)})),Jae(Zae(t),"handleTouchMove",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&t.handleDrag(e.changedTouches[0])})),Jae(Zae(t),"handleDragEnd",(function(){t.setState({isTravellerMoving:!1,isSlideMoving:!1}),t.detachDragEndListener()})),Jae(Zae(t),"handleLeaveWrapper",(function(){(t.state.isTravellerMoving||t.state.isSlideMoving)&&(t.leaveTimer=window.setTimeout(t.handleDragEnd,t.props.leaveTimeOut))})),Jae(Zae(t),"handleEnterSlideOrTraveller",(function(){t.setState({isTextActive:!0})})),Jae(Zae(t),"handleLeaveSlideOrTraveller",(function(){t.setState({isTextActive:!1})})),Jae(Zae(t),"handleSlideDragStart",(function(e){var n=eie(e)?e.changedTouches[0]:e;t.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:n.pageX}),t.attachDragEndListener()})),t.travellerDragStartHandlers={startX:t.handleTravellerDragStart.bind(Zae(t),"startX"),endX:t.handleTravellerDragStart.bind(Zae(t),"endX")},t.state={},t}return t=o,n=[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(e){var t=e.startX,n=e.endX,r=this.state.scaleValues,a=this.props,i=a.gap,s=a.data.length-1,u=Math.min(t,n),c=Math.max(t,n),l=o.getIndexInRange(r,u),f=o.getIndexInRange(r,c);return{startIndex:l-l%i,endIndex:f===s?s:f-f%i}}},{key:"getTextOfTick",value:function(e){var t=this.props,n=t.data,r=t.tickFormatter,a=t.dataKey,i=gae(n[e],a,e);return q0()(r)?r(i,e):i}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(e){var t=this.state,n=t.slideMoveStartX,r=t.startX,a=t.endX,i=this.props,o=i.x,s=i.width,u=i.travellerWidth,c=i.startIndex,l=i.endIndex,f=i.onChange,h=e.pageX-n;h>0?h=Math.min(h,o+s-u-a,o+s-u-r):h<0&&(h=Math.max(h,o-r,o-a));var d=this.getIndex({startX:r+h,endX:a+h});d.startIndex===c&&d.endIndex===l||!f||f(d),this.setState({startX:r+h,endX:a+h,slideMoveStartX:e.pageX})}},{key:"handleTravellerDragStart",value:function(e,t){var n=eie(t)?t.changedTouches[0]:t;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:e,brushMoveStartX:n.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(e){var t,n=this.state,r=n.brushMoveStartX,a=n.movingTravellerId,i=n.endX,o=n.startX,s=this.state[a],u=this.props,c=u.x,l=u.width,f=u.travellerWidth,h=u.onChange,d=u.gap,p=u.data,v={startX:this.state.startX,endX:this.state.endX},g=e.pageX-r;g>0?g=Math.min(g,c+l-f-s):g<0&&(g=Math.max(g,c-s)),v[a]=s+g;var m=this.getIndex(v),y=m.startIndex,b=m.endIndex;this.setState((Jae(t={},a,s+g),Jae(t,"brushMoveStartX",e.pageX),t),(function(){h&&function(){var e=p.length-1;return"startX"===a&&(i>o?y%d===0:b%d===0)||i<o&&b===e||"endX"===a&&(i>o?b%d===0:y%d===0)||i>o&&b===e}()&&h(m)}))}},{key:"renderBackground",value:function(){var e=this.props,t=e.x,n=e.y,a=e.width,i=e.height,o=e.fill,s=e.stroke;return r.createElement("rect",{stroke:s,fill:o,x:t,y:n,width:a,height:i})}},{key:"renderPanorama",value:function(){var e=this.props,t=e.x,n=e.y,a=e.width,i=e.height,o=e.data,s=e.children,u=e.padding,c=r.Children.only(s);return c?r.cloneElement(c,{x:t,y:n,width:a,height:i,margin:u,compact:!0,data:o}):null}},{key:"renderTravellerLayer",value:function(e,t){var n=this.props,a=n.y,i=n.travellerWidth,s=n.height,u=n.traveller,c=Math.max(e,this.props.x),l=Kae(Kae({},E1(this.props)),{},{x:c,y:a,width:i,height:s});return r.createElement(U1,{className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[t],onTouchStart:this.travellerDragStartHandlers[t],style:{cursor:"col-resize"}},o.renderTraveller(u,l))}},{key:"renderSlide",value:function(e,t){var n=this.props,a=n.y,i=n.height,o=n.stroke,s=n.travellerWidth,u=Math.min(e,t)+s,c=Math.max(Math.abs(t-e)-s,0);return r.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:o,fillOpacity:.2,x:u,y:a,width:c,height:i})}},{key:"renderText",value:function(){var e=this.props,t=e.startIndex,n=e.endIndex,a=e.y,i=e.height,o=e.travellerWidth,s=e.stroke,u=this.state,c=u.startX,l=u.endX,f={pointerEvents:"none",fill:s};return r.createElement(U1,{className:"recharts-brush-texts"},r.createElement(T8,Gae({textAnchor:"end",verticalAnchor:"middle",x:Math.min(c,l)-5,y:a+i/2},f),this.getTextOfTick(t)),r.createElement(T8,Gae({textAnchor:"start",verticalAnchor:"middle",x:Math.max(c,l)+o+5,y:a+i/2},f),this.getTextOfTick(n)))}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.className,a=e.children,i=e.x,o=e.y,s=e.width,u=e.height,c=e.alwaysShowText,l=this.state,f=l.startX,h=l.endX,d=l.isTextActive,p=l.isSlideMoving,v=l.isTravellerMoving;if(!t||!t.length||!E0(i)||!E0(o)||!E0(s)||!E0(u)||s<=0||u<=0)return null;var g=c$()("recharts-brush",n),m=1===r.Children.count(a),y=function(e,t){if(!e)return null;var n=e.replace(/(\w)/,(function(e){return e.toUpperCase()})),r=Wae.reduce((function(e,r){return Uae(Uae({},e),{},Bae({},r+n,t))}),{});return r[e]=t,r}("userSelect","none");return r.createElement(U1,{className:g,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:y},this.renderBackground(),m&&this.renderPanorama(),this.renderSlide(f,h),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(h,"endX"),(d||p||v||c)&&this.renderText())}}],a=[{key:"renderDefaultTraveller",value:function(e){var t=e.x,n=e.y,a=e.width,i=e.height,o=e.stroke,s=Math.floor(n+i/2)-1;return r.createElement(r.Fragment,null,r.createElement("rect",{x:t,y:n,width:a,height:i,fill:o,stroke:"none"}),r.createElement("line",{x1:t+1,y1:s,x2:t+a-1,y2:s,fill:"none",stroke:"#fff"}),r.createElement("line",{x1:t+1,y1:s+2,x2:t+a-1,y2:s+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):q0()(e)?e(t):o.renderDefaultTraveller(t)}},{key:"getDerivedStateFromProps",value:function(e,t){var n=e.data,r=e.width,a=e.x,i=e.travellerWidth,o=e.updateId,s=e.startIndex,u=e.endIndex;if(n!==t.prevData||o!==t.prevUpdateId)return Kae({prevData:n,prevTravellerWidth:i,prevUpdateId:o,prevX:a,prevWidth:r},n&&n.length?function(e){var t=e.data,n=e.startIndex,r=e.endIndex,a=e.x,i=e.width,o=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,u=m9().domain($0()(0,s)).range([a,a+i-o]),c=u.domain().map((function(e){return u(e)}));return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,startX:u(n),endX:u(r),scale:u,scaleValues:c}}({data:n,width:r,x:a,travellerWidth:i,startIndex:s,endIndex:u}):{scale:null,scaleValues:null});if(t.scale&&(r!==t.prevWidth||a!==t.prevX||i!==t.prevTravellerWidth)){t.scale.range([a,a+r-i]);var c=t.scale.domain().map((function(e){return t.scale(e)}));return{prevData:n,prevTravellerWidth:i,prevUpdateId:o,prevX:a,prevWidth:r,startX:t.scale(e.startIndex),endX:t.scale(e.endIndex),scaleValues:c}}return null}},{key:"getIndexInRange",value:function(e,t){for(var n=0,r=e.length-1;r-n>1;){var a=Math.floor((n+r)/2);e[a]>t?r=a:n=a}return t>=e[r]?r:n}}],n&&qae(t.prototype,n),a&&qae(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);Jae(tie,"displayName","Brush"),Jae(tie,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var nie=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},rie=n(7702),aie=n.n(rie),iie=function(e){return null};iie.displayName="Cell";var oie=n(5727),sie=n.n(oie);function uie(e){return uie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uie(e)}var cie=["data","valueAccessor","dataKey","clockWise","id","textBreakAll"];function lie(e){return function(e){if(Array.isArray(e))return fie(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return fie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fie(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hie(){return hie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hie.apply(this,arguments)}function die(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?die(Object(n),!0).forEach((function(t){vie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):die(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vie(e,t,n){return t=function(e){var t=function(e,t){if("object"!==uie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==uie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===uie(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gie(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var mie={valueAccessor:function(e){return b0()(e.value)?sie()(e.value):e.value}};function yie(e){var t=e.data,n=e.valueAccessor,a=e.dataKey,i=e.clockWise,o=e.id,s=e.textBreakAll,u=gie(e,cie);return t&&t.length?r.createElement(U1,{className:"recharts-label-list"},t.map((function(e,t){var c=t1()(a)?n(e,t):gae(e&&e.payload,a),l=t1()(o)?{}:{id:"".concat(o,"-").concat(t)};return r.createElement(W8,hie({},E1(e,!0),u,l,{parentViewBox:e.parentViewBox,index:t,value:c,textBreakAll:s,viewBox:W8.parseViewBox(t1()(i)?e:pie(pie({},e),{},{clockWise:i})),key:"label-".concat(t)}))}))):null}yie.displayName="LabelList",yie.renderCallByParent=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.children&&n&&!e.label)return null;var a=I1(e.children,yie).map((function(e,n){return(0,r.cloneElement)(e,{data:t,key:"labelList-".concat(n)})}));return n?[function(e,t){return e?!0===e?r.createElement(yie,{key:"labelList-implicit",data:t}):r.isValidElement(e)||q0()(e)?r.createElement(yie,{key:"labelList-implicit",data:t,content:e}):i1()(e)?r.createElement(yie,hie({data:t},e,{key:"labelList-implicit"})):null:null}(e.label,t)].concat(lie(a)):a},yie.defaultProps=mie;var bie=["value","background"];function xie(e){return xie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xie(e)}function kie(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function wie(){return wie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wie.apply(this,arguments)}function Iie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Iie(Object(n),!0).forEach((function(t){Nie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Aie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Oie(r.key),r)}}function Sie(e,t){return Sie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Sie(e,t)}function _ie(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tie(e);if(t){var a=Tie(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===xie(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Eie(e)}(this,n)}}function Eie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tie(e){return Tie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Tie(e)}function Nie(e,t,n){return(t=Oie(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oie(e){var t=function(e,t){if("object"!==xie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==xie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===xie(t)?t:String(t)}var Rie=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sie(e,t)}(o,e);var t,n,a,i=_ie(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Nie(Eie(e=i.call.apply(i,[this].concat(n))),"state",{isAnimationFinished:!1}),Nie(Eie(e),"id",O0("recharts-bar-")),Nie(Eie(e),"handleAnimationEnd",(function(){var t=e.props.onAnimationEnd;e.setState({isAnimationFinished:!0}),t&&t()})),Nie(Eie(e),"handleAnimationStart",(function(){var t=e.props.onAnimationStart;e.setState({isAnimationFinished:!1}),t&&t()})),e}return t=o,n=[{key:"renderRectanglesStatically",value:function(e){var t=this,n=this.props.shape,a=E1(this.props);return e&&e.map((function(e,i){var s=Cie(Cie(Cie({},a),e),{},{index:i});return r.createElement(U1,wie({className:"recharts-bar-rectangle"},p1(t.props,e,i),{key:"rectangle-".concat(i),role:"img"}),o.renderRectangle(n,s))}))}},{key:"renderRectanglesWithAnimation",value:function(){var e=this,t=this.props,n=t.data,a=t.layout,i=t.isAnimationActive,o=t.animationBegin,s=t.animationDuration,u=t.animationEasing,c=t.animationId,l=this.state.prevData;return r.createElement(d3,{begin:o,duration:s,isActive:i,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(c),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},(function(t){var i=t.t,o=n.map((function(e,t){var n=l&&l[t];if(n){var r=D0(n.x,e.x),o=D0(n.y,e.y),s=D0(n.width,e.width),u=D0(n.height,e.height);return Cie(Cie({},e),{},{x:r(i),y:o(i),width:s(i),height:u(i)})}if("horizontal"===a){var c=D0(0,e.height)(i);return Cie(Cie({},e),{},{y:e.y+e.height-c,height:c})}var f=D0(0,e.width)(i);return Cie(Cie({},e),{},{width:f})}));return r.createElement(U1,null,e.renderRectanglesStatically(o))}))}},{key:"renderRectangles",value:function(){var e=this.props,t=e.data,n=e.isAnimationActive,r=this.state.prevData;return!(n&&t&&t.length)||r&&b9()(r,t)?this.renderRectanglesStatically(t):this.renderRectanglesWithAnimation()}},{key:"renderBackground",value:function(){var e=this,t=this.props.data,n=E1(this.props.background);return t.map((function(t,r){t.value;var a=t.background,i=kie(t,bie);if(!a)return null;var s=Cie(Cie(Cie(Cie(Cie({},i),{},{fill:"#eee"},a),n),p1(e.props,t,r)),{},{index:r,key:"background-bar-".concat(r),className:"recharts-bar-background-rectangle"});return o.renderRectangle(e.props.background,s)}))}},{key:"renderErrorBar",value:function(e,t){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var n=this.props,a=n.data,i=n.xAxis,o=n.yAxis,s=n.layout,u=I1(n.children,cae);if(!u)return null;var c="vertical"===s?a[0].height/2:a[0].width/2;function l(e,t){return{x:e.x,y:e.y,value:e.value,errorVal:gae(e,t)}}var f={clipPath:e?"url(#clipPath-".concat(t,")"):null};return r.createElement(U1,f,u.map((function(e,t){return r.cloneElement(e,{key:"error-bar-".concat(t),data:a,xAxis:i,yAxis:o,layout:s,offset:c,dataPointFormatter:l})})))}},{key:"render",value:function(){var e=this.props,t=e.hide,n=e.data,a=e.className,i=e.xAxis,o=e.yAxis,s=e.left,u=e.top,c=e.width,l=e.height,f=e.isAnimationActive,h=e.background,d=e.id;if(t||!n||!n.length)return null;var p=this.state.isAnimationFinished,v=c$()("recharts-bar",a),g=i&&i.allowDataOverflow||o&&o.allowDataOverflow,m=t1()(d)?this.id:d;return r.createElement(U1,{className:v},g?r.createElement("defs",null,r.createElement("clipPath",{id:"clipPath-".concat(m)},r.createElement("rect",{x:s,y:u,width:c,height:l}))):null,r.createElement(U1,{className:"recharts-bar-rectangles",clipPath:g?"url(#clipPath-".concat(m,")"):null},h?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(g,m),(!f||p)&&yie.renderCallByParent(this.props,n))}}],a=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curData:e.data,prevData:t.curData}:e.data!==t.curData?{curData:e.data}:null}},{key:"renderRectangle",value:function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):q0()(e)?e(t):r.createElement(X6,t)}}],n&&Aie(t.prototype,n),a&&Aie(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);function Pie(e){return Pie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pie(e)}function Die(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jie(r.key),r)}}function Mie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mie(Object(n),!0).forEach((function(t){Lie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lie(e,t,n){return(t=jie(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jie(e){var t=function(e,t){if("object"!==Pie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Pie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Pie(t)?t:String(t)}Nie(Rie,"displayName","Bar"),Nie(Rie,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",isAnimationActive:!_3.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),Nie(Rie,"getComposedData",(function(e){var t=e.props,n=e.item,r=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,s=e.xAxisTicks,u=e.yAxisTicks,c=e.stackedData,l=e.dataStartIndex,f=e.displayedData,h=e.offset,d=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null}(r,n);if(!d)return null;var p=t.layout,v=n.props,g=v.dataKey,m=v.children,y=v.minPointSize,b="horizontal"===p?o:i,x=c?b.scale.domain():null,k=function(e){var t=e.numericAxis,n=t.scale.domain();if("number"===t.type){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]}({numericAxis:b}),w=I1(m,iie),I=f.map((function(e,t){var r,f,h,v,m,b;if(c?r=function(e,t){if(!t||2!==t.length||!E0(t[0])||!E0(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!E0(e[0])||e[0]<n)&&(a[0]=n),(!E0(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a}(c[l+t],x):(r=gae(e,g),b0()(r)||(r=[k,r])),"horizontal"===p){var I,C=[o.scale(r[0]),o.scale(r[1])],A=C[0],S=C[1];f=Nae({axis:i,ticks:s,bandSize:a,offset:d.offset,entry:e,index:t}),h=null!==(I=null!==S&&void 0!==S?S:A)&&void 0!==I?I:void 0,v=d.size;var _=A-S;if(m=Number.isNaN(_)?0:_,b={x:f,y:o.y,width:v,height:o.height},Math.abs(y)>0&&Math.abs(m)<Math.abs(y)){var E=S0(m||y)*(Math.abs(y)-Math.abs(m));h-=E,m+=E}}else{var T=[i.scale(r[0]),i.scale(r[1])],N=T[0],O=T[1];if(f=N,h=Nae({axis:o,ticks:u,bandSize:a,offset:d.offset,entry:e,index:t}),v=O-N,m=d.size,b={x:i.x,y:h,width:i.width,height:m},Math.abs(y)>0&&Math.abs(v)<Math.abs(y))v+=S0(v||y)*(Math.abs(y)-Math.abs(v))}return Cie(Cie(Cie({},e),{},{x:f,y:h,width:v,height:m,value:c?r:r[1],payload:e,background:b},w&&w[t]&&w[t].props),{},{tooltipPayload:[Lae(n,e)],tooltipPosition:{x:f+v/2,y:h+m/2}})}));return Cie({data:I,layout:p},h)}));var zie=function(e,t){var n=e.x,r=e.y,a=t.x,i=t.y;return{x:Math.min(n,a),y:Math.min(r,i),width:Math.abs(a-n),height:Math.abs(i-r)}},Uie=function(e){var t=e.x1,n=e.y1,r=e.x2,a=e.y2;return zie({x:t,y:n},{x:r,y:a})},Bie=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scale=t}var t,n,r;return t=e,n=[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.bandAware,r=t.position;if(void 0!==e){if(r)switch(r){case"start":default:return this.scale(e);case"middle":var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a;case"end":var i=this.bandwidth?this.bandwidth():0;return this.scale(e)+i}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}},{key:"isInRange",value:function(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}}],r=[{key:"create",value:function(t){return new e(t)}}],n&&Die(t.prototype,n),r&&Die(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();Lie(Bie,"EPS",1e-4);var Wie=function(e){var t=Object.keys(e).reduce((function(t,n){return Fie(Fie({},t),{},Lie({},n,Bie.create(e[n])))}),{});return Fie(Fie({},t),{},{apply:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.bandAware,a=n.position;return aie()(e,(function(e,n){return t[n].apply(e,{bandAware:r,position:a})}))},isInRange:function(e){return V0()(e,(function(e,n){return t[n].isInRange(e)}))}})};function Vie(e){return Vie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vie(e)}function Gie(){return Gie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gie.apply(this,arguments)}function Hie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hie(Object(n),!0).forEach((function(t){qie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qie(e,t,n){return t=function(e){var t=function(e,t){if("object"!==Vie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Vie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Vie(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xie=function(e){var t=e.x,n=e.y,r=e.xAxis,a=e.yAxis,i=Wie({x:r.scale,y:a.scale}),o=i.apply({x:t,y:n},{bandAware:!0});return nie(e,"discard")&&!i.isInRange(o)?null:o};function Yie(e){var t=e.x,n=e.y,a=e.r,i=e.alwaysShow,o=e.clipPathId,s=T0(t),u=T0(n);if(L0(void 0===i,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!s||!u)return null;var c=Xie(e);if(!c)return null;var l=c.x,f=c.y,h=e.shape,d=e.className,p=Kie(Kie({clipPath:nie(e,"hidden")?"url(#".concat(o,")"):void 0},E1(e,!0)),{},{cx:l,cy:f});return r.createElement(U1,{className:c$()("recharts-reference-dot",d)},Yie.renderDot(h,p),W8.renderCallByParent(e,{x:l-a,y:f-a,width:2*a,height:2*a}))}Yie.displayName="ReferenceDot",Yie.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1},Yie.renderDot=function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):q0()(e)?e(t):r.createElement(F6,Gie({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"}))};var Zie=n(4064),Qie=n.n(Zie);function Jie(e){return Jie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jie(e)}var $ie=["isFront","ifOverflow","xAxisId","yAxisId","position","fill","fillOpacity","stroke","strokeWidth"];function eoe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(Wse){c=!0,a=Wse}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return toe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return toe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function toe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function noe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function roe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?noe(Object(n),!0).forEach((function(t){aoe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):noe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function aoe(e,t,n){return t=function(e){var t=function(e,t){if("object"!==Jie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Jie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Jie(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ioe(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function ooe(){return ooe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ooe.apply(this,arguments)}var soe=function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):q0()(e)?e(t):r.createElement("line",ooe({},t,{className:"recharts-reference-line-line"}))},uoe=function(e,t,n,r,a){var i=a.viewBox,o=i.x,s=i.y,u=i.width,c=i.height,l=a.position;if(n){var f=a.y,h=a.yAxis.orientation,d=e.y.apply(f,{position:l});if(nie(a,"discard")&&!e.y.isInRange(d))return null;var p=[{x:o+u,y:d},{x:o,y:d}];return"left"===h?p.reverse():p}if(t){var v=a.x,g=a.xAxis.orientation,m=e.x.apply(v,{position:l});if(nie(a,"discard")&&!e.x.isInRange(m))return null;var y=[{x:m,y:s+c},{x:m,y:s}];return"top"===g?y.reverse():y}if(r){var b=a.segment.map((function(t){return e.apply(t,{position:l})}));return nie(a,"discard")&&Qie()(b,(function(t){return!e.isInRange(t)}))?null:b}return null};function coe(e){var t=e.isFront,n=void 0!==t&&t,a=e.ifOverflow,i=void 0===a?"discard":a,o=e.xAxisId,s=void 0===o?0:o,u=e.yAxisId,c=void 0===u?0:u,l=e.position,f=void 0===l?"middle":l,h=e.fill,d=void 0===h?"none":h,p=e.fillOpacity,v=void 0===p?1:p,g=e.stroke,m=void 0===g?"#ccc":g,y=e.strokeWidth,b=roe({isFront:n,ifOverflow:i,xAxisId:s,yAxisId:c,fill:d,stroke:m,fillOpacity:v,strokeWidth:void 0===y?1:y,position:f},ioe(e,$ie)),x=b.x,k=b.y,w=b.segment,I=b.xAxis,C=b.yAxis,A=b.shape,S=b.className,_=b.alwaysShow,E=b.clipPathId;L0(void 0===_,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var T=Wie({x:I.scale,y:C.scale}),N=T0(x),O=T0(k),R=w&&2===w.length,P=uoe(T,N,O,R,b);if(!P)return null;var D=eoe(P,2),M=D[0],F=M.x,L=M.y,j=D[1],z=j.x,U=j.y,B=roe(roe({clipPath:nie(b,"hidden")?"url(#".concat(E,")"):void 0},E1(b,!0)),{},{x1:F,y1:L,x2:z,y2:U});return r.createElement(U1,{className:c$()("recharts-reference-line",S)},soe(A,B),W8.renderCallByParent(b,Uie({x1:F,y1:L,x2:z,y2:U})))}function loe(e){return loe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},loe(e)}coe.displayName="ReferenceLine";var foe=["isFront","ifOverflow","xAxisId","yAxisId","r","fill","fillOpacity","stroke","strokeWidth"];function hoe(){return hoe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hoe.apply(this,arguments)}function doe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function poe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?doe(Object(n),!0).forEach((function(t){voe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):doe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function voe(e,t,n){return t=function(e){var t=function(e,t){if("object"!==loe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==loe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===loe(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function goe(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var moe=function(e,t,n,r,a){var i=a.x1,o=a.x2,s=a.y1,u=a.y2,c=a.xAxis,l=a.yAxis;if(!c||!l)return null;var f=Wie({x:c.scale,y:l.scale}),h={x:e?f.x.apply(i,{position:"start"}):f.x.rangeMin,y:n?f.y.apply(s,{position:"start"}):f.y.rangeMin},d={x:t?f.x.apply(o,{position:"end"}):f.x.rangeMax,y:r?f.y.apply(u,{position:"end"}):f.y.rangeMax};return!nie(a,"discard")||f.isInRange(h)&&f.isInRange(d)?zie(h,d):null};function yoe(e){var t=e.isFront,n=void 0!==t&&t,a=e.ifOverflow,i=void 0===a?"discard":a,o=e.xAxisId,s=void 0===o?0:o,u=e.yAxisId,c=void 0===u?0:u,l=e.r,f=void 0===l?10:l,h=e.fill,d=void 0===h?"#ccc":h,p=e.fillOpacity,v=void 0===p?.5:p,g=e.stroke,m=void 0===g?"none":g,y=e.strokeWidth,b=poe({isFront:n,ifOverflow:i,xAxisId:s,yAxisId:c,r:f,fill:d,fillOpacity:v,stroke:m,strokeWidth:void 0===y?1:y},goe(e,foe)),x=b.x1,k=b.x2,w=b.y1,I=b.y2,C=b.className,A=b.alwaysShow,S=b.clipPathId;L0(void 0===A,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var _=T0(x),E=T0(k),T=T0(w),N=T0(I),O=b.shape;if(!_&&!E&&!T&&!N&&!O)return null;var R=moe(_,E,T,N,b);if(!R&&!O)return null;var P=nie(b,"hidden")?"url(#".concat(S,")"):void 0;return r.createElement(U1,{className:c$()("recharts-reference-area",C)},yoe.renderRect(O,poe(poe({clipPath:P},E1(b,!0)),R)),W8.renderCallByParent(b,R))}function boe(e){return function(e){if(Array.isArray(e))return xoe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return xoe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xoe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xoe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}yoe.displayName="ReferenceArea",yoe.renderRect=function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):q0()(e)?e(t):r.createElement(X6,hoe({},t,{className:"recharts-reference-area-rect"}))};var koe=function(e,t,n,r,a){var i=I1(e,coe),o=I1(e,Yie),s=[].concat(boe(i),boe(o)),u=I1(e,yoe),c="".concat(r,"Id"),l=r[0],f=t;if(s.length&&(f=s.reduce((function(e,t){if(t.props[c]===n&&nie(t.props,"extendDomain")&&E0(t.props[l])){var r=t.props[l];return[Math.min(e[0],r),Math.max(e[1],r)]}return e}),f)),u.length){var h="".concat(l,"1"),d="".concat(l,"2");f=u.reduce((function(e,t){if(t.props[c]===n&&nie(t.props,"extendDomain")&&E0(t.props[h])&&E0(t.props[d])){var r=t.props[h],a=t.props[d];return[Math.min(e[0],r,a),Math.max(e[1],r,a)]}return e}),f)}return a&&a.length&&(f=a.reduce((function(e,t){return E0(t)?[Math.min(e[0],t),Math.max(e[1],t)]:e}),f)),f},woe=n(7143),Ioe=new(n.n(woe)());Ioe.setMaxListeners&&Ioe.setMaxListeners(10);var Coe="recharts.syncMouseEvents",Aoe=["item"],Soe=["children","className","width","height","style","compact","title","desc"];function _oe(e){return _oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_oe(e)}function Eoe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(Wse){c=!0,a=Wse}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||Loe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Toe(){return Toe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Toe.apply(this,arguments)}function Noe(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Ooe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Woe(r.key),r)}}function Roe(e,t){return Roe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Roe(e,t)}function Poe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Moe(e);if(t){var a=Moe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===_oe(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Doe(e)}(this,n)}}function Doe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Moe(e){return Moe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Moe(e)}function Foe(e){return function(e){if(Array.isArray(e))return joe(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Loe(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Loe(e,t){if(e){if("string"===typeof e)return joe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?joe(e,t):void 0}}function joe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zoe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uoe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zoe(Object(n),!0).forEach((function(t){Boe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zoe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Boe(e,t,n){return(t=Woe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Woe(e){var t=function(e,t){if("object"!==_oe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==_oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===_oe(t)?t:String(t)}var Voe={xAxis:["bottom","top"],yAxis:["left","right"]},Goe={x:0,y:0},Hoe=Number.isFinite?Number.isFinite:isFinite,Koe="function"===typeof requestAnimationFrame?requestAnimationFrame:"function"===typeof setImmediate?setImmediate:setTimeout,qoe="function"===typeof cancelAnimationFrame?cancelAnimationFrame:"function"===typeof clearImmediate?clearImmediate:clearTimeout,Xoe=function(e,t,n){var r=t.graphicalItems,a=t.dataStartIndex,i=t.dataEndIndex,o=(r||[]).reduce((function(e,t){var n=t.props.data;return n&&n.length?[].concat(Foe(e),Foe(n)):e}),[]);return o&&o.length>0?o:n&&n.props&&n.props.data&&n.props.data.length>0?n.props.data:e&&e.length&&E0(a)&&E0(i)?e.slice(a,i+1):[]};function Yoe(e){return"number"===e?[0,"auto"]:void 0}var Zoe=function(e,t,n,r){var a=e.graphicalItems,i=e.tooltipAxis,o=Xoe(t,e);return n<0||!a||!a.length||n>=o.length?null:a.reduce((function(e,t){if(t.props.hide)return e;var a,s=t.props.data;i.dataKey&&!i.allowDuplicatedCategory?a=M0(void 0===s?o:s,i.dataKey,r):a=s&&s[n]||o[n];return a?[].concat(Foe(e),[Lae(t,a)]):e}),[])},Qoe=function(e,t,n,r){var a=r||{x:e.chartX,y:e.chartY},i=function(e,t){return"horizontal"===t?e.x:"vertical"===t?e.y:"centric"===t?e.angle:e.radius}(a,n),o=e.orderedTooltipTicks,s=e.tooltipAxis,u=e.tooltipTicks,c=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,i=-1,o=null!==(t=null===n||void 0===n?void 0:n.length)&&void 0!==t?t:0;if(o<=1)return 0;if(a&&"angleAxis"===a.axisType&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var s=a.range,u=0;u<o;u++){var c=u>0?r[u-1].coordinate:r[o-1].coordinate,l=r[u].coordinate,f=u>=o-1?r[0].coordinate:r[u+1].coordinate,h=void 0;if(S0(l-c)!==S0(f-l)){var d=[];if(S0(f-l)===S0(s[1]-s[0])){h=f;var p=l+s[1]-s[0];d[0]=Math.min(p,(p+c)/2),d[1]=Math.max(p,(p+c)/2)}else{h=c;var v=f+s[1]-s[0];d[0]=Math.min(l,(v+l)/2),d[1]=Math.max(l,(v+l)/2)}var g=[Math.min(l,(h+l)/2),Math.max(l,(h+l)/2)];if(e>g[0]&&e<=g[1]||e>=d[0]&&e<=d[1]){i=r[u].index;break}}else{var m=Math.min(c,f),y=Math.max(c,f);if(e>(m+l)/2&&e<=(y+l)/2){i=r[u].index;break}}}else for(var b=0;b<o;b++)if(0===b&&e<=(n[b].coordinate+n[b+1].coordinate)/2||b>0&&b<o-1&&e>(n[b].coordinate+n[b-1].coordinate)/2&&e<=(n[b].coordinate+n[b+1].coordinate)/2||b===o-1&&e>(n[b].coordinate+n[b-1].coordinate)/2){i=n[b].index;break}return i}(i,o,u,s);if(c>=0&&u){var l=u[c]&&u[c].value,f=Zoe(e,t,c,l),h=function(e,t,n,r){var a=t.find((function(e){return e&&e.index===n}));if(a){if("horizontal"===e)return{x:a.coordinate,y:r.y};if("vertical"===e)return{x:r.x,y:a.coordinate};if("centric"===e){var i=a.coordinate,o=r.radius;return Uoe(Uoe(Uoe({},r),v6(r.cx,r.cy,o,i)),{},{angle:i,radius:o})}var s=a.coordinate,u=r.angle;return Uoe(Uoe(Uoe({},r),v6(r.cx,r.cy,s,u)),{},{angle:u,radius:s})}return Goe}(n,o,c,a);return{activeTooltipIndex:c,activeLabel:l,activePayload:f,activeCoordinate:h}}return null},Joe=function(e,t){var n=t.axes,r=t.graphicalItems,a=t.axisType,i=t.axisIdKey,o=t.stackGroups,s=t.dataStartIndex,u=t.dataEndIndex,c=e.layout,l=e.children,f=e.stackOffset,h=wae(c,a),d=n.reduce((function(t,n){var d,p=n.props,v=p.type,g=p.dataKey,m=p.allowDataOverflow,y=p.allowDuplicatedCategory,b=p.scale,x=p.ticks,k=n.props[i];if(t[k])return t;var w,I,C,A=Xoe(e.data,{graphicalItems:r.filter((function(e){return e.props[i]===k})),dataStartIndex:s,dataEndIndex:u}),S=A.length;(function(e,t,n){if("number"===n&&!0===t&&Array.isArray(e)){var r=null===e||void 0===e?void 0:e[0],a=null===e||void 0===e?void 0:e[1];if(r&&a&&E0(r)&&E0(a))return!0}return!1})(n.props.domain,m,v)&&(w=Dae(n.props.domain,null,m),!h||"number"!==v&&"auto"===b||(C=mae(A,g,"category")));var _=Yoe(v);if(!w||0===w.length){var E,T=null!==(E=n.props.domain)&&void 0!==E?E:_;if(g){if(w=mae(A,g,v),"category"===v&&h){var N=function(e){if(!b0()(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[e[r]])return!0;n[e[r]]=!0}return!1}(w);y&&N?(I=w,w=$0()(0,S)):y||(w=Fae(T,w,n).reduce((function(e,t){return e.indexOf(t)>=0?e:[].concat(Foe(e),[t])}),[]))}else if("category"===v)w=y?w.filter((function(e){return""!==e&&!t1()(e)})):Fae(T,w,n).reduce((function(e,t){return e.indexOf(t)>=0||""===t||t1()(t)?e:[].concat(Foe(e),[t])}),[]);else if("number"===v){var O=function(e,t,n,r,a){var i=t.map((function(t){return xae(e,t,n,a,r)})).filter((function(e){return!t1()(e)}));return i&&i.length?i.reduce((function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}),[1/0,-1/0]):null}(A,r.filter((function(e){return e.props[i]===k&&!e.props.hide})),g,a,c);O&&(w=O)}!h||"number"!==v&&"auto"===b||(C=mae(A,g,"category"))}else w=h?$0()(0,S):o&&o[k]&&o[k].hasStack&&"number"===v?"expand"===f?[0,1]:Oae(o[k].stackGroups,s,u):kae(A,r.filter((function(e){return e.props[i]===k&&!e.props.hide})),v,c,!0);if("number"===v)w=koe(l,w,k,a,x),T&&(w=Dae(T,w,m));else if("category"===v&&T){var R=T;w.every((function(e){return R.indexOf(e)>=0}))&&(w=R)}}return Uoe(Uoe({},t),{},Boe({},k,Uoe(Uoe({},n.props),{},{axisType:a,domain:w,categoricalDomain:C,duplicateDomain:I,originalDomain:null!==(d=n.props.domain)&&void 0!==d?d:_,isCategorical:h,layout:c})))}),{});return d},$oe=function(e,t){var n=t.axisType,r=void 0===n?"xAxis":n,a=t.AxisComp,i=t.graphicalItems,o=t.stackGroups,s=t.dataStartIndex,u=t.dataEndIndex,c=e.children,l="".concat(r,"Id"),f=I1(c,a),h={};return f&&f.length?h=Joe(e,{axes:f,graphicalItems:i,axisType:r,axisIdKey:l,stackGroups:o,dataStartIndex:s,dataEndIndex:u}):i&&i.length&&(h=function(e,t){var n=t.graphicalItems,r=t.Axis,a=t.axisType,i=t.axisIdKey,o=t.stackGroups,s=t.dataStartIndex,u=t.dataEndIndex,c=e.layout,l=e.children,f=Xoe(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:u}),h=f.length,d=wae(c,a),p=-1;return n.reduce((function(e,t){var v,g=t.props[i],m=Yoe("number");return e[g]?e:(p++,d?v=$0()(0,h):o&&o[g]&&o[g].hasStack?(v=Oae(o[g].stackGroups,s,u),v=koe(l,v,g,a)):(v=Dae(m,kae(f,n.filter((function(e){return e.props[i]===g&&!e.props.hide})),"number",c),r.defaultProps.allowDataOverflow),v=koe(l,v,g,a)),Uoe(Uoe({},e),{},Boe({},g,Uoe(Uoe({axisType:a},r.defaultProps),{},{hide:!0,orientation:m0()(Voe,"".concat(a,".").concat(p%2),null),domain:v,originalDomain:m,isCategorical:d,layout:c}))))}),{})}(e,{Axis:a,graphicalItems:i,axisType:r,axisIdKey:l,stackGroups:o,dataStartIndex:s,dataEndIndex:u})),h},ese=function(e){var t,n,r=e.children,a=e.defaultShowTooltip,i=C1(r,tie);return{chartX:0,chartY:0,dataStartIndex:i&&i.props&&i.props.startIndex||0,dataEndIndex:void 0!==(null===i||void 0===i||null===(t=i.props)||void 0===t?void 0:t.endIndex)?null===i||void 0===i||null===(n=i.props)||void 0===n?void 0:n.endIndex:e.data&&e.data.length-1||0,activeTooltipIndex:-1,isTooltipActive:!t1()(a)&&a}},tse=function(e){return"horizontal"===e?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:"vertical"===e?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:"centric"===e?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},nse=function(e,t){var n=e.props,r=(e.graphicalItems,e.xAxisMap),a=void 0===r?{}:r,i=e.yAxisMap,o=void 0===i?{}:i,s=n.width,u=n.height,c=n.children,l=n.margin||{},f=C1(c,tie),h=C1(c,g5),d=Object.keys(o).reduce((function(e,t){var n=o[t],r=n.orientation;return n.mirror||n.hide?e:Uoe(Uoe({},e),{},Boe({},r,e[r]+n.width))}),{left:l.left||0,right:l.right||0}),p=Object.keys(a).reduce((function(e,t){var n=a[t],r=n.orientation;return n.mirror||n.hide?e:Uoe(Uoe({},e),{},Boe({},r,m0()(e,"".concat(r))+n.height))}),{top:l.top||0,bottom:l.bottom||0}),v=Uoe(Uoe({},p),d),g=v.bottom;return f&&(v.bottom+=f.props.height||tie.defaultProps.height),h&&t&&(v=function(e,t,n,r){var a=n.children,i=n.width,o=n.margin,s=i-(o.left||0)-(o.right||0),u=bae({children:a,legendWidth:s}),c=e;if(u){var l=r||{},f=u.align,h=u.verticalAlign,d=u.layout;("vertical"===d||"horizontal"===d&&"middle"===h)&&E0(e[f])&&(c=pae(pae({},e),{},vae({},f,c[f]+(l.width||0)))),("horizontal"===d||"vertical"===d&&"center"===f)&&E0(e[h])&&(c=pae(pae({},e),{},vae({},h,c[h]+(l.height||0))))}return c}(v,0,n,t)),Uoe(Uoe({brushBottom:g},v),{},{width:s-v.left-v.right,height:u-v.top-v.bottom})},rse=["layout","type","stroke","connectNulls","isRange","ref"];function ase(e){return ase="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ase(e)}function ise(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function ose(){return ose=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ose.apply(this,arguments)}function sse(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function use(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sse(Object(n),!0).forEach((function(t){pse(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sse(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cse(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,vse(r.key),r)}}function lse(e,t){return lse=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lse(e,t)}function fse(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dse(e);if(t){var a=dse(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ase(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hse(e)}(this,n)}}function hse(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dse(e){return dse=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dse(e)}function pse(e,t,n){return(t=vse(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vse(e){var t=function(e,t){if("object"!==ase(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ase(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ase(t)?t:String(t)}var gse=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lse(e,t)}(o,e);var t,n,a,i=fse(o);function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pse(hse(e=i.call.apply(i,[this].concat(n))),"state",{isAnimationFinished:!0}),pse(hse(e),"id",O0("recharts-area-")),pse(hse(e),"handleAnimationEnd",(function(){var t=e.props.onAnimationEnd;e.setState({isAnimationFinished:!0}),q0()(t)&&t()})),pse(hse(e),"handleAnimationStart",(function(){var t=e.props.onAnimationStart;e.setState({isAnimationFinished:!1}),q0()(t)&&t()})),e}return t=o,n=[{key:"renderDots",value:function(e,t){var n=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(n&&!a)return null;var i=this.props,s=i.dot,u=i.points,c=i.dataKey,l=E1(this.props),f=E1(s,!0),h=u.map((function(e,t){var n=use(use(use({key:"dot-".concat(t),r:3},l),f),{},{dataKey:c,cx:e.x,cy:e.y,index:t,value:e.value,payload:e.payload});return o.renderDotItem(s,n)})),d={clipPath:e?"url(#clipPath-".concat(t,")"):null};return r.createElement(U1,ose({className:"recharts-area-dots"},d),h)}},{key:"renderHorizontalRect",value:function(e){var t=this.props,n=t.baseLine,a=t.points,i=t.strokeWidth,o=a[0].x,s=a[a.length-1].x,u=e*Math.abs(o-s),c=k9()(a.map((function(e){return e.y||0})));return E0(n)&&"number"===typeof n?c=Math.max(n,c):n&&b0()(n)&&n.length&&(c=Math.max(k9()(n.map((function(e){return e.y||0}))),c)),E0(c)?r.createElement("rect",{x:o<s?o:o-u,y:0,width:u,height:Math.floor(c+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(e){var t=this.props,n=t.baseLine,a=t.points,i=t.strokeWidth,o=a[0].y,s=a[a.length-1].y,u=e*Math.abs(o-s),c=k9()(a.map((function(e){return e.x||0})));return E0(n)&&"number"===typeof n?c=Math.max(n,c):n&&b0()(n)&&n.length&&(c=Math.max(k9()(n.map((function(e){return e.x||0}))),c)),E0(c)?r.createElement("rect",{x:0,y:o<s?o:o-u,width:c+(i?parseInt("".concat(i),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(e){return"vertical"===this.props.layout?this.renderVerticalRect(e):this.renderHorizontalRect(e)}},{key:"renderAreaStatically",value:function(e,t,n,a){var i=this.props,o=i.layout,s=i.type,u=i.stroke,c=i.connectNulls,l=i.isRange,f=(i.ref,ise(i,rse));return r.createElement(U1,{clipPath:n?"url(#clipPath-".concat(a,")"):null},r.createElement(e6,ose({},E1(f,!0),{points:e,connectNulls:c,type:s,baseLine:t,layout:o,stroke:"none",className:"recharts-area-area"})),"none"!==u&&r.createElement(e6,ose({},E1(this.props),{className:"recharts-area-curve",layout:o,type:s,connectNulls:c,fill:"none",points:e})),"none"!==u&&l&&r.createElement(e6,ose({},E1(this.props),{className:"recharts-area-curve",layout:o,type:s,connectNulls:c,fill:"none",points:t})))}},{key:"renderAreaWithAnimation",value:function(e,t){var n=this,a=this.props,i=a.points,o=a.baseLine,s=a.isAnimationActive,u=a.animationBegin,c=a.animationDuration,l=a.animationEasing,f=a.animationId,h=this.state,d=h.prevPoints,p=h.prevBaseLine;return r.createElement(d3,{begin:u,duration:c,isActive:s,easing:l,from:{t:0},to:{t:1},key:"area-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},(function(a){var s=a.t;if(d){var u,c=d.length/i.length,l=i.map((function(e,t){var n=Math.floor(t*c);if(d[n]){var r=d[n],a=D0(r.x,e.x),i=D0(r.y,e.y);return use(use({},e),{},{x:a(s),y:i(s)})}return e}));return u=E0(o)&&"number"===typeof o?D0(p,o)(s):t1()(o)||k0()(o)?D0(p,0)(s):o.map((function(e,t){var n=Math.floor(t*c);if(p[n]){var r=p[n],a=D0(r.x,e.x),i=D0(r.y,e.y);return use(use({},e),{},{x:a(s),y:i(s)})}return e})),n.renderAreaStatically(l,u,e,t)}return r.createElement(U1,null,r.createElement("defs",null,r.createElement("clipPath",{id:"animationClipPath-".concat(t)},n.renderClipRect(s))),r.createElement(U1,{clipPath:"url(#animationClipPath-".concat(t,")")},n.renderAreaStatically(i,o,e,t)))}))}},{key:"renderArea",value:function(e,t){var n=this.props,r=n.points,a=n.baseLine,i=n.isAnimationActive,o=this.state,s=o.prevPoints,u=o.prevBaseLine,c=o.totalLength;return i&&r&&r.length&&(!s&&c>0||!b9()(s,r)||!b9()(u,a))?this.renderAreaWithAnimation(e,t):this.renderAreaStatically(r,a,e,t)}},{key:"render",value:function(){var e=this.props,t=e.hide,n=e.dot,a=e.points,i=e.className,o=e.top,s=e.left,u=e.xAxis,c=e.yAxis,l=e.width,f=e.height,h=e.isAnimationActive,d=e.id;if(t||!a||!a.length)return null;var p=this.state.isAnimationFinished,v=1===a.length,g=c$()("recharts-area",i),m=u&&u.allowDataOverflow||c&&c.allowDataOverflow,y=t1()(d)?this.id:d;return r.createElement(U1,{className:g},m?r.createElement("defs",null,r.createElement("clipPath",{id:"clipPath-".concat(y)},r.createElement("rect",{x:s,y:o,width:l,height:Math.floor(f)}))):null,v?null:this.renderArea(m,y),(n||v)&&this.renderDots(m,y),(!h||p)&&yie.renderCallByParent(this.props,a))}}],a=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,curBaseLine:e.baseLine,prevPoints:t.curPoints,prevBaseLine:t.curBaseLine}:e.points!==t.curPoints||e.baseLine!==t.curBaseLine?{curPoints:e.points,curBaseLine:e.baseLine}:null}}],n&&cse(t.prototype,n),a&&cse(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o}(r.PureComponent);pse(gse,"displayName","Area"),pse(gse,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!_3.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"}),pse(gse,"getBaseValue",(function(e,t,n,r){var a=e.layout,i=e.baseValue,o=t.props.baseValue,s=null!==o&&void 0!==o?o:i;if(E0(s)&&"number"===typeof s)return s;var u="horizontal"===a?r:n,c=u.scale.domain();if("number"===u.type){var l=Math.max(c[0],c[1]),f=Math.min(c[0],c[1]);return"dataMin"===s?f:"dataMax"===s||l<0?l:Math.max(Math.min(c[0],c[1]),0)}return"dataMin"===s?c[0]:"dataMax"===s?c[1]:c[0]})),pse(gse,"getComposedData",(function(e){var t,n=e.props,r=e.item,a=e.xAxis,i=e.yAxis,o=e.xAxisTicks,s=e.yAxisTicks,u=e.bandSize,c=e.dataKey,l=e.stackedData,f=e.dataStartIndex,h=e.displayedData,d=e.offset,p=n.layout,v=l&&l.length,g=gse.getBaseValue(n,r,a,i),m=!1,y=h.map((function(e,t){var n,r=gae(e,c);v?n=l[f+t]:(n=r,b0()(n)?m=!0:n=[g,n]);var h=t1()(n[1])||v&&t1()(r);return"horizontal"===p?{x:Tae({axis:a,ticks:o,bandSize:u,entry:e,index:t}),y:h?null:i.scale(n[1]),value:n,payload:e}:{x:h?null:a.scale(n[1]),y:Tae({axis:i,ticks:s,bandSize:u,entry:e,index:t}),value:n,payload:e}}));return t=v||m?y.map((function(e){return"horizontal"===p?{x:e.x,y:t1()(m0()(e,"value[0]"))||t1()(m0()(e,"y"))?null:i.scale(m0()(e,"value[0]"))}:{x:t1()(m0()(e,"value[0]"))?null:a.scale(m0()(e,"value[0]")),y:e.y}})):"horizontal"===p?i.scale(g):a.scale(g),use({points:y,baseLine:t,layout:p,isRange:m},d)})),pse(gse,"renderDotItem",(function(e,t){return r.isValidElement(e)?r.cloneElement(e,t):q0()(e)?e(t):r.createElement(F6,ose({},t,{className:"recharts-area-dot"}))}));var mse=function(){return null};mse.displayName="XAxis",mse.defaultProps={allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0};var yse=function(){return null};yse.displayName="YAxis",yse.defaultProps={allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1};var bse=function(e){var t,n=e.chartName,a=e.GraphicalChild,i=e.defaultTooltipEventType,o=void 0===i?"axis":i,s=e.validateTooltipEventTypes,u=void 0===s?["axis"]:s,c=e.axisComponents,l=e.legendContent,f=e.formatAxisMap,h=e.defaultProps,d=function(e,t){var n=t.graphicalItems,r=t.stackGroups,a=t.offset,i=t.updateId,o=t.dataStartIndex,s=t.dataEndIndex,u=e.barSize,l=e.layout,f=e.barGap,h=e.barCategoryGap,d=e.maxBarSize,p=tse(l),v=p.numericAxisName,g=p.cateAxisName,m=function(e){return!(!e||!e.length)&&e.some((function(e){var t=b1(e&&e.type);return t&&t.indexOf("Bar")>=0}))}(n),y=m&&function(e){var t=e.barSize,n=e.stackGroups,r=void 0===n?{}:n;if(!r)return{};for(var a={},i=Object.keys(r),o=0,s=i.length;o<s;o++)for(var u=r[i[o]].stackGroups,c=Object.keys(u),l=0,f=c.length;l<f;l++){var h=u[c[l]],d=h.items,p=h.cateAxisId,v=d.filter((function(e){return b1(e.type).indexOf("Bar")>=0}));if(v&&v.length){var g=v[0].props.barSize,m=v[0].props[p];a[m]||(a[m]=[]),a[m].push({item:v[0],stackList:v.slice(1),barSize:t1()(g)?t:g})}}return a}({barSize:u,stackGroups:r}),b=[];return n.forEach((function(n,u){var p=Xoe(e.data,{dataStartIndex:o,dataEndIndex:s},n),m=n.props,x=m.dataKey,k=m.maxBarSize,w=n.props["".concat(v,"Id")],I=n.props["".concat(g,"Id")],C=c.reduce((function(e,r){var a,i=t["".concat(r.axisType,"Map")],o=n.props["".concat(r.axisType,"Id")],s=i&&i[o];return Uoe(Uoe({},e),{},(Boe(a={},r.axisType,s),Boe(a,"".concat(r.axisType,"Ticks"),Cae(s)),a))}),{}),A=C[g],S=C["".concat(g,"Ticks")],_=r&&r[w]&&r[w].hasStack&&function(e,t){var n=e.props.stackId;if(T0(n)){var r=t[n];if(r&&r.items.length){for(var a=-1,i=0,o=r.items.length;i<o;i++)if(r.items[i]===e){a=i;break}return a>=0?r.stackedData[a]:null}}return null}(n,r[w].stackGroups),E=b1(n.type).indexOf("Bar")>=0,T=Mae(A,S),N=[];if(E){var O,R,P=t1()(k)?d:k,D=null!==(O=null!==(R=Mae(A,S,!0))&&void 0!==R?R:P)&&void 0!==O?O:0;N=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,a=e.sizeList,i=void 0===a?[]:a,o=e.maxBarSize,s=i.length;if(s<1)return null;var u,c=R0(t,r,0,!0);if(i[0].barSize===+i[0].barSize){var l=!1,f=r/s,h=i.reduce((function(e,t){return e+t.barSize||0}),0);(h+=(s-1)*c)>=r&&(h-=(s-1)*c,c=0),h>=r&&f>0&&(l=!0,h=s*(f*=.9));var d={offset:((r-h)/2>>0)-c,size:0};u=i.reduce((function(e,t){var n=[].concat(fae(e),[{item:t.item,position:{offset:d.offset+d.size+c,size:l?f:t.barSize}}]);return d=n[n.length-1].position,t.stackList&&t.stackList.length&&t.stackList.forEach((function(e){n.push({item:e,position:d})})),n}),[])}else{var p=R0(n,r,0,!0);r-2*p-(s-1)*c<=0&&(c=0);var v=(r-2*p-(s-1)*c)/s;v>1&&(v>>=0);var g=o===+o?Math.min(v,o):v;u=i.reduce((function(e,t,n){var r=[].concat(fae(e),[{item:t.item,position:{offset:p+(v+c)*n+(v-g)/2,size:g}}]);return t.stackList&&t.stackList.length&&t.stackList.forEach((function(e){r.push({item:e,position:r[r.length-1].position})})),r}),[])}return u}({barGap:f,barCategoryGap:h,bandSize:D!==T?D:T,sizeList:y[I],maxBarSize:P}),D!==T&&(N=N.map((function(e){return Uoe(Uoe({},e),{},{position:Uoe(Uoe({},e.position),{},{offset:e.position.offset-D/2})})})))}var M,F,L,j=n&&n.type&&n.type.getComposedData;j&&b.push({props:Uoe(Uoe({},j(Uoe(Uoe({},C),{},{displayedData:p,props:e,dataKey:x,item:n,bandSize:T,barPosition:N,offset:a,stackedData:_,layout:l,dataStartIndex:o,dataEndIndex:s}))),{},(M={key:n.key||"item-".concat(u)},Boe(M,v,C[v]),Boe(M,g,C[g]),Boe(M,"animationId",i),M)),childIndex:(F=n,L=e.children,w1(L).indexOf(F)),item:n})})),b},p=function(e,t){var r=e.props,i=e.dataStartIndex,o=e.dataEndIndex,s=e.updateId;if(!A1({props:r}))return null;var u=r.children,l=r.layout,h=r.stackOffset,p=r.data,v=r.reverseStackOrder,g=tse(l),m=g.numericAxisName,y=g.cateAxisName,b=I1(u,a),x=function(e,t,n,r,a,i){if(!e)return null;var o=(i?t.reverse():t).reduce((function(e,t){var a=t.props,i=a.stackId;if(a.hide)return e;var o=t.props[n],s=e[o]||{hasStack:!1,stackGroups:{}};if(T0(i)){var u=s.stackGroups[i]||{numericAxisId:n,cateAxisId:r,items:[]};u.items.push(t),s.hasStack=!0,s.stackGroups[i]=u}else s.stackGroups[O0("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[t]};return pae(pae({},e),{},vae({},o,s))}),{});return Object.keys(o).reduce((function(t,i){var s=o[i];return s.hasStack&&(s.stackGroups=Object.keys(s.stackGroups).reduce((function(t,i){var o=s.stackGroups[i];return pae(pae({},t),{},vae({},i,{numericAxisId:n,cateAxisId:r,items:o.items,stackedData:Eae(e,o.items,a)}))}),{})),pae(pae({},t),{},vae({},i,s))}),{})}(p,b,"".concat(m,"Id"),"".concat(y,"Id"),h,v),k=c.reduce((function(e,t){var n="".concat(t.axisType,"Map");return Uoe(Uoe({},e),{},Boe({},n,$oe(r,Uoe(Uoe({},t),{},{graphicalItems:b,stackGroups:t.axisType===m&&x,dataStartIndex:i,dataEndIndex:o}))))}),{}),w=nse(Uoe(Uoe({},k),{},{props:r,graphicalItems:b}),null===t||void 0===t?void 0:t.legendBBox);Object.keys(k).forEach((function(e){k[e]=f(r,k[e],w,e.replace("Map",""),n)}));var I=function(e){var t=P0(e),n=Cae(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:Q0()(n,(function(e){return e.coordinate})),tooltipAxis:t,tooltipAxisBandSize:Mae(t,n)}}(k["".concat(y,"Map")]),C=d(r,Uoe(Uoe({},k),{},{dataStartIndex:i,dataEndIndex:o,updateId:s,graphicalItems:b,stackGroups:x,offset:w}));return Uoe(Uoe({formattedGraphicalItems:C,graphicalItems:b,offset:w,stackGroups:x},I),k)};return t=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Roe(e,t)}(c,e);var t,a,i,s=Poe(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),Boe(Doe(t=s.call(this,e)),"clearDeferId",(function(){!t1()(t.deferId)&&qoe&&qoe(t.deferId),t.deferId=null})),Boe(Doe(t),"handleLegendBBoxUpdate",(function(e){if(e){var n=t.state,r=n.dataStartIndex,a=n.dataEndIndex,i=n.updateId;t.setState(Uoe({legendBBox:e},p({props:t.props,dataStartIndex:r,dataEndIndex:a,updateId:i},Uoe(Uoe({},t.state),{},{legendBBox:e}))))}})),Boe(Doe(t),"handleReceiveSyncEvent",(function(e,n,r){t.props.syncId===e&&n!==t.uniqueChartId&&(t.clearDeferId(),t.deferId=Koe&&Koe(t.applySyncEvent.bind(Doe(t),r)))})),Boe(Doe(t),"handleBrushChange",(function(e){var n=e.startIndex,r=e.endIndex;if(n!==t.state.dataStartIndex||r!==t.state.dataEndIndex){var a=t.state.updateId;t.setState((function(){return Uoe({dataStartIndex:n,dataEndIndex:r},p({props:t.props,dataStartIndex:n,dataEndIndex:r,updateId:a},t.state))})),t.triggerSyncEvent({dataStartIndex:n,dataEndIndex:r})}})),Boe(Doe(t),"handleMouseEnter",(function(e){var n=t.props.onMouseEnter,r=t.getMouseInfo(e);if(r){var a=Uoe(Uoe({},r),{},{isTooltipActive:!0});t.setState(a),t.triggerSyncEvent(a),q0()(n)&&n(a,e)}})),Boe(Doe(t),"triggeredAfterMouseMove",(function(e){var n=t.props.onMouseMove,r=t.getMouseInfo(e),a=r?Uoe(Uoe({},r),{},{isTooltipActive:!0}):{isTooltipActive:!1};t.setState(a),t.triggerSyncEvent(a),q0()(n)&&n(a,e)})),Boe(Doe(t),"handleItemMouseEnter",(function(e){t.setState((function(){return{isTooltipActive:!0,activeItem:e,activePayload:e.tooltipPayload,activeCoordinate:e.tooltipPosition||{x:e.cx,y:e.cy}}}))})),Boe(Doe(t),"handleItemMouseLeave",(function(){t.setState((function(){return{isTooltipActive:!1}}))})),Boe(Doe(t),"handleMouseMove",(function(e){e&&q0()(e.persist)&&e.persist(),t.triggeredAfterMouseMove(e)})),Boe(Doe(t),"handleMouseLeave",(function(e){var n=t.props.onMouseLeave,r={isTooltipActive:!1};t.setState(r),t.triggerSyncEvent(r),q0()(n)&&n(r,e),t.cancelThrottledTriggerAfterMouseMove()})),Boe(Doe(t),"handleOuterEvent",(function(e){var n=R1(e),r=m0()(t.props,"".concat(n));n&&q0()(r)&&r(/.*touch.*/i.test(n)?t.getMouseInfo(e.changedTouches[0]):t.getMouseInfo(e),e)})),Boe(Doe(t),"handleClick",(function(e){var n=t.props.onClick,r=t.getMouseInfo(e);if(r){var a=Uoe(Uoe({},r),{},{isTooltipActive:!0});t.setState(a),t.triggerSyncEvent(a),q0()(n)&&n(a,e)}})),Boe(Doe(t),"handleMouseDown",(function(e){var n=t.props.onMouseDown;q0()(n)&&n(t.getMouseInfo(e),e)})),Boe(Doe(t),"handleMouseUp",(function(e){var n=t.props.onMouseUp;q0()(n)&&n(t.getMouseInfo(e),e)})),Boe(Doe(t),"handleTouchMove",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&t.handleMouseMove(e.changedTouches[0])})),Boe(Doe(t),"handleTouchStart",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&t.handleMouseDown(e.changedTouches[0])})),Boe(Doe(t),"handleTouchEnd",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&t.handleMouseUp(e.changedTouches[0])})),Boe(Doe(t),"verticalCoordinatesGenerator",(function(e){var t=e.xAxis,n=e.width,r=e.height,a=e.offset;return Iae(i9.getTicks(Uoe(Uoe(Uoe({},i9.defaultProps),t),{},{ticks:Cae(t,!0),viewBox:{x:0,y:0,width:n,height:r}})),a.left,a.left+a.width)})),Boe(Doe(t),"horizontalCoordinatesGenerator",(function(e){var t=e.yAxis,n=e.width,r=e.height,a=e.offset;return Iae(i9.getTicks(Uoe(Uoe(Uoe({},i9.defaultProps),t),{},{ticks:Cae(t,!0),viewBox:{x:0,y:0,width:n,height:r}})),a.top,a.top+a.height)})),Boe(Doe(t),"axesTicksGenerator",(function(e){return Cae(e,!0)})),Boe(Doe(t),"renderCursor",(function(e){var a=t.state,i=a.isTooltipActive,o=a.activeCoordinate,s=a.activePayload,u=a.offset,c=a.activeTooltipIndex,l=t.getTooltipEventType();if(!e||!e.props.cursor||!i||!o||"ScatterChart"!==n&&"axis"!==l)return null;var f,h=t.props.layout,d=e6;if("ScatterChart"===n)f=o,d=u6;else if("BarChart"===n)f=t.getCursorRectangle(),d=X6;else if("radial"===h){var p=t.getCursorPoints(),v=p.cx,g=p.cy,m=p.radius;f={cx:v,cy:g,startAngle:p.startAngle,endAngle:p.endAngle,innerRadius:m,outerRadius:m},d=E6}else f={points:t.getCursorPoints()},d=e6;var y=e.key||"_recharts-cursor",b=Uoe(Uoe(Uoe(Uoe({stroke:"#ccc",pointerEvents:"none"},u),f),E1(e.props.cursor)),{},{payload:s,payloadIndex:c,key:y,className:"recharts-tooltip-cursor"});return(0,r.isValidElement)(e.props.cursor)?(0,r.cloneElement)(e.props.cursor,b):(0,r.createElement)(d,b)})),Boe(Doe(t),"renderPolarAxis",(function(e,n,a){var i=m0()(e,"type.axisType"),o=m0()(t.state,"".concat(i,"Map")),s=o&&o[e.props["".concat(i,"Id")]];return(0,r.cloneElement)(e,Uoe(Uoe({},s),{},{className:i,key:e.key||"".concat(n,"-").concat(a),ticks:Cae(s,!0)}))})),Boe(Doe(t),"renderXAxis",(function(e,n,r){var a=t.state.xAxisMap[e.props.xAxisId];return t.renderAxis(a,e,n,r)})),Boe(Doe(t),"renderYAxis",(function(e,n,r){var a=t.state.yAxisMap[e.props.yAxisId];return t.renderAxis(a,e,n,r)})),Boe(Doe(t),"renderGrid",(function(e){var n=t.state,a=n.xAxisMap,i=n.yAxisMap,o=n.offset,s=t.props,u=s.width,c=s.height,l=P0(a),f=H0()(i,(function(e){return V0()(e.domain,Hoe)}))||P0(i),h=e.props||{};return(0,r.cloneElement)(e,{key:e.key||"grid",x:E0(h.x)?h.x:o.left,y:E0(h.y)?h.y:o.top,width:E0(h.width)?h.width:o.width,height:E0(h.height)?h.height:o.height,xAxis:l,yAxis:f,offset:o,chartWidth:u,chartHeight:c,verticalCoordinatesGenerator:h.verticalCoordinatesGenerator||t.verticalCoordinatesGenerator,horizontalCoordinatesGenerator:h.horizontalCoordinatesGenerator||t.horizontalCoordinatesGenerator})})),Boe(Doe(t),"renderPolarGrid",(function(e){var n=e.props,a=n.radialLines,i=n.polarAngles,o=n.polarRadius,s=t.state,u=s.radiusAxisMap,c=s.angleAxisMap,l=P0(u),f=P0(c),h=f.cx,d=f.cy,p=f.innerRadius,v=f.outerRadius;return(0,r.cloneElement)(e,{polarAngles:b0()(i)?i:Cae(f,!0).map((function(e){return e.coordinate})),polarRadius:b0()(o)?o:Cae(l,!0).map((function(e){return e.coordinate})),cx:h,cy:d,innerRadius:p,outerRadius:v,key:e.key||"polar-grid",radialLines:a})})),Boe(Doe(t),"renderLegend",(function(){var e=t.state.formattedGraphicalItems,n=t.props,a=n.children,i=n.width,o=n.height,s=t.props.margin||{},u=i-(s.left||0)-(s.right||0),c=bae({children:a,formattedGraphicalItems:e,legendWidth:u,legendContent:l});if(!c)return null;var f=c.item,h=Noe(c,Aoe);return(0,r.cloneElement)(f,Uoe(Uoe({},h),{},{chartWidth:i,chartHeight:o,margin:s,ref:function(e){t.legendInstance=e},onBBoxUpdate:t.handleLegendBBoxUpdate}))})),Boe(Doe(t),"renderTooltip",(function(){var e=C1(t.props.children,U3);if(!e)return null;var n=t.state,a=n.isTooltipActive,i=n.activeCoordinate,o=n.activePayload,s=n.activeLabel,u=n.offset;return(0,r.cloneElement)(e,{viewBox:Uoe(Uoe({},u),{},{x:u.left,y:u.top}),active:a,label:s,payload:a?o:[],coordinate:i})})),Boe(Doe(t),"renderBrush",(function(e){var n=t.props,a=n.margin,i=n.data,o=t.state,s=o.offset,u=o.dataStartIndex,c=o.dataEndIndex,l=o.updateId;return(0,r.cloneElement)(e,{key:e.key||"_recharts-brush",onChange:Aae(t.handleBrushChange,null,e.props.onChange),data:i,x:E0(e.props.x)?e.props.x:s.left,y:E0(e.props.y)?e.props.y:s.top+s.height+s.brushBottom-(a.bottom||0),width:E0(e.props.width)?e.props.width:s.width,startIndex:u,endIndex:c,updateId:"brush-".concat(l)})})),Boe(Doe(t),"renderReferenceElement",(function(e,n,a){if(!e)return null;var i=Doe(t).clipPathId,o=t.state,s=o.xAxisMap,u=o.yAxisMap,c=o.offset,l=e.props,f=l.xAxisId,h=l.yAxisId;return(0,r.cloneElement)(e,{key:e.key||"".concat(n,"-").concat(a),xAxis:s[null!==f&&void 0!==f?f:0],yAxis:u[null!==h&&void 0!==h?h:0],viewBox:{x:c.left,y:c.top,width:c.width,height:c.height},clipPathId:i})})),Boe(Doe(t),"renderActivePoints",(function(e){var t=e.item,n=e.activePoint,r=e.basePoint,a=e.childIndex,i=e.isRange,o=[],s=t.props.key,u=t.item.props,l=u.activeDot,f=Uoe(Uoe({index:a,dataKey:u.dataKey,cx:n.x,cy:n.y,r:4,fill:yae(t.item),strokeWidth:2,stroke:"#fff",payload:n.payload,value:n.value,key:"".concat(s,"-activePoint-").concat(a)},E1(l)),d1(l));return o.push(c.renderActiveDot(l,f)),r?o.push(c.renderActiveDot(l,Uoe(Uoe({},f),{},{cx:r.x,cy:r.y,key:"".concat(s,"-basePoint-").concat(a)}))):i&&o.push(null),o})),Boe(Doe(t),"renderGraphicChild",(function(e,n,a){var i=t.filterFormatItem(e,n,a);if(!i)return null;var o=t.getTooltipEventType(),s=t.state,u=s.isTooltipActive,c=s.tooltipAxis,l=s.activeTooltipIndex,f=s.activeLabel,h=C1(t.props.children,U3),d=i.props,p=d.points,v=d.isRange,g=d.baseLine,m=i.item.props,y=m.activeDot,b=!m.hide&&u&&h&&y&&l>=0,x={};"axis"!==o&&h&&"click"===h.props.trigger?x={onClick:Aae(t.handleItemMouseEnter,null,e.props.onCLick)}:"axis"!==o&&(x={onMouseLeave:Aae(t.handleItemMouseLeave,null,e.props.onMouseLeave),onMouseEnter:Aae(t.handleItemMouseEnter,null,e.props.onMouseEnter)});var k=(0,r.cloneElement)(e,Uoe(Uoe({},i.props),x));if(b){var w,I;if(c.dataKey&&!c.allowDuplicatedCategory){var C="function"===typeof c.dataKey?function(e){return"function"===typeof c.dataKey?c.dataKey(e.payload):null}:"payload.".concat(c.dataKey.toString());w=M0(p,C,f),I=v&&g&&M0(g,C,f)}else w=p[l],I=v&&g&&g[l];if(!t1()(w))return[k].concat(Foe(t.renderActivePoints({item:i,activePoint:w,basePoint:I,childIndex:l,isRange:v})))}return v?[k,null,null]:[k,null]})),Boe(Doe(t),"renderCustomized",(function(e,n,a){return(0,r.cloneElement)(e,Uoe(Uoe({key:"recharts-customized-".concat(a)},t.props),t.state))})),t.uniqueChartId=t1()(e.id)?O0("recharts"):e.id,t.clipPathId="".concat(t.uniqueChartId,"-clip"),e.throttleDelay&&(t.triggeredAfterMouseMove=Y0()(t.triggeredAfterMouseMove,e.throttleDelay)),t.state={},t}return t=c,a=[{key:"componentDidMount",value:function(){t1()(this.props.syncId)||this.addListener()}},{key:"componentDidUpdate",value:function(e){t1()(e.syncId)&&!t1()(this.props.syncId)&&this.addListener(),!t1()(e.syncId)&&t1()(this.props.syncId)&&this.removeListener()}},{key:"componentWillUnmount",value:function(){this.clearDeferId(),t1()(this.props.syncId)||this.removeListener(),this.cancelThrottledTriggerAfterMouseMove()}},{key:"cancelThrottledTriggerAfterMouseMove",value:function(){"function"===typeof this.triggeredAfterMouseMove.cancel&&this.triggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var e=C1(this.props.children,U3);if(e&&r1()(e.props.shared)){var t=e.props.shared?"axis":"item";return u.indexOf(t)>=0?t:o}return o}},{key:"getMouseInfo",value:function(e){if(!this.container)return null;var t=function(e,t){return{chartX:Math.round(e.pageX-t.left),chartY:Math.round(e.pageY-t.top)}}(e,function(e){var t=e.ownerDocument.documentElement,n={top:0,left:0};return"undefined"!==typeof e.getBoundingClientRect&&(n=e.getBoundingClientRect()),{top:n.top+window.pageYOffset-t.clientTop,left:n.left+window.pageXOffset-t.clientLeft}}(this.container)),n=this.inRange(t.chartX,t.chartY);if(!n)return null;var r=this.state,a=r.xAxisMap,i=r.yAxisMap;if("axis"!==this.getTooltipEventType()&&a&&i){var o=P0(a).scale,s=P0(i).scale,u=o&&o.invert?o.invert(t.chartX):null,c=s&&s.invert?s.invert(t.chartY):null;return Uoe(Uoe({},t),{},{xValue:u,yValue:c})}var l=Qoe(this.state,this.props.data,this.props.layout,n);return l?Uoe(Uoe({},t),l):null}},{key:"getCursorRectangle",value:function(){var e=this.props.layout,t=this.state,n=t.activeCoordinate,r=t.offset,a=t.tooltipAxisBandSize,i=a/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?n.x-i:r.left+.5,y:"horizontal"===e?r.top+.5:n.y-i,width:"horizontal"===e?a:r.width-1,height:"horizontal"===e?r.height-1:a}}},{key:"getCursorPoints",value:function(){var e,t,n,r,a=this.props.layout,i=this.state,o=i.activeCoordinate,s=i.offset;if("horizontal"===a)n=e=o.x,t=s.top,r=s.top+s.height;else if("vertical"===a)r=t=o.y,e=s.left,n=s.left+s.width;else if(!t1()(o.cx)||!t1()(o.cy)){if("centric"!==a){var u=o.cx,c=o.cy,l=o.radius,f=o.startAngle,h=o.endAngle;return{points:[v6(u,c,l,f),v6(u,c,l,h)],cx:u,cy:c,radius:l,startAngle:f,endAngle:h}}var d=o.cx,p=o.cy,v=o.innerRadius,g=o.outerRadius,m=o.angle,y=v6(d,p,v,m),b=v6(d,p,g,m);e=y.x,t=y.y,n=b.x,r=b.y}return[{x:e,y:t},{x:n,y:r}]}},{key:"inRange",value:function(e,t){var n=this.props.layout;if("horizontal"===n||"vertical"===n){var r=this.state.offset;return e>=r.left&&e<=r.left+r.width&&t>=r.top&&t<=r.top+r.height?{x:e,y:t}:null}var a=this.state,i=a.angleAxisMap,o=a.radiusAxisMap;if(i&&o){var s=P0(i);return y6({x:e,y:t},s)}return null}},{key:"parseEventsOfWrapper",value:function(){var e=this.props.children,t=this.getTooltipEventType(),n=C1(e,U3),r={};return n&&"axis"===t&&(r="click"===n.props.trigger?{onClick:this.handleClick}:{onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd}),Uoe(Uoe({},d1(this.props,this.handleOuterEvent)),r)}},{key:"addListener",value:function(){Ioe.on(Coe,this.handleReceiveSyncEvent),Ioe.setMaxListeners&&Ioe._maxListeners&&Ioe.setMaxListeners(Ioe._maxListeners+1)}},{key:"removeListener",value:function(){Ioe.removeListener(Coe,this.handleReceiveSyncEvent),Ioe.setMaxListeners&&Ioe._maxListeners&&Ioe.setMaxListeners(Ioe._maxListeners-1)}},{key:"triggerSyncEvent",value:function(e){var t=this.props.syncId;t1()(t)||Ioe.emit(Coe,t,this.uniqueChartId,e)}},{key:"applySyncEvent",value:function(e){var t=this.props,n=t.layout,r=t.syncMethod,a=this.state.updateId,i=e.dataStartIndex,o=e.dataEndIndex;if(t1()(e.dataStartIndex)&&t1()(e.dataEndIndex))if(t1()(e.activeTooltipIndex))this.setState(e);else{var s=e.chartX,u=e.chartY,c=e.activeTooltipIndex,l=this.state,f=l.offset,h=l.tooltipTicks;if(!f)return;if("function"===typeof r)c=r(h,e);else if("value"===r){c=-1;for(var d=0;d<h.length;d++)if(h[d].value===e.activeLabel){c=d;break}}var v=Uoe(Uoe({},f),{},{x:f.left,y:f.top}),g=Math.min(s,v.x+v.width),m=Math.min(u,v.y+v.height),y=h[c]&&h[c].value,b=Zoe(this.state,this.props.data,c),x=h[c]?{x:"horizontal"===n?h[c].coordinate:g,y:"horizontal"===n?m:h[c].coordinate}:Goe;this.setState(Uoe(Uoe({},e),{},{activeLabel:y,activeCoordinate:x,activePayload:b,activeTooltipIndex:c}))}else this.setState(Uoe({dataStartIndex:i,dataEndIndex:o},p({props:this.props,dataStartIndex:i,dataEndIndex:o,updateId:a},this.state)))}},{key:"filterFormatItem",value:function(e,t,n){for(var r=this.state.formattedGraphicalItems,a=0,i=r.length;a<i;a++){var o=r[a];if(o.item===e||o.props.key===e.key||t===b1(o.item.type)&&n===o.childIndex)return o}return null}},{key:"renderAxis",value:function(e,t,n,a){var i=this.props,o=i.width,s=i.height;return r.createElement(i9,Toe({},e,{className:"recharts-".concat(e.axisType," ").concat(e.axisType),key:t.key||"".concat(n,"-").concat(a),viewBox:{x:0,y:0,width:o,height:s},ticksGenerator:this.axesTicksGenerator}))}},{key:"renderClipPath",value:function(){var e=this.clipPathId,t=this.state.offset,n=t.left,a=t.top,i=t.height,o=t.width;return r.createElement("defs",null,r.createElement("clipPath",{id:e},r.createElement("rect",{x:n,y:a,height:i,width:o})))}},{key:"getXScales",value:function(){var e=this.state.xAxisMap;return e?Object.entries(e).reduce((function(e,t){var n=Eoe(t,2),r=n[0],a=n[1];return Uoe(Uoe({},e),{},Boe({},r,a.scale))}),{}):null}},{key:"getYScales",value:function(){var e=this.state.yAxisMap;return e?Object.entries(e).reduce((function(e,t){var n=Eoe(t,2),r=n[0],a=n[1];return Uoe(Uoe({},e),{},Boe({},r,a.scale))}),{}):null}},{key:"getXScaleByAxisId",value:function(e){var t,n;return null===(t=this.state.xAxisMap)||void 0===t||null===(n=t[e])||void 0===n?void 0:n.scale}},{key:"getYScaleByAxisId",value:function(e){var t,n;return null===(t=this.state.yAxisMap)||void 0===t||null===(n=t[e])||void 0===n?void 0:n.scale}},{key:"getItemByXY",value:function(e){var t=this.state.formattedGraphicalItems;if(t&&t.length)for(var n=0,r=t.length;n<r;n++){var a=t[n],i=a.props,o=a.item,s=b1(o.type);if("Bar"===s){var u=(i.data||[]).find((function(t){return q6(e,t)}));if(u)return{graphicalItem:a,payload:u}}else if("RadialBar"===s){var c=(i.data||[]).find((function(t){return y6(e,t)}));if(c)return{graphicalItem:a,payload:c}}}return null}},{key:"render",value:function(){var e=this;if(!A1(this))return null;var t=this.props,n=t.children,a=t.className,i=t.width,o=t.height,s=t.style,u=t.compact,c=t.title,l=t.desc,f=Noe(t,Soe),h=E1(f),d={CartesianGrid:{handler:this.renderGrid,once:!0},ReferenceArea:{handler:this.renderReferenceElement},ReferenceLine:{handler:this.renderReferenceElement},ReferenceDot:{handler:this.renderReferenceElement},XAxis:{handler:this.renderXAxis},YAxis:{handler:this.renderYAxis},Brush:{handler:this.renderBrush,once:!0},Bar:{handler:this.renderGraphicChild},Line:{handler:this.renderGraphicChild},Area:{handler:this.renderGraphicChild},Radar:{handler:this.renderGraphicChild},RadialBar:{handler:this.renderGraphicChild},Scatter:{handler:this.renderGraphicChild},Pie:{handler:this.renderGraphicChild},Funnel:{handler:this.renderGraphicChild},Tooltip:{handler:this.renderCursor,once:!0},PolarGrid:{handler:this.renderPolarGrid,once:!0},PolarAngleAxis:{handler:this.renderPolarAxis},PolarRadiusAxis:{handler:this.renderPolarAxis},Customized:{handler:this.renderCustomized}};if(u)return r.createElement(F1,Toe({},h,{width:i,height:o,title:c,desc:l}),this.renderClipPath(),O1(n,d));var p=this.parseEventsOfWrapper();return r.createElement("div",Toe({className:c$()("recharts-wrapper",a),style:Uoe({position:"relative",cursor:"default",width:i,height:o},s)},p,{ref:function(t){e.container=t},role:"region"}),r.createElement(F1,Toe({},h,{width:i,height:o,title:c,desc:l}),this.renderClipPath(),O1(n,d)),this.renderLegend(),this.renderTooltip())}}],a&&Ooe(t.prototype,a),i&&Ooe(t,i),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.Component),Boe(t,"displayName",n),Boe(t,"defaultProps",Uoe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),Boe(t,"getDerivedStateFromProps",(function(e,t){var n=e.data,r=e.children,a=e.width,i=e.height,o=e.layout,s=e.stackOffset,u=e.margin;if(t1()(t.updateId)){var c=ese(e);return Uoe(Uoe(Uoe({},c),{},{updateId:0},p(Uoe(Uoe({props:e},c),{},{updateId:0}),t)),{},{prevData:n,prevWidth:a,prevHeight:i,prevLayout:o,prevStackOffset:s,prevMargin:u,prevChildren:r})}if(n!==t.prevData||a!==t.prevWidth||i!==t.prevHeight||o!==t.prevLayout||s!==t.prevStackOffset||!s1(u,t.prevMargin)){var l=ese(e),f={chartX:t.chartX,chartY:t.chartY,isTooltipActive:t.isTooltipActive},h=Uoe(Uoe({},Qoe(t,n,o)),{},{updateId:t.updateId+1}),d=Uoe(Uoe(Uoe({},l),f),h);return Uoe(Uoe(Uoe({},d),p(Uoe({props:e},d),t)),{},{prevData:n,prevWidth:a,prevHeight:i,prevLayout:o,prevStackOffset:s,prevMargin:u,prevChildren:r})}if(!T1(r,t.prevChildren)){var v=!t1()(n)?t.updateId:t.updateId+1;return Uoe(Uoe({updateId:v},p(Uoe(Uoe({props:e},t),{},{updateId:v}),t)),{},{prevChildren:r})}return null})),Boe(t,"renderActiveDot",(function(e,t){var n;return n=(0,r.isValidElement)(e)?(0,r.cloneElement)(e,t):q0()(e)?e(t):r.createElement(F6,t),r.createElement(U1,{className:"recharts-active-dot",key:t.key},n)})),t}({chartName:"AreaChart",GraphicalChild:gse,axisComponents:[{axisType:"xAxis",AxisComp:mse},{axisType:"yAxis",AxisComp:yse}],formatAxisMap:function(e,n,r,a,i){var o=e.width,s=e.height,u=e.layout,c=e.children,l=Object.keys(n),f={left:r.left,leftMirror:r.left,right:o-r.right,rightMirror:o-r.right,top:r.top,topMirror:r.top,bottom:s-r.bottom,bottomMirror:s-r.bottom},h=!!C1(c,Rie);return l.reduce((function(o,s){var c,l,d,p,v,g=n[s],m=g.orientation,y=g.domain,b=g.padding,x=void 0===b?{}:b,k=g.mirror,w=g.reversed,I="".concat(m).concat(k?"Mirror":"");if("number"===g.type&&("gap"===g.padding||"no-gap"===g.padding)){var C=y[1]-y[0],A=1/0,S=g.categoricalDomain.sort();S.forEach((function(e,t){t>0&&(A=Math.min((e||0)-(S[t-1]||0),A))}));var _=A/C,E="vertical"===g.layout?r.height:r.width;if("gap"===g.padding&&(c=_*E/2),"no-gap"===g.padding){var T=R0(e.barCategoryGap,_*E),N=_*E/2;c=N-T-(N-T)/E*T}}l="xAxis"===a?[r.left+(x.left||0)+(c||0),r.left+r.width-(x.right||0)-(c||0)]:"yAxis"===a?"horizontal"===u?[r.top+r.height-(x.bottom||0),r.top+(x.top||0)]:[r.top+(x.top||0)+(c||0),r.top+r.height-(x.bottom||0)-(c||0)]:g.range,w&&(l=[l[1],l[0]]);var O=function(e,n,r){var a=e.scale,i=e.type,o=e.layout,s=e.axisType;if("auto"===a)return"radial"===o&&"radiusAxis"===s?{scale:v9(),realScaleType:"band"}:"radial"===o&&"angleAxis"===s?{scale:hee(),realScaleType:"linear"}:"category"===i&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:m9(),realScaleType:"point"}:"category"===i?{scale:v9(),realScaleType:"band"}:{scale:hee(),realScaleType:"linear"};if(A0()(a)){var u="scale".concat(W3()(a));return{scale:(t[u]||m9)(),realScaleType:t[u]?u:"point"}}return q0()(a)?{scale:a}:{scale:m9(),realScaleType:"point"}}(g,i,h),R=O.scale,P=O.realScaleType;R.domain(y).range(l),function(e){var t=e.domain();if(t&&!(t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-Sae,i=Math.max(r[0],r[1])+Sae,o=e(t[0]),s=e(t[n-1]);(o<a||o>i||s<a||s>i)&&e.domain([t[0],t[n-1]])}}(R);var D=function(e,t){var n=t.realScaleType,r=t.type,a=t.tickCount,i=t.originalDomain,o=t.allowDecimals,s=n||t.scale;if("auto"!==s&&"linear"!==s)return null;if(a&&"number"===r&&i&&("auto"===i[0]||"auto"===i[1])){var u=e.domain();if(!u.length)return null;var c=nae(u,a,o);return e.domain([I9()(c),k9()(c)]),{niceTicks:c}}if(a&&"number"===r){var l=e.domain();return{niceTicks:rae(l,a,o)}}return null}(R,Fie(Fie({},g),{},{realScaleType:P}));"xAxis"===a?(v="top"===m&&!k||"bottom"===m&&k,d=r.left,p=f[I]-v*g.height):"yAxis"===a&&(v="left"===m&&!k||"right"===m&&k,d=f[I]-v*g.width,p=r.top);var M=Fie(Fie(Fie({},g),D),{},{realScaleType:P,x:d,y:p,scale:R,width:"xAxis"===a?r.width:g.width,height:"yAxis"===a?r.height:g.height});return M.bandSize=Mae(M,D),g.hide||"xAxis"!==a?g.hide||(f[I]+=(v?-1:1)*M.width):f[I]+=(v?-1:1)*M.height,Fie(Fie({},o),{},Lie({},s,M))}),{})}});function xse(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function kse(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function wse(e){return wse="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wse(e)}function Ise(e,t){kse(2,arguments);var n=function(e){kse(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===wse(e)&&"[object Date]"===t?new Date(e.getTime()):"number"===typeof e||"[object Number]"===t?new Date(e):("string"!==typeof e&&"[object String]"!==t||"undefined"===typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}(e),r=xse(t);return isNaN(r)?new Date(NaN):r?(n.setDate(n.getDate()+r),n):n}var Cse=function(e){var t=e.loginDatesObject,n=(0,r.useRef)(),a=(0,r.useRef)(),i=E((0,r.useState)([]),2),o=(i[0],i[1],E((0,r.useState)({}),2)),s=o[0],u=o[1],c=E((0,r.useState)({}),2),l=(c[0],c[1]);function f(e){e.stopPropagation()}function h(e){var t=[];return Object.keys(e).forEach((function(e){t.push(e)})),t}(0,r.useEffect)((function(){var e=function(e){var t=[];return Object.entries(e).forEach((function(e){t.push({id:e[0],loginDates:h(e[1])})})),t}(t);!function(e){var t={},n={};e.forEach((function(e){null!==e&&void 0!==e&&e.loginDates&&Array.isArray(e.loginDates)&&e.loginDates.forEach((function(e,r){0==r&&(n[e]?n[e]++:n[e]=1),t[e]?t[e]++:t[e]=1}))}));var r=[];Object.entries(t).forEach((function(e){r.push({date:e[0],count:e[1]})}));var a=[];Object.entries(n).forEach((function(e){a.push({date:e[0],count:e[1]})})),r=function(e){return e.sort((function(e,t){return t.date>e.date?-1:1}))}(r),u(r),l(a)}(e)}),[t]),(0,r.useEffect)((function(){!function(){var e=new Date,t=[];t[0]=qQ(function(e,t){return kse(2,arguments),Ise(e,-xse(t))}(e,p)),t[1]=qQ(e),m(t),n.current.value=t[0],a.current.value=t[1]}()}),[]);var d=E((0,r.useState)(7),2),p=d[0],v=(d[1],E((0,r.useState)([]),2)),g=v[0],m=v[1];return(0,O.jsxs)("div",{onClick:f,className:"chartArea",children:[(0,O.jsx)("input",{type:"date",onClick:f,ref:n,onChange:function(){m([n.current.value,g[1]])},defaultValue:g[0]})," to ",(0,O.jsx)("input",{type:"date",onClick:f,ref:a,onChange:function(){m([g[0],a.current.value])},defaultValue:g[1]}),(0,O.jsx)("div",{className:"chartTitle",children:"User Logins by Day"}),(0,O.jsx)(B0,{width:"100%",aspect:3,children:(0,O.jsxs)(bse,{data:function(e,t){if(!e||!Array.isArray(e)||0==e.length||!t||!Array.isArray(t))return[];new Date(t[0]);for(var n=new Date(t[0]),r=new Date(t[1]),a={};n<=r;)n=Ise(n,1),a[qQ(n)]=0;e.forEach((function(e){void 0!=a[e.date]&&(a[e.date]=e.count)}));var i=[];return Object.entries(a).forEach((function(e){i.push({date:e[0],count:e[1]})})),i}(s,g),margin:{top:10,right:30,left:0,bottom:0},children:[(0,O.jsx)(mse,{dataKey:"date"}),(0,O.jsx)(yse,{}),(0,O.jsx)(U3,{}),(0,O.jsx)(gse,{type:"monotone",dataKey:"count",stroke:"#8884d8",fill:"#8884d8"})]})})]})};var Ase=function(){var e=E((0,r.useState)(),2),t=(e[0],e[1],(0,r.useRef)()),n=(0,r.useRef)(),a=(0,r.useRef)(),i=(0,r.useRef)(),o=(0,r.useRef)(),s=(0,r.useRef)(),u=(0,r.useRef)(),c=(0,r.useRef)(),l=(0,r.useRef)(),f=(0,r.useRef)(),h=(0,r.useRef)(),d=E((0,r.useState)({id:"temp",title:"Admin Post Title",postPropagation:"All Users",postFrequency:"Once"}),2),p=d[0],v=d[1],m=E((0,r.useState)(),2),y=m[0],b=m[1],x=A(),k=g((function(e){return e.dataSlice.adminPostData}));function w(){var e=t.current.value,r=n.current.value,d=a.current.value,g=i.current.value,m=o.current.value,y=u.current.value,b=s.current.value,x=c.current.value,k=l.current.value,w=f.current.value,I=h.current.value,C={id:(null===p||void 0===p?void 0:p.id)||"temp",adminPost:!0,title:e,text:r,previewUrl:d,mainUrl:g,displayType:m,postFrequency:y,postPropagation:b,pageUrl:x,userPageUrl:k,redditUrl:w,viewsPerTime:I},A={};Object.entries(C).forEach((function(e){void 0!=e[1]&&""!==e[1]&&(A[e[0]]=e[1])})),v(A)}function I(e){e.stopPropagation(),x(LQ(null))}return(0,r.useEffect)((function(){k&&v(tt({},k))}),[]),(0,O.jsxs)("div",{className:"pageCreationWindow",onClick:function(e){e.stopPropagation()},children:[(0,O.jsxs)("div",{className:"postCreationInputSide",children:[(0,O.jsx)("div",{className:"closeButton",onClick:I,children:"X"}),(0,O.jsxs)("div",{children:[(0,O.jsx)("input",{placeholder:"Post Title",ref:t,onChange:w,defaultValue:null===p||void 0===p?void 0:p.title}),(0,O.jsx)("input",{placeholder:"Post Text",ref:n,onChange:w,defaultValue:null===p||void 0===p?void 0:p.text}),(0,O.jsx)("input",{placeholder:"Preview Url",ref:a,onChange:w,defaultValue:null===p||void 0===p?void 0:p.previewUrl}),(0,O.jsx)("input",{placeholder:"Main Url",ref:i,onChange:w,defaultValue:null===p||void 0===p?void 0:p.mainUrl}),(0,O.jsx)("input",{placeholder:"Page Url (optional)",ref:c,onChange:w,defaultValue:null===p||void 0===p?void 0:p.pageUrl}),(0,O.jsx)("input",{placeholder:"User Page Url (optional)",ref:l,onChange:w,defaultValue:null===p||void 0===p?void 0:p.userPageUrl}),(0,O.jsx)("input",{placeholder:"Reddit Url (optional)",ref:f,onChange:w,defaultValue:null===p||void 0===p?void 0:p.redditUrl}),(0,O.jsx)("input",{placeholder:"Views / Time",ref:h,onChange:w,defaultValue:null===p||void 0===p?void 0:p.viewsPerTime,title:"The number of times the user will see the admin post per unit of time. \nExample: 2 and Once means the user will see the post twice. \nExample: 2 and Per Week means the user will see the post 2 times per week."}),(0,O.jsxs)("select",{ref:o,onChange:w,value:null===p||void 0===p?void 0:p.displayType,children:[(0,O.jsx)("option",{children:"text"}),(0,O.jsx)("option",{children:"image"}),(0,O.jsx)("option",{children:"iframe"}),(0,O.jsx)("option",{children:"video"})]}),(0,O.jsxs)("select",{ref:u,onChange:w,title:"This is how often the users will see this post",value:null===p||void 0===p?void 0:p.postFrequency,children:[(0,O.jsx)("option",{title:"The user(s) will see this post <Views/Time> times",children:"Once"}),(0,O.jsx)("option",{title:"The user(s) will see this post <Views/Time> per week",children:"Per Day"}),(0,O.jsx)("option",{title:"The user(s) will see this post <Views/Time> per week",children:"Per Week"}),(0,O.jsx)("option",{title:"The user(s) will see this post <Views/Time> per month",children:"Per Month"}),(0,O.jsx)("option",{title:"The user(s) will see this post <Views/Time> every 2 months",children:"Per 2 Months"}),(0,O.jsx)("option",{title:"The user(s) will see this post <Views/Time> times every time they log i ",children:"Every Login"})]}),(0,O.jsxs)("select",{ref:s,onChange:w,value:null===p||void 0===p?void 0:p.postPropagation,children:[(0,O.jsx)("option",{title:"All users will see this post",children:"All Users"}),(0,O.jsx)("option",{title:"This post can be added to some users profiles",children:"Specific Users"})]})]}),(0,O.jsxs)("div",{className:"postCreationButtons",children:[(0,O.jsx)("button",{onClick:I,children:"Cancel"}),(0,O.jsx)("button",{onClick:function(){var e=tt({},p);if(e.title&&e.displayType){var t="redflix/adminPosts";if("Specific Users"===e.postPropagation&&(t="redflix/adminPostsSpecific"),"temp"===e.id){var n=Dd(Rd(uJ,t));e.id=n.key,v(e),Fd(n,e).then((function(){b("Saved New Post")})).catch((function(e){b("Error saving post "+e.message)}))}else Fd(Rd(uJ,t+"/"+e.id),e).then((function(){b("Updated Post")})).catch((function(e){b("Error Updating Post")}))}else b("Not enough input to create a post")},children:"Save"}),(0,O.jsx)("button",{onClick:function(){if(null!==p&&void 0!==p&&p.id&&"temp"!==(null===p||void 0===p?void 0:p.id)){var e="redflix/adminPosts";"Specific Users"===(null===p||void 0===p?void 0:p.postPropagation)&&(e="redflix/adminPostsSpecific"),Md(Rd(uJ,e+"/"+p.id))}},children:"Delete"})]}),(0,O.jsx)("div",{className:"postCreationMessage",children:y})]}),(0,O.jsx)("div",{className:"postCreationPreviewSide",children:(0,O.jsx)(s$,{postData:p})})]})};var Sse=function(){g((function(e){return e.dataSlice.showAdminPostEditor}));var e=g((function(e){return e.userDataSlice.blur})),t=(g((function(e){return e.userDataSlice.userId})),A());return(0,O.jsxs)("div",{children:[(0,O.jsx)("button",{onClick:function(e){e.stopPropagation(),Ld(Rd(uJ,"redflix")).then((function(e){console.log("Entire redflix database: "),console.log(e.val())}))},children:"Log Entire Database"}),(0,O.jsx)("button",{onClick:function(e){e.stopPropagation(),t(LQ({id:"temp",title:"New Admin Post",displayType:"text"}))},children:"Create post"}),(0,O.jsx)("button",{onClick:function(n){n.stopPropagation(),t(TJ(!e))},children:"Toggle Blur"})]})};var _se=function(e){e.Component;var t=e.title,n=e.defaultOpen,a=e.children,i=E((0,r.useState)(!1),2),o=i[0],s=i[1];return(0,r.useEffect)((function(){n&&s(!0)}),[]),(0,O.jsxs)("div",{className:"adminSection",onClick:function(e){e.stopPropagation(),s(!o)},children:[(0,O.jsx)("div",{className:"adminSectionTitle",children:t}),o&&a]})};var Ese=function(e){var t=e.data,n=E((0,r.useState)(!1),2),a=n[0],i=n[1],o=E((0,r.useState)([]),2),s=o[0],u=o[1],c=E((0,r.useState)([]),2),l=c[0],f=c[1],h=E((0,r.useState)([]),2),d=h[0],p=h[1],v=g((function(e){return e.userDataSlice.allUsersJson}));function m(e){return e.sort((function(e,t){return t.count-e.count}))}return(0,r.useEffect)((function(){!function(){var e=[];t.postClicks&&Object.entries(t.postClicks).forEach((function(t){var n,r;e.push({link:null===(n=t[1])||void 0===n?void 0:n.link,count:null===(r=t[1])||void 0===r?void 0:r.count})}));u(m(e));var n=[];t.pageClicks&&Object.entries(t.pageClicks).forEach((function(e){var t;n.push({link:"r/"+e[0],count:null===(t=e[1])||void 0===t?void 0:t.count})}));p(m(n));var r=[];t.userPagesClicks&&Object.entries(t.userPagesClicks).forEach((function(e){var t;r.push({link:"user/"+e[0],count:null===(t=e[1])||void 0===t?void 0:t.count})}));f(m(r))}()}),[]),(0,O.jsxs)("div",{className:"userDataViewer",onClick:function(e){e.stopPropagation(),i(!a)},children:["Name: ",function(e){var t="blue";try{var n;t=null===(n=v[e])||void 0===n?void 0:n.name}catch(r){}return t}(null===t||void 0===t?void 0:t.id),a&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(_se,{title:"Top Posts",children:(0,O.jsx)(zJ,{array:s,Component:QJ})}),(0,O.jsx)(_se,{title:"Top Pages",children:(0,O.jsx)(zJ,{array:d,Component:QJ})}),(0,O.jsx)(_se,{title:"Top User Pages",children:(0,O.jsx)(zJ,{array:l,Component:QJ,componentProp:!0})})]})]})},Tse=n.p+"static/media/editIconSW.3aaf1d15399aa57d3a2b.png";var Nse=function(e){var t=e.data,n=A();return(0,O.jsxs)("div",{className:"adminPostViwer",onClick:function(e){e.stopPropagation(),e.preventDefault()},children:[(0,O.jsx)("div",{className:"editIcon",onClick:function(e){e.stopPropagation(),n(LQ(t))},children:(0,O.jsx)("img",{src:Tse})}),(0,O.jsx)(s$,{postData:t})]})};var Ose=function(){var e=E((0,r.useState)([]),2),t=e[0],n=e[1],a=E((0,r.useState)([]),2),i=a[0],o=a[1],s=E((0,r.useState)([]),2),u=s[0],c=s[1],l=E((0,r.useState)([]),2),f=l[0],h=l[1],d=E((0,r.useState)({}),2),p=d[0],v=d[1],m=E((0,r.useState)([]),2),y=m[0],b=m[1],x=g((function(e){return e.dataSlice.adminPostData}));function k(e){return e.sort((function(e,t){return t.count-e.count}))}return(0,r.useEffect)((function(){Bd(Rd(uJ,"redflix/userActivity"),(function(e){var t=[];Object.entries(e.val()).forEach((function(e){var n=e[1];n.id=e[0],t.push(n)})),h(t)})),Bd(Rd(uJ,"redflix/loginDates"),(function(e){v(e.val())})),Bd(Rd(uJ,"redflix/stats"),(function(e){var t=e.val().posts;n(k(Object.values(t)));var r=e.val().pages,a=[];Object.entries(r).forEach((function(e){var t;a.push({link:"r/"+e[0],count:null===(t=e[1])||void 0===t?void 0:t.count})})),c(k(a));var i=e.val().userPages;a=[],Object.entries(i).forEach((function(e){var t;a.push({link:"user/"+e[0],count:null===(t=e[1])||void 0===t?void 0:t.count})})),o(k(a))})),Bd(Rd(uJ,"redflix/adminPosts"),(function(e){var t=[];Object.values(e.val()).forEach((function(e){t.push(e)})),b(t)}))}),[]),(0,O.jsxs)("div",{className:"adminContainer",children:[(0,O.jsx)(_se,{title:"Charts",defaultOpen:!0,children:(0,O.jsx)(Cse,{loginDatesObject:p})}),(0,O.jsx)(_se,{title:"Top Posts",children:(0,O.jsx)(zJ,{array:t,Component:QJ})}),(0,O.jsx)(_se,{title:"Top Pages",children:(0,O.jsx)(zJ,{array:u,Component:QJ})}),(0,O.jsx)(_se,{title:"Top User Pages",children:(0,O.jsx)(zJ,{array:i,Component:QJ})}),(0,O.jsx)(_se,{title:"User Activity Data",children:(0,O.jsx)(zJ,{array:f,Component:Ese})}),(0,O.jsx)(_se,{title:"Admin Posts",children:(0,O.jsx)(zJ,{array:y,Component:Nse})}),(0,O.jsx)(_se,{title:"DB Actions",children:(0,O.jsx)(Sse,{})}),x&&(0,O.jsx)(Ase,{})]})},Rse=n.p+"static/media/sendIconWS.5a3df572f5c864b59991.png";var Pse=function(){var e=g((function(e){return e.userDataSlice.userId})),t=g((function(e){return e.userDataSlice.allUsersJson})),n=E((0,r.useState)([]),2),a=n[0],i=n[1],o=(0,r.useRef)();function s(e){var n="blue";try{var r;n=null===(r=t[e])||void 0===r?void 0:r.name}catch(a){}return n}function u(e){var n="blue";try{var r;n=null===(r=t[e])||void 0===r?void 0:r.favColor}catch(a){}return n}function c(){var t,n;if(""!==(null===(t=o.current)||void 0===t?void 0:t.textContent))if(a.length>3&&a[0].userId===e&&a[1].userId===e&&a[2].userId===e)alert("One user can only send 3 messages in a row");else{var r=Dd(Rd(uJ,"redflix/forum"));Fd(r,{userId:e,message:null===(n=o.current)||void 0===n?void 0:n.textContent,date:qQ(new Date,!0),key:r.key}),o.current.textContent=""}}return(0,r.useEffect)((function(){o.current.focus(),Bd(Rd(uJ,"redflix/forum"),(function(e){i(function(e){var t=[];return e.forEach((function(e){t=[e].concat(X(t))})),t}(Object.values(e.val())))}))}),[]),(0,O.jsxs)("div",{className:"forum",children:[(0,O.jsx)("div",{className:"forumHeader",children:"Welcome to the Redflix forum"}),(0,O.jsx)("div",{className:"messagesContainer",children:a.map((function(e){return(0,O.jsxs)("div",{className:"messageBox",children:[(0,O.jsx)("div",{className:"messageUser",style:{color:u(e.userId)},children:s(e.userId)}),(0,O.jsx)("div",{className:"messageDate",children:e.date}),(0,O.jsx)("div",{className:"message",children:e.message})]})}))}),(0,O.jsx)("div",{className:"messageInputArea",children:(0,O.jsxs)("div",{className:"messageInputBox",children:[(0,O.jsx)("div",{ref:o,contentEditable:!0,className:"inputBox"}),(0,O.jsx)("div",{onClick:c,className:"sendButton",children:(0,O.jsx)("img",{src:Rse})})]})})]})},Dse=n.p+"static/media/rIcon80.fbc2d6e84d92b7ea0a7f.png";var Mse=function(e){var t=(0,r.useRef)(),n=g((function(e){return e.dataSlice.linkToAdd})),a=A();function i(n){var r=t.current.value;console.log("adding "+r),r?(a(tJ(r)),a(mJ(r)),n&&e.close&&e.close()):console.log("input values are not valid")}return(0,r.useEffect)((function(){}),[]),(0,O.jsxs)("div",{className:"addToListMenu",children:[(0,O.jsx)("div",{className:"closeButton",onClick:e.close,children:"X"}),(0,O.jsxs)("div",{className:"addListSection",children:[(0,O.jsx)("div",{className:"addListSectionDescription",children:"Url To Add"}),(0,O.jsx)("div",{children:(0,O.jsx)("input",{defaultValue:n,className:"addToListMenuInput",ref:t})}),(0,O.jsx)("button",{onClick:function(){return i(!0)},children:"Add and Close"})]}),(0,O.jsxs)("div",{className:"addListSection",children:[(0,O.jsx)("div",{className:"addListSectionDescription",children:"List to add it to"}),(0,O.jsx)("div",{children:(0,O.jsx)(KJ,{adder:!0})}),(0,O.jsx)("button",{onClick:function(){return i()},children:"Add to List"})]})]})};var Fse=function(e){var t=e.columnIndex,n=e.columns,a=(e.widthStyle,g((function(e){return e.dataSlice.postArray}))),i=E((0,r.useState)([]),2),o=i[0],s=i[1],u=g((function(e){return e.dataSlice.loading}));(0,r.useEffect)((function(){}),[]),(0,r.useEffect)((function(){s(c())}),[a]);var c=function(){if(void 0==t)return a;var e=2;void 0!=n&&(e=n);var r=[];return a.forEach((function(n,a){if(a%e==t){var i=tt({},n);i.index=a,r.push(i)}})),r};return(0,O.jsxs)("div",{className:"column ",children:[o.map((function(e,t){var n;return(0,O.jsx)(s$,{postData:e,lastPost:t==o.length-2||t+1==o.length,index:t},(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.id)+""+t)})),u&&(0,O.jsx)("div",{className:"post loadingPost",children:"Loading..."})]})};var Lse=function(){var e=A(),t=g((function(e){return e.dataSlice.sub})),n=(0,r.useRef)(),a=(0,r.useRef)(),i=(0,r.useRef)(!1),o=g((function(e){return e.dataSlice.showAddToListMenu})),s=g((function(e){return e.dataSlice.postArray})),u=g((function(e){return e.userDataSlice.adminPostArray})),c=(0,r.useRef)(),l=g((function(e){return e.userDataSlice.seenAdminPosts})),f=(0,r.useRef)(),h=g((function(e){return e.dataSlice.lastPostId})),d=(0,r.useRef)(),p=E((0,r.useState)(2),2),v=p[0],m=p[1],y=E((0,r.useState)({}),2),b=y[0],x=y[1],k=g((function(e){return e.userDataSlice.postWeightArray})),w=(0,r.useRef)(),I=(0,r.useRef)(),C=10,S=E((0,r.useState)(!1),2),_=(S[0],S[1]),T=(0,r.useRef)(0);function N(){var e=2;e=window.innerWidth<800?1:window.innerWidth<1600?2:3,m(e)}(0,r.useEffect)((function(){w.current=k,"home"==n.current&&function(){j.apply(this,arguments)}()}),[k]),(0,r.useEffect)((function(){c.current=u}),[u]),(0,r.useEffect)((function(){f.current=l}),[l]),(0,r.useEffect)((function(){a.current=h}),[h]),(0,r.useEffect)((function(){N(),e(NQ()),e(rJ()),R.current=new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){if(i.current)return;e(FQ(!0));var r=t.target.classList,a=!1;if(r.forEach((function(e){"last-post"===e&&(a=!0)})),!a)return;"home"===n.current?U():ee();for(var o=document.getElementsByClassName("last-post"),s=0;s<o.length;s++)t=o[s],R.current.unobserve(t)}}))})),function(){var t={threshold:.5};D.current=new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){var n,r=t.target;r.classList.forEach((function(e){e.includes("ID=")&&(n=e.split("ID=")[1])})),e(aJ(n)),D.current.unobserve(r)}}))}),t)}(),window.addEventListener("resize",(function(){N()})),setTimeout((function(){_(!0)}),1e3)}),[]),(0,r.useEffect)((function(){t&&(n.current=t,"home"===t?function(){var t=window.localStorage.getItem("savedPosts");if(!t)return!1;var n=JSON.parse(t),r=[];return Object.values(n).forEach((function(e){r.push(e)})),r=Z(r),e(MQ(r)),!0}()||(zQ("in fast load. Time: "+performance.now()),Ld(Rd(uJ,"redflix/fastLoad")).then((function(t){var n=[];Object.values(t.child("posts").val()).forEach((function(e){n.push(e)})),n=Z(n),e(OQ(n))}))):(!function(){Q.apply(this,arguments)}(),ee()))}),[t]),(0,r.useEffect)((function(){d.current=s}),[s]);var R=(0,r.useRef)();function P(){document.querySelectorAll(".last-post").forEach((function(e){R.current.observe(e)}))}(0,r.useRef)(),(0,r.useRef)(0),(0,r.useRef)(!1),(0,r.useRef)(),(0,r.useRef)();var D=(0,r.useRef)();function M(){document.querySelectorAll(".unobserved").forEach((function(e){D.current.observe(e),e.classList.remove("unobserved")}))}function F(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*C;if(e){var r="";if(r="https://www.reddit.com/"+e+".json?",n&&(r+="&limit="+n),I.current){var a=r.split(".json?");r=a[0]+"/"+I.current+".json?"+a[1]+"&t=year"}return t&&(r+="&after="+t),r}}(0,r.useRef)(),(0,r.useRef)(),(0,r.useRef)(),(0,r.useRef)(),(0,r.useRef)([{link:"r/catgifs",lastPostId:null},{link:"r/dogs",lastPostId:null},{link:"r/itookapicture",lastPostId:null},{link:"r/damnthatsinteresting",lastPostId:null}]),(0,r.useRef)([]);var L=(0,r.useRef)();function j(){return j=V(B().mark((function t(){var n,r,a;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(w.current){t.next=3;break}return console.log("in checkAddToPostDataArray with no postWeightArrayRef"),t.abrupt("return");case 3:return e(FQ(!0)),n=[],w.current.forEach((function(e){var t,r=null===(t=e.link)||void 0===t?void 0:t.toLowerCase(),a=!1;L.current&&Array.isArray(L.current)&&L.current.forEach((function(e){e.link===r&&(a=!0)})),a||n.push(r)})),r=[],n.forEach((function(e){var t=F(e,null,2*C);t&&r.push(fetch(t))})),a=[],t.next=11,Promise.all(r).then((function(e){e.forEach((function(e){a.push(e.json())})),Promise.all(a).then((function(e){var t=[];e.forEach((function(e){var n=bQ(e.data.children)[0];t.push(n)})),z(t,L.current)}))}));case 11:case"end":return t.stop()}}),t)}))),j.apply(this,arguments)}function z(e,t){var n=[];e.forEach((function(e){n.push(function(e){var t=[];return e.forEach((function(e){"text"!==(null===e||void 0===e?void 0:e.displayType)&&t.push(e)})),t}(e))}));var r=[];(e=n).forEach((function(e){var t,n;r.push({link:null===(t=e[0])||void 0===t?void 0:t.subreddit_name_prefixed.toLowerCase().replaceAll("u/","user/"),postArray:e,index:0,lastPostID:null===(n=e[e.length-1])||void 0===n?void 0:n.id})})),t&&(r=[].concat(X(t),X(r))),L.current=r,t||U()}function U(){for(var t=[],n=0;n<C;n++)t.push(G());L.current.forEach((function(e){e.index>=e.postArray.length-2*C&&function(e,t){var n=F(e,t);n&&fetch(n).then((function(e){return e.json()})).then((function(t){var n,r=[],a=null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.children;a&&(r=bQ(a,d.current)[0],function(e,t){for(var n=X(L.current),r=0;r<n.length;r++)if(n[r].link===e){var a=[].concat(X(n[r].postArray),X(t));n[r].postArray=a;var i=t[t.length-1],o=i.id;n[r].lastPostID=o}L.current=n}(e,r))}))}(e.link,e.lastPostID)})),e(OQ(t)),function(e){q.apply(this,arguments)}(t),setTimeout((function(){P(),M()}),1e3)}function W(){if(!c.current||!Array.isArray(c.current)||0==c.current.length)return console.log("there are no posts in the adminPostArray"),null;var t=null;return T.current%10==0&&(console.log("user has seen these admin posts: "),console.log(f.current),t=c.current[0],console.log("chosen admin post: "),console.log(t),e(NJ(t.id))),t}function G(){var e,t=(Y(e={id:"none",mainUrl:null,type:"text",displayType:"text",previewUrl:null,title:"No Post Found",permalink:"data?.permalink"},"title","No Post Found"),Y(e,"subreddit_name_prefixed","data?.subreddit_name_prefixed"),Y(e,"author","data?.author"),Y(e,"text","No Post Found"),Y(e,"kind","rawPostData?.kind"),Y(e,"index","rawPostData?.index"),e),n=0,r=[],a=[];w.current.forEach((function(e){"sfw"===e.type?a.push(e):r.push(e)}));var i=1;a.forEach((function(e){i+=e.weight}));var o=1;for(r.forEach((function(e){o+=e.weight}));"none"===(null===(s=t)||void 0===s?void 0:s.id)&&n<100;){var s,u=H(100);(t=W())?(console.log("chose a post from chooseAdminPost in chosePostFromWeight: "),console.log(t)):(u<15?a.forEach((function(e){H(i)<e.weight&&(t=K(e.link))})):r.forEach((function(e){H(o)<e.weight&&(t=K(e.link))})),n++)}return t?T.current++:t=K(r[0].link),t}function H(e){return Math.floor(Math.random()*e)}function K(e){var t=e;"string"===typeof t&&(t=t.toLowerCase());var n=null;return L.current.forEach((function(e){if(e.link===t){var r=e.index,a=e.postArray;!function(e){var t=X(L.current);t.forEach((function(t){t.link===e&&t.index++})),L.current=t}(e.link),"text"===(n=a[r]).displayType&&"r/jokes"===!n.subreddit_name_prefixed&&(n=null)}})),n}function q(){return q=V(B().mark((function e(t){var n,r,a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&Array.isArray(t)&&!(t.length<6)){e.next=3;break}return e.next=3,fetch("http://reddit.com/r/gonewild.json").then((function(e){return e.json()})).then((function(e){t=bQ(Object.values(e))}));case 3:n=qQ(),r=window.localStorage.getItem("localPostArrayDate"),n!==r&&(t.length>10&&(t=t.splice(0,10)),a={},t.forEach((function(e){a[null===e||void 0===e?void 0:e.id]=e})),window.localStorage.setItem("savedPosts",JSON.stringify(a)),window.localStorage.setItem("localPostArrayDate",n)),Ld(Rd(uJ,"redflix/fastLoad/date")).then((function(e){e.val()!==n&&fetch(F("r/gonewild")).then((function(e){return e.json()})).then((function(e){var t,r=bQ(null===e||void 0===e||null===(t=e.date)||void 0===t?void 0:t.children,d.current)[0],a={};r.forEach((function(e){a[e.id]=e})),Fd(Rd(uJ,"redflix/fastLoad"),{posts:a,date:n})}))}));case 7:case"end":return e.stop()}}),e)}))),q.apply(this,arguments)}function Z(e){if(!Array.isArray(e))return[];for(var t=X(e),n=2*e.length,r=0;r<n;r++){var a=H(e.length-1),i=H(e.length-1),o=t[a];t[a]=t[i],t[i]=o}return t}function Q(){return Q=V(B().mark((function e(){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.includes("user")){e.next=6;break}return n="https://www.reddit.com/"+t+"/about.json",e.next=4,fetch(n).then((function(e){return e.json()})).then((function(e){x($(e))}));case 4:e.next=9;break;case 6:return r="https://www.reddit.com/"+t+"/about.json",e.next=9,fetch(r).then((function(e){return e.json()})).then((function(e){x(J(e))}));case 9:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function J(e){var t,n,r,a,i=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.display_name,o=AQ(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.public_description),s=null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.header_img,u=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.community_icon;return"string"===typeof u&&(u=(u=u.split("?")[0]).replaceAll("&amp;","&")),{name:i,description:o,icon:u,image:s}}function $(e){var t,n,r,a,i,o,s,u=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.subreddit)||void 0===n?void 0:n.display_name,c=AQ(null===e||void 0===e||null===(r=e.data)||void 0===r||null===(a=r.subreddit)||void 0===a?void 0:a.public_description),l=null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.total_karma,f=null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.snoovatar_img,h=null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.icon_img;return"string"===typeof h&&(h=(h=h.split("?")[0]).replaceAll("&amp;","&")),{name:u,description:c,icon:h,image:f,karma:l}}function ee(){return te.apply(this,arguments)}function te(){return te=V(B().mark((function t(){var r;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=F(n.current,a.current),i.current=!0,e(FQ(!0)),t.next=5,fetch(r).then((function(e){return e.json()})).then((function(t){var n=E(bQ(t.data.children,d.current),2),r=n[0],i=n[1];i&&(a.current=i),r.length,e(OQ(r))}));case 5:i.current=!1,setTimeout((function(){P(),M()}),1e3);case 7:case"end":return t.stop()}}),t)}))),te.apply(this,arguments)}return(0,O.jsx)("div",{className:"home",children:(0,O.jsxs)("div",{className:"homeContainer",children:[(0,O.jsx)("div",{className:"topBar",children:(0,O.jsx)("div",{children:(0,O.jsxs)("div",{className:"topBarPageInfo",children:[(0,O.jsx)("div",{className:"topBarIcon",children:null!==b&&void 0!==b&&b.icon?(0,O.jsx)("img",{src:null===b||void 0===b?void 0:b.icon}):(0,O.jsx)("img",{src:Dse})}),(0,O.jsxs)("div",{className:"topBarTextInfo",children:[(0,O.jsx)("div",{className:"userName",children:(null===b||void 0===b?void 0:b.name)||"Welcome to Redflix."}),(0,O.jsx)("div",{className:"homeRedditButton",onClick:function(e){return CQ(e,"http://reddit.com/"+t)},title:"Open on Reddit",children:(0,O.jsx)("img",{src:e$})}),(0,O.jsx)("div",{className:"userKarma",children:(null===b||void 0===b?void 0:b.karma)&&(null===b||void 0===b?void 0:b.karma)+" Karma"}),(0,O.jsx)("div",{className:"topBarDescription",children:(null===b||void 0===b?void 0:b.description)&&(null===b||void 0===b?void 0:b.description)})]})]})})}),o&&(0,O.jsx)(Mse,{close:function(){return e(PQ(!1))}}),function(e){for(var t=[],n=0;n<e;n++)t.push((0,O.jsx)(Fse,{columnIndex:n,columns:v},"column"+n)),n<e-1&&t.push((0,O.jsx)("div",{className:"spacer"},"spacer"+n));return t}(v)]})})};var jse=function(){var e=g((function(e){return e.dataSlice.page}));return(0,O.jsx)(O.Fragment,{children:"forum"===e?(0,O.jsx)(Pse,{}):"admin"===e?(0,O.jsx)(Ose,{}):(0,O.jsx)(Lse,{})})};var zse=function(){var e=A(),t=g((function(e){return e.userDataSlice.listToView}));return(0,r.useEffect)((function(){Bd(Rd(uJ,"redflix/users"),(function(t){e(dJ(t.val()))})),Bd(Rd(uJ,"redflix/adminPosts"),(function(t){var n=[];Object.entries(t.val()).forEach((function(e){var t=e[1];t.id=e[0],n.push(t)})),e(OJ(n))}))}),[]),function(e,t,n,r){Be(e).onAuthStateChanged(t,n,r)}(sJ,(function(t){var n;!function(t){if(t){if(!window.localStorage.getItem("savedAnonData")){var n=window.localStorage.getItem("anonymousID");n&&Ld(Rd(uJ,"redflix/userData/"+n)).then((function(e){var n,r=null===(n=e.child("lists"))||void 0===n?void 0:n.val();r&&Object.values(r).forEach((function(e){Fd(Dd(Rd(uJ,"redflix/userData/"+t+"/lists")),e)}));var a=e.child("name").val();a&&Fd(Rd(uJ,"redflix/userData/"+t+"/anonName"),a);var i=e.child("favColor").val();i&&Fd(Rd(uJ,"redflix/userData/"+t+"/favColor"),i),window.localStorage.setItem("savedAnonData",!0)}))}e(hJ(t)),e($Q(t)),e(SJ(!1)),Bd(Rd(uJ,"redflix/userData/"+t),(function(t){setTimeout((function(){e(IJ(t.val())),e(pJ(t.child("lists").val()))}),200)}))}else{var r=window.localStorage.getItem("anonymousID");if(r)e(hJ(r)),e($Q(r)),e(SJ(!0)),Bd(Rd(uJ,"redflix/userData/"+r),(function(t){setTimeout((function(){e(pJ(t.child("lists").val())),e(IJ(t.val()))}),200)}));else{var a=Dd(Rd(uJ,"redflix/userData"));Fd(Rd(uJ,"redflix/userData/"+a.key),{name:"Anonymous User",isAnon:!0,favColor:"rgb(".concat(Math.round(255*Math.random(0,255)),", ").concat(Math.round(255*Math.random(0,255)),", ").concat(Math.round(255*Math.random(0,255)),")"),lists:[{name:"favorites",links:[],description:"The links in this list will be added to the links the home page pulls from."},{name:"home",links:[],description:"Save your favorite pages and links for easy one click access. Use the plus button in the nav menu, select this list from the dropdown, and press add. Format is r/pageName. Full urls also work for external links."}],createdDate:(new Date).toString()}),window.localStorage.setItem("anonymousID",a.key)}}Bd(Rd(uJ,"redflix/userData/"+t+"/seenAdminPosts"),(function(t){var n=[];Object.values(t.val()).forEach((function(e){n.push(e)})),setTimeout((function(){e(RJ(n))}),250)}))}(null===t||void 0===t?void 0:t.uid),window.localStorage.setItem("mostRecentID",null===t||void 0===t?void 0:t.uid),n=null===t||void 0===t?void 0:t.uid,Bd(Rd(uJ,"redflix/userActivity/"+n+"/userRatings"),(function(t){setTimeout((function(){e(PJ(t.val()))}),250)}))})),(0,O.jsxs)("div",{className:"App",children:[(0,O.jsx)(ZJ,{}),(0,O.jsx)(jse,{}),t&&(0,O.jsx)(HJ,{})]})},Use=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))},Bse=function(e){var t,n=Ws(),r=e||{},a=r.reducer,i=void 0===a?void 0:a,o=r.middleware,s=void 0===o?n():o,u=r.devTools,c=void 0===u||u,l=r.preloadedState,f=void 0===l?void 0:l,h=r.enhancers,d=void 0===h?void 0:h;if("function"===typeof i)t=i;else{if(!zs(i))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=bs(i)}var p=s;if("function"===typeof p&&(p=p(n),!Vs&&!Array.isArray(p)))throw new Error("when using a middleware builder function, an array of middleware must be returned");if(!Vs&&p.some((function(e){return"function"!==typeof e})))throw new Error("each middleware provided to configureStore must be a function");var v=ks.apply(void 0,p),g=xs;c&&(g=js(Ms({trace:!Vs},"object"===typeof c&&c)));var m=[v];return Array.isArray(d)?m=_s([v],d):"function"===typeof d&&(m=d(m)),ys(t,f,g.apply(void 0,m))}({reducer:{dataSlice:EQ,userDataSlice:lJ,logSlice:QQ}});a.createRoot(document.getElementById("root")).render((0,O.jsx)(x,{store:Bse,children:(0,O.jsx)(zse,{})})),Use()}()}();
//# sourceMappingURL=main.0bd1ddb9.js.map